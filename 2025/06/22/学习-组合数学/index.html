<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="mask-icon" href="/images/%E5%A4%B4%E5%83%8F1.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lwlaymh.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="二项式系数 上升幂和下降幂 定义下降幂$x ^{ } &#x3D; _{ i &#x3D; 0 } ^{ k - 1 } ( x - i ) &#x3D; { ( x - k ) ! } $. 定义上升幂$x ^{ } _{ i &#x3D; 0 } ^{ k - 1 } ( x + i ) &#x3D; { ( x - 1 ) ! } $. 上升幂和下降幂的定义是可以引申到复数域的. 例如我们有加倍公式:$r ^{ } ( r">
<meta property="og:type" content="article">
<meta property="og:title" content="组合数学">
<meta property="og:url" content="http://lwlaymh.github.io/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/index.html">
<meta property="og:site_name" content="LWLAymh的备忘录">
<meta property="og:description" content="二项式系数 上升幂和下降幂 定义下降幂$x ^{ } &#x3D; _{ i &#x3D; 0 } ^{ k - 1 } ( x - i ) &#x3D; { ( x - k ) ! } $. 定义上升幂$x ^{ } _{ i &#x3D; 0 } ^{ k - 1 } ( x + i ) &#x3D; { ( x - 1 ) ! } $. 上升幂和下降幂的定义是可以引申到复数域的. 例如我们有加倍公式:$r ^{ } ( r">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-22T08:57:48.662Z">
<meta property="article:modified_time" content="2025-06-22T08:57:48.662Z">
<meta property="article:author" content="LWLAymh">
<meta property="article:tag" content="数学">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://lwlaymh.github.io/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://lwlaymh.github.io/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/","path":"2025/06/22/学习-组合数学/","title":"组合数学"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>组合数学 | LWLAymh的备忘录</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>






  <script src="/js/third-party/addtoany.js" defer></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>


<link rel="dns-prefetch" href="my-repository-jade-beta-79.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LWLAymh的备忘录</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">混乱节拍拼凑出血肉喧嚷</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">二项式系数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.1.</span> <span class="nav-text">上升幂和下降幂</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.2.</span> <span class="nav-text">二项式系数的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.3.</span> <span class="nav-text">基本的二项式恒等式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.4.</span> <span class="nav-text">扩展的二项式恒等式(整数范围内)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.5.</span> <span class="nav-text">拓展的二项式恒等式(实数范围内)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.6.</span> <span class="nav-text">卡特兰数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">Example([HNOI2009]有趣的数列)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.6.0.2.</span> <span class="nav-text">Example2([23省选10连测day7]b)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.7.</span> <span class="nav-text">二项式系数的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.7.1.</span> <span class="nav-text">通过恒等式变形求解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">Example1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.1.2.</span> <span class="nav-text">Example2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.1.3.</span> <span class="nav-text">Example3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.1.4.</span> <span class="nav-text">Example4</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.1.5.</span> <span class="nav-text">Example5</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.7.2.</span> <span class="nav-text">转化为递归式&#x2F;和式求解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">Example1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.2.2.</span> <span class="nav-text">Example2</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.7.3.</span> <span class="nav-text">利用微积分求解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.3.1.</span> <span class="nav-text">Example</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.7.4.</span> <span class="nav-text">转化为二维平面</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.7.4.1.</span> <span class="nav-text">Example1</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.8.</span> <span class="nav-text">Lucas定理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.8.0.1.</span> <span class="nav-text">Example1([CF1770F]Koxia and
Sequence)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.9.</span> <span class="nav-text">扩展Lucas定理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">斯特林数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.1.</span> <span class="nav-text">第一类斯特林数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.2.</span> <span class="nav-text">第二类斯特林数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.3.</span> <span class="nav-text">斯特林数的扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.4.</span> <span class="nav-text">基本斯特林恒等式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.5.</span> <span class="nav-text">补充斯特林恒等式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text">欧拉数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">3.1.</span> <span class="nav-text">欧拉数与二项式系数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">4.</span> <span class="nav-text">伯努利数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">5.</span> <span class="nav-text">斐波那契数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.1.</span> <span class="nav-text">斐波那契数的扩展定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.2.</span> <span class="nav-text">斐波那契数与数论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.3.</span> <span class="nav-text">斐波那契数系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.4.</span> <span class="nav-text">斐波那契数的封闭形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.5.</span> <span class="nav-text">连项式</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LWLAymh"
      src="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <p class="site-author-name" itemprop="name">LWLAymh</p>
  <div class="site-description" itemprop="description">不过是白日梦里一瞬息</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LWLAymh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LWLAymh" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lwlaymh@outlook.com" title="E-Mail → mailto:lwlaymh@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/LWLAymh" title="WeChat → LWLAymh" rel="noopener me"><i class="fab fa-skype fa-fw"></i>WeChat</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://minyuchengmin.github.io/" title="https:&#x2F;&#x2F;minyuchengmin.github.io" rel="noopener" target="_blank">ycm的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://shanlunjiajian.github.io/" title="http:&#x2F;&#x2F;shanlunjiajian.github.io" rel="noopener" target="_blank">qyc的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://www.cnblogs.com/do-while-true" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;do-while-true" rel="noopener" target="_blank">dwt的blog</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="组合数学 | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          组合数学
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-22 16:57:48" itemprop="dateCreated datePublished" datetime="2025-06-22T16:57:48+08:00">2025-06-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">具体数学</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><span id="more"></span>
<h2><span id="二项式系数">二项式系数</span></h2>
<h3><span id="上升幂和下降幂">上升幂和下降幂</span></h3>
<p>定义下降幂$x ^{ } = _{ i = 0 } ^{ k - 1 } ( x - i ) = { ( x - k ) ! }
$.</p>
<p>定义上升幂$x ^{ } _{ i = 0 } ^{ k - 1 } ( x + i ) = { ( x - 1 ) ! }
$.</p>
<p>上升幂和下降幂的定义是可以引申到复数域的.</p>
<p>例如我们有加倍公式:$r ^{ } ( r - 0 . 5 ) ^{ } = { 2 ^{ 2 k } } , k
$.</p>
<p>他们之间存在转换:$x ^{ } = ( - 1 ) ^n ( - x ) ^{ } $.</p>
<p>同时存在大小关系:$x ^{ } x ^n x ^{ } $,其中$0 n &lt; x $.</p>
<h3><span id="二项式系数的定义">二项式系数的定义</span></h3>
<p>考虑令$ { m } <span class="math inline">\(表示从一个大小为\)</span>n
<span class="math inline">\(的子集中选出大小为\)</span>m <span class="math inline">\(的子集的方案数.第一次有\)</span>n <span class="math inline">\(个选择,第二次有\)</span>n - 1 <span class="math inline">\(个选择......第m次有\)</span>n - m + 1 <span class="math inline">\(个选择.而由于可能可以选择重复的,但一个排列被重复选择的次数显然是\)</span>m
! <span class="math inline">\(,因此显然有\)</span> { m } = { m ! }
$.</p>
<p>如果我们把它的定义拓展到复数域,我们有:</p>
$ { k } =
<span class="math display">\[\begin{cases}\cfrac { r ^{ \underline {
k  }  }  } { k !  } &amp; k \geq 0 \\ 0 &amp; k &lt; 0
\end{cases}\]</span>
<p>, r , k $.</p>
<p>值得一提的是,如果我们这么定义,本质上其实是把$ { k } <span class="math inline">\(看作了一个关于\)</span>r <span class="math inline">\(的\)</span>k $次多项式.</p>
<p>另外根据定义,$r r &lt; k $时,该公式给出$0 $.</p>
<p>值得一提的是,为了使二项式系数在面对$0 $的时候更加简洁,通常直接定义$0
! = 1 , 0 ^0 = 1 $.</p>
<p>另外不难发现$ { n } <span class="math inline">\(是所有\)</span> { k }
<span class="math inline">\(中最大的.事实上我们有Wallis公式:\)</span>_{
n } { 2 n + 1 } = { 2 } $.</p>
<h3><span id="基本的二项式恒等式">基本的二项式恒等式</span></h3>
<ol type="1">
<li>阶乘展开式:$ { k } = { k ! ( n - k ) ! } , n , k , n k \ $.</li>
</ol>
<p>证明根据定义是显然的.</p>
<ol start="2" type="1">
<li>对称恒等式:$ { k } = { n - k } , n , k \ $.</li>
</ol>
<p>根据$( 1 ) $,$0 k n $时是显然的.而其他情况两边都会给出$0
$,因此也是成立的.</p>
<ol start="3" type="1">
<li>吸收恒等式:$ { k } = { k } { k - 1 } , k k \ $.</li>
</ol>
<p>证明根据定义是显然的.</p>
<ol start="4" type="1">
<li>吸收恒等式的变式:$k { k } = r { k - 1 } , k \ $.</li>
</ol>
<p>根据$( 3 ) <span class="math inline">\(,只需要验证\)</span>k = 0
$的情况即可,也是显然的.</p>
<ol start="5" type="1">
<li>相伴恒等式:$( r - k ) { k } = r { k } , k \ $.</li>
</ol>
<p>证明如下:</p>
<p><span class="math display">\[
\begin{aligned}
( r - k ) \binom { r  } { k  } &amp; = ( r - k ) \binom { r  } { r -
k  } \\
&amp; = r \binom { r - 1  } { r - k - 1  } \\
&amp; = r \binom { r - 1  } { k  }
\end{aligned}
\]</span></p>
<p>问题在于:我们在上述描述中并未提到$r <span class="math inline">\(的范围,但是推导过程要求\)</span>r <span class="math inline">\(.不过,我们已经说明了二项式系数是关于\)</span>r
<span class="math inline">\(的\)</span>k <span class="math inline">\(次多项式,因此只需要有\)</span>k + 1 <span class="math inline">\(个\)</span>r <span class="math inline">\(满足这个公式即可.而根据推导过程显然有无限个\)</span>r
<span class="math inline">\(满足,因此这个公式对\)</span>r
$也是成立的.</p>
<p>不过事实上,直接用吸收恒等式就可以证明:</p>
<p><span class="math display">\[
\begin{aligned}
k \binom { r  } { k  } &amp; = r \binom { r - 1  } { k - 1  } \\
( r - k ) \binom { r  } { r - k  } &amp; = r \binom { r - 1  } { r - k -
1  } \\
( r - k ) \binom { r  } { k  } &amp; = r \binom { r - 1  } { k  }
\end{aligned}
\]</span></p>
<ol start="6" type="1">
<li>加法公式:$ { k } = { k } + { k - 1 } , k \ $.</li>
</ol>
<p>证明可以使用定义,也可以先用$r
$的情况给出组合意义,再使用多项式推理法证明.</p>
<ol start="7" type="1">
<li>$ { m } { k } = { k } { m - k } , n , k \ $.</li>
</ol>
<p>证明可以使用组合意义和多项式推理法.</p>
<ol start="8" type="1">
<li>平行求和法:$_{ k n } { k } = { n } , n \ $.</li>
</ol>
<p>我们不妨考虑不断使用加法公式:</p>
<p>$ { n } = { n } + { n - 1 } = { n } + { n - 1 } + { n - 2 } = . . . \
$,最终下标会减成负数,这样后面的项就全都是$0 $了.</p>
<p>也可以考虑组合意义:如果$r <span class="math inline">\(,那么我们考虑从右到左第一个没有被选上的数,假设它是\)</span>r
+ k + 1 <span class="math inline">\(,那么在它右边的数全部选择了,一共是\)</span>n - k
<span class="math inline">\(个数,而还需要在左边的\)</span>r + k <span class="math inline">\(中选择\)</span>k $个数.</p>
<ol start="9" type="1">
<li>上指标求和法:$_{ 0 k n } { m } = { m + 1 } , n , m \ $.</li>
</ol>
<p>可以组合意义解释:我们不妨假设选的最大数是$k + 1 <span class="math inline">\(,接下来就还需要在\)</span>[ 1 , k ] <span class="math inline">\(中选择\)</span>m $个.</p>
<p>如果我们将这个公式两边同时乘以$m ! <span class="math inline">\(,我们可以得到公式:\)</span>_{ 0 k n } k ^{ } = { m
+ 1 } , n , m \ $,这也就是有限微积分的公式中的一个.</p>
<ol start="10" type="1">
<li>二项式定理:$( x + y ) ^r = _{ k } { k } x ^k y ^{ r - k } , r \
$.</li>
</ol>
<p>可以使用组合意义证明.</p>
<p>二项式定理有一些有用的特殊情况:</p>
$$
<span class="math display">\[\begin{aligned}
\sum _{ 0 \leq k \leq n  } \binom { n  } { k  } &amp; = 2 ^n , n \in
\mathbb { N  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>在二项式定理中令$x = y = 1 $即可证明.</p>
$$
<span class="math display">\[\begin{aligned}
\sum _{ 0 \leq k \leq n  } ( - 1 ) ^k \binom { n  } { k  } &amp; = 0 ^n
&amp; = [ n &amp; = 0 ] , n \in \mathbb { N  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>在二项式定理中令$x = - 1 , y = 1 <span class="math inline">\(即可证明,值得一提的是,当\)</span>n = 0
$的时候这个式子给出$1 $,并在其他情况下给出$0
$,这个式子是二项式反演的基础.</p>
<ol start="11" type="1">
<li>三项式定理:$( x + y + z ) ^n = _{ 0 a , b , c n } [ a + b + c = n ]
{ a ! b ! c ! } x ^a y ^b z ^c , n \ $.</li>
</ol>
<p>证明与二项式定理类似.值得一提的是,$ { a ! b ! c ! } = { b + c } { c }
$.</p>
<ol start="12" type="1">
<li>多项式定理:$( _{ i = 1 } ^m x <em>i ) ^n = </em>{ i , 0 a <em>i n }
[ _{ i = 1 } ^m a _i = n ] { </em>{ i = 1 } ^m a <em>i ! } </em>{ i = 1
} ^m x _i ^{ a _i } , n \ $.</li>
</ol>
<p>证明与二项式定理类似.</p>
<ol start="13" type="1">
<li>范德蒙德卷积:$_{ k } { m + k } { n - k } = { n + m } , n , m \
$.</li>
</ol>
<p>证明可以使用组合意义和多项式推理法.</p>
<p>另外,这个式子可以直接使用生成函数证明.</p>
<ol start="14" type="1">
<li>范德蒙德卷积的变式:$_{ k } { m + k } { n + k } = { l - m + n } , l ,
n , m \ $.</li>
</ol>
<p>有$ { m + k } = { l - m - k } $,然后运用范德蒙德卷积即可得到答案.</p>
<ol start="15" type="1">
<li>上指标反转公式:$ { k } = ( - 1 ) ^k { k } \ $.</li>
</ol>
<p>根据定义显然.</p>
<h3><span id="扩展的二项式恒等式整数范围内">扩展的二项式恒等式(整数范围内)</span></h3>
<ol type="1">
<li>$_{ k m } { k } ( - 1 ) ^k = ( - 1 ) ^m { m } , m \ $.</li>
</ol>
<p>证明如下:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k \leq m  } \binom { r  } { k  } ( - 1 ) ^k &amp; = \sum _{ k
\leq m  } \binom { k - r - 1  } { k  } \\
&amp; = \binom { - r + m  } { m  } &amp; = ( - 1 ) ^m \binom { r - 1  }
{ m  }
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li>$_{ - q k l } { m } { n } = { m + n + 1 } , n , m , l + q \ $.</li>
</ol>
<p>可以组合意义与多项式推理法证明.</p>
<ol start="3" type="1">
<li>$_{ k } { a + k } { b + k } ( - 1 ) ^k = { a } , a , b \ $.</li>
</ol>
<p>可以数学归纳证明.</p>
<ol start="4" type="1">
<li>$_{ k = 0 } ^m { { k } } = { n + 1 - m } , n , m , n m \ $.</li>
</ol>
<p>我们有$ { m } { k } = { k } { m - k } \ <span class="math inline">\(,两边同时除以\)</span> { m } { m - k } \ <span class="math inline">\(,于是我们得到了\)</span> { { k } } = { { m } } \
$.</p>
<p>有:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k = 0  } ^m \cfrac { \binom { m  } { k  }  } { \binom { n  } {
k  }  } &amp; = \sum _{ k = 0  } ^m \cfrac { \binom { n - k  } { m -
k  }  } { \binom { n  } { m  }  } \\
&amp; = \cfrac { 1  } { \binom { n  } { m  }  } \sum _{ k = 0  } ^m
\binom { n - k  } { m - k  } \\
&amp; = \cfrac { 1  } { \binom { n  } { m  }  } \sum _{ k = 0  } ^m
\binom { n - m + k  } { k  } \\
&amp; = \cfrac { \binom { n + 1  } { m  }  } { \binom { n  } { m  }  }
\\
&amp; = \cfrac { n + 1  } { n + 1 - m  }
\end{aligned}
\]</span></p>
<ol start="5" type="1">
<li>$( - 1 ) ^m { m } = ( - 1 ) ^n { n } , n , m \ $.</li>
</ol>
<p>根据上指标反转公式,这个公式两边都等于$ { m } \ $.</p>
<ol start="6" type="1">
<li>$_{ k m } { k } ( { 2 } - k ) = { 2 } { m + 1 } , m \ $.</li>
</ol>
<p>可以使用归纳法证明这个公式.</p>
<ol start="7" type="1">
<li>$<em>{ k m } { k } x ^k y ^{ m - k } = </em>{ k m } { k } ( - x ) ^k
( x + y ) ^{ m - k } , m \ $.</li>
</ol>
<p>不妨令左边的值为$S _m $,我们有:</p>
<p><span class="math display">\[
\begin{aligned}
S _m &amp; = \sum _{ k \leq m  } \binom { m + r  } { k  } x ^k y ^{ m -
k  } &amp; = \sum _{ k \leq m  } \binom { m + r - 1  } { k  } x ^k y ^{
m - k  } + \sum _{ k \leq m  } \binom { m + r - 1  } { k - 1  } x ^k y
^{ m - k  } \\
&amp; = y \sum _{ k &lt; m  } \binom { m - 1 + r  } { k  } x ^k y ^{ m -
1 - k  } + \binom { m + r - 1  } { m  } x ^m + x \sum _{ k \leq m  }
\binom { m + r - 1  } { k - 1  } x ^{ k - 1  } y ^{ m - k  } \\
&amp; = ( x + y ) S _{ m - 1  } + \binom { m + r - 1  } { m  } x ^m \\
&amp; = ( x + y ) S _{ m - 1  } + \binom { r  } { m  } ( - x ) ^m
\end{aligned}
\]</span></p>
<p>左右两边满足相同递归式,通过数学归纳法不难证明二者相等.</p>
<ol start="8" type="1">
<li>$_{ k m } { k } 2 ^{ - k } = 2 ^m , m \ $.</li>
</ol>
<p>考虑$( 7 ) <span class="math inline">\(,将\)</span>x = y = 1 , r = m
+ 1 $带入,得到:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k \leq m  } \binom { 2 m + 1  } { k  } &amp; = \sum _{ k \leq
m  } \binom { m + k  } { k  } 2 ^{ m - k  } \\
2 ^{ 2 m  } &amp; = \sum _{ k \leq m  } \binom { m + k  } { k  } 2 ^{ m
- k  } \\
2 ^m &amp; = \sum _{ k \leq m  } \binom { m + k  } { k  } 2 ^{ - k  }
\end{aligned}
\]</span></p>
<ol start="9" type="1">
<li>$_{ k } { m + k } { n } ( - 1 ) ^k = ( - 1 ) ^{ l + m } { n - l } ,
l , n , m \ $.</li>
</ol>
<p>可以数学归纳证明.</p>
<ol start="10" type="1">
<li>$_{ k l } { m } { k - n } ( - 1 ) ^k = ( - 1 ) ^{ l + m } { l - n -
m } , l , n , m \ $.</li>
</ol>
<p>可以数学归纳证明.</p>
<h3><span id="拓展的二项式恒等式实数范围内">拓展的二项式恒等式(实数范围内)</span></h3>
<ol type="1">
<li>$ { k } { k } = { 2 ^{ 2 k } } , k \ $.</li>
</ol>
<p>将加倍公式两边同时除以$k ! ^2 $即可得到这个公式.</p>
<ol start="2" type="1">
<li>$ { n } = { 2 ^{ 2 n } } , n \ $.</li>
</ol>
<p>将$( 1 ) <span class="math inline">\(中令\)</span>r = k = n
$即可得到这个公式.</p>
<ol start="3" type="1">
<li>$ { n } = ( { 4 } ) ^n { n } , n \ $.</li>
</ol>
<p>即$( 2 ) $的变形.</p>
<ol start="4" type="1">
<li>$_{ k } { 2 k } { k } 2 ^{ - 2 k } = { { 2 } } , n \ $</li>
</ol>
<p>首先根据$( 1 ) <span class="math inline">\(,左边\)</span>= _{ k } { k
} { k } \ <span class="math inline">\(,而考虑到\)</span> { 2 } <span class="math inline">\(和\)</span> { 2 }
$必有一个是自然数,因此可以直接用范德蒙德卷积的变形.</p>
<ol start="5" type="1">
<li>$_{ k } { k } { n - k } = ( - 1 ) ^n , n \ $.</li>
</ol>
<p>直接使用范德蒙德卷积即可证明.</p>
<ol start="6" type="1">
<li>$_{ k } { k } { n - k } = 4 ^n , n \ $.</li>
</ol>
<p>由$( 5 ) <span class="math inline">\(和\)</span>( 3 ) $不难推出.</p>
<ol start="7" type="1">
<li>$_{ k } { k } { x + k } = x ^{ - 1 } { n } ^{ - 1 } , x { 0 , - 1 ,
. . . , - n } \ $.</li>
</ol>
<p>令$f ( x ) = ( x - 1 ) ^{ } $,直接做高阶差分即可得到这个式子.</p>
<ol start="8" type="1">
<li>$_{ k = 0 } ^n { k } { n - k } ( - 1 ) ^k = [ n  is   ] ( - 1 ) ^{ {
2 } } { { 2 } } \ $.</li>
</ol>
<p>首先不难发现,$( 1 - z ) ^r = _{ k } ( - 1 ) ^k { k } \ $.</p>
<p>考虑$( 1 - z ) ^r ( 1 + z ) ^r = ( 1 - z ^2 ) ^r $.</p>
<p>我们有$[ z ^n ] ( 1 - z ) ^r ( 1 + z ) ^r = [ z ^n ] ( 1 - z ^2 ) ^r
$,不难发现即上式.</p>
<h3><span id="卡特兰数">卡特兰数</span></h3>
<p>卡特兰数$f _n $表示:长度为$2 n $的合法括号序列个数.</p>
<p>卡特兰数的前几项为$1 , 1 , 2 , 5 , 14 , 42 , 132 $.</p>
<p>接下来,我们通过这个定义来证明以下其他定义方式.</p>
<p>递归定义:$f <em>n = </em>{ i = 0 } ^{ n - 1 } f <em>i f </em>{ n - 1
- i } $.</p>
<p>不妨考虑枚举一个括号序列的第一个断点,则该括号序列应形如$( A ) B
$.</p>
<p>考虑将其删成$A <span class="math inline">\(和\)</span>B <span class="math inline">\(,则\)</span>A <span class="math inline">\(一定合法,因为若\)</span>A
$不合法,那么这里一定不是第一个断点.</p>
<p>通项公式:$f <em>n = { n + 1 } C </em>{ 2 n } ^n = C <em>{ 2 n } ^n -
C </em>{ 2 n } ^{ n - 1 } $.</p>
<p>考虑平面直角坐标系,我们将’(‘认为是向右上走一单位长度,将’)’认为是向右下走一单位长度.</p>
<p>那么卡特兰数就相当于从$( 0 , 0 ) <span class="math inline">\(走到\)</span>( 2 n , 0 )
$不经过第四象限的方案数.</p>
<p>考虑反射容斥,如果只是走到$( 2 n , 0 ) <span class="math inline">\(的方案数是\)</span>C _{ 2 n } ^n $.</p>
<p>而如果到达第四象限,说明在这条这线上存在一个点$( x , - 1 ) $.</p>
<p>考虑将$x <span class="math inline">\(以后的折线以直线\)</span>y = - 1
<span class="math inline">\(为对称轴反转,那么终点到了\)</span>( 2 n , -
2 ) $.</p>
<p>不难发现,任意从$( 0 , 0 ) <span class="math inline">\(走到\)</span>(
2 n , - 2 ) <span class="math inline">\(的方案一定唯一对应了一种从\)</span>( 0 , 0 ) <span class="math inline">\(走到\)</span>( 2 n , 0 ) <span class="math inline">\(的不合法方案.因为从\)</span>( 0 , 0 ) <span class="math inline">\(走到\)</span>( 2 n , - 2 ) <span class="math inline">\(一定会经过直线\)</span>y = - 1 <span class="math inline">\(,将后半部分对称后就是其对应方案.而从\)</span>( 0 ,
0 ) <span class="math inline">\(走到\)</span>( 2 n , - 2 ) <span class="math inline">\(的方案数为\)</span>C _{ 2 n } ^{ n - 1 } $.</p>
<p>因而$f <em>n = C </em>{ 2 n } ^n - C _{ 2 n } ^{ n - 1 } \ $.</p>
<p>而$C <em>{ 2 n } ^n - C </em>{ 2 n } ^{ n - 1 } = { n ! n ! } - { ( n
- 1 ) ! ( n + 1 ) ! } = { n ! ( n + 1 ) ! } = { n + 1 } \ $.</p>
<p>递推定义:$f <em>n = { n + 1 } f </em>{ n - 1 } \ $.</p>
<p>使用一下上一步的通项公式:</p>
<p>f_n=\</p>
<p>f_{n-1}=</p>
<p>\end{cases}\</p>
<p>不难发现$f <em>n = { n ( n + 1 ) } f </em>{ n - 1 } \ <span class="math inline">\(.整理,得到\)</span>f <em>n = { n + 1 } f </em>{ n
- 1 } \ $.</p>
<p>换个记号,设$C _n <span class="math inline">\(为卡特兰数的第\)</span>n
<span class="math inline">\(项,卡特兰数有一个著名的结论是\)</span>k
$次卷积:</p>
<p><span class="math display">\[
C ^{ ( k )  } _n = \sum _{ \sum _{ j = 1  } ^k a _j = n  } \prod C _{ a
_i  } = \frac { k  } { n + k  } \binom { 2 n + k - 1  } { n  }
\]</span></p>
<p>我们可以这么理解它:它指的是一个长度为$n + k - 1 <span class="math inline">\(的括号序列,前\)</span>k - 1 <span class="math inline">\(个必须是左括号的方案数.为啥呢?因为这样这个括号序列必须写成\)</span>(
( ( A ) B ) C ) D $之类的形式,等价于卷积.</p>
<p>那么证明就很简单了,类似反射容斥,有:</p>
<p><span class="math display">\[
\begin{aligned}
C ^{ ( k )  } _n &amp; = \binom { 2 n + k - 1  } { n  } - \binom { 2 n +
k - 1  } { n - 1  } \\
&amp; = \frac { k  } { n + k  } \binom { 2 n + k - 1  } { n  }
\end{aligned}
\]</span></p>
<h5><span id="examplehnoi2009有趣的数列">Example([HNOI2009]有趣的数列)</span></h5>
<p>首先,如果没有第三条限制,那显然奇数位置和偶数位置互不影响,直接随便选,答案就是$
{ n } $.</p>
<p>而有了限制呢,我们还是想随便选然后顺序排起来,但是这次不能排列的时候使奇数位置大于偶数位置,可以发现这就是括号序列需要满足的条件,于是答案就是卡特兰数.</p>
<p>至于处理,这题因为模数不是质数,需要做质因数分解来维护除法.</p>
<h5><span id="example223省选10连测day7b">Example2([23省选10连测day7]b)</span></h5>
<p>给定$x , n <span class="math inline">\(,对\)</span>y <span class="math inline">\(,固定\)</span>p _x = y <span class="math inline">\(做笛卡尔树的**形态**计数.\)</span>n ^5 $.</p>
<p>由于是对树的形态计数,其实根本就不在乎每个点具体的取值,只要这个取值有解就行.事实上,容易发现$a
_x = y $只要满足:</p>
<ol type="1">
<li><p>$x <span class="math inline">\(节点的祖先数量不超过\)</span>y - 1
<span class="math inline">\(个(深度小于等于\)</span>y $).</p></li>
<li><p>$x <span class="math inline">\(节点的子树大小不超过\)</span>n - y
+ 1 $.</p></li>
</ol>
<p>发现合法不太好记,经典补集转化,然后两个不合法情况无关,分别算.</p>
<p>我们考虑直接算出$f _p <span class="math inline">\(表示\)</span>x
<span class="math inline">\(的深度为\)</span>p <span class="math inline">\(的答案,\)</span>g _p <span class="math inline">\(表示\)</span>x <span class="math inline">\(的子树大小为\)</span>p
$的答案,然后就可以完成这个题.</p>
<p>这两部分怎么算呢?</p>
<p>先看深度:$x <span class="math inline">\(的祖先有两种:一种在序列中在\)</span>x <span class="math inline">\(的左边,一种在\)</span>x $的右边.我们设前者为$0 = l
<em>0 &lt; l <em>1 &lt; l <em>2 &lt; l <em>p &lt; l </em>{ p + 1 } = x
<span class="math inline">\(,设后者为\)</span>n + 1 = r <em>0 &gt; r
<em>1 &gt; r <em>2 &gt; &gt; r </em>{ q } &gt; r </em>{ q + 1 } = x
<span class="math inline">\(.这么分类有什么用呢?我们考虑\)</span>( l
</em>{ i - 1 } , l </em>{ i } ) <span class="math inline">\(这一段数能放在哪里,它只能是\)</span>l </em>{ i }
<span class="math inline">\(的左儿子,独立于整棵树,因此这一段的答案就是\)</span>C
</em>{ l <em>i - l </em>{ i - 1 } - 1 } $.</p>
<p>记:</p>
$$
<span class="math display">\[\begin{aligned}
L _p &amp; = \sum _{ l  } \prod _{ i = 1  } ^{ p + 1  } C _{ l _i - l _{
i - 1  } - 1  } \\
R _q &amp; = \sum _{ r  } \prod _{ i = 1  } ^{ q + 1  } C _{ r _{ i -
1  } - r _i - 1  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>注意到这等价于卡特兰数的$k $次卷积,有:</p>
$$
<span class="math display">\[\begin{aligned}
L _p &amp; = C _{ x - p - 1  } ^{ ( p + 1 )  } \\
R _q &amp; = C ^{ ( q + 1 )  } _{ n - x - q  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>此时的答案自然是$f _{ p + q + 1 } = L _p R _q { q } $,做卷积.</p>
<p>儿子怎么算呢?二叉搜索树有一个经典性质:确定根后每个点插在哪里是固定的.也就是说我们把$x
<span class="math inline">\(的子树从原树中删去,然后插入\)</span>x <span class="math inline">\(一定会插回原位置,这是一个双射.而子树内随便做,设左子树大小为\)</span>p
<span class="math inline">\(,右子树大小为\)</span>q <span class="math inline">\(,我们有\)</span>g _{ p + q + 1 } = C <em>p C <em>q
C </em>{ n - ( p + q + 1 ) } = C </em>{ n - 1 } ^{ ( 3 ) }
$,同样是简单的卷积.</p>
<h3><span id="二项式系数的处理">二项式系数的处理</span></h3>
<h4><span id="通过恒等式变形求解">通过恒等式变形求解</span></h4>
<h5><span id="example1">Example1</span></h5>
<p>求$_{ k = 0 } ^n k { m - n - 1 } , n , m m &gt; n \ $.</p>
<p>这个式子乘了个系数$k <span class="math inline">\(导致很难处理,一个自然的想法是使用吸收恒等式将\)</span>k
$消去,然后对后面的式子使用上指标求和.</p>
<p>于是:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k = 0  } ^n k \binom { m - k - 1  } { m - n - 1  } &amp; = \sum
_{ k = 0  } ^n m \binom { m - k - 1  } { m - n - 1  } - \sum _{ k = 0  }
^n ( m - k ) \binom { m - k - 1  } { m - n - 1  } \\
&amp; = m \sum _{ k = 0  } ^{ m - 1  } \binom { m - k - 1  } { m - n -
1  } - ( m - n ) \sum _{ k = 0  } ^m \binom { m - k  } { m - n  }
\end{aligned}
\]</span></p>
<p>不妨令$S <em>m = </em>{ k = 0 } ^m { m - n } \ $,不难发现我们有:</p>
<p><span class="math display">\[
S _m = \sum _{ k = 0  } ^m \binom { k  } { m - n  } = \binom { m + 1  }
{ m - n + 1  }
\]</span></p>
<p>于是原式$= mS _{ m - 1 } - ( m - n ) S _m = { m - n + 1 } { m - n } \
$.</p>
<p>不过事实上,我们有另一种方式来处理这个等式,我们直接将$k = { 1 }
$带入:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k = 0  } ^n k \binom { m - k - 1  } { m - n - 1  } &amp; = \sum
_{ k = 0  } ^n \binom { k  } { 1  } \binom { m - k - 1  } { m - n - 1  }
\\
&amp; = \binom { m  } { m - n + 1  } \\
&amp; = \cfrac { n  } { m - n + 1  } \binom { m  } { m - n  }
\end{aligned}
\]</span></p>
<h5><span id="example2">Example2</span></h5>
<p>求$_{ k } k { k } { k } , n \ $.</p>
<p>第一反应仍然是使用吸收恒等式,但是注意到$n <span class="math inline">\(和\)</span>s
$的范围不一样,由于吸收恒等式的范围很松,因此应选择一个范围更松的数吸收,这样才能保证另一个数范围的特殊性,于是有:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k  } k \binom { n  } { k  } \binom { s  } { k  } &amp; = s \sum
_{ k  } \binom { n  } { k  } \binom { s - 1  } { k - 1  } \\
&amp; = s \binom { n + s - 1  } { n - 1  }
\end{aligned}
\]</span></p>
<h5><span id="example3">Example3</span></h5>
<p>求$_{ 0 k } { 2 k } { k } { k + 1 } , n \ $.</p>
<p>我们有:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ 0 \leq k  } \binom { n + k  } { 2 k  } \binom { 2 k  } { k  }
\cfrac { ( - 1 ) ^k  } { k + 1  } &amp; = \sum _{ 0 \leq k  } \binom { n
+ k  } { k  } \binom { n  } { k  } \cfrac { ( - 1 ) ^k  } { k + 1  } , n
\in \mathbb { N  } \\
&amp; = \cfrac { 1  } { n + 1  } \sum _{ 0 \leq k  } \binom { n + k  } {
k  } \binom { n + 1  } { k + 1  } { ( - 1 ) ^k  } \\
&amp; = \cfrac { 1  } { n + 1  } \sum _{ 0 \leq k  } \binom { - n - 1  }
{ k  } \binom { n + 1  } { k + 1  } \\
&amp; = \cfrac { 1  } { n + 1  } \binom { 0  } { n  } \\
&amp; = [ n &amp; = 0 ]
\end{aligned}
\]</span></p>
<h5><span id="example4">Example4</span></h5>
<p>求$_{ k } { m + 2 k } { k } { k + 1 } , n , m \ $.</p>
<p>考虑恒等式扩展的二项式恒等式(整数范围内)的$( 1 ) $,我们有:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ k \geq 0  } \binom { n + k  } { m + 2 k  } \binom { 2 k  } {
k  } \cfrac { ( - 1 ) ^k  } { k + 1  } &amp; = \sum _{ k \geq 0  } \sum
_{ 0 \leq j \leq n + k - 1  } \binom { n + k - 1 - j  } { 2 k  } \binom
{ j  } { m - 1  } \binom { 2 k  } { k  } \cfrac { ( - 1 ) ^k  } { k +
1  } \\
&amp; = \sum _{ 0 \leq j \leq n - 1  } \binom { j  } { m - 1  } \sum _{
j + 1 - n \leq k , 0 \leq k  } \binom { n + k - 1 - j  } { 2 k  } \binom
{ 2 k  } { k  } \cfrac { ( - 1 ) ^k  } { k + 1  }
\end{aligned}
\]</span></p>
<p>注意到如果$j + 1 - n <span class="math inline">\(,则\)</span> { 2 k }
\ $应为$0 $.所以有:</p>
<p><span class="math display">\[
\begin{aligned}
\sum _{ 0 \leq j \leq n - 1  } \binom { j  } { m - 1  } \sum _{ j + 1 -
n \leq k , 0 \leq k  } \binom { n + k - 1 - j  } { 2 k  } \binom { 2
k  } { k  } \cfrac { ( - 1 ) ^k  } { k + 1  } \\
&amp; = \sum _{ 0 \leq j &lt; n  } \binom { j  } { m - 1  } [ n - 1 - j
&amp; = 0 ] &amp; = \binom { n - 1  } { m - 1  }
\end{aligned}
\]</span></p>
<h5><span id="example5">Example5</span></h5>
<p>求$_{ k = 0 } ^n ( C _n ^k ) ^2 $.</p>
<p><span class="math display">\[
\sum _{ k = 0  } ^n ( C _n ^k ) ^2 = \sum _{ k = 0  } ^n C _{ n  } ^k
\times C _{ n  } ^{ n - k  } = C _n ^{ 2 n  }
\]</span></p>
<h4><span id="转化为递归式和式求解">转化为递归式/和式求解</span></h4>
<h5><span id="example1">Example1</span></h5>
<p>求$Q <em>n = </em>{ k ^n } { k } ( - 1 ) ^k , n \ $.</p>
<p>如果要转化为递归式的话,我们所掌握的只有加法恒等式,但加法恒等式只给出了杨辉三角中相邻两行的关系.但由于$Q
_n $的式子中实际上只与$2 ^n <span class="math inline">\(有关,我们不妨令\)</span>R <em>n = </em>{ k n } { k
} ( - 1 ) ^k \ <span class="math inline">\(,显然有\)</span>Q <em>n = R
</em>{ 2 ^n } $.</p>
<p>而我们有:</p>
<p><span class="math display">\[
\begin{aligned}
R _n &amp; = \sum _{ k \leq n  } \binom { n - 1 - k  } { k  } ( - 1 ) ^k
+ \sum _{ k \leq n  } \binom { n - 1 - k  } { k - 1  } ( - 1 ) ^k \\
&amp; = \sum _{ k \leq n  } \binom { n - 1 - k  } { k  } ( - 1 ) ^k +
\sum _{ k \leq n - 1  } \binom { n - k - 2  } { k  } ( - 1 ) ^{ k + 1  }
\\
&amp; = \sum _{ k \leq n - 1  } \binom { n - 1 - k  } { k  } ( - 1 ) ^k
+ \binom { - 1  } { n  } ( - 1 ) ^n - ( \sum _{ k \leq n - 2  } \binom {
n - 2 - k  } { k  } ( - 1 ) ^k + \binom { - 1  } { n - 1  } ( - 1 ) ^{ n
- 1  } ) \\
&amp; = \sum _{ k \leq n - 1  } \binom { n - 1 - k  } { k  } ( - 1 ) ^k
- \sum _{ k \leq n - 1  } \binom { n - 2 - k  } { k  } ( - 1 ) ^k \\
&amp; = R _{ n - 1  } - R _{ n - 2  } \\
&amp; = R _{ n - 2  } - R _{ n - 3  } - R _{ n - 2  } \\
&amp; = - R _{ n - 3  } \\
&amp; = R _{ n - 6  }
\end{aligned}
\]</span></p>
也即$R _n <span class="math inline">\(具有周期性,不难计算前几项答案,最后有\)</span>Q _n
<span class="math display">\[\begin{cases}1 &amp; n = 0 \\ 0 &amp; n \
is \ \mathrm { odd  } \\ - 1 &amp; n &gt; 0 \land n \ is \ \mathrm {
even  } \end{cases}\]</span>
<p>$.</p>
<h5><span id="example2">Example2</span></h5>
<p>求$( ^{ + } <em>{ i = 0 } C ^{ ik + r } </em>{ nk } ) p $.</p>
<p>考虑设$f ( n , r ) = ^{ + } <em>{ i = 0 } C ^{ ik + r } </em>{ nk } \
$,则有:</p>
$$
<span class="math display">\[\begin{aligned}
f ( n , r ) &amp; = \sum ^{ + \infty  } _{ i = 0  } C ^{ ik + r  } _{
nk  } \\
&amp; = \sum _{ i = 0  } ^{ + \infty  } \sum _{ j = 0  } ^k C _{ nk -
k  } ^{ ik + r - j  } \times C _k ^j \\
&amp; = \sum ^k _{ j = 0  } C _k ^j \sum _{ i = 0  } ^{ + \infty  } C _{
nk - k  } ^{ ik + r - j  } \\
&amp; = \sum _{ j = 0  } ^k C _k ^j f ( n - 1 , r - j ) \\

\end{aligned}\]</span>
<p>$$</p>
<p>整理上式,得到:$f ( n , r ) = _{ j = 0 } ^k C _k ^j f ( n - 1 , r - j
) \ $.</p>
<p>于是我们得到了关于$f $的转移方程,可以矩阵加速.</p>
<h4><span id="利用微积分求解">利用微积分求解</span></h4>
<h5><span id="example">Example</span></h5>
<p>求$_{ k = 1 } ^n k ^2 C _n ^k $.</p>
$$
<span class="math display">\[\begin{aligned}
( ( 1 + x ) ^n ) &amp; = ( \sum _{ k = 0  } ^n C _n ^k x ^{ k  } ) \\
( ( 1 + x ) ^n ) &#39; &amp; = ( \sum _{ k = 0  } ^n C _n ^k x ^{ k  } )
&#39; \\
n ( 1 + x ) ^{ n - 1  } &amp; = \sum _{ k = 0  } ^n kC _n ^k x ^{ k -
1  } \\
nx ( 1 + x ) ^{ n - 1  } &amp; = \sum _{ k = 0  } ^n kC _n ^k x ^{ k  }
\\
( nx ( 1 + x ) ^{ n - 1  } ) &#39; &amp; = ( \sum _{ k = 0  } ^n kC _n
^k x ^{ k  } ) &#39; \\
n ( ( 1 + x ) ^{ n - 1  } + ( n - 1 ) x ( 1 + x ) ^{ n - 2  } ) &amp; =
\sum _{ k = 0  } ^n k ^2 C _n ^k x ^{ k - 1  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>取$x = 1 <span class="math inline">\(,则原式\)</span>= n ( n + 1 ) 2
^{ n - 2 } $.</p>
<h4><span id="转化为二维平面">转化为二维平面</span></h4>
<h5><span id="example1">Example1</span></h5>
<p>多次询问给定$k , r <span class="math inline">\(,\)</span>k n , r &lt;
2 n - k <span class="math inline">\(,求\)</span>_{ i = 0 } ^{ r } { 2 ^i
} { n - k } $,.</p>
<p>我们把模型抽象成:在二维平面上,从$( 0 , 0 ) <span class="math inline">\(随机游走到\)</span>( n - k + 1 , r - n + k ) <span class="math inline">\(正下方(包含这个点)的概率,容易发现此时向右走了\)</span>n
- k <span class="math inline">\(步,总共走了\)</span>r <span class="math inline">\(步,然后再向右走一步保证第一次走到了\)</span>( n -
k + 1 , r - n + k ) $下方.</p>
<p>因为是概率,所以当我们已经确定这个事会发生的时候可以多走几步,不难发现这里的概率等价于走到$x
+ y = r + 1 <span class="math inline">\(这条直线时横坐标\)</span>n - k +
1 <span class="math inline">\(的概率.枚举一下总共向上走了几步,就得到\)</span> {
2 ^{ r } } _{ j = 0 } ^{ r - n + k } { j } <span class="math inline">\(,注意这里是\)</span> { 2 ^r } <span class="math inline">\(,因为从一开始钦定了一步,因此映射过来需要多乘个\)</span>
{ 2 } $,反映射就要乘个$2 <span class="math inline">\(.但是这个式子还是做不了,因为\)</span>r <span class="math inline">\(并不满足\)</span>r n $.我们需要另辟蹊径.</p>
<p>做一下补集转化转化成走到上方的概率,这个概率就等价于$1 - { 2 ^{ r } }
_{ i = 0 } ^{ n - k } { i } <span class="math inline">\(.我们考虑暴力预处理出\)</span>f <em>r = </em>{ i =
0 } ^{ n } { i } <span class="math inline">\(,每次删掉一个后缀的组合数就行.现在的问题在于\)</span>f
$怎么做.</p>
<p>直接拆组合数,我们有:</p>
<p><span class="math display">\[
\begin{aligned}
f _r &amp; = \sum _{ i = 0  } ^n \binom { r  } { i  } \\
&amp; = \sum _{ i = 0  } ^n \binom { r - 1  } { i - 1  } + \sum _{ i =
0  } ^n \binom { r - 1  } { i  } \\
&amp; = 2 \sum _{ i = 0  } ^n \binom { r - 1  } { i  } - \binom { r -
1  } { n  } \\
&amp; = 2 f _{ r - 1  } - \binom { r - 1  } { n  }
\end{aligned}
\]</span></p>
<h3><span id="lucas定理">Lucas定理</span></h3>
<p>若$p <span class="math inline">\(是质数,则\)</span>C <em>n ^m p = C
</em>{ n p } ^{ m p } C _{ { p } } ^{ { p } } p \ $.</p>
<p>或者说,将$n <span class="math inline">\(和\)</span>m <span class="math inline">\(在\)</span>p $进制下分解,再逐位求组合数并相乘.</p>
<p>证明:</p>
<p>首先,若$i <span class="math inline">\(且\)</span>i p <span class="math inline">\(,\)</span>C <em>{ p } ^i { i } C </em>{ p - 1 } ^{
i - 1 } ( p ) \ $.</p>
<p>而根据二项式定理,$( 1 + x ) ^p <em>{ i = 0 } ^p C </em>{ p } ^i x ^i
= 1 + x ^p ( p ) \ $.</p>
<p>令$n = k _1 p + b _1 <span class="math inline">\(,\)</span>m = k _2 p
+ b _2 <span class="math inline">\(,则\)</span>( 1 + x ) ^n = ( 1 + x )
^{ k _1 p } ( 1 + x ) ^{ b _1 } \ $.</p>
<p>而$( 1 + x ) ^{ k _1 p } ( 1 + x ^p ) ^{ k _1 } ( p ) \ <span class="math inline">\(,有\)</span>( 1 + x ) ^n ( 1 + x ^p ) ^{ k _1 } (
1 + x ) ^{ b _1 } \ $.</p>
<p>根据二项式定理,$C _n ^m p <span class="math inline">\(即\)</span>x ^m
$项的系数.</p>
<p>我们可以得出,$C <em>n ^m x ^m C </em>{ k _1 } ^{ k _2 } x ^{ k <em>2
p } C </em>{ b 1 } ^{ b _2 } x ^{ b _2 } \ <span class="math inline">\(,那么有\)</span>C <em>a ^b C </em>{ k _1 } ^{ k
<em>2 } C </em>{ b _1 } ^{ b _2 } \ $.</p>
<p>另外,Lucas定理有一个很重要的推论是:</p>
<p><span class="math display">\[
\binom { n  } { m  } \equiv [ m \subseteq n ] \pmod { 2  }
\]</span></p>
<h5><span id="example1cf1770fkoxia-andsequence">Example1([CF1770F]Koxia and
Sequence)</span></h5>
<p>首先观察样例并思考,可以发现当$n
$为偶数时,显然翻转整个序列就可以一一对应(除非翻转后与本身相同,但这种情况下异或值也是$0
$),所以异或值为$0 <span class="math inline">\(.不然,我们可以翻转\)</span>a [ 2 . . . n ] <span class="math inline">\(,得出答案应该是所有\)</span>a _1 $的异或和.</p>
<p>问题在于接下来怎么做,我们考虑把按位或的那个东西容斥掉.现在问题转化为:对于所有$y
’ y <span class="math inline">\(,求出满足\)</span>a _i y ’ , a _i = x
<span class="math inline">\(时,\)</span>a _1
$异或和.接下来怎么做呢?我们考虑拆位,若$2 ^k y ’ <span class="math inline">\(,假设\)</span>a _1 <span class="math inline">\(的第\)</span>k $位是$1
$,然后讨论此时它对答案是否会产生贡献.</p>
<p>我们不难发现,第$k $位贡献是:</p>
<p><span class="math display">\[
[ 2 ^k \subseteq y &#39; ] \bigoplus _{ \sum a = x  } [ 2 ^k \subseteq a
_1 ] \prod _{ i = 1  } ^n [ a _i \subseteq y &#39; ]
\]</span></p>
<p>这个东西看上去没办法做,但我们突然想到个事:Lucas定理的推论:$[ x y ] {
x } $.</p>
<p>所以原式化简为:</p>
$$
<span class="math display">\[\begin{aligned}
\binom { y &#39;  } { 2 ^k  } \sum _{ \sum a = x  } \binom { a _1  } { 2
^k  } \prod _{ i = 1  } ^n \binom { y &#39;  } { a _i  } \pmod { 2  } \\
&amp; = \binom { y &#39;  } { 2 ^k  } \sum _{ a _1  } \binom { y &#39; -
2 ^k  } { a _1 - 2 ^k  } \sum _{ \sum a = x - a _1  } \prod _{ i = 2  }
^n \binom { y &#39;  } { a _i  } \pmod { 2  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>然后呢?不难发现后面那一串是范德蒙德卷积的形式,就可以写成:</p>
<p><span class="math display">\[
\begin{aligned}
\binom { y &#39;  } { 2 ^k  } \sum _{ a _1  } \binom { y &#39; - 2 ^k  }
{ a _1 - 2 ^k  } \binom { ( n - 1 ) y &#39;  } { x - a _1  } \pmod {
2  } \\
&amp; = \binom { y &#39;  } { 2 ^k  } \binom { ny &#39; - 2 ^k  } { x -
2 ^k  } \pmod { 2  } \\
&amp; = [ 2 ^k \subseteq y &#39; ] [ ( x - 2 ^k ) \subseteq ( ny &#39; -
2 ^k ) ]
\end{aligned}
\]</span></p>
<h3><span id="扩展lucas定理">扩展Lucas定理</span></h3>
<p>令$p = p _i ^{ e _i } <span class="math inline">\(,那我们只要对于每个\)</span>i <span class="math inline">\(求出\)</span>C _n ^m p _i ^{ e _i }
$,然后使用中国剩余定理合并即可.</p>
<p>那现在问题转化为要求$C _n ^m p ^k <span class="math inline">\(,其中\)</span>p prime $.</p>
<p>原式$= { m ! ( n - m ) ! } p ^k = { { p ^y } { p ^z } } p ^{ x - y -
z } p ^k \ $.</p>
<p>现在问题转化为求$ { p ^x } p ^k 以 及 p ^x \ $.</p>
<p>注意到:</p>
<p><span class="math display">\[
\begin{aligned}
n ! &amp; = \prod _{ i = 1  } i \\
&amp; = ( \prod _{ i = wp , w \in \mathbb { Z  }  } i ) ( \prod _{ i \ne
wp , w \in \mathbb { Z  }  } i ) \\
&amp; = p ^{ \lfloor n p \rfloor  } ( \lfloor n p \rfloor ! ) ( \prod _{
i \ne wp , w \in \mathbb { Z  }  } i ) \\
&amp; \equiv p ^{ \lfloor \frac { n  } { p  } \rfloor  } ( \lfloor \frac
{ n  } { p  } \rfloor ! ) ( \prod _{ i = 1 , i \ne wp , w \in \mathbb {
Z  }  } ^{ p ^k  } i ) ^{ \lfloor \frac { n  } { p ^k  } \rfloor  } (
\prod ^{ n \ \bmod { p ^k  }  } _{ i = p ^k \lfloor \frac { n  } { p
^k  } \rfloor , i \ne wp , w \in \mathbb { Z  }  } i ) ( \mod p ^k )
\end{aligned}
\]</span></p>
<p>递归求解即可.</p>
<p>ps:</p>
<p>这样摆式子可能非常难以理解,我们考虑将$[ 1 , n ] <span class="math inline">\(的所有数全部排成一个宽为\)</span>p ^k $的矩阵.</p>
<p>那右边第一项就是把那些$p
$的倍数的列拿出来,第二项是那些填满的行,第三项是最后没填满的一行.</p>
<h2><span id="斯特林数">斯特林数</span></h2>
<h3><span id="第一类斯特林数">第一类斯特林数</span></h3>
<p>$n k \ <span class="math inline">\(:长度为\)</span>n <span class="math inline">\(的排列划分成\)</span>k $个轮换的方案数.</p>
<p>考虑现在已经将$n - 1 <span class="math inline">\(个数分成了若干轮换,现在新加入第\)</span>n
$个数.这个数要么和其他的数一起组成轮换,要么自己形成自环.</p>
<p>而由于它可以插入前面轮换的任意位置,显然$= ( n - 1 ) + \ $.</p>
<p>特别地,我们定义$= [ k = 0 ] \ $.</p>
<p>由于所有的排列都由若干置换组成,因此我们有:$_{ k = 0 } ^n = n ! $.</p>
<h3><span id="第二类斯特林数">第二类斯特林数</span></h3>
${
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>} <span class="math inline">\(:将\)</span>n
$个本质不同的物品划分成k个非空集合的方案数.</p>
考虑现在已经放好$n - 1 <span class="math inline">\(个物品,正要放入第\)</span>n <span class="math inline">\(个物品.那么这个物品要么单独放在一起,要么和其他物品放在一起.显然\)</span>{
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
} = k {
<span class="math display">\[\begin{array}{ c  } n - 1 \\ k
\end{array}\]</span>
} + {
<span class="math display">\[\begin{array}{ c  } n - 1 \\ k - 1
\end{array}\]</span>
<p>} \ $.</p>
特别地,我们定义${
<span class="math display">\[\begin{array}{ c  } 0 \\ k
\end{array}\]</span>
<p>} = [ k = 0 ] \ $.</p>
<h3><span id="斯特林数的扩展">斯特林数的扩展</span></h3>
<p>如果我们让斯特林数的定义式扩展到整数域,我们可以发现一个性质:${ n m }
= { - m - n } \ $.</p>
<h3><span id="基本斯特林恒等式">基本斯特林恒等式</span></h3>
<ol type="1">
<li>$x ^n = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
} x ^{ } = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
} ( - 1 ) ^{ n - k } x ^{ } \ $.</li>
</ol>
证明:先考虑前半段,不妨使用数学归纳.若$x ^{ n - 1 } = _{ k = 0 } ^{ n - 1
} {
<span class="math display">\[\begin{array}{ c  } n - 1 \\ k
\end{array}\]</span>
<p>} x ^{ } \ $,我们要证</p>
<p>\</p>
$$
<span class="math display">\[\begin{aligned}
x \sum _{ k = 0  } ^{ n - 1  } \left \{ \begin{array}
{ c  } n - 1 \\
k
\end{array} \right \} x ^{ \underline { k  }  } &amp; = \sum _{ k = 0  }
^{ n  } \left \{ \begin{array}
{ c  } n \\
k
\end{array} \right \} x ^{ \underline { k  }  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>考虑$( x - k ) x ^{ } = x ^{ } <span class="math inline">\(,所以\)</span>x x ^{ } = x ^{ } + kx ^{ } \
$.那么左边即:</p>
$$
<span class="math display">\[\begin{aligned}
\sum _{ k = 0  } ^{ n - 1  } \left \{ \begin{array}
{ c  } n - 1 \\
k
\end{array} \right \} x ^{ \underline { k + 1  }  } + \sum _{ k = 0  }
^{ n - 1  } \left \{ \begin{array}
{ c  } n - 1 \\
k
\end{array} \right \} kx ^{ \underline { k  }  } \\
&amp; = \sum _{ k = 1  } ^{ n  } \left \{ \begin{array}
{ c  } n - 1 \\
k - 1
\end{array} \right \} x ^{ \underline { k  }  } + \sum _{ k = 1  } ^{
n  } \left \{ \begin{array}
{ c  } n - 1 \\
k
\end{array} \right \} kx ^{ \underline { k  }  } \\
&amp; = \sum _{ k = 0  } ^n \left \{ \begin{array}
{ c  } n \\
k
\end{array} \right \} x ^{ \underline { k  }  } \\
\\

\end{aligned}\]</span>
<p>$$</p>
至于后半段,由于$x ^{ } = ( - 1 ) ^n ( - x ) ^{ } \ <span class="math inline">\(,所以\)</span>x ^n = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>} ( - 1 ) ^k ( - x ) ^{ } \ $.</p>
<p>不妨用$x <span class="math inline">\(来代替\)</span>- x $,我们有:</p>
<p><span class="math display">\[
\begin{aligned}
( - x ) ^n &amp; = \sum _{ k = 0  } ^n \left \{ \begin{array}
{ c  } n \\
k
\end{array} \right \} ( - 1 ) ^k ( x ) ^{ \overline { k  }  } \\
x ^n &amp; = \sum _{ k = 0  } ^n \left \{ \begin{array}
{ c  } n \\
k
\end{array} \right \} ( - 1 ) ^{ n - k  } x ^{ \overline { k  }  }
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li><p>$x ^{ } = _{ k = 0 } ^n x ^k \ $.</p></li>
<li><p>$x ^{ } = _{ k = 0 } ^n ( - 1 ) ^{ n - k } x ^k \ $.</p></li>
</ol>
<p>证明:</p>
<p>先考虑前者,由于$( x + n - 1 ) x ^k = x ^{ k + 1 } + ( n - 1 ) x ^k \
$,所以类似于(1)前半段的推导即可得到,后者同样可以使用下降幂和上升幂的转化来得到.</p>
<ol start="4" type="1">
<li>反转公式:$_{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
} ( - 1 ) ^{ n - k } = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
} ( - 1 ) ^{ n - k } = [ m = n ] \ $.</li>
</ol>
<p>证明:</p>
考虑先证明后半部分,将(3)带入(1),得到$x ^n = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
} x ^{ } = <em>{ k = 0 } ^n </em>{ m = 0 } ^k {
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>} ( - 1 ) ^{ n - k } x ^m \ $.</p>
<p>由于这对任意$x <span class="math inline">\(都成立,因此右边除了\)</span>x ^n
$以外的项系数均为$0 <span class="math inline">\(,而\)</span>x ^n
$的系数为$1 $.前半部分是同理的.这个公式是斯特林反演的基础.</p>
<ol start="5" type="1">
<li><p>${</p>
<span class="math display">\[\begin{array}{ c  } n + 1 \\ m + 1
\end{array}\]</span>
<p>} = _{ k = m } ^n (</p>
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>) {</p>
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
<p>} \ $.</p></li>
<li><p>$= _{ k = m } ^n (</p>
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>) \ $.</p></li>
</ol>
<p>证明:对于前者,考虑组合意义,将$n + 1 <span class="math inline">\(个分为\)</span>m + 1 <span class="math inline">\(组,也就是先找一部分分成\)</span>m
$组,再把剩下的分到一组.对于后者,也可以同样考虑组合意义.</p>
<h3><span id="补充斯特林恒等式">补充斯特林恒等式</span></h3>
<ol start="7" type="1">
<li><p>${</p>
<span class="math display">\[\begin{array}{ c  } n \\ m
\end{array}\]</span>
<p>} = _{ k = m } ^n (</p>
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>) {</p>
<span class="math display">\[\begin{array}{ c  } k + 1 \\ m + 1
\end{array}\]</span>
<p>} ( - 1 ) ^{ n - k } \ $.</p></li>
<li><p>$= _{ k = m } ^n (</p>
<span class="math display">\[\begin{array}{ c  } n \\ k
\end{array}\]</span>
<p>) ( - 1 ) ^{ n - k } \ $.</p></li>
</ol>
<p>证明:由(5)(6),根据二项式反演可知.</p>
<ol start="9" type="1">
<li>$m ! {
<span class="math display">\[\begin{array}{ c  } n \\ m
\end{array}\]</span>
} = _{ k = 0 } ^m C _m ^k k ^n ( - 1 ) ^{ m - k } \ $.</li>
</ol>
证明:首先有$m ^n = _{ k = 0 } ^m m ^{ } {
<span class="math display">\[\begin{array}{ c  } m \\ k
\end{array}\]</span>
} = _{ k = 0 } ^m k ! C _m ^k {
<span class="math display">\[\begin{array}{ c  } m \\ k
\end{array}\]</span>
<p>} \ $,对这个式子进行二项式反演即可.</p>
<ol start="10" type="1">
<li>${
<span class="math display">\[\begin{array}{ c  } n + 1 \\ m + 1
\end{array}\]</span>
} = _{ k = 0 } ^n {
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
} ( m + 1 ) ^{ n - k } \ $.</li>
</ol>
<p>证明:</p>
<p>考虑组合意义,相当于先把前$k <span class="math inline">\(个分为\)</span>m <span class="math inline">\(组,把第\)</span>k + 1 <span class="math inline">\(个数放到第\)</span>m + 1 <span class="math inline">\(组.然后剩下\)</span>( n + 1 ) - ( k + 1 ) = n - k
<span class="math inline">\(个随便放.相当于我们按照每组所放的数的最小值区分每组.由于这么做,第\)</span>m
+ 1 <span class="math inline">\(组(最小值最大的那组)在\)</span>k
$不同的时候最小值是不同的,因此一定不重不漏.</p>
<ol start="11" type="1">
<li>$= <em>{ k = 0 } ^n C </em>{ n } ^k ( n - k ) ! = n ! _{ k = 0 } ^n
{ k ! } \ $.</li>
</ol>
<p>证明:</p>
<p>先考虑前半部分,首先如果$n &gt; 0 <span class="math inline">\(,我们有\)</span>= ( n - 1 ) ! \ <span class="math inline">\(.这个式子很显然,我们现在有一个长度为\)</span>n - 1
<span class="math inline">\(的环,想要往里插入第\)</span>n <span class="math inline">\(个数有\)</span>n - 1 <span class="math inline">\(种选择,所以我们有:\)</span>= ( n - 1 ) \
$,数学归纳一下即可.</p>
<p>那么前半部分的组合意义就是:考虑将$n + 1 <span class="math inline">\(个数划分成\)</span>m + 1 <span class="math inline">\(个环,我们先将其中\)</span>k <span class="math inline">\(个数划分成\)</span>m <span class="math inline">\(个环,剩下\)</span>n + 1 - k <span class="math inline">\(个数划分成另一个环.但是这样算显然会算重,所以我们只需要勒令第\)</span>n
+ 1 $个数在最后一个环里即可.该证明就显然了.</p>
<p>而由于$C _n ^k ( n - k ) ! = C _n ^{ n - k } ( n - k ) ! = n ^{ } = {
k ! } \ $.因此后半部分也得证.</p>
<ol start="12" type="1">
<li><p>${</p>
<span class="math display">\[\begin{array}{ c  } n + m + 1 \\ m
\end{array}\]</span>
<p>} = _{ k = 0 } ^m k {</p>
<span class="math display">\[\begin{array}{ c  } n + k \\ k
\end{array}\]</span>
<p>} \ $.</p></li>
<li><p>$_{ k = 0 } ^m ( n + k ) \ $.</p></li>
</ol>
<p>证明:</p>
<p>先考虑前者,我们将$n + k <span class="math inline">\(个位置分到\)</span>k <span class="math inline">\(个集合之后.还剩下\)</span>( n + m + 1 ) - ( n + k
) = ( m - k + 1 ) <span class="math inline">\(个数,剩下\)</span>( m - k
) $个集合.</p>
<p>拿出来$( n + k + 1 ) <span class="math inline">\(这个数,剩下的数刚好够每个集合放一个.最后枚举一下把\)</span>(
n + k + 1 ) $放在哪里即可.由于每个划分一定存在一段(可能是$0
$)单独自己集合的后缀.所以这个递推成立.后者也可以同样证明.</p>
<ol start="14" type="1">
<li>$C <em>n ^m ( n - 1 ) ^{ } = </em>{ k = m } ^n {
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
} \ $.</li>
</ol>
<p>证明:</p>
考虑$( n - 1 ) ^{ } = { ( m - 1 ) ! } \ <span class="math inline">\(,不妨设\)</span>f ( n , m ) = _{ k = m } ^n {
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
<p>} \ <span class="math inline">\(,相当于将\)</span>n <span class="math inline">\(个数分成非空\)</span>m <span class="math inline">\(组,然后组内的数要形成若干轮换的方案数.那么知道\)</span>f
( n , m ) = f ( n - 1 , m - 1 ) + ( n - 1 + m ) f ( n - 1 , m ) \ $.</p>
<p>设$g ( n , m ) = C _n ^m { ( m - 1 ) ! } = { m ! ( n - m ) ! ( m - 1
) ! } \ $,那么知道:</p>
$$
<span class="math display">\[\begin{aligned}
g ( n - 1 , m - 1 ) &amp; = \frac { ( n - 1 ) ! ( n - 2 ) !  } { ( m - 1
) ! ( n - m ) ! ( m - 2 ) !  } \\
g ( n - 1 , m ) &amp; = \frac { ( n - 1 ) ! ( n - 2 ) !  } { m ! ( n - 1
- m ) ! ( m - 2 ) !  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>显然$g ( n , m ) = g ( n - 1 , m - 1 ) + ( n - 1 + m ) g ( n - 1 , m
) \ $,数学归纳即可.</p>
<ol start="15" type="1">
<li><p>$C <em>n ^m = { m ! ( n - m ) ! } = </em>{ k = m } ^n {</p>
<span class="math display">\[\begin{array}{ c  } n + 1 \\ k + 1
\end{array}\]</span>
<p>} ( - 1 ) ^{ m - k } \ $.</p></li>
<li><p>$n ^{ } = { m ! } = _{ k = m } ^n {</p>
<span class="math display">\[\begin{array}{ c  } k \\ m
\end{array}\]</span>
<p>} ( - 1 ) ^{ m - k } ， 其 中 m n \ $.</p></li>
</ol>
<p>证明:考虑(5)(6),对其做一遍斯特林反演即可.</p>
<ol start="17" type="1">
<li><p>${</p>
<span class="math display">\[\begin{array}{ c  } n \\ l + m
\end{array}\]</span>
<p>} C <em>{ l + m } ^l = </em>{ k = l } ^n {</p>
<span class="math display">\[\begin{array}{ c  } k \\ l
\end{array}\]</span>
<p>} {</p>
<span class="math display">\[\begin{array}{ c  } n - k \\ m
\end{array}\]</span>
<p>} C _n ^k \ $.</p></li>
<li><p>$C <em>{ l + m } ^l = </em>{ k = l } ^n C _n ^k \ $.</p></li>
</ol>
<p>证明:先考虑前者,左边即先将$n <span class="math inline">\(个数分为\)</span>l + m <span class="math inline">\(个集合,然后再挑出\)</span>l <span class="math inline">\(个集合.那不妨枚举这\)</span>l
$个集合中是哪些数,然后再进行分配.后者同理.</p>
<h2><span id="欧拉数">欧拉数</span></h2>
记$
<span class="math display">\[\begin{array}\\ n \\ k \end{array}\]</span>
<span class="math inline">\(表示\)</span>{ 1 , 2 , . . . , n } <span class="math inline">\(的排列\)</span>a <span class="math inline">\(中满足这条性质的排列个数:存在且只存在\)</span>k
<span class="math inline">\(个升高,换句话说,存在且只存在\)</span>k <span class="math inline">\(个\)</span>i $,满足$1 i &lt; n <span class="math inline">\(,\)</span>a <em>i &lt; a </em>{ i + 1 } <span class="math inline">\(.不难发现\)</span>
<span class="math display">\[\begin{array}\\ n \\ k \end{array}\]</span>
=
<span class="math display">\[\begin{array}\\ n \\ n - k - 1
\end{array}\]</span>
<p>$.</p>
考虑在一个${ 1 , 2 , . . . , n - 1 } <span class="math inline">\(的排列中插入\)</span>n <span class="math inline">\(,设插入的位置是原本\)</span>a _i <span class="math inline">\(的后面,那么要么原本\)</span>a <em>i &lt; a </em>{
i + 1 } $,要么反之.前者不会改变排列的升高的数量,后者则会增加$1 <span class="math inline">\(.另外还有一种情况是插入到了序列最前面.于是我们自然得到:\)</span>
<span class="math display">\[\begin{array}\\ n \\ k \end{array}\]</span>
= ( k + 1 )
<span class="math display">\[\begin{array}\\ n - 1 \\ k
\end{array}\]</span>
+ ( n - k )
<span class="math display">\[\begin{array}\\ n - 1 \\ k - 1
\end{array}\]</span>
<p>$.</p>
特别地,我们令$
<span class="math display">\[\begin{array}\\ 0 \\ k \end{array}\]</span>
= [ k = 0 ] <span class="math inline">\(,若\)</span>k &lt; 0 <span class="math inline">\(,则\)</span>
<span class="math display">\[\begin{array}\\ n \\ k \end{array}\]</span>
<p>= 0 $.</p>
<h3><span id="欧拉数与二项式系数">欧拉数与二项式系数</span></h3>
<p>我们有Worpitzky恒等式:</p>
<p><span class="math display">\[
x ^n = \sum _{ k \geq 0  } \binom { x + k  } { n  } \left \langle
\begin{array}
\\
n \\
k
\end{array} \right \rangle , n \in \mathbb { N  }
\]</span></p>
<p>还有另一个恒等式:</p>
<p><span class="math display">\[
\left \langle \begin{array}
\\
n \\
m
\end{array} \right \rangle = \sum _{ k = 0  } ^m \binom { n + 1  } {
k  } ( m + 1 - k ) ^n ( - 1 ) ^k
\]</span></p>
<p>剩下的不会了.</p>
<h2><span id="伯努利数">伯努利数</span></h2>
<p>定义$B <em>j <span class="math inline">\(为第\)</span>j <span class="math inline">\(个伯努利数,且满足\)</span></em>{ j = 0 } ^m { j }
B _j = [ m = 0 ] , m \ $.</p>
<p>定义$S <em>m ( n ) = </em>{ i = 0 } ^{ n - 1 } i ^m $.</p>
<p>伯努利数满足公式:$S <em>m ( n ) = { m + 1 } </em>{ k = 0 } ^m { k } B
_k n ^{ m + 1 - k } \ $.</p>
<p>证明如下:</p>
<p>对$S _{ m + 1 } ( n ) $使用扰动法,我们有:</p>
$$
<span class="math display">\[\begin{aligned}
S _{ m + 1  } ( n ) + n ^{ m + 1  } &amp; = \sum _{ k = 0  } ^{ n - 1  }
( k + 1 ) ^{ m + 1  } \\
&amp; = \sum _{ k = 0  } ^{ n - 1  } \sum _{ j = 0  } ^{ m + 1  } \binom
{ m + 1  } { j  } k ^j \\
&amp; = \sum _{ j = 0  } ^{ m + 1  } \binom { m + 1  } { j  } S _j ( n )
\\
&amp; = \sum _{ j = 0  } ^{ m  } \binom { m + 1  } { j  } S _j ( n ) + S
_{ m + 1  } ( n ) \\
n ^{ m + 1  } &amp; = \sum _{ j = 0  } ^m \binom { m + 1  } { j  } S _j
( n ) \\

\end{aligned}\]</span>
<p>$$</p>
<p>接下来使用数学归纳,假设$0 j &lt; m <span class="math inline">\(时该公式成立,并假设有\)</span>S <em>m ( n ) = { m
+ 1 } </em>{ k = 0 } ^m { k } B _k n ^{ m + 1 - k } + \ <span class="math inline">\(,我们只需要证明\)</span>= 0 $.</p>
<p><span class="math display">\[
\begin{aligned}
n ^{ m + 1  } &amp; = \sum _{ j = 0  } ^m \binom { m + 1  } { j  }
\cfrac { 1  } { j + 1  } \sum _{ k = 0  } ^j \binom { j + 1  } { k  } B
_k n ^{ j + 1 - k  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ 0 \leq k \leq j \leq m  } \binom { j + 1  } { k  }
\binom { m + 1  } { j  } \cfrac { 1  } { j + 1  } B _k n ^{ j + 1 - k  }
+ ( m + 1 ) \Delta \\
&amp; = \sum _{ 0 \leq k \leq j \leq m  } \binom { j + 1  } { j - k  }
\binom { m + 1  } { j  } \cfrac { 1  } { j + 1  } B _{ j - k  } n ^{ k +
1  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ 0 \leq k \leq j \leq m  } \binom { j + 1  } { k + 1  }
\binom { m + 1  } { j  } \cfrac { 1  } { j + 1  } B _{ j - k  } n ^{ k +
1  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ 0 \leq k \leq m  } \cfrac { n ^{ k + 1  }  } { k + 1  }
\sum _{ j = k  } ^m B _{ j - k  } \binom { m + 1  } { j  } \binom { j  }
{ k  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ 0 \leq k \leq m  } \cfrac { n ^{ k + 1  }  } { k + 1  }
\binom { m + 1  } { k  } \sum _{ j = k  } ^m B _{ j - k  } \binom { m +
1 - k  } { j - k  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ k = 0  } ^m \cfrac { n ^{ k + 1  }  } { k + 1  } \binom
{ m + 1  } { k  } \sum _{ j = 0  } ^{ m - k  } B _{ j  } \binom { m + 1
- k  } { j  } + ( m + 1 ) \Delta \\
&amp; = \sum _{ k = 0  } ^m \cfrac { n ^{ k + 1  }  } { k + 1  } \binom
{ m + 1  } { k  } [ m - k &amp; = 0 ] + ( m + 1 ) \Delta \\
&amp; = n ^{ m + 1  } + ( m + 1 ) \Delta
\end{aligned}
\]</span></p>
<p>显然$= 0 $,上式成立.</p>
<h2><span id="斐波那契数">斐波那契数</span></h2>
定义斐波那契数$F _n =
<span class="math display">\[\begin{cases}0 &amp; n = 0 \\ 1 &amp; n = 1
\\ F _{ n - 1  } + F _{ n - 2  } &amp; n &gt; 1 \end{cases}\]</span>
<p>$.</p>
<h3><span id="斐波那契数的扩展定义">斐波那契数的扩展定义</span></h3>
<p>首先根据数学归纳,不难证明卡西尼恒等式:</p>
<p><span class="math display">\[
F _{ n + 1  } F _{ n - 1  } - F _n ^2 = ( - 1 ) ^n , n &gt; 0
\]</span></p>
<p>事实上,如果我们将斐波那契数的递推式改写作:$F <em>n = F </em>{ n + 2 }
- F _{ n + 1 } <span class="math inline">\(,我们可以在\)</span>n
$的时候定义斐波那契数,同样也是满足上面的恒等式的,而且我们可以发现:</p>
<p><span class="math display">\[
F _{ - n  } = ( - 1 ) ^{ n - 1  } F _n , n \in \mathbb { Z  }
\]</span></p>
<h3><span id="斐波那契数与数论">斐波那契数与数论</span></h3>
<p>如果我们考虑不断使用斐波那契递推式展开,不难发现:</p>
<p><span class="math display">\[
\begin{aligned}
F _{ n + k  } &amp; = F _k F _{ n + 1  } + F _{ k - 1  } F _n \\
F _{ n + m + 1  } &amp; = F _{ n + 1  } F _{ m + 1  } + F _n F _m
\end{aligned}
\]</span></p>
<p>另外,如果我们在上面这个式子中取$k = wn , w <span class="math inline">\(并使用归纳法,我们又可以得到一个性质:\)</span>F _{
kn } <span class="math inline">\(是\)</span>F _n <span class="math inline">\(的倍数,\)</span>k $.</p>
<p>再观察这个式子,使用归纳法可以证明$( F <em>{ n } , F </em>{ n - 1 } )
= 1 <span class="math inline">\(,进一步有:\)</span>( F _{ n + m } , F _m
) = ( F _n , F _m ) $.</p>
<p>如果我们推广这个结论,就可以得到一个重要的性质:</p>
<p><span class="math display">\[
\gcd ( F _m , F _n ) = F _{ \gcd ( n , m )  }
\]</span></p>
<p>如果我们再一次推广这个结论,可以得到马蒂亚舍维奇引理:</p>
<p><span class="math display">\[
F _n ^2 | F _m \Leftrightarrow nF _n | m , n &gt; 2
\]</span></p>
<p>这个引理的证明如下:</p>
<p>由于$F <em>{ n + 1 } F </em>{ n - 1 } <span class="math inline">\(.于是我们有:\)</span>F <em>{ 2 n } = F <em>n F
</em>{ n + 1 } + F </em>{ n - 1 } F <em>n <span class="math inline">\(,也就是\)</span>F </em>{ 2 n } F <em>n F </em>{ n
+ 1 } $.</p>
<p>另外我们有:$F <em>{ 2 n + 1 } F </em>{ n + 1 } ^2 $.</p>
<p>同理,使用归纳法可以证明:$F <em>{ kn } kF <em>n F </em>{ n + 1 } ^{ k
- 1 } , F </em>{ kn + 1 } F _{ n + 1 } ^k $.</p>
<p>而$F _{ n + 1 } F <em>n <span class="math inline">\(,于是\)</span>F
</em>{ kn } k , n &gt; 2 $.</p>
<h3><span id="斐波那契数系">斐波那契数系</span></h3>
<p>我们如果定义$j k j k + 2 $,那么有齐肯多夫定理:</p>
<p>每个正整数都有唯一的表示方式满足:$n = <em>{ i = 1 } ^r F </em>{ k _i
} , i &lt; r , k <em>i k </em>{ i + 1 } $.</p>
<p>首先证明存在性:我们考虑数学归纳,对于一个数n,如果$k <span class="math inline">\(满足\)</span>F _k = n <span class="math inline">\(,则显然成立,不然,应\)</span>k <span class="math inline">\(满足\)</span>F <em>k &lt; n &lt; F </em>{ k + 1 }
<span class="math inline">\(,而\)</span>n - F _k <span class="math inline">\(的表示已经存在了.另外,由于\)</span>n - F <em>k
&lt; F </em>{ k + 1 } - F <em>k = F </em>{ k - 1 } <span class="math inline">\(,因此必定不可能出现选了\)</span>F <em>k <span class="math inline">\(又选了\)</span>F </em>{ k - 1 }
$的情况,存在性得证.</p>
<p>至于唯一性,如果我们不选择$F <em>k <span class="math inline">\(而是选择\)</span>F </em>{ k - 1 } <span class="math inline">\(,那么显然接下来无论怎么选,它们的加和都不可能大于等于\)</span>F
_k $,因此一定是唯一的.</p>
<p>这样的话,我们可以将一个自然数$n $以斐波那契数的形式表示出来.</p>
<h3><span id="斐波那契数的封闭形式">斐波那契数的封闭形式</span></h3>
<p>使用生成函数,令$F ( z ) = _{ k } F _k z ^k <span class="math inline">\(.那么不难发现\)</span>F ( z ) - zF ( z ) - z ^2 F
( z ) = z <span class="math inline">\(,也就是\)</span>F ( z ) = { 1 - z
- z ^2 } $.</p>
<p>考虑这个形式一定可以分解为$F ( z ) = { 1 - z } + { 1 - z }
$的形式,而这两种形式对应的生成函数都很显然.</p>
<p>进行因式分解,如果令$= { 2 } , = { 2 } <span class="math inline">\(,那么可以得到\)</span>F _n = { } ( ^n - ^n )
$.</p>
<p>另外,由于$^n <span class="math inline">\(的影响很小,于是又有\)</span>F _n = { } + 0 . 5
$.</p>
<h3><span id="连项式">连项式</span></h3>
连项式多项式$K _n ( x _1 , x _2 , . . . , x _n ) <span class="math inline">\(定义为:\)</span>K _n ( x _1 , x _2 , . . . , x _n
) =
<span class="math display">\[\begin{cases}1 &amp; n = 0 \\ x _1 &amp; n
= 1 \\ x _n K _{ n - 1  } ( x _1 , x _2 , . . . x _{ n - 1  } ) + K _{ n
- 2  } ( x _1 , x _2 , . . . , x _{ n - 2  } ) &amp; n \geq 2
\end{cases}\]</span>
<p>$.</p>
<p>通过定义不难发现:$K <em>n ( 1 , 1 , . . . , 1 ) = F </em>{ n + 1 }
$.</p>
<p>继续观察式子,会发现它递归的过程相当于枚举是否消掉相邻的一对数$( x _{
n - 1 } , x _n )
$.我们考虑用这样一种形式的字符串来表示最后某一项的情况:‘.’为还没有消除掉的项,长度为$1
$;’-’为已经消除了的两项,长度为$2 <span class="math inline">\(.那么\)</span>K _n ( x _1 , x _2 , . . . , x _n )
<span class="math inline">\(就可以表示为一个长度为\)</span>n <span class="math inline">\(的字符串,其中若有\)</span>k <span class="math inline">\(个&#39;-&#39;,有\)</span>n - 2 k <span class="math inline">\(个&#39;.&#39;,则有\)</span> { k }
$种不同的排列方式.</p>
<p>于是我们有:</p>
$$
<span class="math display">\[\begin{aligned}
K _n ( z , z , . . . , z ) &amp; = \sum _{ k = 0  } ^n \binom { n - k  }
{ k  } z ^{ n - 2 k  } \\

\end{aligned}\]</span>
<p>$$</p>
<p>另外,这也导出:$F <em>{ n + 1 } = </em>{ k = 0 } ^n { k } \ $.</p>
<p>考虑上面的构造过程,不难发现$K _n ( x _1 , x _2 , . . . , x _n ) = K
_n ( x <em>n , x </em>{ n - 1 } , . . . , x _1 ) $.</p>
<p>于是递归式可以写成:$K _n ( x _1 , x _2 , . . . , x _n ) = x <em>1 K
</em>{ n - 1 } ( x <em>2 , x <em>3 , . . . x </em>{ n } ) + K </em>{ n -
2 } ( x _3 , x <em>4 , . . . , x </em>{ n } ) $.</p>
<p>进一步地,不断展开后得到:</p>
<p><span class="math display">\[
\begin{aligned}
K _{ m + n  } ( x _1 , . . . , x _m , x _{ m + 1  } , . . . , x _{ n +
m  } ) &amp; = \\
K _m ( x _1 , . . . , x _m ) K _n ( x _{ m + 1  } , . . . , x _{ n +
m  } ) + K _{ m - 1  } ( x _1 , . . . , x _{ m - 1  } ) K _{ n - 1  } (
x _{ m + 2  } , . . . , x _{ n + m  } )
\end{aligned}
\]</span></p>
<p>另外,根据连项式的定义,不难导出$K _n ( x _1 , . . . , x _n + y ) = K
_n ( x _1 , . . . , x <em>n ) + K </em>{ n - 1 } ( x <em>1 , . . . , x
</em>{ n - 1 } ) y $.</p>
<p>由这个公式可以推出:$ { K _n ( a _1 , . . . , a <em>n ) } = { K </em>{
n - 1 } ( a <em>1 , . . . , a </em>{ n - 1 } + { a _n } ) } $.</p>
<p>不断做这个迭代,于是我们可以得到连项式与连分数之间的关系:</p>
<p><span class="math display">\[
\cfrac { K _{ n + 1  } ( a _0 , . . . , a _n )  } { K _n ( a _1 , . . .
, a _n )  } = a _0 + \cfrac { 1  } { a _1 + \cfrac { 1  } { a _2 +
\cfrac { 1  } { a _3 + . . .  }  }  }
\]</span></p>
<p>另外,这个与数论中的Stern-Brocot树有很大关系,暂略.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag"># 数学</a>
          </div>

        
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
      <a class="a2a_button_telegram"></a>
      <a class="a2a_button_wechat"></a>
      <a class="a2a_button_qzone"></a>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%AE%80%E5%8D%95%E4%B9%90%E7%90%86/" rel="prev" title="简单乐理">
                  <i class="fa fa-angle-left"></i> 简单乐理
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/22/%E5%AD%A6%E4%B9%A0-%E8%8C%83%E7%95%B4%E8%AE%BA%E5%88%9D%E6%AD%A5/" rel="next" title="范畴论初步">
                  范畴论初步 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">LWLAymh</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"my-repository-jade-beta-79.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"有什么想法?","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2025/06/22/%E5%AD%A6%E4%B9%A0-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

  <!-- 音乐播放器 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.js"></script>
  <div id="aplayer" class="aplayer" data-id="7637648380" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#F58EA8"></div>
  <script src="https://unpkg.com/meting@1.2/dist/Meting.min.js"></script>
  <!-- 音乐播放器 end -->
</body>
</html>
