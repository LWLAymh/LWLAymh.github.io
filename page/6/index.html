<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <link rel="mask-icon" href="/images/%E5%A4%B4%E5%83%8F1.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lwlaymh.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="不过是白日梦里一瞬息">
<meta property="og:type" content="website">
<meta property="og:title" content="LWLAymh的备忘录">
<meta property="og:url" content="http://lwlaymh.github.io/page/6/index.html">
<meta property="og:site_name" content="LWLAymh的备忘录">
<meta property="og:description" content="不过是白日梦里一瞬息">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="LWLAymh">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://lwlaymh.github.io/page/6/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/6/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LWLAymh的备忘录</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>





  <script src="/js/third-party/addtoany.js" defer></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>


<link rel="dns-prefetch" href="my-repository-jade-beta-79.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">LWLAymh的备忘录</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">混乱节拍拼凑出血肉喧嚷</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LWLAymh"
      src="/images/%E5%A4%B4%E5%83%8F1.jpg">
  <p class="site-author-name" itemprop="name">LWLAymh</p>
  <div class="site-description" itemprop="description">不过是白日梦里一瞬息</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LWLAymh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LWLAymh" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lwlaymh@outlook.com" title="E-Mail → mailto:lwlaymh@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/LWLAymh" title="WeChat → LWLAymh" rel="noopener me"><i class="fab fa-skype fa-fw"></i>WeChat</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://minyuchengmin.github.io/" title="https:&#x2F;&#x2F;minyuchengmin.github.io" rel="noopener" target="_blank">ycm的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://shanlunjiajian.github.io/" title="http:&#x2F;&#x2F;shanlunjiajian.github.io" rel="noopener" target="_blank">qyc的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://www.cnblogs.com/do-while-true" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;do-while-true" rel="noopener" target="_blank">dwt的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://windgraham.art/" title="http:&#x2F;&#x2F;windgraham.art&#x2F;" rel="noopener" target="_blank">zhgg的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://www.hjcheng0602.cn/" title="https:&#x2F;&#x2F;www.hjcheng0602.cn&#x2F;" rel="noopener" target="_blank">jcgg的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://illusion.blog/" title="https:&#x2F;&#x2F;illusion.blog&#x2F;" rel="noopener" target="_blank">jjjj的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://blog.imyangty.com/" title="https:&#x2F;&#x2F;blog.imyangty.com&#x2F;" rel="noopener" target="_blank">tygg的blog</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://www.chenquan-tutu.top/" title="https:&#x2F;&#x2F;www.chenquan-tutu.top&#x2F;" rel="noopener" target="_blank">cqgg的blog</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">数学分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-23 11:03:53" itemprop="dateModified" datetime="2025-10-23T11:03:53+08:00">2025-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">大学课程</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h3><span id="实数">实数</span></h3><p>首先我们拿到了有理数,然后我们按照以下步骤定义无理数:</p>
<p>首先我们注意到有理数是不连续的.问题在于我们要将其中不连续的部分给补上.首先我们应当去发现一下如何去发现有理数中的一个断点:</p>
<p>设$S$是一个全序非空集合,我们找到它的两个非空子集$A , B$,若满足:</p>
<ol>
<li><p>$A \cap B = \emptyset , A \cup B = S$.</p>
</li>
<li><p>$\forall a \in A , b \in B , a &lt; b$.</p>
</li>
<li><p>$A$中无最大元素.</p>
</li>
</ol>
<p>则称这是$S$的一个<strong>分划</strong>,记作$( A | B )$.接下来我们先考虑$S = \mathbb{ Q }$的情况.</p>
<p>我们注意到一些事,比如说注意到$B$中有可能没有最小元素.举个例子的话,我们令$S = \mathbb{ Q } , A = \{ x | x \leq 0 \lor ( x &gt; 0 \land x^2 &lt; 2 ) \}$,显然$A$中无最大元素,此时取$B = S \setminus A$,则显然$B$中无最小元素(反证法),假设存在最小元素则可以调整到更小的元素,因为容易证明不存在一个有理数的平方为$2$.</p>
<p>通过上面的铺垫我们知道,有理数并非连续的,因此如果$B$中有最小元素,则称这是一个<strong>有理分划</strong>;如果$B$中无最小元素,则称这是一个<strong>无理分划</strong>.容易发现有理分划与有理数一一对应.我们将无理分划也去对应到一些数上,这就产生了无理数的定义.只需比较$A$集合的大小包含关系就可以比较两个实数的大小.</p>
<p>那我们还需要做的一件事是去证明无理数也有四则运算法则.不妨直接拿分划去验证四则运算法则:</p>
<ol>
<li><p>加法:对于$( A_c | B_c ) + ( A_d | B_d )$,我们取$A_{ c + d } = \{ x + y | x \in A_c , y \in A_d \}$即可.</p>
</li>
<li><p>减法:只需定义加法逆元.如果是无理分划的话,直接把$A , B$中的元素全部取反再交换即可;如果是有理分划的话,需要注意取反再交换后$A$中出现了最大元素,只需要在这里把那个元素给提出来就行.</p>
</li>
<li><p>乘法:两个正数相乘可以直接模仿加法,如果有负数的话就把负号提出来再把绝对值作乘法即可.</p>
</li>
<li><p>除法:只需定义乘法逆元,这个有点麻烦需要判断$A$和$B$哪个集合是同号的,但总之这个是平凡的.</p>
</li>
</ol>
<h4><span id="戴德金分割定理">戴德金分割定理</span></h4><p>对$\mathbb{ R }$的任一分划$( A | B )$,$B$中必定有最小元素.</p>
<p>这个怎么证明呢?对于分划$( A | B )$,我们直接取$A ‘ = A \cap \mathbb{ Q } , B ‘ = B \cap \mathbb{ Q }$,不难发现$( A ‘ | B ‘ )$一定是$\mathbb{ Q }$的一个分划,也就是说$( A ‘ | B ‘ )$对应了一个实数$x$.</p>
<p>既然如此就可以考虑$x$应该属于哪个集合.我们注意到:如果$x \in A$,那么$x$必定是$A$中的最大元素;如果$x \in B$,那么$x$必定是$B$中的最小元素.</p>
<p>两部分是类似的,只考虑前一部分.考虑反证,如果$\exists y &gt; x , y \in A , x \in A$,那么$A ‘ \subsetneq A_y$,那么$A_y$就一定不是$A$的子集.换言之,$\exists w \in A_y$,$\forall z \in A , w &gt; z$.但我们有$y &gt; w$,这必然意味着$y \notin A$,与假设不符.</p>
<h4><span id="确界存在定理">确界存在定理</span></h4><p>若$M$有上(下)界,则必然有上(下)确界.</p>
<p>设$M$有上界$c$,由于它是一个实数,它应该可以写作$( A_c | B_c )$的形式.$\forall \alpha \in M , A_\alpha \subset A_c$.</p>
<p>于是我们取$A = \bigcup_{ \alpha \in M } A_\alpha , B = \mathbb{ Q } \setminus A$,我们来说明$( A | B )$是一个分划.</p>
<p>首先由于有上界,显然$A , B \ne \emptyset , A \cap B = \emptyset , A \cup B = \mathbb{ Q }$.</p>
<p>如果 $\exists b \in B , a \in A , b &lt; a$,这是不可能的,因为如果$b &lt; a$,那么$b \in A , b \notin B$.</p>
<p>因为所有的$A_\alpha$中都没有最大元素,反证即可说明$A$中无最大元素.</p>
<p>那么$( A | B )$就是$M$的上确界.</p>
<h6><span id="example1">Example1</span></h6><p>证明对于单增函数$f : [ 0 , 1 ] \rightarrow [ 0 , 1 ]$,$f ( [ 0 , 1 ] ) \subseteq ( 0 , 1 )$,则$f$与$y = x$一定有交点.</p>
<p>取$A = \{ x | f ( x ) &lt; x \}$,则$1 \in A , A \subseteq [ 0 , 1 ]$.取$a = \inf A$.</p>
<p>此时我们断言$f ( a ) = a$,否则:</p>
<p>如果$f ( a ) &lt; a$,取$\epsilon = a - f ( a )$,注意到$f ( a - \frac{ \epsilon }{ 2 } ) &lt; f ( a ) &lt; a - \frac{ \epsilon }{ 2 }$,因此$( a - \frac{ \epsilon }{ 2 } ) \in A$,与$a$是下确界矛盾.</p>
<p>如果$f ( a ) &gt; a$,取$\epsilon = f ( a ) - a$.考虑由于$a$是下确界,因此$\exists b \in A , b \in ( a , a + \frac{ \epsilon }{ 2 } )$.那么$b &lt; a + \frac{ \epsilon }{ 2 } &lt; f ( a ) &lt; f ( b )$,这与$b \in A$矛盾.</p>
<h4><span id="阿基米德性质">阿基米德性质</span></h4><p>以下命题等价,任取其一均可作为阿基米德性质:</p>
<ol>
<li><p>$\forall y \in \mathbb{ R }$,$\exists n \in \mathbb{ N } , n &gt; y$.</p>
</li>
<li><p>$\forall x \in \mathbb{ R }_+ , \exists n \in \mathbb{ N }$,$nx &gt; 1$.</p>
</li>
<li><p>$\{ \frac{ 1 }{ n } \}$有聚点.</p>
</li>
<li><p>$\lim_{ n \rightarrow \infty } \frac{ 1 }{ n }$存在.</p>
</li>
<li><p>$\lim_{ n \rightarrow \infty } \frac{ 1 }{ n } = 0$.</p>
</li>
<li><p>$\lim_{ n \rightarrow \infty } \frac{ 1 }{ 2^n } = 0$.</p>
</li>
</ol>
<p>(1)$\Rightarrow$(2)$\Rightarrow$(3)$\Rightarrow$(4)$\Rightarrow ( 5 )$是显然的.又考虑$\{ \frac{ 1 }{ 2^n } \}$是$\{ \frac{ 1 }{ n } \}$的子列,所以$( 5 ) \Rightarrow ( 6 )$.而取一个$\frac{ 1 }{ 2^k } &lt; \frac{ 1 }{ | y | }$即可(6)$\Rightarrow$(1).</p>
<p>阿基米德性质可以由确界存在定理推来,简单来说考虑$x \in \mathbb{ R }_+ , A = \{ nx | nx &lt; 1 \}$.反证,如果$A$是无限集合,那么根据确界存在定理一定存在最小上确界$\alpha \leq 1$有$\forall n , nx &lt; \alpha , ( n + 1 ) x &lt; \alpha , nx &lt; \alpha - x$,这就说明$\alpha - x$是一个更小的上界,这就矛盾了.</p>
<h3><span id="实数集上的一元函数">实数集上的一元函数</span></h3><h4><span id="性质">性质</span></h4><h5><span id="奇偶性">奇偶性</span></h5><p>首先需要定义域关于原点对称.</p>
<p>然后注意到取$f ( x ) = \frac{ f ( x ) + f ( - x ) }{ 2 } + \frac{ f ( x ) - f ( - x ) }{ 2 }$,可将任意定义域关于原点对称的函数写作奇偶函数之和.</p>
<p>事实上,对于一个可以求任意次导数的偶函数$f$,是否总存在一个可以求任意次导数的函数$g$使得$f ( x ) = g ( x^2 )$.</p>
<p>这个问题的难点肯定在于$0$附近对吧.</p>
<p>这个证明要用到泰勒展开.</p>
<script type="math/tex; mode=display">
f ( \sqrt{ x } ) = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( 0 ) }{ k ! } x^\frac{ k }{ 2 } + \frac{ f^{ ( n + 1 ) } ( \xi_n ) }{ ( n + 1 ) ! } x^\frac{ n + 1 }{ 2 }</script><p>两边求导,应该有:</p>
<script type="math/tex; mode=display">
( f ( \sqrt{ x } ) )^{ ( t ) } = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( 0 ) \prod \limits_{ i = 0 }^{ t - 1 } ( \frac{ k }{ 2 } - i ) }{ k ! } x^{ \frac{ k }{ 2 } - t } + \frac{ f^{ ( n + 1 ) } ( \xi_n ) \prod \limits_{ i = 0 }^{ t - 1 } ( \frac{ n + 1 }{ 2 } - i ) }{ ( n + 1 ) ! } x^{ \frac{ n + 1 }{ 2 } - t }</script><p>我们知道$f$任意阶导数存在,所以在闭区间$[ - 1 , 1 ]$上任意阶导数有界.这就意味着,对于固定的$t$.只要取足够大的$n = 2 t + 2$满足$\frac{ n + 1 }{ 2 } - t &gt; 1$,就可以让余项趋于$0$.</p>
<p>现在来数学归纳,用多项式的特殊情况,假设$g^{ ( t ) } ( 0 ) = \frac{ t ! }{ ( 2 t ) ! } f^{ ( 2 t ) } ( 0 )$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g^{ ( t + 1 ) } ( 0 ) = \frac{ ( f ( \sqrt{ x } ) )^{ ( t ) } - \frac{ t ! }{ ( 2 t ) ! } f^{ ( 2 t ) } ( 0 ) }{ x } \\
= \cfrac{ \sum_{ k = 0 }^{ 2 t + 2 } \frac{ f^{ ( k ) } ( 0 ) \prod \limits_{ i = 0 }^{ t - 1 } ( \frac{ k }{ 2 } - i ) }{ k ! } x^{ \frac{ k }{ 2 } - t } - \frac{ t ! }{ ( 2 t ) ! } f^{ ( 2 t ) } ( 0 ) }{ x } \\
= \cfrac{ \sum_{ k = 0 }^{ 2 t + 2 } \frac{ f^{ ( k ) } ( 0 ) \prod \limits_{ i = 0 }^{ t - 1 } ( \frac{ k }{ 2 } - i ) }{ k ! } x^{ \frac{ k }{ 2 } } - \frac{ t ! }{ ( 2 t ) ! } f^{ ( 2 t ) } ( 0 ) x^t }{ x^{ 1 + t } } \\

\end{aligned}</script><p>一片混乱,考虑一下下面这项:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ f^{ ( k ) } ( 0 ) \prod \limits_{ i = 0 }^{ t - 1 } ( \frac{ k }{ 2 } - i ) }{ k ! } x^{ \frac{ k }{ 2 } } \\
= & \frac{ f^{ ( k ) } ( 0 ) \prod \limits_{ i = 0 }^{ t - 1 } ( k - 2 i ) }{ k ! 2^t } x^{ \frac{ k }{ 2 } } \\

\end{aligned}</script><p>这个时候我们注意到,当$k$是奇数的时候应该有$f^{ ( k ) } ( 0 ) = 0$,当$k$是偶数并且$k \leq t - 1$的时候应该有$\prod \limits_{ i = 0 }^{ t - 1 } ( k - 2 i ) = 0$,这意味着这个求和最后只会剩下$\frac{ f^{ ( 2 t ) } ( 0 ) t ! }{ ( 2 t ) ! } x^{ t } + \frac{ f^{ 2 t + 2 } ( 0 ) ( t + 1 ) ! }{ ( 2 t + 2 ) ! } x^{ t + 1 }$,然而前半部分和后面的刚好消掉了,这就数学归纳成立了.</p>
<h5><span id="有界性">有界性</span></h5><h5><span id="单调性">单调性</span></h5><h5><span id="周期性">周期性</span></h5><p>周期函数不一定有最小正周期,比如狄利克雷函数.</p>
<p>还有个思考题:</p>
<p>如果$f , g$是定义域为$R$的最小正周期分别为$T_1 , T_2$的周期函数,求问:</p>
<ol>
<li><p>若$\frac{ T_1 }{ T_2 } \in \mathbb{ Q }$,则$f + g$是周期函数.</p>
</li>
<li><p>若$\frac{ T_1 }{ T_2 } \in \mathbb{ R } \setminus \mathbb{ Q }$,结论如何.</p>
</li>
<li><p>若$f , g$均连续,结论如何.</p>
</li>
</ol>
<p>(1)显然,(3)必定不是周期函数,原因是考虑反证:</p>
<p>如果是的话,必定有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x + T ) + g ( x + T ) & = f ( x ) + g ( x ) \\
f ( x + T ) - f ( x ) & = g ( x ) - g ( x + T )
\end{aligned}</script><p>令$h ( x ) = f ( x + T ) - f ( x ) = g ( x ) - g ( x + T )$,则$h ( x )$以$T_1 , T_2$为周期,那么其以$pT_1 + qT_2$为周期,可逼近这个无理数使得其周期趋近于$0$,用$h$的连续性,于是$h ( x )$为常函数,不符题意.</p>
<p>(2)怎么办呢?有没有一种构造方式使得它是周期函数呢?</p>
<p>构造$d_{ p , q } ( x ) = \begin{cases}1 &amp; \exists m , n \in \mathbb{ Z } , mp + nq = x \ 0 &amp; \forall m , n \in \mathbb{ Z } , mp + nq \ne x\end{cases}$.</p>
<p>取$f ( x ) = d_{ 1 , \sqrt{ 2 } } ( x ) - d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x ) , g ( x ) = d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x ) - d_{ 1 , \sqrt{ 3 } }$,容易见到$f + g$的周期为$1$,下面证明$f$的最小正周期是$\sqrt{ 2 }$,而$g$的最小正周期是$\sqrt{ 3 }$.</p>
<p>二者相似,只考虑证明前者,如若存在一个$T$,使得$f ( x ) = f ( x + T )$,则有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
d_{ 1 , \sqrt{ 2 } } ( x ) - d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x ) & = d_{ 1 , \sqrt{ 2 } } ( x + T ) - d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x + T ) \\
d_{ 1 , \sqrt{ 2 } } ( x ) - d_{ 1 , \sqrt{ 2 } } ( x + T ) & = d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x ) - d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( x + T )
\end{aligned}</script><p>取$x = \sqrt{ 3 }$得到:</p>
<script type="math/tex; mode=display">
d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( \sqrt{ 3 } + T ) - d_{ 1 , \sqrt{ 2 } } ( \sqrt{ 3 } + T ) = 1</script><p>这就意味着:</p>
<script type="math/tex; mode=display">
\begin{cases}
d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( \sqrt{ 3 } + T ) = 1 \\
d_{ 1 , \sqrt{ 2 } } ( \sqrt{ 3 } + T ) = 0 \\

\end{cases}</script><p>从而$T = n \sqrt{ 2 } + m \sqrt{ 3 }$,其中$m \ne - 1$.再取$x = 0$得到:</p>
<script type="math/tex; mode=display">
d_{ 1 , \sqrt{ 2 } } ( T ) = d_{ \sqrt{ 2 } , \sqrt{ 3 } } ( T ) = 1</script><p>这就必然意味着$T = n \sqrt{ 2 }$,从而$f$的最小正周期恰好就是$\sqrt{ 2 }$.</p>
<h4><span id="基本初等函数">基本初等函数</span></h4><ol>
<li><p>常值函数</p>
</li>
<li><p>指数函数</p>
</li>
<li><p>对数函数</p>
</li>
<li><p>幂函数</p>
</li>
<li><p>三角函数</p>
</li>
<li><p>反三角函数</p>
</li>
</ol>
<p>其中有一些函数的定义其实有一些缺陷,我们将在讨论完连续性后给出.</p>
<h4><span id="初等函数">初等函数</span></h4><p>由基本初等函数经过有限次四则运算和复合得到的函数.</p>
<p>举个逆天例子:</p>
<script type="math/tex; mode=display">
f ( x ) = \begin{cases}
\sqrt{ - x } & x < 0 \\
0 & x \in [ 0 , 1 ] \\
\ln x & x > 1
\end{cases}</script><p>注意到$f ( x ) = \sqrt{ \frac{ \sqrt{ x^2 } - x }{ 2 } } + \ln \frac{ x + \sqrt{ ( x - 1 )^2 } + 1 }{ 2 }$.</p>
<h4><span id="代数函数">代数函数</span></h4><p>存在多项式$F ( x , y )$满足$F ( x , f ( x ) ) \equiv 0$的函数$f ( x )$称为代数函数.</p>
<h3><span id="数列极限">数列极限</span></h3><h4><span id="定义">定义</span></h4><p>设$\{ a_n \}$是一个给定的序列,若$\exists l$,$\forall \epsilon &gt; 0$,$\exists N \in \mathbb{ N }$,$\forall n &gt; N , | a_n - l | &lt; \epsilon$.我们称$l$是这个序列的<strong>极限</strong>,记作$\lim_{ n \rightarrow \infty } a_n = l \\$.</p>
<h4><span id="性质">性质</span></h4><ol>
<li><p>若数列存在极限,则极限唯一.</p>
</li>
<li><p>有极限的数列有界.</p>
</li>
<li><p>数列的极限可以四则运算.</p>
</li>
<li><p>设序列$\{ a_n \} , \{ b_n \}$有极限并且分别为$l_a , l_b$,若$\exists N \in \mathbb{ N }$,$\forall n &gt; N , a_n \geq b_n$,则$l_a \geq l_b$.</p>
</li>
<li><p>设序列$\{ a_n \} , \{ b_n \}$有极限并且分别为$l_a , l_b$,如果$l_a &gt; l_b$,则$\exists N \in \mathbb{ N }$,$\forall n &gt; N , a_n &gt; b_n$.</p>
</li>
<li><p>夹逼定理:设$\{ a_n \} , \{ b_n \} , \{ c_n \}$是三个序列,且$\exists N_0 , \forall n &gt; n_0 , a_n \leq b_n \leq c_n$.那么如果$\lim_{ n \rightarrow \infty } a_n = \lim_{ n \rightarrow \infty } c_n = l \\$,则$\lim_{ n \rightarrow \infty } b_n = l \\$.</p>
</li>
<li><p>对于原序列,若它有极限$l$,取出它的无穷项子序列,那这个子序列的极限必然也是$l$.(如果一个序列能取出两个无穷项子序列使得极限不相同,那么原序列必然无极限)</p>
</li>
</ol>
<p>大部分的证明都很显然,只需要套用极限定义即可,这里举几个证明为例.</p>
<p>(3):</p>
<p>设序列$\{ a_n \} , \{ b_n \}$有极限并且分别为$l_a , l_b$,则要证$\lim_{ n \rightarrow \infty } ( a_n \pm b_n ) = l_a \pm l_b \\$,$\lim_{ n \rightarrow \infty } ( a_n b_n ) = l_a l_b \\$,若$l_b \ne 0$,$\lim_{ n \rightarrow \infty } ( \frac{ a_n }{ b_n } ) = \frac{ l_a }{ l_b } \\$.</p>
<p>先证明加减法,取$\frac{ 1 }{ 2 } \epsilon$然后合并起来就行.</p>
<p>乘法也类似,首先有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
l_a - \epsilon_1 & < a_n < l_a + \epsilon_1 \\
l_b - \epsilon_2 & < b_n < l_b + \epsilon_2
\end{aligned}</script><p>于是自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| a_n b_n - l_a l_b | & = | ( a_n - l_a ) b_n + l_a ( b_n - l_b ) | \\
& \leq | b_n | | a_n - l_a | + | l_a | | b_n - l_b | \\
& < | b_n | \epsilon_1 + | l_a | \epsilon_2 \\
& < | l_b \pm \epsilon_2 | \epsilon_1 + | l_a | \epsilon_2
\end{aligned}</script><p>不妨令$\epsilon_1 = \epsilon_2$,尝试构造一组解使得$\forall \epsilon &gt; 0 , \exists \epsilon_1 &gt; 0$,$| l_b \pm \epsilon_1 | \epsilon_1 + | l_a | \epsilon_1 &lt; \epsilon$.限制一下$\epsilon &lt; 1 , \epsilon_1 &lt; 1$,取$\epsilon_1 = \frac{ \epsilon }{ 1 + | l_b | + | l_a | }$即可.</p>
<p>接下来证明除法,实际上只需要证明若$l_b \ne 0$,$\lim_{ n \rightarrow \infty } ( \frac{ 1 }{ b_n } ) = \frac{ 1 }{ l_b } \\$.</p>
<p>考虑:$l_b \lim_{ n \rightarrow \infty } b_n = l_b^2 &gt; 0 \\$,这意味着当$\exists N_0 , \forall n &gt; N_0 , l_b b_n &gt; 0 \\$,或者更强一点,$\exists N_0 , \forall n &gt; N_0 , l_b b_n &gt; \frac{ 1 }{ 2 } l_b^2 \\$.</p>
<p>不妨设$\epsilon ‘ &gt; 0 , \exists N_1 , \forall n &gt; N_1 , | l_b - b_n | &lt; \epsilon ‘$</p>
<p>取$n &gt; \max ( N_0 , N_1 )$此时自然有:</p>
<script type="math/tex; mode=display">
| \frac{ 1 }{ b_n } - \frac{ 1 }{ l_b } | = \frac{ | l_b - b_n | }{ | b_n l_b | } \leq \frac{ 2 }{ l_b^2 } \epsilon '</script><p>取$\epsilon ‘ = \frac{ l_b^2 }{ 2 } \epsilon$即可得证.</p>
<p>(4):</p>
<p>反证,设$l_a &lt; l_b$,那么取$\epsilon = \frac{ l_b - l_a }{ 2 }$,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| a_N - l_a | & < \epsilon \\
a_N & < \frac{ l_a + l_b }{ 2 } < b_N
\end{aligned}</script><p>这是不可能的.</p>
<h4><span id="单调收敛准则">单调收敛准则</span></h4><p>单调有界无穷数列有极限.</p>
<p>不妨设$\{ a_n \}$是一个单调有界无穷数列(不妨假设其单增,不然可以取反变成单增),且$\forall n , a_n \leq l_a$.</p>
<p>考虑集合$A = \{ x_n | n \in \mathbb{ N }_+ \}$,根据确界存在定理,其一定有上确界.令$a$是它的上确界,我们来证明$a$一定是数列的极限.</p>
<p>由于$a$是上确界,这意味着$\forall \epsilon &gt; 0 , a - \epsilon$不是上确界,所以$\forall \epsilon &gt; 0$,$\exists N$,$\forall n &gt; N , a - \epsilon &lt; a_n \leq a &lt; a + \epsilon$,这就是极限的定义.</p>
<h4><span id="自然对数的底数">自然对数的底数</span></h4><p>定义$e = \lim_{ n \rightarrow \infty } ( 1 + \frac{ 1 }{ n } )^n \\$.如何证明它存在极限呢?考虑单调有界无穷序列必定存在极限,定义$x_n = ( 1 + \frac{ 1 }{ n } )^n$,于是先证明它有界:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( 1 + \frac{ 1 }{ n } )^n & = \sum_{ k = 0 }^n \frac{ n^{ \underline{ k } } }{ k ! } \frac{ 1 }{ n^k } \\
& < \sum_{ k = 0 }^n \frac{ 1 }{ k ! } \\
& < 2 + \sum_{ k = 2 }^n \frac{ 1 }{ k ( k - 1 ) } \\
& = 2 + \sum_{ k = 2 }^n ( \frac{ 1 }{ k - 1 } - \frac{ 1 }{ k } ) < 3
\end{aligned}</script><p>接下来证明单调,只需证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sqrt[n + 1]{ ( 1 + \frac{ 1 }{ n } )^n } & < \frac{ n + 2 }{ n + 1 } \\
\sqrt[n + 1]{ 1 ( 1 + \frac{ 1 }{ n } )^n } & < \frac{ 1 + n ( 1 + \frac{ 1 }{ n } ) }{ n + 1 }
\end{aligned}</script><p>由均值不等式显然.</p>
<p>如果我们考虑另一个极限$y_n = ( 1 + \frac{ 1 }{ n } )^{ n + 1 }$,注意到:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ y_n } = ( \frac{ n }{ n + 1 } )^{ n + 1 } \times 1 < ( \frac{ n + 1 }{ n + 2 } )^{ n + 2 } = \frac{ 1 }{ y_{ n + 1 } }</script><p>发现$y_n$单调递减且$y_n &gt; x_n$,并且$\lim_{ n \rightarrow \infty } y_n - x_n = 0$,这就意味着二者必然同时趋向于一个常数的两侧,定义为$e = 2 . 7182818284 \cdots$.</p>
<p>这里还可以推出一些结论.因为我们知道:</p>
<script type="math/tex; mode=display">
\begin{aligned}
x_n & < e < y_n \\
n \ln ( 1 + \frac{ 1 }{ n } ) & < 1 < ( n + 1 ) \ln ( 1 + \frac{ 1 }{ n } ) \\
\frac{ 1 }{ n + 1 } & < \ln ( n + 1 ) - \ln ( n ) < \frac{ 1 }{ n } \\
H_{ n + 1 } - 1 & < \ln ( n + 1 ) < H_n
\end{aligned}</script><p>用这个可以注意到定义$z_n = H_n - \ln n$,这个东西肯定$\geq 0$且$\leq 1$,而且注意到$z_{ n + 1 } - z_n = \frac{ 1 }{ n + 1 } - \ln \frac{ n + 1 }{ n } &lt; 0$,所以单调有界,这个极限就是欧拉常数$\gamma = 0 . 57 \cdots$.</p>
<p>接下来证明$e$是无理数.</p>
<p>考虑$e = \lim_{ n \rightarrow \infty } ( 1 + \frac{ 1 }{ n } )^n$,取二项式定理,取$x_k = \sum_{ k = 0 }^n \frac{ n^{ \underline{ k } } }{ k ! n^k } \leq \sum_{ k = 0 }^n \frac{ 1 }{ k ! } = U_n$.</p>
<p>而又注意到$x_n = \sum_{ k = 0 }^n \frac{ n^{ \underline{ k } } }{ k ! n^k }$,取定一个确定的上界$m \leq n$,则$x_n \geq \sum_{ k = 0 }^m \frac{ n^{ \underline{ k } } }{ k ! n^k } = y_n$.由于$m$有限,所以当$n \rightarrow \infty$时,$y_n \rightarrow U_n$的前$m$项,此时再令$m \to \infty$,根据夹逼定理,立刻得到$x_n \rightarrow U_n$.换言之,$m$增大引起的误差总可以被后面的$n$的增大抹平.</p>
<p>考虑一下计算误差,设$r_n = e - U_n$,则$r_n = \sum_{ k \geq n + 1 } \frac{ 1 }{ k ! } = \frac{ 1 }{ ( n + 1 ) ! } \sum_{ k \geq 0 } \frac{ 1 }{ ( n + 2 )^{ \overline{ k } } } &lt; \frac{ 1 }{ ( n + 1 ) ! } \sum_{ k \geq 0 } \frac{ 1 }{ ( n + 2 )^k } = \frac{ 1 }{ ( n + 1 ) ! } \frac{ n + 2 }{ n + 1 } &lt; \frac{ 1 }{ n \times n ! }$.</p>
<p>如果$e$是有理数,设$e = \frac{ m }{ n } \in \mathbb{ Q }$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
0 & < r_n = \frac{ m }{ n } - U_n < \frac{ 1 }{ n \times n ! } \\
0 & < m \times ( n - 1 ) ! - U_n \times n ! < \frac{ 1 }{ n }
\end{aligned}</script><p>这立刻导出矛盾,因为$U_n \times n !$一定是整数.</p>
<h4><span id="开区间与闭区间">开区间与闭区间</span></h4><p>定义一个集合的内部点:$x , \exists \delta &gt; 0 , ( x - \delta , x + \delta ) \subseteq A$.我们将一个集合的所有内部点组成的集合记作$A^{ \degree }$.</p>
<p>这样就可以定义一个集合是内部为空的,就是其没有内部点.反之,如果每个点都是其内部点,那么称其为稠密的.</p>
<p>定义一个集合的边界点:$x , \forall \delta &gt; 0 , ( x - \delta , x + \delta ) \cap A \ne \emptyset , ( x - \delta , x + \delta ) \cap A^C \ne \emptyset$.</p>
<p>一个集合称为开集合,当且仅当$A = A^{ \degree }$.</p>
<p>一个集合称为闭集合,当且仅当对于集合中的任何一个数列,数列极限也存在于这个集合中.</p>
<p>当然也可以用补集来用开集合定义闭集合(补集是开集合的集合是闭集合)或者反之.</p>
<p>由此我们知道开集的并是开集,有限个开集的交是开集;闭集的交是闭集,有限个闭集的并是闭集.</p>
<p>容易发现包含于$A$的所有开集的并是$A^{ \degree }$.</p>
<p>我们类似定义$A$的闭包是$\bar{ A }$.</p>
<p>而且容易发现如果$f$是连续函数,那么如果$U$是开集,那么$f^{ - 1 } ( U )$(也就是$U$的原像)也是开集.</p>
<h4><span id="区间套定理">区间套定理</span></h4><p>设$I_n = [ a_n , b_n ] \ne \emptyset , I_{ n + 1 } \subseteq I_{ n }$,则$I = \bigcap_{ n \geq 1 } I_n$存在且是一个非空闭区间.</p>
<p>怎么证明?考虑$a_n$单增,$b_n$单减并且$a_1 \leq a_n \leq b_n \leq b_1$,所以$a_n$存在极限,不妨设为$l_a$,同理$b_n$也存在极限,设为$l_b$.容易验证$I = [ l_a , l_b ]$.</p>
<p>类似地,设$I_n = ( a_n , b_n ) \ne \emptyset , I_{ n + 1 } \subseteq I_{ n }$,并且$a_n , b_n$不会从某一项开始往后全都是常数(换言之其极限不等于其每一项,且不会上下波动),则$I = \bigcap_{ n \geq 1 } I_n$存在且是一个非空闭区间.</p>
<p>特别地,当$\lim | b_n - a_n | = 0$的时候,上述给出一个单点.</p>
<h6><span id="example1">Example1</span></h6><p>设$x_1 = a , x_2 = b , a \ne b , x_{ n + 2 } = \frac{ x_{ n + 1 } + x_n }{ 2 }$,问$\lim_{ n \rightarrow \infty } x_n$是否存在.</p>
<p>可以设$c_n = \min \{ x_n , x_{ n + 1 } \} , d_n = \max \{ x_n , x_{ n + 1 } \}$,讨论$x_{ n + 1 }$和$x_n$的大小关系(二者显然不相等)可以知道$[ c_n , d_n ]$满足区间套定理的条件,又注意到$| I_{ n + 1 } | = | x_{ n + 2 } - x_{ n + 1 } | = \frac{ 1 }{ 2 } | I_n |$,所以区间长度趋近于$0$,这样的话$\lim_{ n \rightarrow \infty } c_n = \lim_{ n \rightarrow \infty } x_n = \lim_{ n \rightarrow \infty } d_n$.</p>
<h6><span id="example2">Example2</span></h6><p>设$a_1 &gt; b_1 &gt; 0$,$a_{ n + 1 } = \frac{ a_n + b_n }{ 2 } , b_{ n + 1 } = \sqrt{ a_n b_n }$.求证$a_n , b_n$极限都存在且相等.</p>
<p>还是区间套定理,容易验证满足区间套定理的条件,那么要注意到$| I_{ n + 1 } | = \frac{ a_n + b_n }{ 2 } - \sqrt{ a_n b_n } &lt; \frac{ a_n + b_n }{ 2 } - b_n = \frac{ 1 }{ 2 } | I_n |$,所以$\lim_{ n \rightarrow \infty } | I_n | = 0$,这就证明了二者存在且相等.</p>
<p>其实先用单调有界数列有极限,再对着递推式两边求下极限就可以了.</p>
<h4><span id="有限覆盖定理">有限覆盖定理</span></h4><p>覆盖:$\Sigma :$由一些开区间组成的集合.若$M \subset \mathbb{ R }$,称$M$被$\Sigma$覆盖,当且仅当$M \subseteq \bigcup_{ \sigma \in \Sigma } \sigma$.</p>
<p>有限覆盖定理是说,如果$M = [ a , b ]$是一个有界闭区间,且$M$被$\Sigma$覆盖,则一定存在一个$\Sigma$的有限子集$\Sigma_1$,使得$M$能被$\Sigma_1$覆盖.</p>
<p>换言之,有界闭区间若能被开区间覆盖,则一定能被有限个开区间覆盖.</p>
<p>反证:如果$M$不能被有限覆盖,那么$[ a , \frac{ a + b }{ 2 } ]$和$[ \frac{ a + b }{ 2 } , b ]$至少有一个不能被有限覆盖(如果它俩都能那$[ a , b ]$肯定也能).不妨取出二者中任意一个不能被有限覆盖的区间,设为$[ a_1 , b_1 ]$,再进行上面的操作就可以得到$[ a_2 , b_2 ]$,以此类推,如此我们得到了一个满足区间套定理的区间序列而且均不能被有限覆盖,根据区间套定理,可以取出它们交集的那个元素$c$.由于$\{ c \} \in M$,所以$\exists \sigma \in \Sigma , c \in \sigma$.因为$\sigma$是开区间,所以$\exists \epsilon &gt; 0 , [ c - \epsilon , c + \epsilon ] \in \sigma$,而显然可以找到一个$N &gt; 0$,$\forall n \geq N$,$[ a_n , b_n ] \in [ c - \epsilon , c + \epsilon ]$,这就矛盾了.</p>
<h6><span id="example1">Example1</span></h6><p>证明:有界闭区间上的局部有界(对于每一个点,它都存在一个开区间邻域是有界的)函数是整体有界函数.</p>
<p>设定义域为$[ a , b ]$,考虑$\forall x_0 \in [ a , b ] , \exists \sigma &gt; 0$,$f$在$( x_0 - \sigma , x_0 + \sigma )$上有界,注意到设$I_{ x_0 } = ( x_0 - \sigma , x_0 + \sigma )$,那么$[ a , b ]$一定被$I$这个区间集合开覆盖,那么就能被有限开覆盖,取出那有限个区间对应的值域并起来就行.</p>
<h6><span id="example2">Example2</span></h6><p>证明:有界闭区间上的局部增(对于每一个点,它都存在一个开区间邻域是增的)函数是整体增函数.</p>
<p>证明和上面一样,合并两个开区间的时候找任意一个交集元素即可.</p>
<h4><span id="外测度与零测集">外测度与零测集</span></h4><p>定义<strong>外测度:</strong>对于$E \subseteq \mathbb{ R }$,定义$m^<em> ( E )$为$E$的外测度,$m^</em> ( E ) = \inf \{ ( \sum | I_k | ) \mid \bigcup I_k \supseteq E \}$,也就是找一列区间使得其并起来能包含$E$.</p>
<p>定义<strong>零测集</strong>:外测度为$0$的集合.容易发现$m^<em> ( \bigcup E_k ) \leq \sum m^</em> ( E_k )$.于是可数个零测集的并仍然是零测集.</p>
<p>如果一个集合的势可数,那它当然是零测集,原因是可以构造$I_n = ( x_n - \delta , x_n + \delta ) , \delta = \frac{ 1 }{ 2^{ n + 1 } }$.由这个构造$\epsilon_k = \frac{ \epsilon }{ 2^{ k + 1 } }$可以说明可数个零测集的并仍然是零测集.</p>
<p>反之,一个集合是零测集不一定代表其可数,例如康托三分集:先把$[ 0 , 1 )$上扣去$[ \frac{ 1 }{ 3 } , \frac{ 2 }{ 3 } )$,然后再对剩下的线段也做类似的操作,每次扣掉中间一段.算一下每次扣去的长度,发现长度恰好为$1$,于是当然是零测集.但注意到这对应着一个三进制小数并且每一位只能是$0 , 2$,那这当然势仍然是$2^\mathbb{ N }$,于是不可数.</p>
<h4><span id="vitali覆盖引理">Vitali覆盖引理</span></h4><p>当$E \subseteq R$,称一族区间$\Gamma = \{ I_\alpha \}$是$E$的一个Vitali覆盖,若对$\forall x \in E , \epsilon &gt; 0$,$\exists I_{ \alpha } \in \Gamma , | I_\alpha | &lt; \epsilon , x \in I_\alpha$.也就是对于任何一个点都存在足够小的区间把它盖住.</p>
<p>Vitali覆盖引理是说,如果$E$是一个有界集(或者推广到外测度有限的集合),$\Gamma$是$E$的一个Vitali覆盖,则$\forall \epsilon &gt; 0$,$\Gamma$中可以拿出有限个两两不交的区间$I_j \in \Gamma$,满足$m^* ( E \setminus ( \bigcup I_j ) ) &lt; \epsilon$.注意这里取区间的方式依赖于$\epsilon$的选取.</p>
<p>取一个开集$G \supseteq E , m^* ( G ) &lt; \infty$,不妨设$\Gamma$中的每个区间都$\subseteq G$(原因在于Vitali覆盖保证了任意小的区间覆盖,而开集的性质使得总有区间在其中).在此基础上,由于上面的$\Gamma$是任意一个Vitali覆盖,所以我们不妨假设$\Gamma$中的每个区间都是闭区间(也就是把端点加进去,那当然仍然是Vitali覆盖而且更难满足限制,因为闭区间更难以两两不交),这当然仍是可以的.</p>
<p>现在我们归纳取区间,我们任取一个$I_1 \in \Gamma$,开始不断往上添区间.设$I_1 , \cdots , I_k$已经被我们拿到,而且两两不交.</p>
<p>如果此时$E \subseteq \bigcup_{ j = 1 }^k I_j$,当然直接满足条件.</p>
<p>反之,令$\delta_k = \sup \{ ( | I | ) \mid I \in \Gamma , I \cap I_j = \emptyset , 1 \leq j \leq k \}$.容易发现$\delta_k &lt; \infty$.那我们取$I_{ k + 1 }$使得$\forall 1 \leq j \leq k , I_{ k + 1 } \cap I_j = \emptyset , | I_{ k + 1 } | &gt; \frac{ 1 }{ 2 } \delta_k$,这当然做得到.</p>
<p>如果一直做下去都没有使得$E \subseteq \bigcup I_j$,那我们就可以拿到一个区间列.接下来我们考虑$\sum | I_k |$,此时由于$I_k$两两不交,当然有$\sum | I_k | \leq m^* ( G ) &lt; \infty$,那么根据单调收敛准则,$\sum | I_k |$趋于一个极限,于是$| I_k |$当然趋近于$0$,那么$\delta_k$趋近于$0$.在此基础上,我们当然可以取一个$N &gt; 0$,$\forall n \geq N , \sum_{ k \geq n + 1 } | I_k | &lt; \frac{ 1 }{ 5 } \epsilon$.</p>
<p>此时$\forall x \in E \setminus ( \bigcup_{ k \leq N } I_k )$.由于$I_k$均为闭区间,所以$E \setminus ( \bigcup_{ k \leq N } I_k )$必定是开区间,这也就是说$x$存在一个小邻域$I ‘ \in \Gamma$并且$I ‘ \subseteq E \setminus ( \bigcup_{ k \leq N } I_k )$.那当然有$I ‘ \cap ( \bigcup_{ k \leq N } I_k ) = \emptyset$,也就是$I ‘ \cap I_k = \emptyset , 1 \leq k \leq N$.由于$| I ‘ |$有限且不为$0$,而$\delta_n \rightarrow 0$.一定$\exists n \geq N$,使得$I ‘ \cap ( \bigcup_{ k \leq n } I_k ) = \emptyset , I ‘ \cap I_{ n + 1 } \ne \emptyset$.发现此时$| I ‘ | \leq \delta_n &lt; 2 | I_{ n + 1 } |$.</p>
<p>此时会出个什么事呢?由于$| I ‘ | &lt; 2 | I_{ n + 1 } |$,所以我们把$I_{ n + 1 }$这个区间扩大五倍(中心不变,半径扩大到原本的五倍)就一定能盖住$I ‘$.</p>
<p>那会怎么样呢?那$m^* ( E \setminus ( \bigcup_{ k \leq N } I_k ) ) \leq 5 \sum_{ k \geq N + 1 } | I_k | &lt; \epsilon$.于是证毕.</p>
<h4><span id="聚点原理">聚点原理</span></h4><p>假设$M$是一个实数集,称$x_0$是$M$的聚点,当且仅当$\forall \epsilon &gt; 0$,$( ( x_0 - \epsilon , x_0 ) \cup ( x_0 , x_0 + \epsilon ) ) \cap M \ne \emptyset$,或说,$\forall \epsilon &gt; 0 , ( x_0 - \epsilon , x_0 + \epsilon ) \cap M$是一个无限集.可以理解为,$x_0$不是一个孤点.</p>
<p>引理:$x_0$为$M$的聚点,当且仅当$\exists \{ x_n \} \in M \setminus \{ x_0 \} , \lim_{ n \rightarrow \infty } x_n = x_0$.充分性显然,必要性的话只需取$\epsilon = 2^{ - n }$然后从上面的交集拿点就行.</p>
<p>聚点原理:有界无穷集$M$必有聚点.</p>
<p>我们可以找一个$I_0 = [ a , b ] , M \subset I_0$,我们找$[ a , \frac{ a + b }{ 2 } ] , [ \frac{ a + b }{ 2 } , b ]$,其中至少有一个和$M$的交集为无穷集,我们取其为$[ a_1 , b_1 ]$,不断这么做又会得到一个闭区间套列,交起来得到的那个元素$c$就是聚点,因为$\forall \epsilon &gt; 0 , \exists N &gt; 0 , \forall n \geq N , | b_n - a_n | &lt; \epsilon$,那么$[ a_n , b_n ] \subseteq ( c - \epsilon , c + \epsilon )$,立刻证毕.</p>
<h4><span id="baire纲定理">Baire纲定理</span></h4><ol>
<li><p>设$\{ F_n \}$是一列内部为空(没有除空集以外的开子集)的闭集,则$\bigcup_{ n = 1 }^{ \infty } F_n$内部为空.</p>
</li>
<li><p>设$\{ G_n \}$是一列稠密(补集内部为空)的开集,则$\bigcap_{ n = 1 }^{ \infty } G_n$稠密.</p>
</li>
</ol>
<p>(1)(2)等价,下面只证明(1):</p>
<p>反证,假设$F = \bigcup_{ n = 1 }^{ \infty } F_n$内部不为空,也就是其存在一个内部开集$( x_0 - \delta_0 , x_0 + \delta_0 ) \subseteq F$.由于$F_1$是一个闭集,因此$( x_0 - \delta_0 , x_0 + \delta_0 ) \setminus F_1$当然是一个开集,于是其就存在一个子区间$[ x_1 - \delta_1 , x_1 + \delta_1 ] \subseteq ( x_0 - \delta_0 , x_0 + \delta_0 )$并且$[ x_1 - \delta_1 , x_1 + \delta_1 ] \cap F_1 = \emptyset$,同理可以找到一列闭区间$\{ [ x_k - \delta_k , x_k + \delta_k ] \}$使得$[ x_k - \delta_k , x_k + \delta_k ] \cap \bigcup_{ j = 1 }^k F_j = \emptyset$.</p>
<p>容易见到我们可以任意调小$\delta_k$的大小,调整使得$\delta_k &lt; \frac{ 1 }{ k }$总成立就得到了一列闭区间套,必然拿到了一个单独的点$\xi$,那么$\xi \in ( x_0 - \delta_0 , x_0 + \delta_0 ) \subseteq F$,然而对于任意区间都有$\xi \notin F_n$,因此$\xi \notin F$,这就导出了矛盾.</p>
<h6><span id="example1">Example1</span></h6><p>证明:如果$f ( x )$连续,并且$\forall x &gt; 0 , \lim_{ n \rightarrow \infty } f ( nx ) = 0$,则$\lim_{ x \rightarrow \infty } f ( x ) = 0$.</p>
<p>对于一个$\epsilon &gt; 0$,考虑构造内部为空的闭集$F_n = \{ x | \forall k \geq n , f ( kx ) \leq \epsilon \}$(为什么这是闭集呢?因为当你设$F_{ n , k }$满足上述定义,那$F_{ n , k }$肯定是闭集,然后$F_n$就是上述这些的交,当然也是闭集).容易发现$F_n$的并是$\mathbb{ R }_+$,那就一定至少有一个闭集内部不为空,我们就可以取出其中的一个区间设为$( a , b )$,然后用这个区间在若干倍后覆盖后半部分数轴,原因是当$n$足够大的时候,一定有$nb &gt; ( n + 1 ) a$存在.</p>
<h4><span id="致密性定理">致密性定理</span></h4><p>有界无穷数列有收敛的子列.</p>
<p>考虑数列值域$M = \{ x | x = x_n , n \in \mathbb{ N }_+ \}$.</p>
<p>如果$M$是有限集合,那$\exists a$,$I = \{ n | x_n = a \}$是无限集合,把这些数拿出来就是一个无限的常数列.</p>
<p>如果$M$是无限集,那其存在聚点,设$a$为其中一个聚点.则$M_k = ( ( a - \frac{ 1 }{ k } , a + \frac{ 1 }{ k } ) \setminus \{ a \} ) \cap M , k \in \mathbb{ N }_+$是个无限集.</p>
<p>那只需要取$x_{ n_k }$为$M_k$中的某个$x_{ n ‘ }$满足$n ‘ &gt; n_{ k - 1 }$即可,由于这是无限集,所以显然可以取出.拿出来的这个数列显然以$a$为极限.</p>
<h4><span id="柯西收敛准则">柯西收敛准则</span></h4><p>称一个数列为柯西数列,当且仅当$\forall \epsilon &gt; 0 , \exists N &gt; 0 , \forall n , m \geq N , | x_n - x_m | &lt; \epsilon$.</p>
<p>一个数列收敛的充要条件是他是一个柯西数列.</p>
<p>先证必要性:</p>
<p>$\forall \epsilon &gt; 0 , \exists N &gt; 0 , \forall n , m \geq N , | a - x_n | &lt; \frac{ \epsilon }{ 2 } , | a - x_m | &lt; \frac{ \epsilon }{ 2 } , | x_n - x_m | \leq | x_n - a | + | a - x_m | &lt; \epsilon$.</p>
<p>再证充分性:</p>
<p>考虑取$\epsilon = 1$,则$\exists N_1 , \forall n \geq N_1 , | x_n - x_{ N_1 } | &lt; 1$,于是$| x_n | &lt; | x_{ N_1 } | + 1$,于是$\forall n , | x_n | &lt; \max_{ k = 1 }^{ N_1 } \{ | x_k | \} + 1$,于是这个数列有界,那么存在无穷子列有极限$a$.</p>
<p>那么$\forall \epsilon &gt; 0 , \exists N &gt; 0 , \forall n_k , m \geq N , | x_{ n_k } - x_m | &lt; \epsilon$,其中$\{ x_{ n_k } \}$以$a$为极限,于是可以取足够远的$x_{ n_k }$.接下来就是简单说明的环节了.</p>
<p>柯西收敛准则的充分性还可以用上下极限证明:</p>
<p>取$\forall \epsilon &gt; 0 , \exists N , \forall n \geq N , x_n \in ( x_N - \epsilon , x_N + \epsilon )$,那么上下极限之差$\leq 2 \epsilon$.</p>
<p>于是引出了实数的第二种定义方式:我们定义两个柯西列等价,有$\{ x_n \} \sim \{ y_n \} \Leftrightarrow \lim_{ n \rightarrow \infty } | x_n - y_n | = 0$.那么所有有理数组成的柯西列的等价类构成实数集合.不难证明这样定义出来的实数和戴德金分割等价.</p>
<p>这个定义方式只依赖于距离的定义.而且我们可以证明任何一次扩充后得到的空间一定是封闭的.用这个例子就是说你对于一个实数的柯西列,证明它一定收敛到一个实数.那么就可以把这个柯西列的每一个数(作为实数,实际上对应了一个柯西列)中抽出一个数来,然后证明这些数组成的新的柯西列与刚才那个柯西列等价,这样就证明了其封闭性.其实只要第$k$个数把其代表的任意一个柯西列中选第$k$个元素构造即可.</p>
<h4><span id="上下极限">上下极限</span></h4><p>我们推广广义极限,也就是一个数列可以以$+ \infty$或者$- \infty$为极限.这个容易用$\epsilon - N$语言写出来.这样的话我们立刻得到单调数列有极限.</p>
<p>那我们取任意一个数列从某一项往后的上确界$h_n = \sup_{ k \geq n } \{ x_k \}$和下确界$l_n = \inf_{ k \geq n } \{ x_k \}$,那么注意到$\{ l_n \}$单调不降,$\{ h_n \}$单调不增,所以二者都存在极限.由此可以定义上下极限,并且任意数列都一定存在上下极限.</p>
<p>注意到$\lim_{ n \rightarrow \infty } l_n = \sup_{ n \geq 1 } \inf_{ k \geq n } \{ x_k \} , \lim_{ n \rightarrow \infty } h_n = \inf_{ n \geq 1 } \sup_{ k \geq n } \{ x_k \}$,于是$\varliminf_{ n \rightarrow \infty } x_n = \lim_{ n \rightarrow \infty } l_n \leq \lim_{ n \rightarrow \infty } h_n = \varlimsup_{ n \rightarrow \infty } x_n$.</p>
<p>那么$x_n$存在极限当且仅当$\varlimsup_{ n \rightarrow \infty } x_n = \varliminf_{ n \rightarrow \infty } x_n$.</p>
<p>充分性很好证明,只需要使用夹逼定理即可.</p>
<p>必要性也很好说如果极限不是$\infty$,$\forall \epsilon &gt; 0 , \exists N , \forall n \geq N , a - \epsilon &lt; x_n &lt; a + \epsilon$,那么$a - \epsilon &lt; l_n \leq h_n &lt; a + \epsilon$.自然得到两者极限相等.是$\infty$也很好说.</p>
<p>上下极限同样有保序性,相反数有$\varlimsup ( - x ) = - \varliminf x$,但是不能简单的四则运算,而是有$\varliminf x_n + \varliminf y_n \leq \varliminf ( x_n + y_n ) \leq \varlimsup ( x_n + y_n ) \leq \varlimsup x_n + \varlimsup y_n$,我们这里先不讨论出现$\infty - \infty$的情况.</p>
<p>证明的话只需注意到$\inf_{ k \geq n } x_k + \inf_{ k \geq n } y_k \leq x_m + y_m , \forall m \geq n$,因此对右边可以取下确界,然后两边一起取极限即可.</p>
<p>另外还有结论是$\varliminf ( x_n + y_n ) \leq \varlimsup x_n + \varliminf y_n$.这个又如何证明呢?只需证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\varliminf ( x_n + y_n ) - \varlimsup x_n & \leq \varliminf y_n \\
\varliminf ( x_n + y_n ) + \varliminf ( - x_n ) & \leq \varliminf y_n \\

\end{aligned}</script><p>于是证毕.</p>
<p>乘法的话需要规定$x_n , y_n &gt; 0$,然后和加法的不等式形式是类似的(同样先不考虑$0 \times \infty$的情况).</p>
<p>如果$\{ x_n \} , \{ y_n \}$其中一个存在极限,那么上面的不等式就可以取等了(当然仍然不讨论出现$\infty - \infty$和$0 \times \infty$的情况).如果$x_n = y_n &gt; 0$的话上面的乘法不等式也可以取等,换言之$x_n &gt; 0$的时候$\varlimsup x_n^2 = ( \varlimsup x_n )^2$成立.</p>
<h6><span id="example1">Example1</span></h6><p>对于数列$\{ a_n \}$,满足$a_n &gt; 0$,$a_{ n + 2 } = \frac{ 2 }{ a_{ n + 1 } + a_n }$.</p>
<p>求证:</p>
<ol>
<li><p>$\{ a_n \}$有界.</p>
</li>
<li><p>$\lim_{ n \rightarrow \infty } a_n = 1$.</p>
</li>
<li><p>$\exists \lambda \in ( 0 , 1 ) , c &gt; 0$,$\forall n , | a_n - 1 | &lt; c \lambda^n$.</p>
</li>
<li><p>对所有满足条件的数列,求$\min ( \lambda ) = \frac{ \sqrt{ 2 } }{ 2 }$.</p>
</li>
</ol>
<p>对于(1),取$M = \max ( \max ( a_1 , a_2 ) , \frac{ 1 }{ \min ( a_1 , a_2 ) } )$,数学归纳可证明$a_n \in [ \frac{ 1 }{ M } , M ]$.</p>
<p>两边取一下上极限和下极限,立刻得到$1 \leq \overline{ a } \underline{ a } \leq 1$,于是$\overline{ a } \underline{ a } = 1$.</p>
<p>后面不会了(乐).</p>
<h4><span id="stolz定理">Stolz定理</span></h4><p>如果$\lim_{ n \rightarrow \infty } \frac{ a_{ n + 1 } - a_n }{ b_{ n + 1 } - b_n } = A$,并且$\{ b_n \}$单调递增且发散,那么$\lim_{ n \rightarrow \infty } \frac{ a_n }{ b_n } = A$.</p>
<p>这个怎么证明呢?先取$c_n = a_n - Ab_n$,考虑$\forall \epsilon &gt; 0 , \exists N &gt; 0 , \forall n \geq N$,有:</p>
<script type="math/tex; mode=display">
c_{ n + 1 } - c_n \leq | c_{ n + 1 } - c_n | < \epsilon ( b_{ n + 1 } - b_n )</script><p>两边求和,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_{ n } - c_N & < \epsilon ( b_{ n } - b_N ) \\
\frac{ c_n - c_N }{ b_n - b_N } & < \epsilon \\
\frac{ \frac{ c_n }{ b_n } - \frac{ c_N }{ b_n } }{ 1 - \frac{ b_N }{ b_n } } & < \epsilon
\end{aligned}</script><p>由于$b_n$发散,对左边取极限就得到$\lim_{ n \rightarrow \infty } \frac{ c_n }{ b_n } = 0$,也就证明了原结论.</p>
<p>如果将上述条件改为:</p>
<ol>
<li><p>$\{ b_n \}$单调递减且$\lim b_n = 0$.</p>
</li>
<li><p>$\lim a_n = 0$.</p>
</li>
</ol>
<p>上述定理也是成立的.</p>
<p>证明仍然是上面那个过程,只是做一些小修改:</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_{ N } - c_n & < \epsilon ( b_{ N } - b_n ) \\
\frac{ c_N - c_n }{ b_N - b_n } & < \epsilon \\
\frac{ \frac{ c_N }{ b_N } - \frac{ c_n }{ b_N } }{ 1 - \frac{ b_n }{ b_N } } & < \epsilon
\end{aligned}</script><p>两边取极限.</p>
<p>把Stolz定理推广到上下极限上.换言之,当:</p>
<ol>
<li>$\{ b_n \}$单调上升且趋近于无穷.</li>
</ol>
<p>或:</p>
<ol>
<li><p>$\{ b_n \}$单调递减且$\lim b_n = 0$.</p>
</li>
<li><p>$\lim a_n = 0$.</p>
</li>
</ol>
<p>此时应当有:</p>
<script type="math/tex; mode=display">
\varliminf \frac{ a_{ n + 1 } - a_n }{ b_{ n + 1 } - b_n } \leq \varliminf \frac{ a_n }{ b_n } \leq \varlimsup \frac{ a_n }{ b_n } \leq \varlimsup \frac{ a_{ n + 1 } - a_n }{ b_{ n + 1 } - b_n }</script><p>上述命题的一个平凡推论是:</p>
<script type="math/tex; mode=display">
\varliminf ( a_{ n + 1 } - a_n ) \leq \varliminf \frac{ a_n }{ n } \leq \varlimsup \frac{ a_n }{ n } \leq \varlimsup ( a_{ n + 1 } - a_n )</script><h3><span id="实数的完备性基本定理">实数的完备性基本定理</span></h3><p>我们将以下定理称作实数的完备性的基本定理:</p>
<ol>
<li><p>戴德金分割定理</p>
</li>
<li><p>确界存在定理</p>
</li>
<li><p>单调收敛准则</p>
</li>
<li><p>闭区间套定理(+阿基米德性质)</p>
</li>
<li><p>有限覆盖定理</p>
</li>
<li><p>聚点原理</p>
</li>
<li><p>致密性定理</p>
</li>
<li><p>柯西收敛准则(+阿基米德性质)</p>
</li>
</ol>
<p>这七条定理(除了3和7,它们需要与阿基米德性质配合使用)全部与戴德金分割定理等价.</p>
<p>我们上面已经论证了其中的部分推导关系,我们在下面声称它们分为若干组推导链条,分别代表了实数的不同性质.</p>
<h3><span id="函数极限">函数极限</span></h3><h4><span id="定义">定义</span></h4><p>函数的极限类型比较多:</p>
<ol>
<li><p>$x$是从一点$a$的右侧趋向于$a$,这时记作$x \rightarrow a + 0$.</p>
</li>
<li><p>$x$是从一点$a$的左侧趋向于$a$,这时记作$x \rightarrow a - 0$.</p>
</li>
<li><p>$x$同时从一点$a$的两侧趋向于$a$,这时记作$x \rightarrow a$.</p>
</li>
<li><p>$x$无限制增大,记作$x \rightarrow + \infty$.</p>
</li>
<li><p>$x$无限制减小,记作$x \rightarrow - \infty$.</p>
</li>
<li><p>$| x |$无限制增大,$x$同时增大或减小,记作$x \rightarrow \infty$.</p>
</li>
</ol>
<p>序列极限的定理在函数极限的条件下几乎也全都成立.</p>
<h5><span id="单侧极限">单侧极限</span></h5><p>即$x \rightarrow a + 0$和$x \rightarrow a - 0$,这两种是对称的,我们只讨论前一种.</p>
<p>若$\exists l , \forall \epsilon &gt; 0 , \exists \delta &gt; 0 , \forall 0 &lt; x - a &lt; \delta , | f ( x ) - l | &lt; \epsilon$.我们称$l$是$x \rightarrow a + 0$时$f ( x )$的<strong>右极限</strong>,记作$\lim_{ x \rightarrow a + 0 } f ( x ) = l \\$,同理可以定义<strong>左极限</strong>.</p>
<h5><span id="双侧极限">双侧极限</span></h5><p>若左右极限都存在且相等,那么双侧极限也存在并且$\lim_{ x \rightarrow a } f ( x ) = \lim_{ x \rightarrow a + 0 } f ( x ) = \lim_{ x \rightarrow a - 0 } f ( x ) \\$.</p>
<h5><span id="自变量趋于无穷时的极限">自变量趋于无穷时的极限</span></h5><p>设函数$f ( x )$在$( a , + \infty )$上有定义,若$\exists l$,$\forall \epsilon , \exists A \geq a , \forall x &gt; A , | f ( x ) - l | &lt; \epsilon$,则记$\lim_{ x \rightarrow + \infty } f ( x ) = l \\$,同理定义$\lim_{ x \rightarrow - \infty }$,若二者均存在且相等,定义$\lim_{ x \rightarrow \infty } = \lim_{ x \rightarrow + \infty } = \lim_{ x \rightarrow - \infty }$.</p>
<h4><span id="上下极限">上下极限</span></h4><p>定义去心邻域$U_0 ( x_0 , \delta ) = ( x_0 - \delta , x_0 + \delta ) \setminus \{ x_0 \}$.</p>
<p>定义$\varlimsup_{ x \rightarrow x_0 } f ( x ) = \lim_{ \delta \rightarrow + 0 } \sup_{ x \in U_0 ( x_0 , \delta ) } f ( x )$,下极限同理.</p>
<p>显然$\lim_{ x \rightarrow x_0 } f ( x ) = A \Leftrightarrow \varlimsup_{ x \rightarrow x_0 } f ( x ) = \varliminf_{ x \rightarrow x_0 } f ( x ) = A$.</p>
<h4><span id="第一可数公理">第一可数公理</span></h4><p>函数极限当然满足四则运算法则,保序性,夹逼定理,单调收敛准则,柯西收敛准则.</p>
<p>事实上函数极限和数列极限满足关系:</p>
<p>$\forall \{ x_n \} \in U_0 ( x_0 )$,如果$\lim_{ n \rightarrow \infty } x_n = x_0$,那么$\lim_{ n \rightarrow \infty } f ( x_n ) = \lim_{ x \rightarrow x_0 } f ( x )$,前提是这两个极限都存在.</p>
<p>证明是堆$\delta - \epsilon$语言,不再赘述.</p>
<p>而它们之间关系的本质其实是:$x_0$处的”任意小邻域”其实可以用某列邻域替代.</p>
<p>我们定义邻域基:一个由$x_0$的邻域组成的集合$U$,如果对于任意小邻域,$U$中都存在一个邻域比这个邻域更小,那么就称$U$是一个邻域基.$\mathbb{ R }$的特殊之处在于任意一个点都有可数邻域基,这被称为第一可数公理($C_1$公理).</p>
<p>另外$\mathbb{ R }$是可分的,也就是它存在可数稠密集($\mathbb{ Q }$).</p>
<h4><span id="无穷大量和无穷小量">无穷大量和无穷小量</span></h4><p>如果$x \rightarrow x_0$时,$f ( x )$有界,称$f ( x ) = O ( 1 )$.</p>
<p>如果$x \rightarrow x_0$的时候,$f ( x ) \rightarrow 0$,称$f ( x ) = o ( 1 )$.</p>
<p>如果$f , g = o ( 1 )$,$\frac{ f }{ g } \rightarrow 1$,那么称二者为<strong>等价无穷小</strong>;如果$\frac{ f }{ g } = c \ne 0$,则称二者为同阶无穷小(可记作$f \sim g$);如果$\frac{ f }{ g } = 0$,则称$f$为$g$的<strong>高阶无穷小</strong>,可记作$f = o ( g )$.</p>
<p>同阶无穷小在做乘除法的时候是可以替换的.</p>
<p>如果$\frac{ f }{ g }$是有界的,那么可以写作$f = O ( g )$.</p>
<h6><span id="example1">Example1</span></h6><p>$\lim_{ x \rightarrow 0 } \frac{ \sin x }{ x } = 1$.</p>
<p>因为其左右对称,考虑取$x \in ( 0 , \frac{ \pi }{ 2 } )$我们有$\sin x &lt; x &lt; \tan x$(用单位元的面积证明).</p>
<p>那么考虑$\frac{ \sin x }{ x } &lt; 1$,又注意到:</p>
<script type="math/tex; mode=display">
\frac{ \sin x }{ x } > \frac{ \sin x }{ \tan x } = \cos x</script><p>夹逼定理一下就行.</p>
<p>类似可以证明$\lim_{ x \rightarrow 0 } \frac{ \tan x }{ x } = 1 , \lim_{ x \rightarrow 0 } \frac{ 1 - \cos x }{ x^2 } = \frac{ 1 }{ 2 } ,$</p>
<h6><span id="example2">Example2</span></h6><p>$\lim_{ x \rightarrow 0 } \frac{ x - \sin x }{ x^3 } = \frac{ 1 }{ 6 }$.</p>
<p>下面有个三次方,考虑套用一下三倍角公式,我们知道:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & = \frac{ x - \sin x }{ x^3 } = \frac{ x - ( 3 \sin \frac{ x }{ 3 } - 4 \sin^3 \frac{ x }{ 3 } ) }{ x^3 } \\
& = \frac{ 3 ( \frac{ x }{ 3 } - \sin \frac{ x }{ 3 } ) + 4 \sin^3 \frac{ x }{ 3 } }{ ( \frac{ x }{ 3 } )^3 } \frac{ 1 }{ 27 } \\
& = \frac{ 1 }{ 9 } f ( \frac{ x }{ 3 } ) + \frac{ 4 }{ 27 } ( \frac{ \sin \frac{ x }{ 3 } }{ \frac{ x }{ 3 } } )^3
\end{aligned}</script><p>看上去两边取上下极限就做完了对吧!但是还差一点,因为我们要证明上下极限都不是无穷,起码得说明它有界.</p>
<p>注意到$\frac{ x - \sin x }{ x^3 } &lt; \frac{ \tan x - \sin x }{ x^3 } = \frac{ \sin x }{ x } ( \frac{ 1 - \cos x }{ x^2 \cos x } ) = \frac{ \sin x }{ x } ( \frac{ 2 \sin^2 \frac{ x }{ 2 } }{ x^2 \cos x } )$,这样两边限定一下范围再取上极限可以说明原式上极限有界.</p>
<h6><span id="example3">Example3</span></h6><p>求$\lim_{ x \rightarrow 0 } \frac{ \sin x - \tan x }{ x^3 }$.</p>
<p>考虑$\frac{ \sin x - \tan x }{ x^3 } = \frac{ \sin x }{ x } \frac{ 1 }{ x^2 } \frac{ \cos x - 1 }{ \cos x } = \frac{ \tan x }{ x } \frac{ \cos x - 1 }{ x^2 } = - \frac{ 1 }{ 2 }$.</p>
<h6><span id="example4">Example4</span></h6><p>$\lim_{ t \rightarrow 0 } \frac{ \log_{ a } ( 1 + t ) }{ t } = \frac{ 1 }{ \ln a }$.</p>
<script type="math/tex; mode=display">
\lim_{ t \rightarrow 0 } \frac{ \log_{ a } ( 1 + t ) }{ t } = \log_a \lim_{ t \rightarrow 0 } ( 1 + t )^{ \frac{ 1 }{ t } } = \log_a e = \frac{ 1 }{ \ln a }</script><h6><span id="example5">Example5</span></h6><p>$\lim_{ t \rightarrow 0 } \frac{ a^t - 1 }{ t } = \ln a$.</p>
<p>令$s = a^t - 1$,则原式等于$\lim_{ s \rightarrow 0 } \frac{ s }{ \log_a ( s + 1 ) } = \ln a$.</p>
<h6><span id="example6">Example6</span></h6><p>$\lim_{ t \rightarrow 0 } \frac{ ( 1 + t )^\mu - 1 }{ t } = \mu$.</p>
<p>令$s = ( 1 + t )^\mu - 1$,那么原式等于$\lim_{ t \rightarrow 0 , s \rightarrow 0 } \mu \frac{ s }{ \ln ( 1 + s ) } \frac{ \ln ( 1 + t ) }{ t } = \mu$.</p>
<h4><span id="连续函数">连续函数</span></h4><p>不妨设$f ( x )$在$( a , b )$上有定义,若对于$x_0 \in ( a , b )$,$f ( x )$在$x_0$处有双侧极限且$\lim_{ x \rightarrow x_0 } f ( x ) = f ( x_0 )$,称其在$x_0$处<strong>连续</strong>,$x_0$称为<strong>连续点</strong>,若$\forall x_0 \in ( a , b )$,$f ( x )$在$x_0$处连续,则称其在$( a , b )$上<strong>连续</strong>.连续性相当于说:取极限和$f$可以交换顺序,换言之$\lim_{ x \rightarrow x_0 } f ( x ) = f ( \lim_{ x \rightarrow x_0 } x )$.</p>
<p>我们也可以类似上面定义<strong>左连续</strong>和<strong>右连续</strong>,若$f ( x )$在$[ a , b ]$上有定义,且在$( a , b )$上连续,在$a$处右连续,在$b$处左连续,称其在$[ a , b ]$上连续.</p>
<p>如果$f ( x )$在$x_0$附近有定义且不连续,则称$x_0$是一个<strong>间断点</strong>,间断点有以下几种:</p>
<ol>
<li><p>如果$\lim_{ x \rightarrow x_0 + 0 } f ( x )$和$\lim_{ x \rightarrow x_0 - 0 } f ( x )$都存在但不相等或者不等于$f ( x_0 )$,则称为<strong>第一类间断点</strong>.如果是后者情况,可以通过修改$f ( x_0 )$的定义来去掉这个间断点,因而一般被称为<strong>可去间断点</strong>.</p>
</li>
<li><p>反之,如果$\lim_{ x \rightarrow x_0 + 0 } f ( x )$和$\lim_{ x \rightarrow x_0 - 0 } f ( x )$至少有一个不存在,则称为<strong>第二类间断点</strong>.</p>
</li>
</ol>
<p>使用单调收敛准则,可证明单调函数没有第二类间断点.并且单调函数的间断点只有可数个(几乎处处连续).</p>
<p>这个怎么证明呢?考虑设$M$是函数$f$的第一类间断点集,取$x \in M , I_x = ( f ( x_0 - 0 ) , f ( x_0 + 0 ) )$,由于函数单调,所以这些$I_x$两两不交.考虑映射$M \rightarrow \mathbb{ Q } , x \mapsto \min ( I_x \cap \mathbb{ Q } )$,也就是考虑每一个$I_x$中都有若干个有理数,且互不相交,那么显然这个映射是个单射,$M$可数.</p>
<p>事实上有更强的结论:任意函数的第一类间断点集都是可数的.</p>
<p>设$M$是函数$f$的第一类间断点集,取$M_n = \{ x \in M \mid | f ( x + 0 ) - f ( x - 0 ) | &gt; \frac{ 1 }{ n } \} , M ‘ = \{ x \in M | f ( x + 0 ) = f ( x - 0 ) \ne f ( x ) \}$.</p>
<p>注意到$M = ( \bigcup_{ n \geq 1 } M_n ) \cup M ‘$.</p>
<p>我们定义孤立点:如果$x \in A , \exists \sigma , ( x - \sigma , x + \sigma ) \nsubseteq A$,则称$x$是$A$中的一个孤立点.类似刚才证明可数性,我们每个孤立点都可以取一段邻域,领域中一定存在有理数,所以任意一个集合中的孤立点个数一定是可数的.</p>
<p>又发现所有的$x \in M_n$,$x$都是孤立点,原因很显然因为在$x$的两侧小区间都在趋近于一个极限,所以它们肯定不是第一类间断点.所以所有的$M_n$都是可数集.</p>
<p>那怎么证明$M ‘$是可数集呢?考虑取$M ‘_n = \{ x \in M | | f ( x ) - f ( x - 0 ) | &gt; \frac{ 1 }{ n } \}$,现在$M ‘ = \bigcup_{ n \geq 1 } M ‘_n$,而$M ‘_n$一定是孤立点集,所以$M ‘$可数.</p>
<p>综上就可以看出$M$是一个可数集.</p>
<p>而第二类间断点则是可以有任意多个,例如对于迪利克雷函数,其处处都是第二类间断点.</p>
<p>由于连续性由极限定义,这意味着在$( a , b )$上的连续函数的有定义的四则运算必定得到的还是在$( a , b )$上的连续函数.那么,如果我们对于一个区间$I$,定义$C ( I )$为所有在$I$上连续的函数组成的集合,$C ( I )$就是一个线性空间.且不难发现,连续函数的复合仍然是连续函数.这其实对应着$\lim_{ x \rightarrow a } g ( f ( x ) ) = g ( \lim_{ x \rightarrow a } f ( x ) ) = g ( f ( a ) ) \\$.</p>
<p>另外,如果一个连续函数有单值反函数,则反函数必连续.</p>
<p>不难证明,所有的初等函数在定义域上都是连续的.</p>
<p>另外:连续周期非常值函数一定有最小正周期.</p>
<p>考虑设正周期的集合是$\{ t \}$,取$T = \inf \{ t \}$.</p>
<p>当$T = 0$的时候,取一个正周期的数列$\{ t_n \} \rightarrow 0$,然后$\forall x &lt; y , x_n = x + \lfloor \frac{ y - x }{ t_n } \rfloor t_n , | y - x_n | \leq t_n \rightarrow 0$,于是$\lim_{ n } f ( x_n ) = f ( y )$,而恒有$f ( x ) = f ( x_n )$于是这是一个常值函数.</p>
<p>反之,则取$\{ t_n \} \rightarrow T , f ( x + T ) = \lim_{ n } f ( x + t_n ) = f ( x )$.</p>
<h5><span id="一致连续">一致连续</span></h5><p>假设$f : I \rightarrow \mathbb{ R }$,若$\forall \epsilon &gt; 0 , \exists \delta &gt; 0 , \forall x_1 , x_2 \in I , | x_1 - x_2 | &lt; \delta , | f ( x_1 ) - f ( x_2 ) | &lt; \epsilon$,则称其<strong>一致连续</strong>.一致连续性是一个比连续性强得多的性质,例如$f ( x ) = x^2$就不是一致连续的.</p>
<h5><span id="李氏连续">李氏连续</span></h5><p>假设$f : I \rightarrow \mathbb{ R }$,若$\exists L , \forall x_1 , x_2 \in I , | f ( x_1 ) - f ( x_2 ) | \leq L | x_1 - x_2 |$,则称其<strong>李氏连续</strong>.李氏连续当然强于一致连续.</p>
<h4><span id="闭区间下的连续函数">闭区间下的连续函数</span></h4><h5><span id="介值定理零点存在定理">介值定理(零点存在定理)</span></h5><p>设$f ( x )$在$[ a , b ]$上有定义且连续,$f ( a ) \ne f ( b )$,则$\forall \eta \in ( f ( a ) , f ( b ) ) , \exists c \in ( a , b ) , f ( c ) = \eta$.这当然等价于$f ( a ) f ( b ) &lt; 0 \Rightarrow \exists c \in ( a , b ) , f ( c ) = 0$.</p>
<p>考虑取$f ( \frac{ a + b }{ 2 } )$,如果$f ( \frac{ a + b }{ 2 } ) = 0$那就完事了.不然的话考虑$f ( a ) f ( \frac{ a + b }{ 2 } )$和$f ( \frac{ a + b }{ 2 } ) f ( b )$中必定有恰好一个小于$0$,这当然给出一个闭区间套,不妨设最后套出了一个单点$c$.此时取极限立刻有$0 \geq \lim f ( a_n ) f ( b_n ) = f ( c )^2$,于是$f ( c ) = 0$.</p>
<p>也有一个存在性证明:反证,如果$\forall x \in [ a , b ]$,$f ( x ) \ne 0$.那么$\forall x \in [ a , b ] , \exists \delta ( x ) &gt; 0$,$f$在$( x - \delta ( x ) , x + \delta ( x ) )$与$f ( x )$同号.根据有限覆盖定理,我们可以拿出有限个开区间来覆盖整个区间.此时可以将这些开区间排序,相邻两个区间两两有交,自然导出矛盾.</p>
<p>介质定理还有两个推论:</p>
<ol>
<li><p><strong>介值定理的推论1</strong>:设$f ( x )$在$[ a , b ]$上有定义且连续,那么$[ f ( a ) , f ( b ) ] \subseteq$其值域.</p>
</li>
<li><p><strong>介值定理的推论2</strong>:单调连续函数的反函数仍然是单调连续函数.</p>
</li>
</ol>
<p>推论(1)显然,考虑推论(2)的证明:</p>
<p>考虑对于连续单增函数$f ( x ) \in C ( a , b ) , \alpha = f ( a + 0 ) , \beta = f ( b - 0 )$.先要证明其存在反函数$\varphi \in C ( \alpha , \beta )$.</p>
<p>这里有一点小问题是我们要用介值定理要把定义域控制在闭区间,但这当然是好做的,对于任何一个$c \in ( a , b )$,你一定可以取一个$a_1 , b_1$使得$f ( a_1 ) &lt; f ( c ) &lt; f ( b_1 )$,这样$f ( x ) \in C [ a_1 , b_1 ]$.</p>
<p>这样的话容易说明$f$是$( a , b ) \rightarrow ( \alpha , \beta )$的双射,于是反函数是存在的.反函数的单调性是好证的.</p>
<p>对于反函数的连续性,反证,假设其在某一点$c \in ( \alpha , \beta )$处不连续,必然意味着$a &lt; \varphi ( c - 0 ) &lt; \varphi ( c + 0 ) &lt; b$.此时容易说明$\varphi ( x ) \in ( a , b ) \setminus ( \varphi ( c - 0 ) , \varphi ( c + 0 ) ) \cup \{ \varphi ( c ) \}$,那只需要取$w \in ( \varphi ( c - 0 ) , \varphi ( c + 0 ) ) \setminus \{ \varphi ( c ) \}$,$\nexists x , \varphi ( x ) = w$,这当然与我们上述结论不符.</p>
<h6><span id="example1">Example1</span></h6><p>对于连续函数$f \in C [ a , b ] , \forall x_0 \in [ a , b ] \setminus \mathbb{ Q } , \varlimsup_{ \Delta x \rightarrow 0 + 0 } \frac{ f ( x_0 + \Delta x ) - f ( x_0 ) }{ \Delta x } \geq 0$,求证:$f$单调递增.</p>
<p>先考虑把条件改成$\forall x_0 \in [ a , b ]$怎么做.</p>
<p>一个想法是反证,如果不单调的话,找一个点使得它的右上导数小于$0$.最自然的想法是找最大值,但最大值有可能只能证明右上导数$\leq 0$.所以有一个想法是拿一条稍微斜一点(也就是斜率为较小的负数)的直线去截整个曲线.</p>
<p>下面反证,如果其不单增,总能找到两个点$a ‘ &lt; b ‘$,使得$f ( a ‘ ) &gt; f ( b ‘ )$.此时任意取一个$\epsilon_0 &lt; f ( a ‘ ) - f ( b ‘ )$,然后取一个点$B = ( b ‘ , f ( b ‘ ) + \epsilon_0 )$.当然可以再取一个$\epsilon &gt; 0$使得$\epsilon + \epsilon_0 &lt; f ( a ‘ ) - f ( b ‘ )$,然后取一个点$A = ( a ‘ , f ( b ‘ ) + \epsilon_0 + \epsilon )$,这样$AB$这条直线确定了一条斜率$k &lt; 0$的一次函数$g ( x )$,不妨设$h ( x ) = f ( x ) - g ( x )$,容易发现$h ( a ‘ ) &gt; 0 , h ( b ‘ ) &lt; 0$,所以可以取一个变号零点$x_\epsilon = \sup \{ x | h ( x ) \geq 0 , x \in [ a ‘ , b ‘ ] \}$.当$\epsilon$取值不一样的时候当然可以取不同的而且是不可数个$x_\epsilon$,此时可以取出一个无理数$x_0$,那考虑$\varlimsup_{ \Delta x \rightarrow 0 + 0 } \frac{ f ( x_0 + \Delta x ) - f ( x_0 ) }{ \Delta x } = \varlimsup_{ \Delta x \rightarrow 0 + 0 } \frac{ h ( x_0 + \Delta x ) }{ \Delta x } + k \leq k &lt; 0$,这就矛盾了.</p>
<h5><span id="有界定理">有界定理</span></h5><p>设$f ( x )$在$[ a , b ]$上有定义且连续,$\exists A , B$,$\forall x_0 \in [ a , b ] , A \leq f ( x_0 ) \leq B$.</p>
<p>可以用之前的有限覆盖定理所证明的闭区间上的局部有界函数是有界函数,然后还有另一个证明:</p>
<p>假设无界,则存在一个数列$\{ x_n \}$使得$| f ( x_n ) | \rightarrow + \infty$.由于$\{ x_n \}$是有界数列,其一定有收敛子列$\{ x ‘_n \}$收敛于$x ‘$,当然$| f ( x ‘ ) | = \lim_{ n \rightarrow \infty } | f ( x_n ) | = + \infty$,这当然产生了矛盾.</p>
<p>还有一个闭区间套的证明方式:你考虑每次区间分两半,一定有其中一半是无界的,然后做闭区间套.</p>
<h5><span id="最值定理">最值定理</span></h5><p>设$f ( x )$在$[ a , b ]$上有定义且连续,$\exists x_1 , x_2 \in [ a , b ]$,$\forall x_0 \in [ a , b ] , f ( x_1 ) \leq f ( x_0 ) \leq f ( x_2 )$.</p>
<p>考虑先用有界定理得知$f ( x ) \in C [ a , b ]$有界,然后就可以拿到其上下确界$m \leq f ( x ) \leq M$,只需证明其上下确界均能取到就行.</p>
<p>反证,考虑若$M$取不到,那考虑定义$g ( x ) = \frac{ 1 }{ M - f ( x ) } &gt; 0$,根据有界定理$g ( x )$有上界$C$,于是$\frac{ 1 }{ M - f ( x ) } \leq C \Rightarrow f ( x ) \leq M - \frac{ 1 }{ C }$,矛盾.</p>
<p>或者我们知道$M$是上确界则$M - \frac{ 1 }{ n }$不是上界,取出$\{ x_n \}$使得$M - \frac{ 1 }{ n } &lt; f ( x_n ) \leq M$,那么$\{ x_n \}$必然有收敛子列,设其收敛于$x_0$,那么根据夹逼定理必然能得到$f ( x_0 ) = M$.</p>
<h5><span id="康托尔定理">康托尔定理</span></h5><p>有界闭区间上的连续函数必然一致连续.</p>
<p>考虑反证,反命题是$\exists \epsilon_0 &gt; 0 , \forall n &gt; 0 , \exists x ‘_n , x ‘ ‘_n , | x ‘_n - x ‘ ‘_n | &lt; \frac{ 1 }{ n } , | f ( x ‘_n ) - f ( x ‘ ‘_n ) | \geq \epsilon_0$.</p>
<p>用致密性定理,取出$\{ x ‘_n \}$的收敛子列,可以拿到$\{ x ‘ ‘_n \}$与其对应的数列,二者必然同时收敛于一个值$x_0$,那么$| f ( x ‘_n ) - f ( x ‘ ‘_n ) | = 0 \geq \epsilon_0$,当然矛盾.</p>
<p>如果是开区间呢?如果$f ( x ) \in C ( a , b ]$,其在开区间$( a , b ]$上一致连续,这需要等价于$\forall x_n \in ( a , b ) , x_n \rightarrow a$,$\{ f ( x_n ) \}$是柯西列(也就是$f ( a + 0 )$极限存在),由此看出开区间上的一致连续函数必然能延拓称闭区间上的连续函数.</p>
<h4><span id="不动点和周期点">不动点和周期点</span></h4><p>定义$f ( x )$的<strong>不动点</strong>$\text{ fix } f ( x ) \Leftrightarrow f ( x ) = x$,<strong>周期点</strong>$P_n = \{ x | f^{ [ n ] } ( x ) = x \land \forall 0 &lt; m &lt; n , f^{ [ m ] } ( x ) \ne x \}$,其中$f^{ [ n ] } ( x )$表示将$f$复合$n$次.</p>
<h5><span id="压缩映照原理">压缩映照原理</span></h5><p>设$f ( x )$在$[ a , b ]$上有定义并且$f ( [ a , b ] ) \subseteq [ a , b ]$,并且满足$\exists 0 \leq q &lt; 1 , \forall x , y \in [ a , b ] , | f ( x ) - f ( y ) | \leq q | x - y |$,那么$[ a , b ]$上存在唯一的不动点$c$.</p>
<p>任取一个点$x_0 \in [ a , b ]$,考虑$x_{ n + 1 } = f ( x_n )$,然后尝试判断这个数列的极限,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| x_{ n + 1 } - x_n | & = | f ( x_n ) - f ( x_{ n - 1 } ) | \leq q | x_n - x_{ n - 1 } | \leq q^{ n } | x_1 - x_0 | \\
| x_{ n + p } - x_n | & \leq \sum_{ k = 1 }^p | x_{ n + k } - x_{ n + k - 1 } | \\
& \leq \sum_{ k = 0 }^{ p - 1 } q^{ n + k } | x_1 - x_0 | = | x_1 - x_0 | q^n \frac{ 1 - q^{ p } }{ 1 - q }
\end{aligned}</script><p>所以$\{ x_n \}$是柯西列,其极限存在,取$c = \lim x_n$,容易发现:</p>
<script type="math/tex; mode=display">
| f ( x_n ) - f ( c ) | \leq q | x_n - c |</script><p>两边取极限得知$f ( c ) = c$,于是$c$是一个不动点.如果还存在一个不动点$c ‘ \ne c$,那么:</p>
<script type="math/tex; mode=display">
| c - c ' | = | f ( c ) - f ( c ' ) | \leq q | c - c ' |</script><p>不符.</p>
<h5><span id="李-约克定理">李-约克定理</span></h5><p>对于一个$f ( x ) \in C [ a , b ]$,如果$P_3 \ne \emptyset$,那么$\forall n \in \mathbb{ N }_+$,$P_n \ne \emptyset$.</p>
<h6><span id="引理一">引理一</span></h6><p>设$J$是实区间,$G : J \rightarrow \mathbb{ R }$是连续函数,$\forall I = [ a , b ] \subseteq G ( J )$,$\exists Q = [ a ‘ , b ‘ ] \subseteq J , G ( Q ) = I$.</p>
<p>根据介值定理,当然存在一对点$p , q$,$I = [ G ( p ) , G ( q ) ]$.不妨设$p &lt; q$,那么$a ‘ = \sup \{ x \in [ p , q ] | G ( x ) = G ( p ) \} , b ‘ = \inf \{ x \in [ a ‘ , q ] | G ( x ) = G ( q ) \}$即可.</p>
<p>换言之,我们可以拿到一个区间使得它的像正是我们想要的区间.感性理解的话我们可以对一个区间求原像并且原像当然也是一个区间.那我们自然可以对区间进行迭代.这样迭代的区间有什么性质么?</p>
<h6><span id="引理二">引理二</span></h6><p>设$J$是实区间,$F : J \rightarrow J$是连续函数,取一列闭区间$I_n$,满足$\forall n \geq 0 , I_n \subseteq J , I_{ n + 1 } \subseteq F ( I_n )$.不妨把这种区间列记作$I_0 \Rightarrow I_1 \Rightarrow I_2 \Rightarrow \cdots$.</p>
<p>那么我们可以找到一列闭区间$I_0 = Q_0 \supseteq Q_1 \supseteq Q_2 \cdots$,$\forall n \geq 0$,有$F^{ [ n ] } ( Q_n ) = I_n$.</p>
<p>考虑数学归纳,假设对于$\leq n$的都已经满足,现在有$I_{ n + 1 } \subseteq F ( I_n ) = F^{ [ n + 1 ] } ( Q_n )$,令$G = F^{ [ n + 1 ] }$然后用引理一就可以.</p>
<p>这个引理的意义在于,$\{ I_n \}$当然不必是一条链,但是只要其满足一定的性质,我们就可以在它们中找到一条链,也就是每迭代一次都可能会将射出去的那个集合变小,或者是射出需要的集合所需要的初始集合变小.</p>
<p>这个当然也是给我们求原像的机会.我们尝试感性理解一下这个在干什么:</p>
<p>如果一个函数操作完一个区间后会把这个区间变小,那显然我如果想求$F^{ [ - n ] } ( I )$,$n$越大得到的原像就越大对吧.反之,如果会把这个区间变大,那$n$越大得到的原像就越小对吧.</p>
<p>这个讨论显然是不好的,我们得想办法刻画一下这个东西.那当然要在这里蕴含一个$F$本身.</p>
<p>于是用上面的定义会发现,即使$F$会把这个区间扩张到奇怪的大小,只要我们能把它缩回去,那不断取原像的过程照样是可行的.</p>
<h6><span id="引理三">引理三</span></h6><p>设$J$是实区间,$G : J \rightarrow \mathbb{ R }$是连续函数,$I \subseteq J$是闭区间,并且$I \subseteq G ( I )$或者$G ( I ) \subseteq I$,都可以推出$\exists p \in I , G ( p ) = p$.</p>
<p>只需构造函数$H ( x ) = x - G ( x )$然后用介值定理即可.</p>
<h6><span id="李-约克定理">李-约克定理</span></h6><p>设$q_3 \in P_3$,则$F ( q_3 ) , F ( F ( q_3 ) ) \in P_3$,容易看出,这三个点中必然有一个点$a \in P_3$,使得$a , b = F ( a ) , c = F ( F ( a ) )$这三个数单调递增或单调递减.不妨设$a &lt; b &lt; c$.</p>
<p>下面证明对于任意$k &gt; 0$,存在$k$周期点.</p>
<p>我们接下来取$K = [ a , b ] , L = [ b , c ]$,立刻由介值定理发现$F ( K ) \supseteq L$以及$F ( L ) \supseteq [ a , c ] = K \cup L$.</p>
<p>接下来我们开始构造一列满足引理二的闭区间,我们考虑:</p>
<ol>
<li><p>当$k = 1$的时候,我们直接取$\forall n , I_n = L$.</p>
</li>
<li><p>当$k &gt; 1$的时候,取$I_n = \begin{cases}K &amp; n \equiv 0 \pmod{ k } \ L &amp; \text{ otherwise }\end{cases}$</p>
</li>
</ol>
<p>现在我们可以用引理二立刻拿到区间列$\{ Q_n \}$,我们发现$Q_k \subseteq Q_0 = I_0 = I_k = F^{ [ k ] } ( Q_k )$,根据引理三立刻得到$\exists q \in Q_k , F^{ [ k ] } ( q ) = q$.</p>
<p>那么这个$q$有没有可能存在更小的周期$d$呢?如果有的话,不妨取其中最小的那个$d$,辗转相除一下自然有$d | k$,那么当然要有$F^{ [ k ] } ( q ) = F^{ [ k - d ] } ( q ) = q$.</p>
<p>此时我们发现$q \in Q_k \subseteq Q_{ k - d }$,$q \in I_{ k } \cap I_{ k - d } = K \cap L = \{ b \}$,于是$F^{ [ k ] } ( q ) = b , F^{ [ k + 1 ] } ( q ) = c , F^{ [ k + 2 ] } ( q ) = a$.</p>
<p>这说明此时$d = 3$.</p>
<p>而当$k \geq 4$的时候,$F^{ [ k + 2 ] } ( q ) = a \notin L$,这当然与$I_{ k + 2 } = L$矛盾.</p>
<p>仔细观察一下上面的过程,我们到底依赖于什么东西得到了这个?</p>
<p>首先找到$q$使得$F^{ [ k ] } ( q ) = q$这个其实反而并不是最主要的,因为只要$F ( q ) = q$那么显然$F^{ [ k ] } ( q ) = q$,真正离谱的是竟然要让这个点在之前从未跳到过$q$.这也是这个证明的最精髓的部分,那就是证明任何一个$d &lt; q$都不是周期.</p>
<p>那我们考虑取一个区间(也就是$K$),在$K$中取一个合法的$q$,然后我们只要找到一个闭区间(也就是$Q_k \subseteq K$),使得它当且仅当复合$k$次的时候才会打到$K$上,在其它时候都得打在$K$的外面(在这里是$L$)上,那自然是可行的了对吧.而数字$3$恰好完美地给出了这个构造.</p>
<p>如果我们再总结一下上面的过程,我们需要找到两个区间$K , L$,找到一个$Q_k \subseteq K$,使得$F^k ( Q_k )$可以打到$K$上但是对于$d &lt; k$,$F^d ( Q_k )$打到$L$上.于是根据引理三其存在$k$周期点,但是几乎不可能存在$d$周期点(这里就需要简单判断一下$L \cap K$的部分了)</p>
<p>这样的$K$和$L$怎么构造呢?如果我们构造$F ( K )$打到$L$上,$F ( L )$打到$K$上显然是吧不合理的,那就可以一个打到另一个,另一个打到全集上再用引理一缩一下,这个看上去合理多了.这当然就是$F ( K ) \supseteq L$以及$F ( L ) \supseteq [ a , c ] = K \cup L$.</p>
<h5><span id="sharkovskii定理">Sharkovskii定理</span></h5><p>定义如下的一种序关系$\prec$(称为Sharkovskii序):</p>
<script type="math/tex; mode=display">
\begin{gathered}
3 \prec 5 \prec 7 \prec \cdots \\
\prec 2 \times 3 \prec 2 \times 5 \prec \cdots \\
\cdots \\
\prec 2^k \times 3 \prec 2^k \times 5 \prec \cdots \\
\cdots \\
\cdots \prec 2^n \prec 2^{ n - 1 } \prec \cdots \prec 4 \prec 2 \prec 1
\end{gathered}</script><p>对于$f ( x ) \in C [ l , r ] , f : [ l , r ] \rightarrow [ l , r ]$.那么如果$m \prec n , P_m \ne \emptyset \Rightarrow P_n \ne \emptyset$.</p>
<p>(首先发现当然存在不动点)</p>
<p>这咋办呢?我们刚才用了$3$的最重要的性质就是$3$个点可以排成有序的一列,如果有类似的引理,那我们就可以尝试推广上面的结论.</p>
<h6><span id="引理">引理</span></h6><p>设$f : I \rightarrow I$是连续函数,$f$有$2 n + 1$周期点但无更小非一奇数阶周期点,我们取出其一个周期轨$x_0 \rightarrow x_1 \rightarrow \cdots x_{ 2 n }$,必有以下两者成立其一:</p>
<ol>
<li><p>$x_{ 2 n } &lt; x_{ 2 n - 2 } &lt; \cdots &lt; x_2 &lt; x_0 &lt; x_1 &lt; \cdots &lt; x_{ 2 n - 3 } &lt; x_{ 2 n - 1 }$.</p>
</li>
<li><p>$x_{ 2 n } &gt; x_{ 2 n - 2 } &gt; \cdots &gt; x_2 &gt; x_0 &gt; x_1 &gt; \cdots &gt; x_{ 2 n - 3 } &gt; x_{ 2 n - 1 }$.</p>
</li>
</ol>
<p>这个引理怎么证明呢?考虑把周期轨排一下序然后归纳,我们不妨假设排好序后的结果是$y_0 &lt; y_1 &lt; \cdots &lt; y_{ 2 n }$.</p>
<p>如果引理成立,(第一种情况下)取$I_0 = [ x_0 , x_1 ]$,则$I_0 \Rightarrow I_0$.容易发现其实只有$I_0$有这个性质,那我们不妨来看看满足$[ y_k , y_{ k + 1 } ] \Rightarrow [ y_k , y_{ k + 1 } ]$的情况是什么样子的,尝试去满足$[ f ( y_{ k + 1 } ) , f ( y_{ k } ) ] \supseteq [ y_k , y_{ k + 1 } ]$.这个时候注意到我们可以把所有点分成两类:满足$f ( y_i ) \geq y_{ i + 1 }$(称为$\alpha$类点,容易见到这里也就等价于$f ( y_i ) &gt; y_i$)和$f ( y_i ) \leq y_{ i - 1 }$(称为$\beta$类点)的.那我们就是要找到一个$k$使得$y_k$是$\alpha$类点并且$y_{ k + 1 }$是$\beta$类点.</p>
<p>由于$f ( y_0 ) \geq y_1 , f ( y_{ 2 n } ) \leq y_{ 2 n - 1 }$,这两类点显然都有,那就一定存在交界的地方,这样我们就可以拿出这个分界的地方记作$I_0 = [ y_k , y_{ k + 1 } ]$,其中$y_k$是$\alpha$类点,$y_{ k + 1 }$是$\beta$类点.</p>
<p>我们不妨定义一个集合$S$的张成区间$A$为$A = [ \inf S , \sup S ]$,那我们现在取$S_0 = \{ y_k , y_{ k + 1 } \}$,设周期轨为$O_f = \{ x_0 , \cdots x_{ 2 n } \}$,我们递归定义$S_{ k + 1 } = f ( A_k ) \cap O_f$,容易根据上面对$S_0$的构造发现$S_0 \subsetneq S_1$,并且$S_k$中因为取了一段极大的区间(但并没有包含所有周期点),所以一定能跳出这个区间(不然这个区间内部就可以自己射自己),所以$S_k \subsetneq S_{ k + 1 }$.</p>
<p>那由此我们当然可以得到一条链:</p>
<script type="math/tex; mode=display">
S_0 \subsetneq S_1 \subsetneq \cdots \subsetneq S_t = O_f</script><p>按理来说应该有$t = 2 n - 1$(这就会给出每次$S$扩张只会多一个数),让我们先来证明这个结论:</p>
<p>反证,假设$t &lt; 2 n - 1$,尝试找到一个更小的奇数周期来推出矛盾,不妨尝试找到一个$2 n - 1$的周期(当然,如果$2 n + 1 = 3$的话,这个结论我们在李约克定理已经证明了,所以下面假设$2 n + 1 \geq 5$).</p>
<p>我不说你也知道我要干啥,我们考虑在末尾补$2 n - t - 1$个$A_t$,并把最后一个缩成$A_0$,当然有:</p>
<script type="math/tex; mode=display">
A_0 \Rightarrow A_1 \Rightarrow A_2 \Rightarrow \cdots \Rightarrow A_t \Rightarrow A_t \supseteq A_0</script><p>但这样并不太行,因为这些区间的交不是空的,我们起码得把其中的一个区间给挪出去,不妨考虑改掉最后一个$A_t$,试图取一个$l \ne k$使得$[ y_l , y_{ l + 1 } ] \Rightarrow A_0 = [ y_k , y_{ k + 1 } ]$.如果我们结合一下下面的主定理的证明部分,其实我们可以发现这里的$[ y_l , y_{ l + 1 } ]$也就是$I_{ 2 n - 1 }$.</p>
<p>我们上面已经保证了$f ( y_{ k + 1 } ) \leq y_k$,如果有$f ( y_{ k + 2 } ) \geq y_{ k + 1 }$,那当然可以取$l = k + 1$.也就是如果我们的这一列点类别中出现了$\alpha \beta \alpha$这样的结构就完事了.如果找不到,那说明$f ( y_{ k + 2 } ) \leq y_{ k + 1 }$.我们继续往后找,如果可以遇到第一个$f ( y_i ) \geq y_{ k + 1 }$,那$[ y_{ i - 1 } , y_i ]$自然是满足条件的.如果一直都找不到,说明始终有$f ( y_i ) &lt; y_{ k + 1 } \leq y_{ i - 1 } , i \in [ k + 2 , 2 n ]$,那说明后面全是$\beta$点.</p>
<p>同理如果出现了$\beta \alpha \beta$这样的结构也找到了.不然类似同理,如果一直找不到就说明前面全是$\alpha$点,前面的点始终满足$f ( y_i ) \geq y_{ k + 1 } , i \in [ 0 , k ]$.</p>
<p>这已经推导出了矛盾,因为我们发现前面的点射到后面,后面的点射到前面,问题在于前面有$k + 1$个点,后面有$2 n - k$个点,于是$k + 1 = 2 n - k \Rightarrow 2 k + 1 = 2 n$,这导出了矛盾.</p>
<p>所以确实可以找到这样的$l \ne k , [ y_l , y_{ l + 1 } ] \Rightarrow [ y_k , y_{ k + 1 } ]$,那我们用上面的区间列自然可以推导出存在一个$2 n - 1$周期点(或者其因子周期点,不过那也导出矛盾了).</p>
<p>于是$t = 2 n - 1$,这表示我们拿到的这条链$S_0 \subsetneq S_1 \subsetneq \cdots \subsetneq S_t = O_f$每次只增加一个元素.如果$S_0$到$S_1$是只增加了一个元素,当然说明$f ( y_k ) = y_{ k + 1 }$或者$f ( y_{ k + 1 } ) = y_k$.两者的证明是一样的,不妨设$f ( y_k ) = y_{ k + 1 }$.</p>
<p>此时我们取$x_0 = y_k , x_1 = y_{ k + 1 }$,此时其实也可以发现$x_2 &lt; x_0 &lt; x_1$.并且根据上面的说法,我们知道$A_{ k } \subsetneq A_{ k + 1 }$,那这个扩张一定是每次在边界上往外跑一个,也就是每次取一个新的迭代出来的结果扔到左边或者扔到右边.</p>
<p>网络上有关于这一点的证明往往是反证,假设不按规则走的话然后去尝试构造三周期点推到矛盾,但我们这里给出另一个证明方法:</p>
<p>考虑由于每次只增大一个数,那么如果我们能证明这一列$y$形如$\alpha \cdots \alpha \beta \cdots \beta$的形式就做完了,这等价于$I_0$的唯一性.</p>
<p>假设还有另一个区间也满足要求,对于这个新的区间,我们设其是$[ y_l , y_{ l + 1 } ]$,我们再拿一个周期点$y_{ l + 2 }$出来,假设这三个数按照顺序是$a &lt; b &lt; c$,那么根据上面的结论一定有$b \rightarrow c \rightarrow a$或者$b \rightarrow a \rightarrow c$成立,这就说明$b$被夹在了中间.而我们从一个$I_0$扩张当然是逐步的,会将$x_3 , x_4 \cdots$逐个加入,这必然意味着在$b$加入之前,$a , c$中已经有一个加进去了,但这是不可能的,只有$b$加入后才能把$a , c$给加进去.</p>
<h6><span id="sharkovskii定理">sharkovskii定理</span></h6><p>有了引理就可以开始类比了,不妨假设$x_{ 2 n } &lt; x_{ 2 n - 2 } &lt; \cdots &lt; x_2 &lt; x_0 &lt; x_1 &lt; \cdots &lt; x_{ 2 n - 3 } &lt; x_{ 2 n - 1 }$.</p>
<p>现在我们要取区间列了,显然有一些奇偶对跳的现象,事实上我们取$I_0 = [ x_0 , x_1 ] , I_{ 2 k - 1 } = [ x_{ 2 k } , x_{ 2 k - 2 } ] , I_{ 2 k } = [ x_{ 2 k - 1 } , x_{ 2 k + 1 } ]$显然就是满足条件的.而且这些区间除了端点外完全不相交(而且任意三个区间的交都是空集).这一列一共有$2 n$个区间.我们事实上可以取$J = [ x_{ 0 } , x_{ 2 n - 1 } ] = \bigcup I_{ 2 k }$放到整个区间的最后.</p>
<p>接下来我们用这些东西去对于多种情况来对跳.</p>
<p><strong>Case1</strong></p>
<p>(假设$2 n + 1$是最小的非空的非一奇数周期)首先证明$P_{ 2 n + 1 } \ne \emptyset \Rightarrow \forall 0 &lt; k , P_{ k + 2 n } \ne \emptyset$.</p>
<p>在前面补$k$个$I_0$,在最后也补一个$I_0$,构造区间列:</p>
<script type="math/tex; mode=display">
I_0 \Rightarrow I_0 \Rightarrow \cdots \Rightarrow I_0 \Rightarrow I_1 \Rightarrow I_2 \Rightarrow \cdots \Rightarrow I_{ 2 n - 1 } \Rightarrow I_0</script><p>也就是在前面补$I_0$直到整个区间列的数量为$k + 2 n + 1$,此时当然存在$x_0 \in Q_{ k + 2 n }$使得$f^{ [ k + 2 n ] } ( x_0 ) = x_0$,只需证明$\nexists d | ( k + 2 n )$,$f^{ [ d ] } ( x_0 ) = x_0$即可.这当然好证,因为$d \leq \frac{ k + 2 n }{ 2 } \leq \max ( k , 2 n )$,因为你只需要把它卡在那一堆$I_0$和$I_k$的分界线上就行.</p>
<p><strong>Case2</strong></p>
<p>(假设$2 n + 1$是最小的非空的非一奇数周期)接下来我们来证明$P_{ 2 n + 1 } \ne \emptyset \Rightarrow \forall 0 &lt; m , P_{ 2 m } \ne \emptyset$.</p>
<p>当$2 m &gt; 2 n + 1$的时候我们已经证完了,接下来考虑$2 m &lt; 2 n + 1$的情况.</p>
<p>由于$\forall k , I_{ 2 n - 1 } \Rightarrow I_{ 2 k }$,我们考虑取出$2 m + 1$个区间列,恰好有:</p>
<script type="math/tex; mode=display">
I_{ 2 n - 2 m } \Rightarrow I_{ 2 n - 2 m + 1 } \Rightarrow \cdots \Rightarrow I_{ 2 n - 1 } \Rightarrow I_{ 2 n - 2 m }</script><p>接下来就是简单说明的过程了.</p>
<p><strong>Case3</strong></p>
<p>接下来考虑证明:$P_{ 4 } \ne \emptyset \Rightarrow P_2 \ne \emptyset$.</p>
<p>这个证明就比较无聊了,我们进行暴力讨论,不妨假设$a &lt; b &lt; c &lt; d$,那么:</p>
<ol>
<li>$a \rightarrow b \rightarrow c \rightarrow d \rightarrow a$.</li>
</ol>
<p>此时$[ a , b ] \Rightarrow [ b , c ] \Rightarrow [ c , d ] \Rightarrow [ a , d ] \supseteq [ a , b ]$,于是可证明有三周期点,当然有二周期点.</p>
<ol>
<li>$a \rightarrow b \rightarrow d \rightarrow c \rightarrow a$.</li>
</ol>
<p>此时$[ a , b ] \Rightarrow [ b , d ] \Rightarrow [ c , d ] \Rightarrow [ a , c ] \supseteq [ a , b ]$,于是可证明有三周期点,当然有二周期点.</p>
<ol>
<li>$a \rightarrow c \rightarrow b \rightarrow d \rightarrow a$.</li>
</ol>
<p>此时$[ a , b ] \Rightarrow [ c , d ] \Rightarrow [ a , b ]$,当然有二周期点.</p>
<ol>
<li>$a \rightarrow c \rightarrow d \rightarrow b \rightarrow a$.</li>
</ol>
<p>此时$[ a , c ] \Rightarrow [ c , d ] \Rightarrow [ b , d ] \Rightarrow [ a , b ] \Rightarrow [ a , c ] \supseteq [ b , c ] \Rightarrow [ a , d ] \supseteq [ a , c ]$.于是有五周期点,于是有二周期点.</p>
<ol>
<li>$a \rightarrow d \rightarrow b \rightarrow c \rightarrow a$.</li>
</ol>
<p>此时$[ a , b ] \Rightarrow [ c , d ] \Rightarrow [ a , b ]$,当然有二周期点.</p>
<ol>
<li>$a \rightarrow d \rightarrow c \rightarrow b \rightarrow a$.</li>
</ol>
<p>此时$[ b , c ] \Rightarrow [ a , b ] \Rightarrow [ a , d ] \supseteq [ b , c ]$,于是有二周期点.</p>
<p><strong>Case4</strong></p>
<p>接下来考虑证明:$P_{ 2^{ n + 1 } } \ne \emptyset \Rightarrow P_{ 2^n } \ne \emptyset$.</p>
<p>考虑上面命题等价于$f^{ [ 2^{ n - 1 } ] }$有四周期点,则其有二周期点.</p>
<p><strong>Case5</strong></p>
<p>接下来考虑证明:$P_{ 2^{ n } p } \ne \emptyset \Rightarrow P_{ 2^n q } \ne \emptyset$,其中$p , q \in \text{ odd } , p &lt; q$.</p>
<p>考虑$f^{ [ 2^n ] }$有$p$周期点,当然也就有$q$周期点.</p>
<p><strong>Case6</strong></p>
<p>接下来考虑证明:$P_{ 2^{ n } p } \ne \emptyset \Rightarrow P_{ 2^m q } \ne \emptyset$,其中$p , q \in \text{ odd } , m &gt; n$.</p>
<p>考虑$f^{ [ 2^n ] }$有$p$周期点,当然也就有$q 2^{ m - n }$周期点.</p>
<p><strong>Case7</strong></p>
<p>接下来考虑证明:$P_{ 2^{ n } p } \ne \emptyset \Rightarrow P_{ 2^m } \ne \emptyset$,其中$p \in \text{ odd }$.</p>
<p>选取$N = \max ( n + 1 , m + 1 )$,则考虑$f^{ [ 2^n ] }$有$p$周期点,则其有$2^{ N - n }$周期点,$P_{ 2^N } \ne \emptyset$.于是$P_{ 2^m } \ne \emptyset$.</p>
<h3><span id="导数">导数</span></h3><p>设函数$f ( x )$在一个区间$( a , b )$上有定义,对于给定的$x_0 \in ( a , b )$,考虑增量$\Delta x \ne 0 \land x_0 + \Delta x \in ( a , b )$,则$\Delta y = f ( x_0 + \Delta x ) - f ( x_0 )$称为关于$\Delta x$的<strong>增量</strong>.若极限$\lim_{ \Delta x \rightarrow 0 } \frac{ \Delta y }{ \Delta x } \\$存在则称这个函数在$x_0$处<strong>可导</strong>,并称这个值为这个函数在$x_0$处的<strong>导数</strong>或者<strong>微商</strong>,记作$f ‘ ( x_0 )$或$\frac{ \text{ d } f }{ \text{ d } x } |_{ x = x_0 }$.同理可以定义出<strong>左导数</strong>和<strong>右导数</strong>.如果某个函数的导数构成一个函数,我们称这个函数为其对应的<strong>导函数</strong>.</p>
<p>显然右可导能推出右连续,左可导能推出左连续.换言之,可导一定连续.</p>
<p>但是连续不一定可导,相当漂亮的一个反例是$f ( x ) = \begin{cases}0 &amp; x = 0 \ x \sin \frac{ 1 }{ x } &amp; \text{ otherwise }\end{cases}$,其在零点没有左右导数.</p>
<p>如果$f$的$n - 1$次导数存在,记作$f^{ ( n - 1 ) } ( x )$,如果该函数可导则其导数称作$f^{ ( n ) } ( x )$.</p>
<p>如果$f^{ ( n ) } ( x )$在$I$上连续,则称$f \in C^{ n } ( I )$.如果其任意阶可导,则称$f \in C^{ \infty } ( I )$.</p>
<p>特别地,如果称一个函数是$\alpha$次可导,即$| f ( x ) - f ( y ) | \leq | x - y |^\alpha$.其实就是Holder连续.</p>
<h4><span id="导数基本运算">导数基本运算</span></h4><p>导数也可以类似求出四则运算以及复合的法则:</p>
<ol>
<li><p>$[ cf ( x ) ] ‘ = cf ‘ ( x )$.</p>
</li>
<li><p>$[ f ( x ) \pm g ( x ) ] ‘ = f ‘ ( x ) \pm g ‘ ( x )$.</p>
</li>
<li><p>$[ f ( x ) g ( x ) ] ‘ = f ‘ ( x ) g ( x ) + g ‘ ( x ) f ( x )$.</p>
</li>
<li><p>(莱布尼茨公式):$[ f ( x ) g ( x ) ]^{ ( n ) } = \sum_{ k = 0 }^n \binom{ n }{ k } f^{ ( k ) } ( x ) g^{ ( n - k ) } ( x )$.</p>
</li>
<li><p>$[ \frac{ f ( x ) }{ g ( x ) } ] ‘ = \frac{ f ‘ ( x ) g ( x ) - g ‘ ( x ) f ( x ) }{ g^2 ( x ) } , g ( x ) \ne 0$.</p>
</li>
<li><p>$[ g ( f ( x ) ) ] ‘ = g ‘ ( f ( x ) ) f ‘ ( x )$.</p>
</li>
</ol>
<p>(1)(2)比较平凡.</p>
<p>(3)(4)的证明的话,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ f ( x + \Delta x ) g ( x + \Delta x ) - f ( x ) g ( x ) }{ \Delta x } \\
= & \frac{ f ( x + \Delta x ) - f ( x ) }{ \Delta x } g ( x + \Delta x ) + f ( x ) \frac{ g ( x + \Delta x ) - g ( x ) }{ \Delta x }
\end{aligned}</script><p>取一下极限就行.</p>
<p>(5)的话,其实求出$( \frac{ 1 }{ g ( x ) } ) ‘$就行了,我们来看:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( \frac{ 1 }{ g ( x ) } ) ' & = \lim_{ \Delta x \rightarrow 0 } \frac{ \frac{ 1 }{ g ( x + \Delta x ) } - \frac{ 1 }{ g ( x ) } }{ \Delta x } \\
& = \lim_{ \Delta x \rightarrow 0 } \frac{ \frac{ g ( x ) - g ( x + \Delta x ) }{ g ( x + \Delta x ) g ( x ) } }{ \Delta x } \\
& = \frac{ - g ' ( x ) }{ g^2 ( x ) }
\end{aligned}</script><p>对于(6),不妨设$f ( x_0 ) = y_0$.</p>
<p>当$\Delta y \ne 0$的时候,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\lim_{ \Delta y \rightarrow 0 } \frac{ g ( y_0 + \Delta y ) - g ( y_0 ) }{ \Delta y } & = g ' ( y_0 ) \\
\lim_{ \Delta y \rightarrow 0 } [ \frac{ g ( y_0 + \Delta y ) - g ( y_0 ) }{ \Delta y } - g ' ( y_0 ) ] & = 0
\end{aligned}</script><p>令$\eta ( \Delta y ) = \frac{ g ( y_0 + \Delta y ) - g ( y_0 ) }{ \Delta y } - g ‘ ( y_0 ) = \frac{ \Delta z }{ \Delta y } - g ‘ ( y_0 ) , \Delta y \ne 0$,那么$\lim_{ \Delta y \rightarrow 0 } \eta ( \Delta y ) = 0$.</p>
<p>此时有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ \Delta z }{ \Delta x } & = \frac{ \Delta z }{ \Delta y } \frac{ \Delta y }{ \Delta x } = \eta ( \Delta y ) \frac{ \Delta y }{ \Delta x } + g ' ( y_0 ) \frac{ \Delta y }{ \Delta x } \\

\end{aligned}</script><p>带上极限,前者为$0$.</p>
<p>另一种写法是,类似上面的讨论,我们这里有一些无穷小量,而且(除了$\frac{ \Delta z }{ \Delta x }$以外)也不会出现无穷小量之间的除法,用一下当然有,$g ( y + \Delta y ) - g ( y ) = ( g ‘ ( y ) + o ( 1 ) ) \Delta y , f ( x + \Delta x ) - f ( x ) = ( f ‘ ( x ) + o ( 1 ) ) \Delta x$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\Delta z & = ( g ' ( y ) + o ( 1 ) ) \Delta y \\
& = ( g ' ( y ) + o ( 1 ) ) ( f ' ( x ) + o ( 1 ) ) \Delta x \\

\end{aligned}</script><p>两边除一下$\Delta x$两边求极限就行.</p>
<p>不难发现上面的过程等价于啥呢?等价于:</p>
<script type="math/tex; mode=display">
\frac{ \text{ d } z }{ \text{ d } x } = \frac{ \text{ d } z }{ \text{ d } y } \frac{ \text{ d } y }{ \text{ d } x }</script><h4><span id="反函数的导数">反函数的导数</span></h4><p>我们首先声称:如果$x = \varphi ( y ) , \varphi ‘ \ne 0 \Rightarrow$\varphi$有 反 函 数$f=\varphi^{-1}</p>
<p>然后我们声称:如果$x = \varphi ( y ) \in C ( c , d )$,并且其严格单调且连续.如果$( x_0 , y_0 )$处其导数存在,则$f ‘ ( x_0 ) = \frac{ 1 }{ \varphi ‘ ( f ( x_0 ) ) }$.</p>
<p>这个可以用极限证明,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' ( x_0 ) & = \lim_{ x \rightarrow x_0 } \frac{ f ( x ) - f ( x_0 ) }{ x - x_0 } \\
& = \lim_{ y \rightarrow y_0 } \frac{ y - y_0 }{ \varphi ( y ) - \varphi ( y_0 ) } \\
& = \lim_{ y \rightarrow y_0 } \frac{ 1 }{ \frac{ \varphi ( y ) - \varphi ( y_0 ) }{ y - y_0 } } \\
& = \frac{ 1 }{ \varphi ' ( y_0 ) }
\end{aligned}</script><p>现在我们证明了反函数有导数,立即有:</p>
<script type="math/tex; mode=display">
f ( g ( x ) ) = x \Rightarrow f ' ( x ) g ' ( f ( x ) ) = 1</script><h4><span id="隐函数求导">隐函数求导</span></h4><p>这里我们不加证明地给出隐函数求导法则,也就是暂且把$y$当成$x$的函数.</p>
<h6><span id="example1">Example1</span></h6><p>举例的话,我们来看方程:</p>
<script type="math/tex; mode=display">
x = y + \epsilon \sin y</script><p>两边对$x$求导:</p>
<script type="math/tex; mode=display">
\begin{aligned}
1 & = y ' + y ' \epsilon \cos y \\
y ' & = \frac{ 1 }{ 1 + \epsilon \cos y }
\end{aligned}</script><h4><span id="参数方程的求导">参数方程的求导</span></h4><p>如果$\begin{cases}x = x ( t ) \ y = y ( t )\end{cases}$,考虑求导$\frac{ \text{ d } y }{ \text{ d } x }$.</p>
<p>这个做法就是反函数+链式法则.当然要保证下面需要的地方导数都不是$0$.</p>
<p>不妨设$t = t ( x )$,当然有$y = y ( t ( x ) )$,那么$\frac{ \text{ d } y }{ \text{ d } x } = y ‘ ( t ( x ) ) t ‘ ( x ) = \frac{ y ‘ ( t ) }{ x ‘ ( t ) }$.</p>
<h6><span id="example1">Example1</span></h6><p>极坐标的求导:</p>
<script type="math/tex; mode=display">
\begin{cases}
x = r ( \theta ) \cos \theta \\
y = r ( \theta ) \sin \theta
\end{cases}</script><p>当然$\frac{ \text{ d } y }{ \text{ d } x } = \frac{ r ‘ \sin \theta + r \cos \theta }{ r ‘ \cos \theta - r \sin \theta } = \frac{ \tan \theta + \frac{ r }{ r ‘ } }{ 1 - \tan \theta \frac{ r }{ r ‘ } } = \tan ( \theta + \arctan ( \frac{ r }{ r ‘ } ) ) = \tan \alpha$.</p>
<p>而容易发现$\tan \alpha$其实是切线和$x$轴正半轴的夹角.</p>
<h4><span id="初等函数的导数">初等函数的导数</span></h4><p>下面给出若干初等函数的导数.</p>
<h5><span id="常函数">常函数</span></h5><p>常函数的连续性显然.</p>
<p>导数有:</p>
<script type="math/tex; mode=display">
f ( x ) = c \Rightarrow f ' ( x ) = 0</script><p>证明显然.</p>
<h5><span id="三角函数">三角函数</span></h5><p>三角函数的连续性比较有意思,考虑只需证明$\sin x$连续即可,使用和差化积得到$| \sin x - \sin x_0 | = | 2 \sin \frac{ x - x_0 }{ 2 } \cos \frac{ x + x_0 }{ 2 } | \leq 2 | \sin \frac{ x - x_0 }{ 2 } | \leq | x - x_0 |$.</p>
<p>导数有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sin ' ( x ) & = \cos ( x ) \\
\cos ' ( x ) & = - \sin ( x )
\end{aligned}</script><p>只给出前者的证明,后者类似,或者换个元做诱导公式也行.</p>
<p>我们有和差化积:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sin ( x + \Delta x ) - \sin ( x ) \\
= & 2 \sin ( \frac{ \Delta x }{ 2 } ) \cos ( x + \frac{ \Delta x }{ 2 } )
\end{aligned}</script><p>自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\lim_{ \Delta x \rightarrow 0 } \frac{ \Delta y }{ \Delta x } & = \lim_{ \Delta x \rightarrow 0 } \frac{ 2 \sin ( \frac{ \Delta x }{ 2 } ) \cos ( x + \frac{ \Delta x }{ 2 } ) }{ \Delta x } \\
& = \lim_{ \Delta x \rightarrow 0 } \frac{ \sin ( \frac{ \Delta x }{ 2 } ) }{ \frac{ \Delta x }{ 2 } } \cos ( x + \frac{ \Delta x }{ 2 } ) \\
& = \cos ( x )
\end{aligned}</script><p>进一步,我们可以考虑高阶导数:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( \sin x )^{ ( n ) } & = \sin ( x + \frac{ n \pi }{ 2 } ) \\
( \cos x )^{ ( n ) } & = \cos ( x + \frac{ n \pi }{ 2 } )
\end{aligned}</script><p>而考虑$( \tan x ) ‘$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( \tan x ) ' & = \lim_{ \Delta x \rightarrow 0 } \frac{ \frac{ \sin ( x + \Delta x ) }{ \cos ( x + \Delta x ) } - \frac{ \sin x }{ \cos x } }{ \Delta x } \\
& = \lim_{ \Delta x \rightarrow 0 } \frac{ \sin \Delta x }{ \Delta x } \frac{ 1 }{ \cos x \cos ( x + \Delta x ) } \\
& = \frac{ 1 }{ \cos^2 x }
\end{aligned}</script><h5><span id="反三角函数">反三角函数</span></h5><p>使用反函数的导数公式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\arctan ' ( x ) & = \frac{ 1 }{ 1 + x^2 } \\
\arccos ' ( x ) & = \frac{ - 1 }{ \sqrt{ 1 - x^2 } } \\
\arcsin ' ( x ) & = \frac{ 1 }{ \sqrt{ 1 - x^2 } }
\end{aligned}</script><p>反三角函数的高阶导数比较困难,我们来看个例子:</p>
<p>考虑$y = \arctan x$,$y ‘ = \frac{ 1 }{ 1 + x^2 } = \frac{ 1 }{ 1 + \tan^2 y } = \cos^2 y$,那么$y ‘ ‘ = - 2 \cos y \sin y \times y ‘ = - \cos^2 y \sin 2 y$,事实上容易用归纳法证明$y^{ ( n ) } = ( n - 1 ) ! \cos^n y \sin ( n ( y + \frac{ \pi }{ 2 } ) )$.</p>
<p>不过还有一种办法,那就是我们考虑$y ‘ = - \frac{ 1 }{ 2 i } ( \frac{ 1 }{ i + x } + \frac{ 1 }{ i - x } )$,用这个归纳立刻得到$y^{ ( n ) } = - \frac{ ( n - 1 ) ! }{ 2 i } ( ( i - x )^{ - n } - ( - 1 )^n ( i + x )^{ - n } )$.</p>
<p>然而$y = \arcsin x$要麻烦得多.下面我们来看一下:</p>
<script type="math/tex; mode=display">
\begin{aligned}
y ' & = \frac{ 1 }{ \sqrt{ 1 - x^2 } } \\
( y ' )^2 ( 1 - x^2 ) & = 1 \\
( 1 - x^2 ) 2 y ' y ' ' - 2 x ( y ' )^2 & \equiv 0 \\
( 1 - x^2 ) 2 y ' ' - 2 xy ' & \equiv 0
\end{aligned}</script><p>两边求$n - 2$次导,利用莱布尼茨公式,化简后得到:</p>
<script type="math/tex; mode=display">
( 1 - x^2 ) y^{ ( n ) } + ( 3 - 2 n ) xy^{ ( n - 1 ) } - ( n - 2 )^2 y^{ ( n - 2 ) } \equiv 0</script><h5><span id="指数函数">指数函数</span></h5><p>我们需要首先拿到指数为有理数的东西.</p>
<p>首先整数次方是有定义的,我们需要拿到形如$f ( x ) = a^{ \frac{ 1 }{ x } }$的东西,这个考虑取一下反函数即可.然后二者嵌套一下得到形如$a^{ \frac{ q }{ p } }$的幂函数,取反一下得到形如$a^{ - \frac{ q }{ p } }$的幂函数.</p>
<p>然后要定义无理数指数幂,类似戴德金分割,定义$a^x = \sup_{ q \leq x , q \in Q } a^q$.</p>
<p>当然我们要验证那些指数的运算法则,还有一些单调性(两个无理数之间插入两个有理数就可以拆成单调的,这里还需要讨论一下和$1$的大小关系),这些当然都是对的.</p>
<p>然后我们就可以拿出指数函数,用反函数定义对数函数.</p>
<p>指数函数的连续性:考虑对于$f ( x ) = a^x$,$\forall \epsilon &gt; 0$,$\exists N &gt; 0 , a &lt; ( 1 + \epsilon )^N$,此时取$q_1 &lt; x_0 &lt; q_2$,$q_2 - q_1 &lt; \frac{ 1 }{ N }$,这当然能做得到.考虑$a^{ x_0 } \leq f ( x_0 + 0 ) \leq f ( q_2 )$,于是$1 \leq \frac{ a^{ q_2 } }{ a^{ q_1 } } \leq a^{ \frac{ 1 }{ N } } \leq 1 + \epsilon$.</p>
<p>先来看最特殊的指数函数:</p>
<script type="math/tex; mode=display">
f ( x ) = e^x \Rightarrow f ' ( x ) = e^x</script><p>事实上我们还有:</p>
<script type="math/tex; mode=display">
f ( x ) = a^x \Rightarrow f ' ( x ) = a^x \ln a , a > 0</script><p>下面来看下为啥:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' ( x ) & = \lim_{ \Delta x \rightarrow 0 } \frac{ a^{ x + \Delta x } - a^x }{ \Delta x } \\
& = a^x \lim_{ \Delta x \rightarrow 0 } \frac{ a^{ \Delta x } - 1 }{ \Delta x } \\
& = a^x \ln a
\end{aligned}</script><p>而高阶导数有:</p>
<script type="math/tex; mode=display">
f ( x ) = e^{ ax } \Rightarrow f^{ ( n ) } = a^n e^{ ax }</script><h5><span id="对数函数">对数函数</span></h5><p>先看:</p>
<script type="math/tex; mode=display">
f ( x ) = \log_a ( x ) \Rightarrow f ' ( x ) = \frac{ 1 }{ x \ln a }</script><p>证明的话考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' ( x ) & = \lim_{ \Delta x \rightarrow 0 } \frac{ \log_a ( 1 + \frac{ \Delta x }{ x } ) }{ \Delta x } \\
& = \lim_{ \Delta x \rightarrow 0 } \frac{ \log_a ( 1 + \frac{ \Delta x }{ x } ) }{ \frac{ \Delta x }{ x } } \frac{ 1 }{ x } \\
& = \frac{ 1 }{ x \ln a }
\end{aligned}</script><p>再看:</p>
<script type="math/tex; mode=display">
f ( x ) = \ln | x | \Rightarrow f ' ( x ) = \frac{ 1 }{ x }</script><p>考虑$f ( x ) = \ln | x | = \frac{ 1 }{ 2 } \ln x^2$.</p>
<p>考虑对数函数的高阶导数:</p>
<script type="math/tex; mode=display">
f ( x ) = \ln x \Rightarrow f^{ ( n ) } ( x ) = ( - 1 )^{ n - 1 } ( n - 1 ) ! x^{ - n }</script><h5><span id="幂函数">幂函数</span></h5><p>我们只需要定义$x^{ \alpha } = e^{ \alpha \ln x }$即可.</p>
<p>导数有:</p>
<script type="math/tex; mode=display">
f ( x ) = x^\mu \Leftrightarrow f ' ( x ) = \mu x^{ \mu - 1 }</script><p>证明的话,考虑$x = 0$的时候根据定义显然,如果$x \ne 0$,那么:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' ( x ) & = \lim_{ \Delta x \rightarrow 0 } \frac{ ( x + \Delta x )^\mu - x^\mu }{ \Delta x } \\
& = \lim_{ \frac{ \Delta x }{ x } \rightarrow 0 } \frac{ ( 1 + \frac{ \Delta x }{ x } )^\mu - 1 }{ \frac{ \Delta x }{ x } } x^{ \mu - 1 } \\
& = \mu x^{ \mu - 1 }
\end{aligned}</script><p>容易发现其高阶导数是:</p>
<script type="math/tex; mode=display">
f ( x ) = x^\alpha \Rightarrow f^{ ( n ) } ( x ) = \alpha^{ \underline{ n } } x^{ \alpha - n }</script><h5><span id="一般初等函数">一般初等函数</span></h5><p>定理:初等函数在其定义域上除了至多一个孤立点集外,可求导并且导函数也是初等函数.</p>
<h4><span id="单调函数的导数">单调函数的导数</span></h4><p>定义右上导数$D^+ f ( x_0 ) = \varlimsup_{ h \rightarrow 0 + 0 } \frac{ f ( x_0 + h ) - f ( x_0 ) }{ h }$,同理定义右下导数$D_+$,左上导数$D^{ - }$,左下导数$D_-$.那么$f ‘ ( x_0 )$存在的充要条件当然是$D_+ = D^+ = D_- = D^-$并且有限.</p>
<p>下面证明单调(不妨设为单增)函数$f : [ a , b ] \rightarrow \mathbb{ R }$几乎处处有导数.</p>
<p>我们接下来尝试证明$E_1 = \{ x \in [ a , b ] \mid D^+ f ( x ) &gt; D_- f ( x ) \} , E_2 = \{ x \in [ a , b ] \mid D^- f ( x ) &gt; D_+ f ( x ) \}$两个集合是零测集.此时$E_1 \cup E_2$就是零测集,而$\mathbb{ R } \setminus ( E_1 \cup E_2 )$中的点都满足$D^{ + } f ( x ) \leq D_- f ( x ) \leq D^- f ( x ) \leq D_+ f ( x ) \leq D^+ f ( x )$,于是它们都相等(可能等于$+ \infty$).</p>
<p>二者类似,我们下面挑选前者进行证明:</p>
<p>考虑设$A_{ r , s } = \{ x | D^+ f ( x ) &gt; r &gt; s &gt; D_- f ( x ) \}$,其中$r , s$都是正有理数(因为是单调递增).这当然是可数个集合,所以只需要证明其中任意一个是零测集就可以.我们取$A = A_{ r , s }$,下面证明$A$是零测集.</p>
<p>反证,先假设$A$不是零测集,$m^* ( A ) &gt; 0$且有限(最大是$b - a$).</p>
<p>首先删除$A$中的孤立点集.由于孤立点集是零测集,这当然不会对答案有什么影响,也不会删成空集.这样下面可以直接假设$A$是开集.</p>
<p>根据定义,存在任意小的$h &gt; 0$使得$\frac{ f ( x - h ) - f ( x ) }{ - h } &lt; s \Rightarrow f ( x ) - f ( x - h ) &lt; sh$,那么我们取出这些$I_{ x , h } = [ x - h , x ]$,并且满足$I_{ x , h } \subseteq A$.它们当然构成$A$的一个Vitali覆盖.</p>
<p>根据Vitali覆盖引理我们有$\exists I_{ k } = [ x_k - h_k , x_k ]$两两不交并且满足$m^<em> ( A \setminus ( \bigcup I_k ) ) &lt; \epsilon$.而考虑$m^</em> ( A \setminus ( \bigcup I_k ) ) + m^<em> ( \bigcup I_k ) \geq m^</em> ( A )$,不妨令$B = \bigcup I_k$于是我们得到了$m^<em> ( B ) &gt; m^</em> ( A ) - \epsilon$.</p>
<p>这里我曾经以为可以直接写$m^<em> ( B ) = m^</em> ( A )$,但实际上是不行的,因为我们$B$的构造依赖于$\epsilon$.</p>
<p>同时由于所有的$I_k \subseteq A$并且两两不交,我们还有$\sum_j h_j \leq m^<em> ( A ) &lt; ( 1 + \epsilon ) m^</em> ( A )$.</p>
<p>而我们发现我们又有$f ( x_j ) - f ( x_j - h_j ) &lt; sh_j$,两边求和就有$\sum f ( x_j ) - f ( x_j - h_j ) &lt; sm^* ( A )$.</p>
<p>而接下来考虑$B$,$B$当然仍然是一个开集.对于$\forall y \in B$,当然应该存在一个任意小的$k &gt; 0$使得$f ( y + k ) - f ( y ) &gt; rk$.取出这些区间$[ y , y + k ]$当然仍然构成$B$的一个Vitali覆盖.类似上面,我们当然有结论$\sum f ( y_j + k_j ) - f ( y_j ) &gt; rm^<em> ( B ) &gt; r ( m^</em> ( A ) - \epsilon )$.但考虑$[ y_j , y_j + k_j ]$一定被包含在某个$[ x_j - h_j , x_j ]$中,又根据函数的单调性,自然可以知道$sm^<em> ( A ) &gt; \sum f ( x_j ) - f ( x_j - h_j ) \geq \sum f ( y_j + k_j ) - f ( y_j ) &gt; r ( m^</em> ( A ) - \epsilon )$.于是$sm^<em> ( A ) \geq rm^</em> ( A )$,这当然导出$m^* ( A ) = 0$,与条件不符!</p>
<p>接下来的修补工作是证明$E = \{ x | f ‘ ( x ) = + \infty \}$的集合是零测集.这意味着对于$\forall N &gt; 0 , \exists \Delta x &gt; 0 , f ( x + \Delta x ) - f ( x ) &gt; N \Delta x$,取$[ x , x + \Delta x ]$当然仍然是$E$的一个Vitali覆盖.同样根据Vitali覆盖引理得知$\sum \Delta x &gt; m^<em> ( E ) - \epsilon$,如果$m^</em> ( E ) \ne 0$,做Vitali覆盖后对$f ( x + \Delta x ) - f ( x ) &gt; N \Delta x$左右两边分别求和,左边是有界,上界当然是$f ( b ) - f ( a )$,但右边无界.这就给出矛盾了.</p>
<p>理解一下上面的过程的话就是,由于该单调函数定义在一个闭区间上,那么这个单调函数应该有某种最值性.这必然会限制其大小,而如果哪里的大小崩坏了导致没有导数,这些地方的外测度一定要是$0$,不然整体的最值性无法保证.</p>
<h4><span id="李氏连续函数的导数">李氏连续函数的导数</span></h4><p>注意到李氏连续的定义$| f ( x ) - f ( y ) | \leq L | x - y |$,注意到$f ( x ) = f ( x ) - Lx + Lx$.</p>
<p>如果钦定$x &lt; y$,那李氏连续等价于$f ( y ) - f ( x ) \leq | f ( x ) - f ( y ) | \leq L ( y - x ) , f ( y ) - Ly \leq f ( x ) - Lx$,于是$f ( x ) - Lx$是单调降函数,当然几乎处处可导,而$Lx$作为初等函数当然处处可导.</p>
<p>李氏连续几乎等价于导函数有界.</p>
<p>下面我们证明:如果$f ( x )$在$[ a , b ]$上可导,那么$| f ‘ | \leq L \Leftrightarrow | f ( x_1 ) - f ( x_2 ) | \leq L | x_1 - x_2 |$.</p>
<p>右推左是显然的,除一下然后取极限即可.</p>
<p>左推右也很显然,只需用一下拉格朗日中值定理即可.</p>
<h4><span id="微分">微分</span></h4><p>设$y = f ( x )$在$x_0$处有定义,假设有一个常数$A$使得$f ( x_0 + \Delta x ) - f ( x_0 ) = A \Delta x + o ( \Delta x ) , \Delta x \rightarrow 0$,称$f ( x )$在$x_0$处<strong>可微</strong>,并把$\text{ d } f = \text{ d } y = A \Delta x$称为$f ( x )$在$x_0$处的<strong>微分</strong>,由于后半部分是一个更高阶的无穷小量,我们说微分是函数改变量的线性主要部分.</p>
<h5><span id="微分与导数微商">微分与导数(微商)</span></h5><p>结合导数极限的定义,就可以得到$\text{ d } y = f ‘ ( x ) \text{ d } x$,$f ‘ ( x ) = \frac{ \text{ d } y }{ \text{ d } x } \\$.这就是我们将导数称作<strong>微商</strong>的原因.换言之,一阶可微一定一阶可导,反之亦然.但容易发现,可微的定义要比可导好得多,可微可以往外拓展到平面等拓扑结构,但可导不行.</p>
<p>一阶微分具有<strong>形式不变性</strong>.换言之就是,我们在求导的时候是需要选定一个自变量的,当选定的自变量是$y$的时候,根据上面自然会有$z = g ( y ) , \text{ d } z = g ‘ ( y ) \text{ d } y$.</p>
<p>但是当选定的自变量不是$y$的时候,上面的形式是同样成立的.我们下面证明这个结论,令$y = f ( x )$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
[ g ( f ( x ) ) ] ' & = g ' ( f ( x ) ) f ' ( x ) \\
\text{ d } z & = g ' ( f ( x ) ) f ' ( x ) \text{ d } x \\
\text{ d } z & = g ' ( y ) \text{ d } y \\

\end{aligned}</script><p>必须提出高阶微分不存在形式不变性,换句话说,$z = g ( y )$的二阶微分的形式不等价于$z = g ( y = f ( x ) )$的二阶微分,你不能乱换元.</p>
<p>一般将高阶微分记作$\frac{ \text{ d }^n y }{ \text{ d } x^n }$.</p>
<h4><span id="导函数的性质">导函数的性质</span></h4><h5><span id="费马定理">费马定理</span></h5><p>如果$f ( x )$在邻域$U ( \xi , \delta )$上有定义,$\xi$是其的一个极值点,在$\xi$处存在导数,那么$f ‘ ( \xi ) = 0$.</p>
<p>不妨考虑最大值情况,$f ‘ ( \xi ) = \lim_{ \Delta x \to + 0 } \frac{ f ( \xi + \Delta x ) - f ( \xi ) }{ \Delta x } = \lim_{ \Delta x \to - 0 } \frac{ f ( \xi + \Delta x ) - f ( \xi ) }{ \Delta x }$,前者$\leq 0$,后者$\geq 0$,此时当然$f ‘ ( \xi ) = 0$.</p>
<h5><span id="罗尔中值定理">罗尔中值定理</span></h5><p>如果$f \in C [ a , b ]$且可导,并且$f ( a ) = f ( b )$.则$\exists \xi \in ( a , b )$,$f ‘ ( \xi ) = 0$.</p>
<p>即:可导函数两个零点间一定有导数的零点.</p>
<p>设$M$为$f [ a , b ]$上的最大值,$m$是最小值,当二者相等即常值函数的时候,当然成立.</p>
<p>当$M &gt; m$的时候,则$M &gt; f ( a )$和$m &lt; f ( a )$至少有一个成立.不妨设$f ( M ) &gt; f ( a ) = f ( b )$.</p>
<p>根据费马定理,这个极值点的导数为$0$.</p>
<p>由此可以推论:函数的零点数量$| \{ x | f ( x ) = 0 \} | \leq 1 + | \{ x | f ‘ ( x ) = 0 \} |$.</p>
<p>这当然可以推出$n$次多项式至多$n$个实根.</p>
<p>事实上可以证明更强的结论,当$c_i$不全为$0$的时候,取$n$个不同实数$\lambda_k$,$f ( x ) = \sum_{ i = 1 }^n c_i x^{ \lambda_i }$至多有$n - 1$个正根.</p>
<p>归纳法,$n = 1$的时候显然成立.$n - 1$时成立的话,考虑$f ( x ) = 0 \Leftrightarrow x^{ - \lambda_n } f ( x ) = 0$,而后者有一项是常数项,求导后少一项.</p>
<h5><span id="拉格朗日中值定理">拉格朗日中值定理</span></h5><p>$f \in C [ a , b ]$,并且在$( a , b )$上可导，$\exists \xi \in ( a , b ) , f ‘ ( \xi ) = \frac{ f ( b ) - f ( a ) }{ b - a }$.</p>
<p>考虑先把函数放平,设$g ( x ) = f ( x ) - \frac{ f ( b ) - f ( a ) }{ b - a } ( x - a ) - f ( a )$,容易发现$g ( a ) = g ( b ) = 0$,根据罗尔中值定理,$\exists \xi , g ‘ ( \xi ) = 0 = f ‘ ( \xi ) - \frac{ f ( b ) - f ( a ) }{ b - a } , f ‘ ( \xi ) = \frac{ f ( b ) - f ( a ) }{ b - a }$.</p>
<h6><span id="example1">Example1</span></h6><p>证明:如果$f ‘ ( x ) \equiv 0 \Rightarrow f ( x ) \equiv C$.</p>
<p>考虑$\forall x , y , x \ne y$,$\forall \xi , f ‘ ( \xi ) = \frac{ f ( y ) - f ( x ) }{ y - x } = 0 \Rightarrow f ( x ) = f ( y )$.</p>
<h6><span id="example2">Example2</span></h6><p>证明:如果$f ‘ ( x ) \equiv g ‘ ( x )$,那么$f ( x ) = g ( x ) + C$.</p>
<p>考虑$h ( x ) = f ( x ) - g ( x ) , h ‘ ( x ) \equiv 0 \Rightarrow h ( x ) = C$.</p>
<h6><span id="example3">Example3</span></h6><p>考虑对抛物线用拉格朗日中值定理,设$f ( x ) = px^2 + qx + r$,则$\frac{ f ( b ) - f ( a ) }{ b - a } = \frac{ p ( b^2 - a^2 ) + q ( b - a ) }{ b - a } = p ( b + a ) + q = f ‘ ( \frac{ a + b }{ 2 } )$.</p>
<p>反过来,如果恒有$\frac{ f ( b ) - f ( a ) }{ b - a } = f ‘ ( \frac{ a + b }{ 2 } )$,事实上也可以推出$f ( x )$是抛物线.</p>
<p>此时我们有$f ( x + y ) - f ( x - y ) = 2 yf ‘ ( x )$,取$y = 1$,知道$f ( x ) \in C^{ \infty }$,于是可以两边对$y$求两次导数,得到$f ‘ ‘ ( x + y ) - f ‘ ‘ ( x - y ) \equiv 0$,取$y = x$,这当然意味着$f ‘ ‘ ( x )$是常函数.</p>
<h5><span id="柯西中值定理">柯西中值定理</span></h5><p>$f , g \in C [ a , b ]$,并且均在$( a , b )$上可导,其中$g ‘ ( x ) \ne 0$.则$\exists \xi \in ( a , b )$,$\frac{ f ( b ) - f ( a ) }{ g ( b ) - g ( a ) } = \frac{ f ‘ ( \xi ) }{ g ‘ ( \xi ) }$.</p>
<p>此时注意到$g ( b ) \ne g ( a )$,原因是根据拉格朗日中值定理,如果$g ( b ) = g ( a ) , \exists \xi \in ( a , b ) , g ‘ ( \xi ) = 0$,这与$g ‘ ( x ) \ne 0$矛盾.</p>
<p>令$F ( x ) = f ( x ) ( g ( b ) - g ( a ) ) - g ( x ) ( f ( b ) - f ( a ) )$.</p>
<p>接下来注意到上述命题等价于$\exists \xi \in ( a , b ) , F ‘ ( \xi ) = 0$.</p>
<p>而注意到$F ( a ) = f ( a ) g ( b ) - g ( a ) f ( b ) = F ( b )$,根据罗尔中值定理立刻得到答案.</p>
<p>然而这个东西竟然还能推广,我们有:</p>
<p>如果$f , g , h \in C [ a , b ]$并且在$( a , b )$上可导,$\exists \xi \in ( a , b ) ,$有:</p>
<script type="math/tex; mode=display">
\left | \begin{matrix}
f ' ( \xi ) & g ' ( \xi ) & h ' ( \xi ) \\
f ( a ) & g ( a ) & h ( a ) \\
f ( b ) & g ( b ) & h ( b )
\end{matrix} \right | = 0</script><p>证明的话考虑构造:</p>
<script type="math/tex; mode=display">
F ( x ) = \left | \begin{matrix}
f ( x ) & g ( x ) & h ( x ) \\
f ( a ) & g ( a ) & h ( a ) \\
f ( b ) & g ( b ) & h ( b )
\end{matrix} \right |</script><p>注意到$F ( a ) = F ( b ) = 0$.</p>
<h5><span id="广义微分中值定理">广义微分中值定理</span></h5><h6><span id="广义罗尔中值定理">广义罗尔中值定理</span></h6><p>如果$f \in C [ a , b ]$且$\forall x \in ( a , b ) , f ‘_\pm ( x )$均存在,并且$f ( a ) = f ( b ) = 0$.则$\exists \xi \in ( a , b )$,$f_+ ‘ ( \xi ) f_- ‘ ( \xi ) \leq 0$.</p>
<p>证明和罗尔中值定理没区别,仍然是找最值.</p>
<h6><span id="广义拉格朗日中值定理">广义拉格朗日中值定理</span></h6><p>如果$f \in C [ a , b ]$且$\forall x \in ( a , b ) , f ‘_\pm ( x )$均存在,$\eta = \frac{ f ( a ) - f ( b ) }{ a - b }$,则$\exists \xi \in ( a , b )$,$( f_+ ‘ ( \xi ) - \eta ) ( f_- ‘ ( \xi ) - \eta ) \leq 0$.</p>
<p>证明差不多,仍然是把函数放平然后用广义罗尔中值定理就行.</p>
<h5><span id="导函数与间断点">导函数与间断点</span></h5><p>导函数不存在第一类间断点.</p>
<p>证明的话,考虑证明当$f ( x )$在$x_0$处可导的时候,$\exists x_n &lt; x_0 &lt; y_n$,使得$x_n , y_n \rightarrow x_0$,并且满足$\lim f ‘ ( x_n ) = \lim f ‘ ( y_n ) = f ‘ ( x_0 )$.</p>
<p>原因根据拉格朗日中值定理,$\exists x_n \in ( x_0 - \frac{ 1 }{ n } , x_0 )$,$f ‘ ( x_n ) = \frac{ f ( x_0 ) - f ( x_0 - \frac{ 1 }{ n } ) }{ \frac{ 1 }{ n } }$,直接这么取当然就是可行的.</p>
<h5><span id="函数的升降性">函数的升降性</span></h5><p>$f \in C [ a , b ]$并且在$( a , b )$上可导,$f$单调不减$\Leftrightarrow$f’(x)\geq 0</p>
<p>左推右当然是导数定义,右推左可以用拉格朗日微分中值定理.</p>
<p>另外由于保号性,$f ‘ ( x ) &gt; 0 \Rightarrow f \uparrow$,但反之不成立.</p>
<h5><span id="函数的极值">函数的极值</span></h5><p>若$f$在$( x_0 - \delta , x_0 + \delta )$上$n - 1$次可导,$\forall 1 \leq k \leq n - 1 , f^{ ( k ) } ( x_0 ) = 0$.而且$f$在$x_0$处存在$n$阶导数并有$f^{ ( n ) } ( x_0 ) \ne 0$.我们有以下结论:</p>
<ol>
<li><p>$n$是奇数的时候,$x_0$不是极值点.</p>
</li>
<li><p>$n$是偶数且$f^{ ( n ) } ( x_0 ) &lt; 0$时,$x_0$是极大值点.</p>
</li>
<li><p>$n$是偶数且$f^{ ( n ) } ( x_0 ) &gt; 0$时,$x_0$是极小值点.</p>
</li>
</ol>
<p>证明考虑泰勒公式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & = f ( x_0 ) + \sum_{ k = 1 }^n \frac{ f^{ ( k ) } ( x_0 ) }{ k ! } ( x - x_0 )^k + o ( ( x - x_0 )^n ) \\
f ( x ) - f ( x_0 ) & = ( x - x_0 )^n ( \frac{ f^{ ( n ) } ( x_0 ) }{ n ! } + o ( 1 ) )
\end{aligned}</script><p>于是取极小邻域并且$n$是偶数的时候$f ( x ) - f ( x_0 )$和$f^{ ( n ) } ( x_0 )$同号,上述命题立见.</p>
<h5><span id="达布定理">达布定理</span></h5><p>也即:导函数拥有介值性.</p>
<p>如果$f$在$[ a , b ]$上可导,$f ‘ ( a ) f ‘ ( b ) &lt; 0$,那么$\exists \xi \in ( a , b ) , f ‘ ( \xi ) = 0$.</p>
<p>不妨设$f ‘ ( a ) &gt; 0 &gt; f ‘ ( b )$,那么$f$在$a$处附近递增,在$b$处附近递减.那我们取一下$f ( \xi ) = \max_{ [ a , b ] } \{ f ( x ) \}$,那么$\xi \ne a , \xi \ne b$,于是$\xi \in ( a , b )$,$f ‘ ( \xi ) = 0$.</p>
<p>那我们加个常数就可以把这个推广到导函数的介值性.</p>
<p>然而这个介值性比连续性弱得多,例如下面这个函数的导函数就在闭区间$[ 0 , 1 ]$上有界但没有最值:</p>
<script type="math/tex; mode=display">
f ( x ) = \begin{cases}
- x^2 ( 1 + \sin{ \frac{ 1 }{ x } } ) & x \ne 0 \\
0 & x = 0
\end{cases}</script><p>其构造思路是让其在$0$附近的导数在$( - 1 , 1 )$上下波动,这样上确界为$1$,但$0$处跳出去,所以取不到$1$.</p>
<p>下面这个函数更极端,其导函数在闭区间$[ 0 , 1 ]$上无界:</p>
<script type="math/tex; mode=display">
f ( x ) = \begin{cases}
x^2 \sin{ \frac{ 1 }{ x^2 } } & x \ne 0 \\
0 & x = 0
\end{cases}</script><p>其构造思路应当是让其在$0$处相当厉害地波动.</p>
<h5><span id="函数的凹凸性">函数的凹凸性</span></h5><p>定义一个函数是下凸的,若对$\forall x_1 , x_2 \in I , \forall \lambda \in [ 0 , 1 ] , f ( \lambda x_1 + ( 1 - \lambda ) x_2 ) \leq \lambda f ( x_1 ) + ( 1 - \lambda ) f ( x_2 )$.</p>
<p>如果一个函数是下凸的,那么其充要条件是$\forall x_1 , x_2 , x_3 \in I$满足$x_1 &lt; x_2 &lt; x_3$,$\left | \begin{matrix}1 &amp; x_1 &amp; f ( x_1 ) \ 1 &amp; x_2 &amp; f ( x_2 ) \ 1 &amp; x_3 &amp; f ( x_3 )\end{matrix} \right | \geq 0$.只需设$x_2 = \lambda x_1 + ( 1 - \lambda ) x_3$然后简单变形即可.</p>
<p>不妨设$k ( x_1 , x_2 ) = \frac{ f ( x_1 ) - f ( x_2 ) }{ x_1 - x_2 }$也就是这里的割线斜率.还可以证明如果一个函数是下凸的,那么其充要条件是$\forall x_1 , x_2 , x_3 \in I , x_1 &lt; x_2 &lt; x_3$,斜率有$k ( x_1 , x_2 ) \leq k ( x_1 , x_3 ) \leq k ( x_2 , x_3 )$,即所谓三弦引理.这个性质容易证明,而且该性质立刻说明开区间上的有界下凸函数一定是李氏连续函数.这意味着其应当几乎处处可导.另外三弦引理还可以改为$k ( x_1 , x_2 ) \leq k ( x_2 , x_3 )$,原因是中间项一定是两项的带权平均.</p>
<p>另外显然的是:</p>
<ol>
<li><p>如果$f$可导,那么$f$下凸$\Leftrightarrow$f’</p>
</li>
<li><p>如果$f$可二阶导,那么$f$下凸$\Leftrightarrow$f’’\geq 0</p>
</li>
</ol>
<p>如果$f ( x )$在$x_0$附近连续并且在$x_0$左右小邻域内凸性相反,称其为$f ( x )$的一个<strong>拐点</strong>.</p>
<p>容易说明$f ‘ ‘ ( x_0 ) = 0$是拐点的必要条件,原因是拐点处$f ‘ ( x )$的增减性相反,$x_0$必定是$f ‘ ( x )$的极值点.由此还可以套用之前的极值点结论:</p>
<p>若$f$在$( a , b )$上$n$次可导,$\exists x_0 \in ( a , b ) , \forall 1 \leq k \leq n - 1 , f^{ ( k ) } ( x_0 ) = 0$.并且$\forall x \in ( a , b ) , f^{ ( n ) } ( x ) &gt; 0$我们有以下结论:</p>
<ol>
<li><p>$n$是奇数的时候,$f ( x )$是严格单增函数.</p>
</li>
<li><p>$n$是偶数的时候,$f ( x )$是严格下凸函数.</p>
</li>
</ol>
<p>但上述条件疑似有点过强,能不能放弱一点呢?</p>
<p>可以发现一个在开区间$( a , b )$上的函数是下凸的充要条件应当是以下条件同时成立:</p>
<ol>
<li><p>$\forall x \in ( a , b )$,$f ‘_\pm ( x )$均存在,并且$f ‘_- ( x ) \leq f ‘_+ ( x )$.</p>
</li>
<li><p>$\forall x_1 , x_2 \in ( a , b ) , x_1 &lt; x_2$,$f ‘_+ ( x_1 ) \leq f ‘_- ( x_2 )$.</p>
</li>
</ol>
<p>必要性几乎是显然的,只需用三弦引理然后在每个点都卡一下极限就行.</p>
<p>充分性略有麻烦.考虑反证,只需反推三弦引理即可.设其不是凸的,那就$\exists x_1 , x_2 , x_3 \in ( a , b ) , x_1 &lt; x_2 &lt; x_3 , k ( x_1 , x_2 ) &gt; k ( x_2 , x_3 )$.不妨设$\eta_1 = k ( x_1 , x_2 ) , \eta_2 = k ( x_2 , x_3 )$那么根据广义拉格朗日中值定理,$\exists \xi_1 \in ( x_1 , x_2 ) , \xi_2 \in ( x_2 , x_3 )$,使得$( f_+ ‘ ( \xi_1 ) - \eta_1 ) ( f ‘_- ( \xi_1 ) - \eta_1 ) \leq 0 , ( f_+ ‘ ( \xi_2 ) - \eta_2 ) ( f ‘_- ( \xi_2 ) - \eta_2 ) \leq 0$.</p>
<p>立刻得到$f ‘_+ ( \xi_1 ) \geq \eta_1 \geq f_- ‘ ( \xi_1 ) , f ‘_+ ( \xi_2 ) \geq \eta_2 \geq f_- ‘ ( \xi_2 )$,由于$\eta_1 &gt; \eta_2$,所以$f ‘_+ ( \xi_1 ) \geq \eta_1 &gt; \eta_2 \geq f ‘_- ( \xi_2 )$,但$\xi_1 &lt; \xi_2$,这就出现了矛盾.</p>
<p>还可以证明下凸函数除了可数个点以外都可导,并且几乎处处有二阶导数.</p>
<p>这个怎么证明呢?考虑由(1)(2),可以发现$f ‘_+ ( x )$和$f_- ‘ ( x )$都是单调函数,那么除了可数个点以外它们均连续,而它们在连续处必定可导,原因是$f_+ ‘ ( x_0 - \epsilon ) \leq f ‘_- ( x_0 ) \leq f ‘_+ ( x_0 )$,夹逼一下就可以了.而这样的话其导数单调,于是处处二阶可导.</p>
<p>由此还可以发现:$f$在开区间$I$上,是下凸的等价于:</p>
<ol>
<li><p>$\forall x_0 \in I , f ‘_\pm ( x_0 )$存在.</p>
</li>
<li><p>$\forall x \in I , f ( x ) \geq f ( x_0 ) + f ‘_\pm ( x_0 ) ( x - x_0 )$.</p>
</li>
</ol>
<p>必要性:</p>
<p>考虑已知凸函数,只需证明$f ( x ) - f ( x_0 ) \geq f ‘_\pm ( x_0 ) ( x - x_0 )$.不妨假设$x &gt; x_0$(另一方向同理),于是只需证明$\frac{ f ( x ) - f ( x_0 ) }{ x - x_0 } \geq f ‘_\pm ( x_0 )$,用广义拉格朗日微分中值定理立刻得见此成立.</p>
<p>充分性:</p>
<p>任取两点$x_1 , x_2 \in I , x_1 &lt; x_2$,有$\frac{ f ( x_2 ) - f ( x_1 ) }{ x_2 - x_1 } \geq f_- ‘ ( x_1 )$,那么左边那个东西取极限得到$f ‘_+ ( x_1 )$,这样就说明了任何一个点都有$f ‘_+ ( x ) \geq f ‘_- ( x )$.</p>
<p>接下来仍然容易得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x_2 ) & \geq f ( x_1 ) + f '_+ ( x_1 ) ( x_2 - x_1 ) \\
f ( x_1 ) & \geq f ( x_2 ) + f '_- ( x_2 ) ( x_1 - x_2 )
\end{aligned}</script><p>由上述式子立刻得到$f_+ ‘ ( x_1 ) ‘ \leq f_- ‘ ( x_2 )$.这样就证明了充分性.</p>
<h4><span id="经典不等式">经典不等式</span></h4><h5><span id="琴生不等式">琴生不等式</span></h5><p>如果$f$在区间$I$上是下凸的,则$\forall x_i \in I , \lambda_i \in [ 0 , 1 ] , \sum \lambda_i = 1$,那么$f ( \sum \lambda_i x_i ) \leq \sum \lambda_i f ( x_i )$.从几何角度来看,这意味着在$f ( \sum \lambda_i x_i )$处作的切线位于原函数下方.所以函数如果是上凸的话不等号要反向.</p>
<p>当所有$x_i$均相等的时候显然成立.</p>
<p>不然考虑直接取$x_0 = \sum \lambda_i x_i$,此时发现$x_0$一定在区间内部.于是我们知道$f ( x_i ) \geq f ( x_0 ) + f ‘_+ ( x_0 ) ( x_i - x_0 )$,求和得到$\sum \lambda_i f ( x_i ) \geq f ( x_0 ) + f_+ ‘ ( x_0 ) \sum \lambda_i ( x_i - x_0 ) = f ( x_0 )$,这样就证毕了.</p>
<p>容易将琴生不等式推广到积分形式,当$\varphi ( x )$是下凸连续函数的时候,当然有$\varphi ( \int_0^1 f \text{ d } x ) \leq \int_0^1 \varphi ( f ( x ) ) \text{ d } x$,证明只需对黎曼和求极限.</p>
<h6><span id="example1">Example1</span></h6><p>证明:圆内接$n$边形以正$n$边形面积和周长最大.</p>
<p>不妨设其为单位元,用圆心向顶点连边,会得到一圈圆心角$\alpha_1 , \ldots , \alpha_n$,它们之和应当是$2 \pi$并且范围均在$( 0 , \pi ]$里(原因是圆心肯定得包含在正$n$边形里,不然肯定不算大),此范围内$\sin$是下凸函数,那么$S = \frac{ 1 }{ 2 } \sum \sin \alpha_i \leq \frac{ n }{ 2 } \sin \frac{ \sum \alpha_i }{ n } = \frac{ n }{ 2 } \sin \frac{ 2 \pi }{ n }$,$L = 2 \sum \sin \frac{ \alpha_i }{ 2 } \leq 2 n \sin \frac{ \sum \alpha_i }{ 2 n } = 2 n \sin \frac{ \pi }{ n }$.</p>
<p>同理还可以证明圆外接$n$边形以正$n$边形面积和周长最小,证明可以考虑取切线然后用$\tan$的凸性.</p>
<h5><span id="均值不等式">均值不等式</span></h5><p>当$x_i &gt; 0$时:</p>
<script type="math/tex; mode=display">
\frac{ n }{ \sum \frac{ 1 }{ x_i } } \leq ( \prod x_i )^{ \frac{ 1 }{ n } } \leq \frac{ \sum x_i }{ n }</script><p>取$f ( x ) = \ln x$,$f ( x )$是上凸的,于是$\ln \frac{ \sum x_i }{ n } \geq \frac{ 1 }{ n } \sum \ln x_i$,右边得证,取倒数得到左边.</p>
<h5><span id="柯西-赫尔德不等式">柯西-赫尔德不等式</span></h5><p>当$a_i , b_i &gt; 0$并且$\frac{ 1 }{ p } + \frac{ 1 }{ q } = 1$时,有$\sum a_i b_i \leq ( \sum a_i^p )^{ \frac{ 1 }{ p } } ( \sum b_i^q )^{ \frac{ 1 }{ q } }$.其特例给出柯西不等式.</p>
<p>套用琴生不等式,取$f ( x ) = x^{ \frac{ 1 }{ q } } , \lambda_i = \frac{ a_i^p }{ \sum_j a_j^p } , x_i = \frac{ b_i^q }{ a_i^p }$,容易发现$f ( x )$上凸.</p>
<p>这样就会得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( \sum \lambda_i x_i ) & \geq \sum \lambda_i f ( x_i ) \\
( \sum_i \frac{ b_i^q }{ \sum_j a_j^p } )^{ \frac{ 1 }{ q } } & \geq \sum_i \frac{ a_i b_i }{ \sum_j a_j^p } \\

\end{aligned}</script><p>化简一下就可以了.</p>
<p>在这里也可以将此形式拓展到积分形式,注意到当$\frac{ 1 }{ p } + \frac{ 1 }{ q } = 1$时,$a^{ \frac{ 1 }{ p } } b^{ \frac{ 1 }{ q } } = e^{ \frac{ \ln a }{ p } + \frac{ \ln b }{ q } } \leq \frac{ a }{ p } + \frac{ b }{ q }$,原因是琴生不等式.</p>
<p>此时令$F = ( \int_a^b | f ( x ) |^p \text{ d } x )^{ \frac{ 1 }{ p } } , G = ( \int_a^b | g ( x ) |^q \text{ d } x )^{ \frac{ 1 }{ q } }$,再令$a = \frac{ | f ( x ) |^p }{ F^p } , b = \frac{ | g ( x ) |^q }{ G^q }$,根据上面的不等式立刻得到$\frac{ | f ( x ) g ( x ) | }{ FG } \leq \frac{ a }{ p } + \frac{ b }{ q }$,此时做两边积分,注意到$\int a = \int b = 1$,立刻得到$( \int_a^b | f ( x ) |^p \text{ d } x )^{ \frac{ 1 }{ p } } ( \int_a^b | g ( x ) |^q \text{ d } x )^{ \frac{ 1 }{ q } } \geq \int_a^b | f ( x ) g ( x ) | \text{ d } x$.</p>
<h5><span id="闵可夫斯基minkovski不等式">闵可夫斯基(Minkovski)不等式</span></h5><p>$x_i , y_i \geq 0 , p \geq 1$,则$( \sum ( x_i + y_i )^p )^{ \frac{ 1 }{ p } } \leq ( \sum x_i^p )^{ \frac{ 1 }{ p } } + ( \sum y_i^p )^{ \frac{ 1 }{ p } }$.这其实揭示了某种度量下的三角形不等式.</p>
<p>套用琴生不等式,取$f ( x ) = ( 1 - x^{ \frac{ 1 }{ p } } )^p , x \in ( 0 , 1 )$.求导得到$f ‘ ( x ) = - ( 1 - x^{ \frac{ 1 }{ p } } )^{ p - 1 } x^{ \frac{ 1 }{ p } - 1 }$,再来一次化简得到$f ‘ ‘ ( x ) = ( 1 - \frac{ 1 }{ p } ) ( 1 - x^{ \frac{ 1 }{ p } } )^{ p - 2 } x^{ \frac{ 1 }{ p } - 2 } \geq 0$.于是$f ( x )$下凸.</p>
<p>取$\lambda_i = \frac{ ( x_i + y_i )^p }{ \sum_j ( x_j + y_j )^p }$,$u_i = ( \frac{ x_i }{ x_i + y_i } )^p$.这样得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( 1 - \frac{ ( \sum x_i^p )^{ \frac{ 1 }{ p } } }{ ( \sum_j ( x_j + y_j )^p )^{ \frac{ 1 }{ p } } } )^p & \leq \sum_i \frac{ ( x_i + y_i )^p }{ \sum_j ( x_j + y_j )^p } ( \frac{ y_i }{ x_i + y_i } )^p \\
( ( \sum ( x_i + y_i )^p )^{ \frac{ 1 }{ p } } - ( \sum x_i^p )^{ \frac{ 1 }{ p } } )^p & \leq \sum y_i^p
\end{aligned}</script><p>化简一下就做完了.</p>
<h4><span id="洛必达法则">洛必达法则</span></h4><p>来看几个抽象的问题:</p>
<ol>
<li><p>$\infty - \infty$.</p>
</li>
<li><p>$0 \times \infty$.</p>
</li>
<li><p>$\frac{ 0 }{ 0 }$.</p>
</li>
<li><p>$\frac{ \infty }{ \infty }$.</p>
</li>
<li><p>$0^0$.</p>
</li>
<li><p>$1^\infty$.</p>
</li>
<li><p>$\infty^0$.</p>
</li>
</ol>
<p>(1)可以写成$\infty ( 1 - \frac{ \infty }{ \infty } )$,这样就转化成了(4)和(2).</p>
<p>(2)可以写成$\frac{ 0 }{ \frac{ 1 }{ \infty } }$,就转化成了(3).</p>
<p>(5)可以写成$e^{ 0 \ln 0 }$,就转化成了(2).</p>
<p>(6)可以写成$e^{ \infty \ln 1 }$,就转化成了(2).</p>
<p>(7)可以写成$e^{ 0 \ln \infty }$,就转化成了(2).</p>
<p>这样的话我们只需要解决俩问题就行了,也就是$\frac{ 0 }{ 0 }$和$\frac{ \infty }{ \infty }$.</p>
<h5><span id="00型">0/0型</span></h5><p>如果$f , g$在$U_0 ( a , \delta )$上可导,$g ‘ ( x ) \ne 0$,$\lim_{ x \rightarrow a } f ( x ) = \lim_{ x \rightarrow a } g ( x ) = 0$.那么若$\lim_{ x \rightarrow a } \frac{ f ‘ ( x ) }{ g ‘ ( x ) } = k \Rightarrow \lim_{ x \rightarrow a } \frac{ f ( x ) }{ g ( x ) } = k$.</p>
<p>这个只需要定义$f ( a ) = g ( a ) = 0$,这样这俩函数就连续了.然后直接跑柯西中值定理就可以对$\frac{ f ( x ) - f ( a ) }{ g ( x ) - g ( a ) } = \frac{ f ‘ ( \xi ) }{ g ‘ ( \xi ) }$.</p>
<p>这里可以看出洛必达法则是单向的,因为我们取得$\xi$并不是连续变化的,只是取了一个$\rightarrow 0$的$\xi$的子列.</p>
<p>而如果$a = \infty$,那就考虑取$t \rightarrow 0$,然后把$x$换成$\frac{ 1 }{ t }$,做复合函数求导即可,结论无差异.</p>
<h5><span id="inftyinfty型">$\infty$/$\infty$型</span></h5><p>如果$f , g$在$U_0 ( a , \delta )$上可导,$g ‘ ( x ) \ne 0$,$\lim_{ x \rightarrow a } g ( x ) = \infty$.那么若$\lim_{ x \rightarrow a } \frac{ f ‘ ( x ) }{ g ‘ ( x ) } = k \Rightarrow \lim_{ x \rightarrow a } \frac{ f ( x ) }{ g ( x ) } = k$.</p>
<p>这个证明麻烦一点,先来讨论$k \ne \pm \infty$的情况.</p>
<p>考虑$\forall \epsilon &gt; 0$,$\exists \delta &gt; 0 , \forall \xi \in ( a , a + \delta )$,应当有$k - \epsilon &lt; \frac{ f ‘ ( \xi ) }{ g ‘ ( \xi ) } &lt; k + \epsilon$,那么$\forall x \in ( a , a + \delta )$,取$x_1 = a + \delta$当然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ f ( x ) - f ( x_1 ) }{ g ( x ) - g ( x_1 ) } & = \frac{ f ' ( \xi ) }{ g ' ( \xi ) } \\
\frac{ f ( x ) }{ g ( x ) } & = \frac{ f ' ( \xi ) }{ g ' ( \xi ) } ( 1 - \frac{ g ( x_1 ) }{ g ( x ) } ) + \frac{ f ( x_1 ) }{ g ( x ) }
\end{aligned}</script><p>两边取极限就做完了.</p>
<p>当$k = \pm \infty$的时候容易发现上面那个还能用.</p>
<h4><span id="泰勒公式">泰勒公式</span></h4><p>设$f ( x )$在$x_0$处有$n$阶导数,则<strong>泰勒公式</strong>声称$x \rightarrow x_0$时$f ( x ) = \sum_{ k = 0 }^n f^{ ( k ) } ( x_0 ) \frac{ ( x - x_0 )^k }{ k ! } + o ( ( x - x_0 )^n )$,其中$o ( ( x - x_0 )^n )$称作<strong>皮亚诺余项</strong>.特别地,当$x_0 = 0$的时候,称其为<strong>麦克劳林公式</strong>.</p>
<p>要证明这个式子只需证明$\lim_{ x \rightarrow x_0 } \frac{ f ( x ) - \sum_{ k = 0 }^n f^{ ( k ) } ( x_0 ) \frac{ ( x - x_0 )^k }{ k ! } }{ ( x - x_0 )^n } = 0$.对上下分别用$n - 1$次洛必达法则后,那么只需要证明$\lim_{ x \rightarrow x_0 } \frac{ f^{ ( n - 1 ) } ( x ) - f^{ ( n - 1 ) ( x_0 ) } }{ ( x - x_0 ) } - f^{ ( n ) } ( x_0 ) = 0$.而这当然就是导数的定义,于是就证毕了.</p>
<h5><span id="拉格朗日余项">拉格朗日余项</span></h5><p>设$f ( x )$在$( a , b )$上有$n + 1$阶导数,并且$f ( x ) \in C^n [ a , b ]$,泰勒公式有$f ( x ) = \sum_{ k = 0 }^n f^{ ( k ) } ( x_0 ) \frac{ ( x - x_0 )^k }{ k ! } + \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - x_0 )^{ n + 1 }$,其中$\xi \in ( x_0 , x )$.一般将$\frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - x_0 )^{ n + 1 }$称作<strong>拉格朗日余项</strong>.</p>
<p>证明的话,考虑对于一个固定的$x$,构造$F ( t ) = f ( x ) - \sum_{ k = 0 }^n f^{ ( k ) } ( t ) \frac{ ( x - t )^k }{ k ! }$,$G ( t ) = ( x - t )^{ n + 1 }$.这里之所以固定$x$而移动$x_0$的原因是,如果反过来固定则求导就不能实现下面的错项相消.不难发现$F ( x ) = G ( x ) = 0$,此时考虑必定有一个$\xi \in ( x_0 , x )$满足$\frac{ F ‘ ( \xi ) }{ G ‘ ( \xi ) } = \frac{ F ( x_0 ) - F ( x ) }{ G ( x_0 ) - G ( x ) } = \frac{ F ( x_0 ) }{ G ( x_0 ) }$.</p>
<p>这个时候研究一下他们的导数,注意到$G ‘ ( t ) = - ( n + 1 ) ( x - t )^{ n }$,$F ‘ ( t ) = - \sum_{ k = 0 }^n f^{ ( k + 1 ) } ( t ) \frac{ ( x - t )^k }{ k ! } + \sum_{ k = 1 }^n f^{ ( k ) } ( t ) \frac{ ( x - t )^{ k - 1 } }{ ( k - 1 ) ! } = - f^{ ( n + 1 ) } ( t ) \frac{ ( x - t )^n }{ n ! }$.</p>
<p>于是$\frac{ F ( x_0 ) }{ G ( x_0 ) } = \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! }$,$F ( x_0 ) = \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - x_0 )^{ n + 1 }$.</p>
<p>下面给出一些常见的泰勒展开公式(其中$0 &lt; \theta &lt; 1$):</p>
<ol>
<li><p>$e^x = \sum_{ k = 0 }^n \frac{ x^k }{ k ! } + \frac{ e^{ \theta x } x^{ n + 1 } }{ ( n + 1 ) ! } = 1 + \frac{ x }{ 1 ! } + \frac{ x^2 }{ 2 ! } + \frac{ x^3 }{ 3 ! } + o ( x^3 )$.</p>
</li>
<li><p>$\sin x = \sum_{ k = 0 }^{ n } \frac{ ( - 1 )^k x^{ 2 k + 1 } }{ ( 2 k + 1 ) ! } + ( - 1 )^{ n + 1 } \frac{ \cos \theta x }{ ( 2 n + 3 ) ! } x^{ 2 n + 3 } = x - \frac{ 1 }{ 3 ! } x^3 + o ( x^4 )$.</p>
</li>
<li><p>$\cos x = \sum_{ k = 0 }^n \frac{ ( - 1 )^k x^{ 2 k } }{ ( 2 k ) ! } + ( - 1 )^{ n + 1 } \frac{ \cos \theta x }{ ( 2 n + 2 ) ! } x^{ 2 n + 2 } = 1 - \frac{ 1 }{ 2 ! } x^2 + \frac{ 1 }{ 4 ! } x^4 + o ( x^5 )$.</p>
</li>
<li><p>$\tan x = x + \frac{ 1 }{ 3 } x^3 + \frac{ 2 }{ 15 } x^5 + o ( x^6 )$.</p>
</li>
<li><p>$\ln ( 1 + x ) = \sum_{ k = 1 }^n \frac{ ( - 1 )^{ k - 1 } x^k }{ k } + ( - 1 )^n \frac{ x^{ n + 1 } }{ ( n + 1 ) ( 1 + \theta x )^{ n + 1 } } = x - \frac{ 1 }{ 2 } x^2 + \frac{ 1 }{ 3 } x^3 + o ( x^3 )$.</p>
</li>
<li><p>$( 1 + x )^\alpha = \sum_{ k = 0 }^n \frac{ \alpha^{ \underline{ k } } }{ k ! } x^k + \frac{ \alpha^{ \underline{ n + 1 } } }{ ( n + 1 ) ! } ( 1 + \theta x )^{ \alpha - n - 1 } x^{ n + 1 }$.</p>
</li>
</ol>
<h4><span id="解析函数">解析函数</span></h4><p>不妨设$f_n ( x , x_0 ) = \sum_{ k = 0 }^n f^{ ( k ) } ( x_0 ) \frac{ ( x - x_0 )^k }{ k ! }$.我们称$f$在$x_0$处解析,若$\exists \delta &gt; 0$,$\lim_{ n \rightarrow \infty } f_n ( x , x_0 ) = f ( x )$,也即泰勒展式在一个邻域上可以逼近原函数.</p>
<p>如果其在$( a , b )$上任何一点都解析,那么称其在$( a , b )$上解析,记作$f \in C^\omega ( a , b )$.</p>
<p>解析函数应当有如下性质:</p>
<ol>
<li><p>$f , g$在$x_0$处解析,那么$f , g$的四则运算在$x_0$处也解析.</p>
</li>
<li><p>$f , g$均解析,并且$f \circ g$有意义,那么$f \circ g$也解析.</p>
</li>
<li><p>$f$在$x_0$处解析,那么$f^{ - 1 }$在$f ( x_0 )$处解析.</p>
</li>
<li><p>初等函数基本是解析函数.</p>
</li>
</ol>
<p>对于(1):</p>
<p>$f \pm g$当然是平凡的,至于$fg$和$\frac{ f }{ g }$如何证明解析性,我们回头再说.</p>
<p>对于(2):</p>
<p>回头再说.</p>
<h4><span id="拉格朗日插值">拉格朗日插值</span></h4><p>构造多项式$P_n = \sum_{ i = 0 }^{ n } y_i ( \prod_{ j = 0 \land j \ne i }^{ n } \frac{ x - x_j }{ x_i - x_j } ) \\$.显然当$x = x_i$时,该多项式的答案为$y_i$.</p>
<p>用这个在一个$n + 1$次可导的函数$f \in C ( a , b )$上打$n + 1$个点并且取出这个多项式$P_n$,考虑它们的误差.取$\omega ( x ) = \prod_{ k = 0 }^n ( x - x_k )$,事实上有:$\exists \xi \in ( a , b ) , f ( x ) = P_n ( x ) + \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } \omega ( x )$.</p>
<p>取$h ( t ) = f ( t ) - P_n ( t )$,考虑对于一个固定的$x \ne x_i$,取$g ( t ) = \frac{ h ( x ) }{ \omega ( x ) } \omega ( t ) - h ( t )$.注意到$g ( x ) = 0 , g ( x_i ) = 0$,所以$g$有$n + 2$个零点,所以$g^{ ( n + 1 ) }$一定有一个零点,记为$\xi$.</p>
<p>那么我们就有$g^{ ( n + 1 ) } ( \xi ) = \frac{ h ( x ) }{ \omega ( x ) } ( n + 1 ) ! - f^{ ( n + 1 ) } ( \xi ) = 0$.上述命题就得证了.</p>
<p>那么怎么样能让$\omega ( x )$这个东西的最大值尽可能小呢?</p>
<p>我们定义所谓$n$次切比雪夫多项式$f$,使得对于任何一个首项为$1$的多项式$T_n$,$\max_{ ( a , b ) } | T_n | \geq \max_{ ( a , b ) } | f |$.</p>
<p>事实上$[ - 1 , 1 ]$上的切比雪夫多项式可以用递推关系描述:</p>
<script type="math/tex; mode=display">
P_n = \begin{cases}
1 & n = 0 \\
x & n = 1 \\
x^2 - \frac{ 1 }{ 2 } & n = 2 \\
xP_{ n - 1 } - \frac{ 1 }{ 4 } P_{ n - 2 } & \text{ otherwise }
\end{cases}</script><p>还可以写成$P_n = \frac{ 1 }{ 2^{ n - 1 } } \cos ( n \arccos x )$.</p>
<h4><span id="函数的作图">函数的作图</span></h4><h5><span id="渐近线">渐近线</span></h5><p>如果对于一个函数$y = f ( x )$,存在一条直线$l$使得函数上一点$P ( x , f ( x ) )$距离原点距离$\to + \infty$的时候,$( x , f ( x ) )$与$l$的距离$\to 0$.</p>
<p>大概可以有以下几类渐近线:</p>
<ol>
<li><p>水平渐近线:$f ( + \infty ) = C$或$f ( - \infty ) = C$.</p>
</li>
<li><p>垂直渐近线:$f ( x_0 - 0 ) = \infty$或$f ( x_0 + 0 ) = \infty$.</p>
</li>
<li><p>斜渐近线:$l = kx + b$,那么$\lim_{ x \to + \infty } \frac{ f ( x ) }{ x } = a , \lim_{ x \to \infty } ( f ( x ) - ax ) = b$.</p>
</li>
</ol>
<h5><span id="作图">作图</span></h5><ol>
<li><p>确定定义域和值域.</p>
</li>
<li><p>研究其奇偶性,周期性.</p>
</li>
<li><p>研究$f ‘ ( x ) = 0$的根以确定极值点和升降区间.</p>
</li>
<li><p>研究$f ‘ ‘ ( x ) = 0$的根找出拐点.</p>
</li>
<li><p>求出渐近线.</p>
</li>
</ol>
<h4><span id="牛顿迭代">牛顿迭代</span></h4><p>目的是找到一个函数$f$的零点,尝试取上面任何一点并作切线,找到切线与$x$轴的交点.或者说任取$x_0$,取$x_{ n + 1 } = x_n - \frac{ f ( x_n ) }{ f ‘ ( x_n ) }$.</p>
<p>我们需要证明这个做法的正确性,事实上:</p>
<p>如果$f ‘ , f ‘ ‘$在$[ a , b ]$上非零,$\exists c \in [ a , b ] , f ( c ) = 0$,那我们取$x_0 \in [ a , b ]$满足$f ( x_0 ) f ‘ ‘ ( x_0 ) &gt; 0$,那么取$x_{ n + 1 } = x_n - \frac{ f ( x_n ) }{ f ‘ ( x_n ) }$的数列$\{ x_n \} \rightarrow c$.事实上:</p>
<ol>
<li><p>当$f ‘ f ‘ ‘ &gt; 0$,$x_n$单调下降趋近于$c$.</p>
</li>
<li><p>当$f ‘ f ‘ ‘ &lt; 0$,$x_n$单调上升趋近于$c$.</p>
</li>
</ol>
<p>并且$| x_n - c | \sim O ( 2^{ - 2^n } )$.</p>
<p>上述讨论情况有点多,我们下面只讨论其中一种进行证明:</p>
<p>当$f ‘ &gt; 0 , f ‘ ‘ &gt; 0$的时候,$f$是一个单调上升的下凸函数.容易发现这个数列单调下降并且应当大于$c$,那它就有极限,两边取极限得知$\lim_{ n \to \infty } f ( x_n ) = 0$.</p>
<p>接下来看一下逼近速度,泰勒公式展开一下知道$0 = f ( c ) = f ( x_n ) + f ‘ ( x_n ) ( c - x_n ) + \frac{ f ‘ ‘ ( \xi ) }{ 2 } ( c - x_n )^2$.从上面的结果容易看出$n \geq 1$的时候,$| x_{ n + 1 } - c | = \frac{ | f ( x_n ) + f ‘ ( x_n ) ( c - x_n ) | }{ | f ‘ ( x_n ) | } = \frac{ f ‘ ‘ ( \xi ) }{ 2 | f ‘ ( x_n ) | } ( c - x_n )^2$.前面那个系数是有界的,可以看作一个常数.于是这一次的误差应当是上一次误差的平方级别.</p>
<h3><span id="积分">积分</span></h3><h4><span id="不定积分">不定积分</span></h4><p>如果存在可导函数$F$满足$F ‘ ( x ) = f ( x )$,则称一个函数$f$是<strong>可积</strong>的,$F ( x )$是$f ( x )$的<strong>原函数</strong>,或称其为$f ( x )$的不定积分.</p>
<p>我们之前已经证明过导数相等的两个函数最多只差一个常数,因此一个函数的原函数是有唯一的$F ( x ) + C$的形式的.</p>
<h5><span id="不定积分的运算">不定积分的运算</span></h5><p>只给出以下两个运算法则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int ( f ( x ) \pm g ( x ) ) \text{ d } x & = \int f ( x ) \text{ d } x \pm \int g ( x ) \text{ d } x \\
\int \alpha f ( x ) \text{ d } x & = \alpha \int f ( x ) \text{ d } x
\end{aligned}</script><h5><span id="积分表">积分表</span></h5><ol>
<li><p>$\int x^\alpha \text{ d } x = \frac{ x^{ \alpha + 1 } }{ \alpha + 1 } + C , \alpha \ne - 1$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ x } = \ln | x | + C$.</p>
</li>
<li><p>$\int e^x \text{ d } x = e^x + C$.</p>
</li>
<li><p>$\int \cos x \text{ d } x = \sin x + C$.</p>
</li>
<li><p>$\int \sin x \text{ d } x = - \cos x + C$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ \cos^2 x } = \tan x + C$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ \sin^2 x } = - \cot x + C = - \frac{ 1 }{ \tan x } + C$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ 1 + x^2 } = \arctan x + C$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ \sqrt{ 1 - x^2 } } = \arcsin x + C$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ \sqrt{ x^2 \pm a^2 } } = \ln | x + \sqrt{ x^2 \pm a^2 } | + C$.</p>
</li>
<li><p>$\int \sqrt{ a^2 - x^2 } \text{ d } x = \frac{ 1 }{ 2 } ( x \sqrt{ a^2 - x^2 } + a^2 \arcsin \frac{ x }{ a } ) + C$.</p>
</li>
<li><p>$\int \sqrt{ x^2 \pm a^2 } \text{ d } x = \frac{ 1 }{ 2 } ( x \sqrt{ x^2 \pm a^2 } \pm a^2 \ln | x + \sqrt{ x^2 \pm a^2 } | ) + C$.</p>
</li>
</ol>
<h5><span id="换元法">换元法</span></h5><p>第一换元法:设$\int g ( t ) \text{ d } t = G ( t ) + C$,$w ( x )$可导,则$\int g ( w ( x ) ) w ‘ ( x ) \text{ d } x = G ( w ( x ) ) + C$.证明只需对右边求导即可.</p>
<p>第二换元法:设$x ( t )$可导,且有反函数$t ( x )$,那么如果$\int f ( x ( t ) ) x ‘ ( t ) \text{ d } t = G ( t ) + C$,则$\int f \text{ d } x = G ( t ( x ) ) + C$.</p>
<h6><span id="example1">Example1</span></h6><p>求$I_n = \int \tan^n x \text{ d } x$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = \int \tan^{ n - 2 } ( \frac{ 1 }{ \cos^2 x } - 1 ) \text{ d } x \\
& = \int \tan^{ n - 2 } x ( \text{ d } \tan x ) - I_{ n - 2 } \\
& = \frac{ \tan^{ n - 1 } x }{ n - 2 } - I_{ n - 2 }
\end{aligned}</script><p>边界条件的话$I_0 = x + C , I_1 = \int \frac{ \sin x }{ \cos x } \text{ d } x = - \int \frac{ 1 }{ \cos x } ( \text{ d } \cos x ) = - \ln ( \cos x ) + C$.</p>
<h5><span id="分部积分">分部积分</span></h5><p>我们应当有$( uv ) ‘ = u ‘ v + v ‘ u$,两边积分得到$uv = \int u ‘ v \text{ d } x + \int v ‘ u \text{ d } x$,变形得到$\int v \text{ d } u = uv - \int u \text{ d } v$.</p>
<h6><span id="example1">Example1</span></h6><p>求$I_n = \int \cos^n x \text{ d } x$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = \int \cos^{ n - 1 } x ( \text{ d } \sin x ) \\
& = \cos^{ n - 1 } x \sin x + ( n - 1 ) \int \sin^2 x \cos^{ n - 2 } x \text{ d } x \\
& = \cos^{ n - 1 } x \sin x + ( n - 1 ) \int ( 1 - \cos^2 x ) \cos^{ n - 2 } x \text{ d } x \\
& = \cos^{ n - 1 } \sin x + ( n - 1 ) I_{ n - 2 } - ( n - 1 ) I_n
\end{aligned}</script><p>整理得到$I_n = \frac{ 1 }{ n } \cos^{ n - 1 } x \sin x + \frac{ n - 1 }{ n } I_{ n - 2 }$.</p>
<p>边界条件当然是$I_0 = x + C , I_1 = \sin x + C$.</p>
<h6><span id="example2">Example2</span></h6><p>求$I_n = \int \frac{ \text{ d } x }{ \cos^n x }$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = \int \frac{ \text{ d } \tan x }{ \cos^{ n - 2 } x } \\
& = \frac{ \tan x }{ \cos^{ n - 2 } x } - \int \tan x ( \text{ d } \cos^{ 2 - n } x ) \\
& = \frac{ \tan x }{ \cos^{ n - 2 } x } + ( 2 - n ) \int \cos^{ - n } x \sin^2 x \text{ d } x \\
& = \frac{ \tan x }{ \cos^{ n - 2 } x } + ( 2 - n ) \int \cos^{ - n } x ( 1 - \cos^2 x ) \text{ d } x \\
& = \frac{ \tan x }{ \cos^{ n - 2 } x } + ( 2 - n ) I_n - ( 2 - n ) I_{ n - 2 }
\end{aligned}</script><p>整理得到$I_n = \frac{ 1 }{ n - 1 } \frac{ \tan x }{ \cos^{ n - 2 } x } + \frac{ n - 2 }{ n - 1 } I_{ n - 2 }$.</p>
<h6><span id="example3">Example3</span></h6><p>求$I_{ m , n } = \int \sin^m x \cos ( nx ) \text{ d } x$,其中$m &lt; n$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_{ m , n } & = \int \sin^m x \cos ( nx ) \text{ d } x \\
& = \frac{ 1 }{ n } \int \sin^m x \text{ d } \sin ( nx ) \\
& = \frac{ 1 }{ n } \left ( \sin^m x \sin ( nx ) - \frac{ m }{ n } \int \sin ( nx ) \sin^{ m - 1 } x \cos x \text{ d } x \right )
\end{aligned}</script><p>然后观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int \sin ( nx ) \sin^{ m - 1 } x \cos x \text{ d } x \\
= & - \frac{ 1 }{ n } \int \sin^{ m - 1 } x \cos x \text{ d } \cos ( nx ) \\
= & - \frac{ 1 }{ n } ( \cos ( nx ) \sin^{ m - 1 } x \cos x - \int \cos ( nx ) ( \text{ d } \sin^{ m - 1 } x \cos x ) )
\end{aligned}</script><p>观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int \cos ( nx ) ( \text{ d } \sin^{ m - 1 } x \cos x ) \\
= & \int \cos ( nx ) ( - \sin^{ m } + ( m - 1 ) \sin^{ m - 2 } x \cos^2 x ) \text{ d } x \\
= & \int \cos ( nx ) ( ( m - 1 ) \sin^{ m - 2 } x - m \sin^m x ) ) \text{ d } x \\
= & ( m - 1 ) I_{ m - 2 , n } - mI_{ m , n }
\end{aligned}</script><p>往回倒腾倒腾,边界条件是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_{ 0 , n } & = \int \cos ( nx ) \text{ d } x = \frac{ \sin ( nx ) }{ n } + C \\
I_{ 1 , n } & = \int \sin x \cos ( nx ) \text{ d } x \\
& = \frac{ 1 }{ 2 } \int ( \sin ( ( n + 1 ) x ) - \sin ( ( n - 1 ) x ) ) \text{ d } x \\
& = \frac{ 1 }{ 2 } ( \frac{ - \cos ( ( n + 1 ) x ) }{ n + 1 } + \frac{ \cos ( ( n - 1 ) x ) }{ n - 1 } ) + C
\end{aligned}</script><h6><span id="example4">Example4</span></h6><p>求$I_n = \int \frac{ \text{ d } x }{ ( x^2 + a^2 )^n }$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = \frac{ x }{ ( x^2 + a^2 )^n } - \int x \text{ d } \frac{ 1 }{ ( x^2 + a^2 )^n } \\
& = \frac{ x }{ ( x^2 + a^2 )^n } + 2 n \int \frac{ x^2 + a^2 - a^2 }{ ( x^2 + a^2 )^{ n + 1 } } \text{ d } x \\
& = \frac{ x }{ ( x^2 + a^2 )^n } + 2 nI_{ n } - 2 a^2 nI_{ n + 1 }
\end{aligned}</script><p>边界是$I_1 = \frac{ 1 }{ a } \arctan \frac{ x }{ a } + C$.</p>
<h6><span id="example5">Example5</span></h6><p>求$I = \int x \cos^3 x \text{ d } x$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = \int x \cos^3 x \text{ d } x = \int x \cos^2 x \text{ d } ( \sin x ) \\
& = x \cos^2 x \sin x - \int \sin x ( \cos^2 x \text{ d } x - 2 x \cos x \sin x ) \\
& = x \cos^2 x \sin x + \int \cos^2 x ( \text{ d } \cos x ) + 2 \int x \cos x \sin^2 x \text{ d } x \\
& = x \cos^2 x \sin x + \frac{ \cos^3 x }{ 3 } + 2 \int x \cos x ( 1 - \cos^2 x ) \text{ d } x \\
& = x \cos^2 x \sin x + \frac{ \cos^3 x }{ 3 } + 2 \int x \cos x \text{ d } x - 2 I \\
& = x \cos^2 x \sin x + \frac{ \cos^3 x }{ 3 } + 2 \int x ( \text{ d } \sin x ) - 2 I \\
& = x \cos^2 x \sin x + \frac{ \cos^3 x }{ 3 } + 2 ( x \sin x + \cos x ) - 2 I + C \\

\end{aligned}</script><p>也就是$3 I = x \cos^2 x \sin x + \frac{ \cos^3 x }{ 3 } + 2 ( x \sin x + \cos x ) + C$.</p>
<h5><span id="有理分式的不定积分">有理分式的不定积分</span></h5><p>考虑真分式$R ( x ) = \frac{ P ( x ) }{ Q ( x ) }$,其中$\deg P ( x ) &lt; \deg Q ( x )$.至于其他分式可以做长除法变成真分式.</p>
<p>定义最简真分式形如$\frac{ A }{ ( x - a )^m } , \frac{ Bx + C }{ ( x^2 + px + q )^n }$.</p>
<p>先证明一个引理:实数域上,任何一个多项式可以分解为若干不可约的一次多项式和二次多项式的乘积.</p>
<p>原因是复根一定成对出现,如果$z$是复根,那么$\bar{ z }$一定也是复根,原因是$\overline{ zw } = \bar{ z } \bar{ w }$,对一个多项式两边逐项取共轭就可以发现上述结论.那只需要把成对的复根扔到一个二次多项式里就行.</p>
<p>再证明一个引理:实数上,任何一个真分式都可以转化为若干最简真分式的线性组合.</p>
<p>先拆一次项,如上将$Q ( x ) = ( x - a )^m R ( x )$,其中$R ( a ) \ne 0$,那我们考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ P ( x ) }{ Q ( x ) } - \frac{ A_1 }{ ( x - a )^m } & = \frac{ P ( x ) - A_1 R ( x ) }{ ( x - a )^m R ( x ) } \\

\end{aligned}</script><p>此时取$A_1 = \frac{ P ( a ) }{ R ( a ) }$,立刻见到$( x - a ) | ( P ( x ) - A_1 R ( x ) )$,于是上下至少少一次,这样就可以继续分解了.</p>
<p>再拆二次项,如上将$Q ( x ) = ( x^2 + px + q )^m R ( x )$,其中$( x^2 + px + q ) \nmid R ( x )$,那:</p>
<script type="math/tex; mode=display">
\frac{ P ( x ) }{ Q ( x ) } - \frac{ A_1 x + B_1 }{ ( x^2 + px + q )^m } = \frac{ P ( x ) - ( A_1 x + B_1 ) R ( x ) }{ ( x^2 + px + q )^m R ( x ) }</script><p>令$T ( x ) = P ( x ) - ( A_1 x + B_1 ) R ( x )$,类似上面应当要确定$A_1 , B_1$使得上面那部分是$x^2 + px + q$的倍数就可以.直接取$x^2 + px + q$的某个复根$\alpha$,则只需$T ( \alpha ) = 0$即可,这是两个方程(实部虚部),而我们有两个未知数,理应可以解出答案.具体解得过程其实也可以直接把$P ( x )$和$R ( x )$直接先用多项式长除法杀一杀然后剩的部分判一下方程.</p>
<p>这样最后就只需要对拆出来的东西逐项积分就行.意味着有理函数的原函数是初等函数.</p>
<h5><span id="有理三角函数的不定积分">有理三角函数的不定积分</span></h5><p>即$\sin x , \cos x$经过有限步四则运算得到的函数.</p>
<p>我们定义二元有理函数$R ( u , v )$,那么有理三角函数实际上是$R ( \cos x , \sin x )$.</p>
<p>下面给出以下命题:</p>
<ol>
<li><p>如果其对于$u$是奇函数,也即$R ( u , v ) = - R ( - u , v )$,那么$R ( u , v ) = uR_1 ( u^2 , v )$,其中$R_1$是另一个二元有理函数.如果对于$v$是奇函数则同理.</p>
</li>
<li><p>当$R ( - u , - v ) = R ( u , v )$时,那么$R ( u , v ) = R_1 ( \frac{ u }{ v } , v^2 )$.</p>
</li>
</ol>
<p>证明只需要拆做$R ( u , v ) = \frac{ P ( u , v ) }{ Q ( u , v ) }$,其中$P , Q$是两个多项式,然后只需简单书写即可证明.</p>
<p>对于(1)形式的有理三角函数,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int R ( \cos x , \sin x ) \text{ d } x \\
= & \int \cos xR ( \cos^2 x , \sin x ) \text{ d } x \\
\\
= & \int R_1 ( 1 - \sin^2 x , \sin x ) \text{ d } ( \sin x ) \\
= & \int R_1 ( 1 - t^2 , t ) \text{ d } t
\end{aligned}</script><p>对于(2)形式的有理三角函数,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int R ( \cos x , \sin x ) \text{ d } x \\
= & \int R_1 ( \cos^2 x , \tan x ) \text{ d } x \\
= & \int R_1 ( \frac{ 1 }{ 1 + \tan^2 x } , \tan x ) \text{ d } x \\
= & \int R_1 ( \frac{ 1 }{ 1 + t^2 } , t ) \frac{ \text{ d } t }{ 1 + t^2 }
\end{aligned}</script><p>有了这两种形式后呢?我们注意到任意的有理三角函数都可以表示为以上两种函数之和,原因是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& R ( u , v ) \\
= & \frac{ R ( u , v ) - R ( - u , v ) }{ 2 } \\
+ \frac{ R ( - u , v ) - R ( - u , - v ) }{ 2 } \\
+ \frac{ R ( - u , - v ) + R ( u , v ) }{ 2 }
\end{aligned}</script><p>或者,令$t = \tan \frac{ x }{ 2 }$,那么$\sin x = \frac{ 2 t }{ 1 + t^2 } , \cos x = \frac{ 1 - t^2 }{ 1 + t^2 } , \text{ d } x = 2 \frac{ \text{ d } t }{ 1 + t^2 }$.</p>
<h5><span id="无理函数的不定积分">无理函数的不定积分</span></h5><p>我们考虑以下几类无理函数:</p>
<p>第一类是$R ( x , \sqrt[m]{ \frac{ ax + b }{ cx + d } } )$的形式.只需做换元$t^m = \frac{ a_1 x + b_1 }{ a_2 x + b_2 }$,立刻得到原式其实就是$R ( \frac{ b_2 t^m - b_1 }{ a_1 - a_2 t^m } , t )$,并且$\text{ d } x$也可以转化到$\text{ d } t$.</p>
<p>第二类是形如$\int x^m ( a + bx^n )^p \text{ d } x$,其中$m , n , p \in \mathbb{ Q }$.</p>
<p>令$t = x^n$,上式就变成了$\frac{ 1 }{ n } \int t^{ \frac{ m + 1 }{ n } - 1 } ( a + bt )^p \text{ d } t$.令$q = \frac{ m + 1 }{ n } - 1$.我们只需要做$\frac{ 1 }{ n } \int t^q ( a + bt )^p \text{ d } t = \frac{ 1 }{ n } \int t^{ p + q } ( \frac{ a + bt }{ t } )^p$.事实上,下面三种情况可以积出来:</p>
<ol>
<li><p>$p \in \mathbb{ Z }$.</p>
</li>
<li><p>$q \in \mathbb{ Z }$.</p>
</li>
<li><p>$p + q \in \mathbb{ Z }$.</p>
</li>
</ol>
<p>其它的都无初等形式.</p>
<p>第三类是形如$R ( x , \sqrt{ ax^2 + bx + c } )$,不妨假设$b^2 - 4 ac \ne 0 , a \ne 0$.</p>
<ol>
<li><p>$b^2 - 4 ac &gt; 0$,则有两个实根$\alpha &gt; \beta$,此时提一下实根就可以知道原式等于$R ( x , ( x - \beta ) \sqrt{ \frac{ a ( x - \alpha ) }{ x - \beta } } )$,这就能做了.</p>
</li>
<li><p>$b^2 - 4 ac &lt; 0$,则无实根,不妨假设$a &gt; 0$.则做$t - \sqrt{ a } x = \sqrt{ ax^2 + bx + c }$并两边平方就可以反解出$x = \frac{ t^2 - c }{ b + 2 \sqrt{ a } t }$,原本的积分就变成了关于$t$的有理函数的积分.</p>
</li>
</ol>
<h5><span id="双曲换元">双曲换元</span></h5><p>引入双曲三角函数$\sinh ( x ) = \frac{ e^x - e^{ - x } }{ 2 } , \cosh = \frac{ e^x + e^{ - x } }{ 2 }$以及$\tanh ( x ) = \frac{ \sinh ( x ) }{ \cosh ( x ) }$.留意到$\cosh^2 - \sinh^2 = 1$.以及:</p>
<ol>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \sinh ( x ) = \cosh ( x )$</p>
</li>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \cosh ( x ) = \sinh ( x )$</p>
</li>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \tanh ( x ) = \frac{ 1 }{ \cosh^2 ( x ) } = 1 - \tanh^2 ( x )$</p>
</li>
</ol>
<p>应当发现:</p>
<ol>
<li><p>$\sinh ( 2 x ) = 2 \sinh ( x ) \cosh ( x )$</p>
</li>
<li><p>$\cosh ( 2 x ) = \cosh^2 ( x ) + \sinh^2 ( x ) = 2 \cosh^2 ( x ) - 1 = 1 + 2 \sinh^2 ( x )$</p>
</li>
</ol>
<p>另外其反函数应当是:</p>
<ol>
<li><p>$\text{ arsinh } ( x ) = \ln ( x + \sqrt{ x^2 + 1 } )$</p>
</li>
<li><p>$\text{ arcosh } ( x ) = \ln ( x + \sqrt{ x^2 - 1 } )$</p>
</li>
</ol>
<p>应当发现:</p>
<ol>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \text{ arsinh } ( x ) = \frac{ 1 }{ \sqrt{ x^2 + 1 } }$</p>
</li>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \text{ arcosh } ( x ) = \frac{ 1 }{ \sqrt{ x^2 - 1 } }$</p>
</li>
<li><p>$\frac{ \text{ d } }{ \text{ d } x } \text{ artanh } ( x ) = \frac{ 1 }{ 1 - x^2 }$</p>
</li>
</ol>
<h6><span id="example1">Example1</span></h6><p>求$I = \int \frac{ \text{ d } x }{ \sqrt{ x^2 \pm a^2 } }$,其中$a &gt; 0$.</p>
<p>于是$\int \frac{ \text{ d } x }{ \sqrt{ x^2 \pm a^2 } } = \ln | x + \sqrt{ x^2 \pm a^2 } | + C$.</p>
<h6><span id="example2">Example2</span></h6><p>求$I = \int \sqrt{ a^2 - x^2 } \text{ d } x$.</p>
<p>考虑三角换元,应当小心符号,这里注意到$x \in [ - a , a ]$,因此直接取$x = a \sin t$,$t \in [ - \frac{ \pi }{ 2 } , \frac{ \pi }{ 2 } ]$,此时$\cos t \geq 0$恒成立,则有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = a^2 \int \cos^2 t \text{ d } t \\
& = a^2 \int \frac{ 1 + \cos ( 2 t ) }{ 2 } \text{ d } t \\
& = \frac{ a^2 t }{ 2 } + \frac{ a^2 }{ 4 } \sin ( 2 t ) + C \\
& = \frac{ 1 }{ 2 } ( x \sqrt{ a^2 - x^2 } + a^2 \arcsin \frac{ x }{ a } ) + C
\end{aligned}</script><h6><span id="example3">Example3</span></h6><p>求$I = \int \sqrt{ x^2 \pm a^2 } \text{ d } x$.</p>
<p>使用双曲换元,先考虑$\int \sqrt{ x^2 + a^2 } \text{ d } x$的情况,此时换$x = a \sinh t$,$\cosh t \geq 0$,根号是平凡开出的,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = a^2 \int \cosh^2 t \text{ d } t \\
& = a^2 \int \frac{ 1 + \cosh ( 2 t ) }{ 2 } \text{ d } t \\
& = \frac{ a^2 t }{ 2 } + \frac{ a^2 }{ 4 } \sinh ( 2 t ) + C \\
& = \frac{ 1 }{ 2 } ( x \sqrt{ x^2 + a^2 } + a^2 \text{ arsinh } \frac{ x }{ a } ) + C
\end{aligned}</script><p>另一个同理,仍然使用双曲换元,结果是$\frac{ 1 }{ 2 } ( x \sqrt{ x^2 - a^2 } + a^2 \text{ arcosh } \frac{ x }{ a } ) + C$</p>
<h5><span id="椭圆积分">椭圆积分</span></h5><p>以下是几个常见的无初等形式的积分:</p>
<ol>
<li><p>$\int \frac{ e^x }{ x } \text{ d } x$.</p>
</li>
<li><p>$\int \frac{ \text{ d } x }{ \ln x }$.</p>
</li>
<li><p>$\int \frac{ \sin x }{ x } \text{ d } x$.</p>
</li>
<li><p>$\int \frac{ \cos x }{ x } \text{ d } x$.</p>
</li>
<li><p>$\int e^{ x^2 } \text{ d } x$.</p>
</li>
</ol>
<p>另外还有一类椭圆积分也无初等形式:设$R ( x , y )$是二元有理函数,其中$y = \sqrt{ P_3 ( x ) }$或$\sqrt{ P_4 ( x ) }$,也即根号下放了个三次或者四次多项式,那么$\int R ( x , y ) \text{ d } x$可能很难有初等形式.这样的积分可以被归结为三类椭圆积分.</p>
<p>首先说明$R ( x , \sqrt{ P_3 ( x ) } )$可以转化,原因是$P_3 ( x ) = 0$一定有至少一个实数解,任意取出一个设为$\lambda$,则$P_3 ( x ) = ( x - \lambda ) P_2 ( x )$,令$t^2 + \lambda = x$,带入可以转化为$R ( t^2 + \lambda , \sqrt{ P_2 ( t^2 + \lambda ) } ) = R_1 ( t , \sqrt{ P_4 ( t ) } )$.这就意味着其实根号下四次多项式是更本质一些的.</p>
<p>而四次多项式可以分解为$P_4 ( x ) = a ( x^2 + p_1 x + q_1 ) ( x^2 + p_2 x + q_2 )$.不妨假设其无重根(如果有重根的话,那么根号下就可以开出去一部分,那就可积了),设其四个根(可能有复根)分别为$\alpha_1 , \beta_1 , \alpha_2 , \beta_2$,并且$\alpha_1 , \beta_1$是上述分解中前半部分的根,特别地,如果这是四个实根,则不妨调整它们的顺序使得$\alpha_1 &gt; \beta_1 &gt; \alpha_2 &gt; \beta_2$.那么根据韦达定理总有:$p_1 = - ( \alpha_1 + \beta_1 ) , q_1 = \alpha_1 \beta_1$,后半部分同理.</p>
<p>我们尝试把这两个式子的一次项都去掉,当$p_1 = p_2$的时候可以直接一起配方令$x = t - \frac{ p }{ 2 }$.当$p_1 \ne p_2$的时候,尝试换元用$t$代替$x$,不妨设$x = \frac{ u t + v }{ 1 + t }$,那么$( x^2 + p_1 x + q_1 ) = \frac{ P_2 ‘ ( t ) }{ ( 1 + t )^2 }$.为了让其没有一次项应当解以下方程:</p>
<script type="math/tex; mode=display">
\begin{cases}
2 u v + p_1 ( u + v ) + 2 q_1 = 0 \\
2 u v + p_2 ( u + v ) + 2 q_2 = 0
\end{cases}</script><p>此时可以解出来$\begin{cases}u + v = - \frac{ 2 ( q_1 - q_2 ) }{ p_1 - p_2 } \ u v = \frac{ p_2 q_1 - p_1 q_2 }{ p_1 - p_2 }\end{cases}$,为了解出$u , v$是两个实数,应当检验$( u + v )^2 - 4 uv \geq 0$是否成立.带入韦达定理发现左边等于$( \alpha_1 - \alpha_2 ) ( \alpha_1 - \beta_2 ) ( \beta_1 - \alpha_2 ) ( \beta_1 - \beta_2 ) &gt; 0$.原因是如果是四个实根,则根据假设立刻得到.如果存在复根则配对一下复根也可以立刻得到.</p>
<p>总之,在上面的一系列操作后,我们要研究的形式统一成了$R ( t , y = \sqrt{ A ( 1 + m_1 t^2 ) ( 1 + m_2 t^2 ) } ) = \frac{ a ( t ) + b ( t ) y }{ c ( t ) + d ( t ) y } = B_1 ( t ) + B_2 ( t ) y$,其中$B_1 ( t ) , B_2 ( t )$都是$t$的有理函数.前者可以直接积分拆出去,那我们关心的就只剩下后面的$B_2 ( t ) y = \frac{ B_2 ( t ) y }{ y }$的部分.</p>
<p>我们之前已经提过可以将一个函数拆为偶函数和奇函数之和,事实上:</p>
<script type="math/tex; mode=display">
R ( t ) = \frac{ R ( t ) + R ( - t ) }{ 2 } + \frac{ R ( t ) - R ( - t ) }{ 2 } = R_1 ( t^2 ) + tR_2 ( t^2 )</script><p>那么后者立刻可以换元积分,只剩下前者做不动.剩下的形式是:$\int \frac{ R ( t^2 ) }{ \sqrt{ A ( 1 + m_1 t^2 ) ( 1 + m_2 t^2 ) } } \text{ d } t$,其中$A$可以先扔出去一些,使得$A = \pm 1$.而且由于被积函数是偶函数,所以还可以不妨设$t \geq 0$.由于根号下不能变成二次函数(不然就直接做完了),还不妨设$m_1 \ne m_2 , m_1 \ne 0 , m_2 \ne 0$.下面开始讨论:</p>
<ol>
<li>$A = 1$,$m_1 = - h_1^2 , m_2 = - h_2^2 , h_1 &gt; h_2 &gt; 0$.</li>
</ol>
<p>此时令$t = \frac{ z }{ h_1 }$带入化简变形再扔出去点常数得到原式变化为$\int \frac{ R ( z^2 ) }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \text{ d } z$,其中$k = \frac{ h_2 }{ h_1 }$.</p>
<ol>
<li>$A = 1$,$m_1 = - h_1^2 , m_2 = h_2^2 , h_1 &gt; 0 , h_2 &gt; 0$.</li>
</ol>
<p>此时令$t = \frac{ \sqrt{ 1 - z^2 } }{ h_1 }$.扔出去一些常数仍然可以化简成(1)的形式,只是$k = \frac{ h_2 }{ \sqrt{ h_1^2 + h_2^2 } }$.</p>
<ol>
<li>$A = 1 , m_1 = h_1^2 , m_2 = h_2^2 , h_1 &gt; h_2 &gt; 0$.</li>
</ol>
<p>令$t = \frac{ z }{ h_1 \sqrt{ 1 - z^2 } }$.扔出去一些常数仍然是(1)的形式,只是$k = \frac{ \sqrt{ h_1^2 - h_2^2 } }{ h_1 }$.</p>
<ol>
<li>$A = - 1$,$m_1 = - h_1^2 , m_2 = h_2^2 , h_1 &gt; 0 , h_2 &gt; 0$.</li>
</ol>
<p>令$t = \frac{ 1 }{ h_1 \sqrt{ 1 - z^2 } }$,还是(1)的形式,只是$k = \frac{ h_1 }{ \sqrt{ h_1^2 + h_2^2 } }$.</p>
<ol>
<li>$A = - 1$,$m_1 = - h_1^2 , m_2 = - h_2^2 , h_1 &gt; h_2 &gt; 0$.</li>
</ol>
<p>令$t = \frac{ \sqrt{ 1 - \frac{ h_1^2 - h^2_2 }{ h_1^2 } z^2 } }{ h_2 }$,还是(1),只是$k = \frac{ \sqrt{ h_1^2 - h_2^2 } }{ h_1 }$.</p>
<p>这样就全都转化为了$\int \frac{ R ( z^2 ) }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \text{ d } z$的形式了.然后把$R ( z^2 )$给拆开,那么这个式子就应该是$I_n = \int \frac{ z^{ 2 n } }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \text{ d } z$和$H_m = \int \frac{ \text{ d } z }{ ( z^2 - a )^m \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } }$的线性组合,注意这里系数有可能是复数.</p>
<p>此时注意到</p>
<script type="math/tex; mode=display">
\begin{aligned}
& ( z^{ 2 n - 3 } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } ) ' \\
= & ( 2 n - 3 ) z^{ 2 n - 4 } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } + z^{ 2 n - 3 } \frac{ 2 k^2 z^3 - ( k^2 + 1 ) z }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \\
= & \frac{ ( 2 n - 3 ) z^{ 2 n - 4 }{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } + z^{ 2 n - 3 } ( 2 k^2 z^3 - ( k^2 + 1 ) z ) }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \\
= & \frac{ ( 2 n - 1 ) k^2 z^{ 2 n } - ( 2 n - 2 ) ( k^2 + 1 ) z^{ 2 n - 2 } + ( 2 n - 3 ) z^{ 2 n - 4 } }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } }
\end{aligned}</script><p>两边积分得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& ( 2 n - 1 ) k^2 I_n - ( 2 n - 2 ) ( k^2 + 1 ) I_{ n - 1 } + ( 2 n - 3 ) I_{ n - 2 } \\
= & z^{ 2 n - 3 } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) }
\end{aligned}</script><p>上述只要$n$是整数就行,甚至不需要$n$是正的.所以所有的$I_n$,包括负整数$n$,都可以被$I_0 , I_1$表示.</p>
<p>接下来看$H_m$,当$a = 0$的时候无非是$H_m = I_{ - m }$,</p>
<p>接下来注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& ( \frac{ z }{ ( z^2 - a )^{ m - 1 } } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } ) ' \\
= & \frac{ ( 2 - 2 m ) z^2 + z^2 - a }{ ( z^2 - a )^m } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } \\
+ \frac{ 2 k^2 z^4 - ( k^2 + 1 ) z^2 }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } \frac{ 1 }{ ( z^2 - a )^{ m - 1 } } \\

\end{aligned}</script><p>令$C = \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) }$,$W = z^2 - a$,那么$C^2 = k^2 ( W + a )^2 - ( k^2 + 1 ) ( W + a ) + 1$.上式化简为:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& = \frac{ ( 2 - 2 m ) ( W + a ) C^2 }{ W^m C } + \frac{ C^2 + 2 k^2 ( W + a )^2 - ( k^2 + 1 ) ( W + a ) }{ W^{ m - 1 } C } \\
& = \frac{ ( 2 - 2 m ) ( W + a ) ( k^2 ( W + a )^2 - ( k^2 + 1 ) ( W + a ) + 1 ) }{ W^m C } \\
+ \frac{ 3 k^2 ( W + a )^2 - 2 ( k^2 + 1 ) ( W + a ) + 1 }{ W^{ m - 1 } C }
\end{aligned}</script><p>接下来是繁复的化简,然后两边积分得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ z }{ ( z^2 - a )^{ m - 1 } } \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } \\
= & ( 2 m - 2 ) ( - a + ( k^2 + 1 ) a^2 - k^2 a^3 ) H_m \\
- ( 2 m - 3 ) ( 1 - 2 a ( k^2 + 1 ) + 3 k^2 a^2 ) H_{ m - 1 } \\
+ ( 2 m - 4 ) ( k^2 + 1 - 3 k^2 a ) H_{ m - 2 } \\
- ( 2 m - 5 ) k^2 H_{ m - 3 }
\end{aligned}</script><p>而注意到$H_0 = I_0 , H_{ - 1 } = I_1 - aI_0$.</p>
<p>综上,所有的椭圆积分都可以由$I_0 , I_1 , H_1$表示.也就是椭圆积分可以转化为以下三种积分:</p>
<ol>
<li><p>$\int \frac{ \text{ d } z }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } }$.</p>
</li>
<li><p>$\int \frac{ z^2 \text{ d } z }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } }$.</p>
</li>
<li><p>$\int \frac{ \text{ d } z }{ ( 1 + hz^2 ) \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } }$,其中$h$可以是复数.</p>
</li>
</ol>
<p>有意思的是如果令$z = \sin \varphi$,$\text{ d } z = \sqrt{ 1 - z^2 } \text{ d } \varphi$,这样形式就好看了很多.椭圆积分可以用以下的优美形式表示:</p>
<ol>
<li><p>$E ( k , \varphi ) = \int \frac{ \text{ d } \varphi }{ \sqrt{ 1 - k^2 \sin^2 \varphi } }$.</p>
</li>
<li><p>$F ( k , \varphi ) = \int \sqrt{ 1 - k^2 \sin^2 \varphi }  \text{ d } \varphi$.</p>
</li>
<li><p>$\Pi ( h , k , \varphi ) = \int \frac{ \text{ d } \varphi }{ ( 1 + h \sin^2 \varphi ) \sqrt{ 1 - k^2 \sin^2 \varphi } }$,其中$h$可以是复数.</p>
</li>
</ol>
<p>其中:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int \frac{ z^2 \text{ d } z }{ \sqrt{ ( 1 - z^2 ) ( 1 - k^2 z^2 ) } } & = \int \frac{ \sin^2 \varphi \text{ d } \varphi }{ \sqrt{ 1 - k^2 \sin^2 \varphi } } \\
& = \int ( \frac{ 1 }{ k^2 \sqrt{ 1 - k^2 \sin^2 \varphi } } \text{ ) } - \frac{ 1 - k^2 \sin^2 \varphi }{ k^2 \sqrt{ 1 - k^2 \sin^2 \varphi } } \text{ ) } d \varphi \\
& = \frac{ E ( k , \varphi ) }{ k^2 } - \frac{ F ( k , \varphi ) }{ k^2 }
\end{aligned}</script><h4><span id="黎曼积分">黎曼积分</span></h4><p>设$f ( x )$是定义在$[ a , b ]$上的函数,对于区间$[ a , b ]$插入分点$x_i ( i = 0 , 1 , \cdots , n )$,且有$a = x_0 &lt; x_1 &lt; \cdots &lt; x_n = b$,我们称之为对区间$[ a , b ]$的一种<strong>分割</strong>,并记为$\Delta$.又记$\Delta x_i = x_i - x_{ i - 1 } , i \in [ 1 , n ]$,$\lambda ( \Delta ) = \max \{ \Delta x_i \mid i \in [ 1 , n ] \}$,并定义黎曼和$S_\Delta = \sum_{ i = 1 }^n f ( \xi_i ) \Delta x_i$.</p>
<p>若存在实数$J$,对$\forall \epsilon &gt; 0 , \exists \delta &gt; 0$,对于任意分划,只要$\lambda ( \Delta ) &lt; \delta$,都有$| S_\Delta - J | &lt; \epsilon \\$,则称$f ( x )$在$[ a , b ]$上<strong>黎曼可积</strong>,这个$J$为$f ( x )$在$[ a , b ]$上的<strong>定积分</strong>,记作$\int_{ a }^b f ( x ) \text{ d } x \\$.容易见到定积分唯一,证明无非也是拿$\epsilon$去卡.</p>
<p>对于$[ a , b ]$上的连续函数,定积分实际上就是其与$f ( x )$围成面积的代数和.</p>
<p>由此可以顺便定义<strong>达布上下和</strong>,即令$m_i = \inf_{ [ x_{ i - 1 } , x_i ] } f ( x ) , M_i = \sup_{ [ x_{ i - 1 } , x_i ] } f ( x )$,并定义<strong>振幅</strong>$w_i = M_i - m_i$,特别地定义$M = \sup ( M_i ) , m = \inf ( m_i )$.定义$\overline{ S }_\Delta = \sum M_i \Delta x_i , \underline{ S }_{ \Delta } = \sum m_i \Delta x_i$.</p>
<p>并在此基础上定义上下积分,上积分$\overline{ \int_a^b } f ( x ) \text{ d } x = \inf \overline{ S }_\Delta , \underline{ \int_a^b } f ( x ) \text{ d } x = \sup \underline{ S }_\Delta$.上下积分显然都是存在的,我们会在后面证明黎曼可积等价于上下积分相等.</p>
<p>为了方便,我们约定:</p>
<ol>
<li><p>$a = b$,$\int_a^b f ( x ) \text{ d } x = 0$.</p>
</li>
<li><p>$a &gt; b$,$\int_a^b f ( x ) \text{ d } x = - \int_b^a f ( x ) \text{ d } x$.</p>
</li>
</ol>
<p>下列性质应当是成立的:</p>
<ol>
<li><p>(必要条件)如果一个函数黎曼可积,则它在该闭区间上有界.</p>
</li>
<li><p>对于任意分划任取$\xi$,都有$\underline{ S }_\Delta \leq S_\Delta ( \xi ) \leq \overline{ S }_\Delta$.</p>
</li>
<li><p>$\forall \epsilon &gt; 0$,$\exists \xi_1 , \xi_2$,使得$\underline{ S }_\Delta - \epsilon \leq S_\Delta ( \xi_1 )$,$\overline{ S }_\Delta + \epsilon \geq S_\Delta ( \xi_2 )$.</p>
</li>
</ol>
<p>再定义所谓加细:如果$\Delta_1 \subseteq \Delta_2$,那么称$\Delta_2$是$\Delta_1$的加细.此时应当有$\overline{ S }_{ \Delta_1 } \geq \overline{ S }_{ \Delta_2 } , \underline{ S }_{ \Delta_1 } \leq \underline{ S }_{ \Delta_2 }$.另外容易注意到如果$| \Delta_2 \setminus \Delta_1 | = k$,那么$0 \leq \overline{ S }_{ \Delta_1 } - \overline{ S }_{ \Delta_2 } \leq k \lambda ( \Delta_1 ) ( M - m )$,原因是考虑把这些新的断点一个一个加上去,每次加一个会新断开原本的断点,此时最多造成$( M - m ) \Delta x \leq ( M - m ) \lambda ( \Delta_1 )$的差.注意到此时这些东西似乎全都可以被限制住.</p>
<p>这同样给出了原因:为什么我们会定义上下积分呢?因为随着分点的加多,也就是随着划分的加细,达布上下和会分别单调递减或递增,这样就应当存在一个极限,然而问题在于我们难以在划分上定义序,这样就少了某种极限的方式.然而,我们试图绕开来找到一种确定的能探到极限的方式.</p>
<p>另外的结论是对于任意两个分划$\Delta_1 , \Delta_2$,总有$\underline{ S }_{ \Delta_1 } \leq \overline{ S }_{ \Delta_2 }$.原因是$\Delta = \Delta_1 \cup \Delta_2$,立刻见到$\underline{ S }_{ \Delta_1 } \leq \underline{ S }_{ \Delta } \leq \overline{ S }_\Delta \leq \overline{ S }_{ \Delta_2 }$.这意味着$\overline{ \int } f \geq \underline{ \int } f$.</p>
<p>接下来证明定积分中的<strong>达布定理</strong>,也就是$\forall \epsilon &gt; 0 , \exists \delta &gt; 0$,$\forall \Delta , \lambda ( \Delta ) &lt; \delta$的时候,$0 \leq \overline{ S }_\Delta - \overline{ \int_a^b } f ( x ) \text{ d } x \leq \epsilon$.换言之$\lim_{ \lambda ( \Delta ) \to 0 } \overline{ S }_{ \Delta } = \overline{ \int_a^b } f ( x ) \text{ d } x$,当然下积分也是同理的.</p>
<p>这个的证明考虑先用上积分的定义,应当存在一个$\Delta ‘$,满足$0 \leq \overline{ S }_{ \Delta ‘ } - \overline{ \int_a^b } f ( x ) \text{ d } x \leq \frac{ \epsilon }{ 2 }$.不妨设$| \Delta ‘ | = n_0$,接下来取$\delta &lt; \frac{ \epsilon }{ 2 n_0 ( M - m ) }$,那么接下来对于$\forall \Delta , \lambda ( \Delta ) &lt; \delta$的时候,取$\Delta^<em> = \Delta ‘ \cup \Delta$,根据上面我们证明的步骤,这里最多会多$n_0$个断点,自然得知$\overline{ S }_{ \Delta } - \overline{ S }_{ \Delta^</em> } \leq n_0 \lambda ( \Delta ) ( M - m ) &lt; \frac{ \epsilon }{ 2 }$.</p>
<p>这样的话就可以注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \overline{ S }_\Delta - \overline{ \int_a^b } f ( x ) \text{ d } x \\
= & ( \overline{ S }_{ \Delta ' } - \overline{ \int_a^b } f ( x ) \text{ d } x ) - ( \overline{ S }_{ \Delta ' } - \overline{ S }_{ \Delta } ) \\
< & \frac{ \epsilon }{ 2 } - ( \overline{ S }_{ \Delta^* } - \overline{ S }_\Delta ) < \epsilon
\end{aligned}</script><p>这里可以证明原函数可积的充分必要条件是上下积分相等.</p>
<p>首先证明充分性:当上下积分相等的时候,设其为$J$,取足够小的$\epsilon$,由上知道$\exists \delta &gt; 0$,使得$J - \epsilon &lt; \underline{ S }_\Delta \leq S_\Delta ( \xi ) \leq \overline{ S }_\Delta &lt; J + \epsilon$,夹逼一下立刻知道其满足.</p>
<p>然后证明必要性:当原函数可积分的时候,只要分点足够密,应当有$J - \epsilon &lt; \underline{ S }_\Delta \leq \underline{ \int } f ( x ) \text{ d } x \leq \overline{ \int } f ( x ) \text{ d } x \leq \overline{ S }_\Delta &lt; J + \epsilon$.</p>
<p>而由于我们可以见到上和与下和应当是错开来的,而如果它们中间能接上自然意味着上下积分相等.因此推论为:如果$f$在闭区间上有界并且$\forall \epsilon , \exists \Delta$使得$0 \leq \overline{ S }_\Delta - \underline{ S }_\Delta \leq \epsilon$,则$f$可积.我们最初拿到的那个定义也可以这么改:只需要存在一个分划而不需要使得任意分划都这么满足.方式就是用我们已经找到的这个去并我们想要限制的那个,然后把限制延后一点使得这些全被限制住.</p>
<p>由上述可以证明闭区间上的连续函数一定是闭区间上的可积函数.原因是闭区间上的连续函数一定是一致连续函数,那么对于一个$\epsilon$,可以找到一个$\delta$控制住区间长度,使得极差$&lt; \epsilon$.此时直接找一个$\Delta$,注意到$\overline{ S } - \underline{ S } = \sum ( M_i - m_i ) \Delta x_i \leq \sum \epsilon \Delta x \leq ( b - a ) \epsilon$,只需取$\epsilon \to 0$就可以搞定.</p>
<p>还可以证明如果$f$在闭区间上有界并且只有有限个间断点,那么$f$可积.原因也很简单,只需要拿足够小的区间把这有限个间断点盖住,然后外面继续如上操作,间断点处尽可能缩小区间长度来取出其影响.</p>
<p>还可以证明单调函数一定可积,原因是$\overline{ S } - \underline{ S } \leq \delta ( f ( b ) - f ( a ) ) \to 0$.</p>
<h5><span id="可积性与连续性的关系勒贝格定理">可积性与连续性的关系(勒贝格定理)</span></h5><p>我们还可以进一步探索黎曼可积和连续性的关系,例如,我们可以证明:$\forall f \in R [ a , b ] , \forall \epsilon &gt; 0 , \exists g \in C [ a , b ] \int_a^b | f ( x ) - g ( x ) | \text{ d } x &lt; \epsilon$.</p>
<p>如何证明呢?感觉上只需要用分段线性函数去逼近一下就可以了对吧.所以我们考虑对于划分$\Delta$,直接把所有的$( x_i , f ( x_i ) )$连起来形成一个分段线性函数.然后观察此时的$| f - g |$,不妨分段考虑,对于$\int_{ x_{ i - 1 } }^{ x_i } ( f - g ) ( x ) \text{ d } x \leq ( M_i - m_i ) \Delta x_i$,而后者求和之后实际上就是$\overline{ S } - \underline{ S }$,当$f$可积的时候这个当然会趋近于$0$.</p>
<p>我们还可以证明$f \in R [ a , b ]$的连续点在$[ a , b ]$上稠密,只需要证明$\forall [ \alpha , \beta ] \in R [ a , b ] , \alpha &lt; \beta$,$[ \alpha , \beta ]$这个区间内存在连续点即可.考虑定义一点处的振幅$w_{ f } ( x_0 ) = \lim_{ \delta \to + 0 } w_f ( x_0 - \delta , x_0 + \delta )$,这个随着$\delta$缩小当然应当是单调不增的,因此一定有非负极限(但可能是无穷大).我们注意到$f$在$x_0$处连续的充要条件是$f$在$x_0$处的振幅为$0$.必要性和充分性都容易证明.</p>
<p>我们考虑用区间套来找到这个连续点,考虑对于$[ \alpha_0 , \beta_0 ] \in [ a , b ]$,取分划$\Delta_0$使得$\sum w_i \Delta x_i &lt; \frac{ 1 }{ 2 } ( \beta_0 - \alpha_0 )$,并且加细使得$\lambda ( \Delta_0 ) &lt; \frac{ 1 }{ 2 } ( \beta_0 - \alpha_0 )$,注意这里的两个$\frac{ 1 }{ 2 }$其实用处不同,前者是为了让$w_i$足够小,后者是为了让区间长度足够小.此时考虑由于$\sum \Delta x_i = \beta_0 - \alpha_0$,所以一定存在一个$w_i &lt; \frac{ 1 }{ 2 }$,拿出这个区间作为$[ \alpha_1 , \beta_1 ]$,则区间长度至少折半,并且只需在上述对$[ \alpha_n , \beta_n ]$时取$\sum w_i \Delta x_i &lt; \frac{ 1 }{ 2^{ n + 1 } } ( \beta_0 - \alpha_0 )$就可以使得$w_i$也趋近于$0$,这样就能用区间套找到一个点使得它是连续点.</p>
<p>事实上可以证明一个函数黎曼可积的充分必要条件是其有界并且几乎处处连续.</p>
<p>为了方便不妨把$f$延拓到整个实轴,令$f ( x ) = \begin{cases}f ( a ) &amp; x \leq a \ f ( b ) &amp; x \geq b \ f ( x ) &amp; \text{ otherwise }\end{cases}$.</p>
<p>下面定义$E_r = \{ x_0 \mid w_f ( x_0 ) \geq \frac{ 1 }{ r } \}$.我们考虑证明其是闭集,也就是证明其补集$E_r^c = \{ x_0 \in ( a , b ) \mid w_f ( x_0 ) &lt; \frac{ 1 }{ r } \}$是开集.如果$x_0 \in E_r^c$,注意到此时$\exists \delta &gt; 0 , w_f ( x_0 - \delta , x_0 + \delta ) &lt; \frac{ 1 }{ r }$,那么这必然意味着$x_0$邻域中的点的振幅也会$&lt; \frac{ 1 }{ r }$,这当然意味着其是开集.</p>
<p>令$D$是$f$的间断点集,容易见到$D = \bigcup_{ n = 1 }^{ \infty } E_n$,下面只需要证明每个$E_n$都是零测集即可.</p>
<p>先证明必要性:当$f \in R [ a , b ]$时,则$f$有界,现在对于固定的$m$,尝试证明$E_m$是零测的,由达布定理,$\forall \epsilon &gt; 0$,$\exists \Delta$,使得$\sum w_i \Delta x_i = \overline{ S }_\Delta - \underline{ S }_\Delta &lt; \epsilon$.</p>
<p>观察前者,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\epsilon & > \sum w_i \Delta x_i = \overline{ S }_\Delta - \underline{ S }_\Delta \\
& = \sum_{ E_m \cap ( x_{ k - 1 } , x_k ) \ne \emptyset } w_k \Delta x_k + \sum_{ E_m \cap ( x_{ k - 1 } , x_k ) = \emptyset } w_k \Delta x_k \\
& \geq \frac{ 1 }{ m } \sum_{ E_m \cap ( x_{ k - 1 } , x_k ) \ne \emptyset } \Delta x_k
\end{aligned}</script><p>因此$m^* ( E_m ) \leq \sum_{ E_m \cap ( x_{ k - 1 } , x_k ) \ne \emptyset } \Delta x_k &lt; m \epsilon$,由于$m$一开始就固定,$\epsilon$可以尽量小,所以这意味着$E_m$是零测集.必要性得证.</p>
<p>再证明充分性:当每一个$E_m$都是零测集的时候,$\forall \epsilon &gt; 0$,取$r \in N_+ , r &gt; \frac{ 1 }{ \epsilon }$.此时见到$E_{ r }^c$是开集,那它可以写成若干两两不交开区间的并,不妨记作$E_r^c = \bigcup_{ k = 1 }^{ \infty } T_k$.由于此时$E_m$是零测集,这意味着$\sum | T_k | = b - a$.接下来可以取足够大的$n$使得$\sum_1^n | T_k | &gt; b - a - \frac{ \epsilon }{ 2 }$,接下来取$T_k$的闭子区间$J_k$,使得$\sum_1^n | J_k | &gt; b - a - \epsilon$.这里为什么要把开区间再进一步缩成闭区间呢?原因是你这里如果直接用开区间构造分划可能会把端点处给包进去,因此我们不得不设其端点处的一部分值拿到闭区间,这样那些振幅较大的就被舍弃了.</p>
<p>接下来考虑由于每个点$x_0 \in J_k$的$w_f ( x_0 ) &lt; \frac{ 1 }{ r } &lt; \epsilon$,必定有其一个小邻域$( x_0 - \delta , x_0 + \delta )$满足整个邻域的振幅$&lt; \epsilon$,用有限覆盖定理拿出一个开覆盖,然后缩掉这些开覆盖的区间就能拿到一个$J_k$的分划(或者干脆将这些开区间的端点和$J_k$的端点直接当作一个分划),把这些分划全都并起来就得到了一个划分$\Delta$.</p>
<p>此时观察这个划分,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \overline{ S }_\Delta - \underline{ S }_\Delta \\
= & \sum w_k \Delta x_k \\
= & \sum_{ [ x_{ k - 1 } , x_k ] \subseteq \bigcup J_i } w_k \Delta x_k + \sum_{ [ x_{ k - 1 } , x_k ] \subsetneq \bigcup J_i } w_k \Delta x_k \\
< & \epsilon ( b - a ) + ( M - m ) \epsilon
\end{aligned}</script><p>这样就可以使其任意小.</p>
<p>上述证明同样声明了:黎曼可积的充要条件是震荡区间超过某个值的区间长度之和随着细分的增加应当尽可能小.</p>
<p>上述结论立刻能见到比如黎曼函数是黎曼可积的,因为其间断点集就是有理点集,就是零测集.</p>
<h5><span id="可积函数的简单性质">可积函数的简单性质</span></h5><p>不妨设$f , g \in R [ a , b ]$,则:</p>
<ol>
<li><p>$m ( b - a ) \leq \int_a^b f ( x ) \text{ d } x \leq M ( b - a )$.</p>
</li>
<li><p>$f \geq 0$则$\int_a^b f ( x ) \text{ d } x \geq 0$.</p>
</li>
<li><p>$\int_{ a }^b ( f \pm g ) \text{ d } x = \int_a^b f \text{ d } x \pm \int_a^b g \text{ d } x$.</p>
</li>
<li><p>$\int_{ a }^b Cf \text{ d } x = C \int_a^b f \text{ d } x$.</p>
</li>
<li><p>(保序性)$f \geq g$则$\int_a^b f \text{ d } x \geq \int_a^b g \text{ d } x$.事实上只要$f \geq g$在一个稠密子集上成立即可.</p>
</li>
<li><p>如果$c \in [ a , b ]$,那么此时$f \in R [ a , c ] , f \in R [ c , b ]$,并且$\int_a^b f \text{ d } x = \int_a^c f \text{ d } x + \int_c^b f \text{ d } x$.</p>
</li>
<li><p>如果$g$是连续函数,那么$g ( f ( x ) ) \in R [ a , b ]$.</p>
</li>
<li><p>$| f | \in R [ a , b ]$,并且$| \int_a^b f ( x ) \text{ d } x | \leq \int_a^b | f ( x ) | \text{ d } x$.</p>
</li>
<li><p>如果除了一个有限的点集以外,$g = f$,则$g \in R [ a , b ]$并且$\int_a^b g \text{ d } x = \int_a^b f \text{ d } x$.</p>
</li>
<li><p>如果$f \geq 0 , \int_a^b f \text{ d } x = 0$,那么$f$在其连续点集合上恒等于$0$.</p>
</li>
</ol>
<p>(1)(2)是显然的,(3)(4)(5)只需将积分看作黎曼和的极限,(6)的话考虑在$[ a , b ]$上间断点集都是零测的了,那么其子集$[ a , c ] , [ c , b ]$上的间断点集当然也是零测集.</p>
<p>(7)的话考虑一个几乎处处连续的函数在外面套一层连续函数当然也是几乎处处连续的.</p>
<p>(8)的话考虑绝对值函数是连续函数,然后注意到$- | f ( x ) | \leq f ( x ) \leq | f ( x ) |$使用保序性就可以了.</p>
<p>(9)的证明是简单的.但是为什么是有限点集而不是零测集呢?因为如果是无限个点,那么它们不仅会影响自己的连续性,还会影响旁边点的连续性,例如迪利克雷函数.这里可以看出来黎曼函数是有其限制性的,推广到勒贝格积分后会消除这个问题.</p>
<p>(10)的话只需考虑反证法,对于一个连续点$x_0$,如果$f ( x_0 ) &gt; 0$,那么周围应当有一个小邻域也大于$0$,或者干脆用一致连续性取$&gt; \frac{ f ( x ) }{ 2 }$的一个小邻域,这样就反证完了.</p>
<h5><span id="广义原函数">广义原函数</span></h5><p>对于$f ( x ) : I \to \mathbb{ R }$,称$F ( x )$为其<strong>广义原函数</strong>,若$\forall c , d \in I , c &lt; d$满足$\frac{ F ( d ) - F ( c ) }{ d - c } \in [ \inf_{ [ c , d ] } f ( x ) , \sup_{ [ c , d ] } f ( x ) ]$.容易见到原函数一定是广义原函数,原因是拉格朗日中值定理.</p>
<p>应当容易注意到以下命题:</p>
<ol>
<li><p>局部有界函数的广义原函数是局部李氏连续的,故几乎处处有导数.</p>
</li>
<li><p>$f ( x )$在$x_0$处连续,$F ( x )$是$f ( x )$的广义原函数,则$F ‘ ( x_0 )$存在并且恰好等于$f ( x_0 )$.</p>
</li>
</ol>
<p>(1)是显然的.</p>
<p>(2)的证明的话,考虑$| \frac{ F ( x ) - F ( x_0 ) }{ x - x_0 } - f ( x_0 ) | \leq w_f [ x_0 , x ]$,由于$f ( x_0 )$连续,那么此时其振幅$w_f [ x_0 , x ]$在$x \to x_0$时应当趋近于$0$,使用夹逼定理,于是证毕.</p>
<h5><span id="牛顿-莱布尼茨公式微积分基本定理">牛顿-莱布尼茨公式(微积分基本定理)</span></h5><p>先证明一个引理:如果$f ( x ) \in [ a , b ]$,$F ( x )$是其广义原函数,那么$\underline{ \int_a^b } f ( x ) \text{ d } x \leq F ( b ) - F ( a ) \leq \overline{ \int_a^b } f ( x ) \text{ d } x$.</p>
<p>证明的话,只需证明对于任意分划$\Delta$都有$\underline{ S }_\Delta ( f ) \leq F ( b ) - F ( a ) \leq \overline{ S }_\Delta f ( x )$.而注意到$F ( b ) - F ( a ) = \sum F ( x_i ) - F ( x_{ i - 1 } ) = \sum \frac{ F ( x_i ) - F ( x_{ i - 1 } ) }{ x_i - x_{ i - 1 } } \Delta x_i$.而根据广义原函数的定义,$m_i \leq \frac{ F ( x_i ) - F ( x_{ i - 1 } ) }{ x_i - x_{ i - 1 } } \leq M_i$,立刻证毕.</p>
<p>由此显然证明了牛顿-莱布尼茨公式(NL公式):设$f ( x ) \in R [ a , b ]$,并且能找到其一个广义原函数$F ( x )$,则$F ( b ) - F ( a ) = \int_a^b f ( x ) \text{ d } x$.</p>
<p>接下来声明一个定理:如果一个函数$f ( x ) \in R [ a , b ]$,它就存在广义原函数,而且不同的广义原函数最多相差一个常数.</p>
<p>先证明存在性,我们注意到变限积分$F ( x ) = \int_a^x f ( t ) \text{ d } t$显然是$f ( x )$的广义原函数,而且它是处处连续的,只需套用定义就可以证明.</p>
<p>再证唯一性,设$F_1 ( x ) , F_2 ( x )$都是$f ( x )$的广义原函数.根据LN公式,有$F_1 ( x ) - F_1 ( a ) = \int_{ a }^x f ( t ) \text{ d } t = F_2 ( x ) - F_2 ( a )$,立刻有$F_1 ( x ) - F_2 ( x ) = F_1 ( a ) - F_2 ( a ) = C$.</p>
<p>此时回忆到$f ( x )$在$x_0$处连续可以推出$F ( x )$可导,那么反过来是否成立呢?考虑以下经典反例:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F ( x ) & = \begin{cases}
0 & x = 0 \\
x^2 \sin \frac{ 1 }{ x } & \text{ otherwise }
\end{cases} \\
f ( x ) & = F ' ( x ) = \begin{cases}
0 & x = 0 \\
2 x \sin \frac{ 1 }{ x } - \cos \frac{ 1 }{ x } & \text{ otherwise }
\end{cases}
\end{aligned}</script><p>但总之可以看到连续函数一定有原函数.</p>
<p>此时回忆到我们曾经定义过左右上下导数$( F_\pm ) ‘$和$( F^\pm ) ‘$.设$f \in R [ a , b ]$,$F$是$f$的广义原函数,不妨直接设$F ( x ) = \int_a^x f ( t ) \text{ d } t$,那么我们声明$\int_a^b ( F_\pm ) ‘ \text{ d } x = \int_a^b ( F^\pm ) ‘ \text{ d } x = \int_a^b f ( x ) \text{ d } x$.</p>
<p>四个证明类似,只考虑其中之一$F_+ ‘$如何证明.取$m_0 = \inf_{ [ c , d ] } f$,下面令$G ( x ) = F ( x ) - F ( c ) - m_0 ( x - c ) = \int_c^x ( f ( t ) - m_0 ) \text{ d } t$.当$x \in [ c , d ]$时,容易发现$G ( x )$单增.既然如此,其任意左右上下导数当然都$\geq 0$,也就是$( G_+ ) ‘ = ( F_+ ) ‘ - m_0 \geq 0$.同理如果取$M_0 = \sup_{ [ c , d ] } f$的话还可以证明$( F_+ ) ‘ \leq M_0$.</p>
<p>那么就有$w_{ F_+ ‘ } [ c , d ] \leq w_{ f } [ c , d ]$,我们知道$f$是黎曼可积的,也就是$0 \leq \sum w_{ F_+ ‘ } [ x_{ i - 1 } , x_i ] \Delta x_i \leq \sum w_f [ x_{ i - 1 } , x_i ] \Delta x_i &lt; \epsilon$,此时就可以证明其可积性.</p>
<p>而注意到$f$几乎处处连续,$F$几乎处处可导,并且在$f$的连续点处$f ( x ) = F_+ ‘$,这个连续点集当然是稠密集,因此它们的积分相等,这样就做完了.</p>
<h6><span id="example1">Example1</span></h6><p>求$\int_a^b \text{ sgn } ( x ) \text{ d } x$.</p>
<p>注意到$\text{ sgn } ( x )$的广义原函数是$| x |$,所以$\int_a^b \text{ sgn } ( x ) \text{ d } x = | b | - | a |$.</p>
<h6><span id="example2黎曼引理">Example2(黎曼引理)</span></h6><p>设$f \in R [ a , b ] , g \in R [ 0 , T ]$并且$g$在$\mathbb{ R }$上以$T$为周期.求证:</p>
<script type="math/tex; mode=display">
\lim_{ \lambda \to \infty } \int_a^b f ( x ) g ( \lambda x ) \text{ d } x = \cfrac{ \int_0^T g ( x ) \text{ d } x }{ T } \int_a^b f ( x ) \text{ d } x</script><p>首先注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \lim_{ \lambda \to \infty } \int_a^b f ( x ) g ( \lambda x ) \text{ d } x \\
= & \lim_{ \lambda \to \infty } \int_a^b f ( x ) ( g ( \lambda x ) - \cfrac{ \int_0^T g ( x ) \text{ d } x }{ T } + \cfrac{ \int_0^T g ( x ) \text{ d } x }{ T } ) \text{ d } x \\

\end{aligned}</script><p>因此可以用$g ( \lambda x ) - \cfrac{ \int_0^T g ( x ) \text{ d } x }{ T }$代替$g$,这样就能满足$\int_0^T g ( x ) \text{ d } x = 0$.</p>
<p>接下来只需证明$\lim_{ \lambda \to \infty } \int_a^b f ( x ) g ( \lambda x ) \text{ d } x = 0$,不妨设$| f ( x ) | \leq M , | g ( x ) | \leq M$.</p>
<p>考虑对分划$\Delta$,满足$\sum w_i \Delta x_i \leq \epsilon$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_a^b f ( x ) g ( \lambda x ) \text{ d } x | \\
= & | \sum \int_{ x_{ i - 1 } }^{ x_i } ( f ( x ) - f ( x_i ) + f ( x_i ) ) g ( \lambda x ) \text{ d } x | \\
\leq & | \sum \int_{ x_{ i - 1 } }^{ x_i } f ( x_i ) g ( \lambda x ) \text{ d } x | + | \sum \int_{ x_{ i - 1 } }^{ x_i } ( f ( x ) - f ( x_i ) ) g ( \lambda x ) \text{ d } x | \\
\leq & \sum | f ( x_i ) | \cdot | \int_{ x_{ i - 1 } }^{ x_i } g ( \lambda x ) \text{ d } x | + M \sum w_i \Delta x_i \\
\leq & M \sum | \int_{ x_{ i - 1 } }^{ x_i } g ( \lambda x ) \text{ d } x | + M \sum w_i \Delta x_i \\
\leq & M \sum | \frac{ 1 }{ \lambda } \int_{ \lambda x_{ i - 1 } }^{ \lambda x_i } g ( x ) \text{ d } x | + M \epsilon
\end{aligned}</script><p>接下来设$G ( x ) = \int_0^x g ( t ) \text{ d } t$,由于$g$的周期性,而且其在任何一个长度为$T$的区间上积分为$0$,所以$| G ( x ) | \leq W$,那么$\forall x , y , | G ( x ) - G ( y ) | \leq 2 W$.</p>
<p>那么上式就$\leq 2 MW \frac{ n }{ \lambda } + M \epsilon$,这里虽然有个无穷大的$n$,但由于$\lambda$可以尽可能大且在$n$之后决定取值,因此这个影响可以被消除.</p>
<p>这个命题的一个平凡推论是$g ( x ) = \sin ( nx )$:</p>
<script type="math/tex; mode=display">
\lim_{ \lambda \to \infty } \int_a^b f ( x ) \sin ( \lambda x ) \mathrm{ d } x = \lim_{ \lambda \to \infty } \int_a^b f ( x ) \cos ( \lambda x ) \mathrm{ d } x = 0</script><h6><span id="example3">Example3</span></h6><p>求$\lim_{ n \to \infty } I_n$,其中$I_n = \frac{ 1 }{ n^{ 1 + \alpha } } ( \sum_{ k = 1 }^n k^\alpha ) = \frac{ 1 }{ n } \sum_{ k = 1 }^n ( \frac{ k }{ n } )^\alpha$.</p>
<p>注意到$n \to \infty$的时候,上面就等于$\int_0^1 x^\alpha \text{ d } x = \frac{ 1 }{ 1 + \alpha }$.</p>
<h6><span id="example4dirichlet核">Example4(Dirichlet核)</span></h6><p>求$\int_0^{ \frac{ \pi }{ 2 } } \frac{ \sin ( ( 2 n + 1 ) x ) }{ \sin x } \text{ d } x$.</p>
<p>注意到根据积化和差有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \frac{ \pi }{ 2 } } \frac{ \sin ( ( 2 n + 1 ) x ) }{ \sin x } \text{ d } x \\
= & \int_0^{ \frac{ \pi }{ 2 } } ( 1 + 2 \sum_k \cos ( 2 kx ) ) \text{ d } x \\
= & \frac{ \pi }{ 2 } + 2 \sum_{ k } \frac{ 1 }{ 2 k } \sin ( k \pi ) \\
= & \frac{ \pi }{ 2 }
\end{aligned}</script><h6><span id="example5">Example5</span></h6><p>考虑$f \in \mathbb{ R }$,$\forall a &lt; b$,都有$f \in R [ a , b ]$,已知$f ( x ) = \int_0^x f ( t ) \text{ d } t$,求证$f \equiv 0$.</p>
<p>首先注意到变限积分是李氏连续的,因此$f$当然就是局部李氏连续的,因此自然看出$f$在$\mathbb{ R }$上都是连续的.既然如此,那$f$就在$\mathbb{ R }$上处处可导并且$f ‘ ( x ) \equiv f ( x )$,同理还可以看出$f$实际上任意阶可导.理应见到$f$应当和$e^x$有关,凑$g ( x ) = \frac{ f ( x ) }{ e^x }$,则$g ‘ ( x ) = \frac{ f ‘ - f }{ e^x } \equiv 0$,这立刻得到$g ( x ) \equiv C$.</p>
<p>然而$g ( 0 ) = f ( 0 ) = 0$,于是$g \equiv C \equiv 0$,所以$f \equiv 0$.</p>
<h5><span id="换元法">换元法</span></h5><p>不妨设$f \in R [ a , b ] , F ‘ = f$,$\varphi ( t ) : [ \alpha , \beta ] \to [ a , b ]$,$\varphi ( \alpha ) = a , \varphi ( \beta ) = b$,并且$\varphi$可导,而且$f ( \varphi ( t ) ) \varphi ‘ ( t ) \in R [ \alpha , \beta ]$,则:</p>
<script type="math/tex; mode=display">
\int_a^b f ( x ) \text{ d } x = \int_\alpha^\beta f ( \varphi ( t ) ) \varphi ' ( t ) \text{ d } t</script><p>证明的话,考虑考虑NL公式,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( F ( \varphi ( t ) ) ) ' & = f ( \varphi ( t ) ) \varphi ' ( t ) \\
\int_\alpha^\beta ( F ( \varphi ( t ) ) ) ' & = \int_\alpha^\beta f ( \varphi ( t ) ) \varphi ' ( t ) \\
F ( b ) - F ( a ) & = \int_\alpha^\beta f ( \varphi ( t ) ) \varphi ' ( t )
\end{aligned}</script><p>然而回忆到有原函数和是否黎曼可积之间是有区别的,适当调整条件可以得到另一个策略的换元法:不妨设$f \in R [ a , b ] , \varphi ( t ) : [ \alpha , \beta ] \to [ a , b ]$,并且$\varphi ( t )$单增,$\varphi ( \alpha ) = a , \varphi ( \beta ) = b$,$\varphi$可导并且$\varphi ‘ \in R [ \alpha , \beta ]$,则$f ( \varphi ( t ) ) \varphi ‘ ( t ) \in R [ \alpha , \beta ]$且上述积分仍然成立.</p>
<p>策略是对两边做黎曼和,利用$\varphi$的单调性和一致连续性,可以取$S_{ \Delta } = \sum f ( \eta_k ) \Delta x_k$,利用中值定理可以写作$S_{ \Delta } = \sum f ( \varphi ( \xi_k ) ) \varphi ‘ ( \mu_k ) \Delta t_k$.</p>
<p>而另一边的黎曼和$\sigma_{ \Delta ‘ } = \sum f ( \varphi ( \xi_k ) ) \varphi ‘ ( \xi_k ) \Delta t_k$.</p>
<p>只需证明二者之差趋近于$0$,令$M = \sup | f | ,$做差得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum f ( \varphi ( \xi_k ) ) ( \varphi ' ( \xi_k ) - \varphi ' ( \mu_k ) ) \Delta t_k | \\
\leq & M | \sum ( \varphi ' ( \xi_k ) - \varphi ' ( \mu_k ) ) \Delta t_k | \\
\leq & M | \sum w_k \Delta t_k |
\end{aligned}</script><p>而$\varphi$可积,上述趋近于$0$.</p>
<p>这些定理都有点诡异,它们会在RS积分处再详细讨论.</p>
<h6><span id="example1">Example1</span></h6><p>求$\int_0^{ \frac{ \pi }{ 2 } } \frac{ \sin x }{ \sin x + \cos x } \text{ d } x$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \frac{ \pi }{ 2 } } \frac{ \sin x }{ \sin x + \cos x } \text{ d } x \\
= & \int_0^{ \frac{ \pi }{ 4 } } \left ( \frac{ \sin x }{ \sin x + \cos x } + \frac{ \sin ( \frac{ \pi }{ 2 } - x ) }{ \sin ( \frac{ \pi }{ 2 } - x ) + \cos ( \frac{ \pi }{ 2 } - x ) } \right ) \text{ d } x \\
= & \int_0^{ \frac{ \pi }{ 4 } } \frac{ \sin x + \cos x }{ \sin x + \cos x } \text{ d } x \\
= & \frac{ \pi }{ 4 }
\end{aligned}</script><p>其实就是找个点对折.</p>
<h6><span id="example2">Example2</span></h6><p>求$I = \int_0^\pi \frac{ \theta \sin \theta }{ a + b \cos^2 \theta } \text{ d } \theta$,其中$a , b &gt; 0$.</p>
<p>令$\theta = \pi - \varphi$,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = - \int_\pi^0 \frac{ ( \pi - \varphi ) \sin \varphi }{ a + b \cos^2 \varphi } \text{ d } \varphi \\
& = \int_0^\pi \frac{ ( \pi - \varphi ) \sin \varphi }{ a + b \cos^2 \varphi } \text{ d } \varphi \\
& = \pi \int_{ 0 }^\pi \frac{ \sin \varphi }{ a + b \cos^2 \varphi } \text{ d } \varphi - I
\end{aligned}</script><p>移项得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = \frac{ \pi }{ 2 } \int_0^\pi \frac{ - \text{ d } \cos \theta }{ a + b \cos^2 \theta } \\
& = \frac{ \pi }{ \sqrt{ ab } } \arctan \sqrt{ \frac{ b }{ a } }
\end{aligned}</script><h6><span id="example3">Example3</span></h6><p>如果$\forall a &lt; b , f \in R [ a , b ]$,并且$f ( x + y ) = f ( x ) + f ( y )$恒成立,求证$f ( x ) \equiv f ( 1 ) x$.</p>
<p>固定$x$,对$y$从$[ 0 , 1 ]$积分,得到:</p>
<script type="math/tex; mode=display">
f ( x ) = \int_x^{ x + 1 } f ( t ) \text{ d } t - \int_0^1 f ( y ) \text{ d } y</script><p>而变限积分是局部李氏连续的,所以$f ( x )$局部连续,所以$f ( x )$整体连续,立刻得到$f ( x )$可导,立刻得到其是$C^\infty$的.</p>
<p>那就可以两边对$x$求导,得到$\forall y , f ‘ ( x + y ) = f ‘ ( x )$,因此$f ‘ \equiv C$.</p>
<h5><span id="分部积分">分部积分</span></h5><p>设$u , v \in R [ a , b ]$并且均可导,而且$u ‘ , v ‘ \in R [ a , b ]$,则:</p>
<script type="math/tex; mode=display">
( uv ) ' = u ' v + uv '</script><p>从这里能看出$( uv ) ‘$也是黎曼可积的,那就可以用牛顿莱布尼茨公式两边积分得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b uv ' \text{ d } x & = uv \mid_a^b - \int_a^b u ' v \text{ d } x \\
& = \int_a^b u \text{ d } v = uv \mid_a^b - \int_a^b v \text{ d } u
\end{aligned}</script><p>这个版本当然是简单的,那能不能上点难度呢?</p>
<p>不妨考虑$f , g \in R [ a , b ]$,那它们的广义原函数可以取为$F ( x ) = \int_a^x f ( t ) \text{ d } t + A , G ( x ) = \int_a^x g ( t ) \text{ d } t + B$.</p>
<p>则$\int_a^b Fg \text{ d } x = FG \mid_a^b - \int_a^b Gf \text{ d } x$.</p>
<p>先证明一个引理:</p>
<script type="math/tex; mode=display">
\lim_{ \lambda ( \Delta ) \to 0 } \sum_k^n f ( \xi_k ) \int_{ x_{ i - 1 } }^{ x_i } g ( t ) \text{ d } t = \int_a^b f ( x ) g ( x ) \text{ d } x</script><p>证明无非是用黎曼和,设$M = \sup | f |$,直接考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_k^n f ( \xi ) \int_{ x_{ i - 1 } }^{ x_i } g \mathrm{ d } t - \sum_k^n \int_{ x_{ i - 1 } }^{ x_i } fg \text{ d } t | \\
\leq & \sum | f ( \xi_k ) | \int_{ x_{ i - 1 } }^{ x_i } | g ( t ) - g ( \xi_k ) | \text{ d } t + | \sum f ( \xi_k ) g ( \xi_k ) \Delta t_k - \int_a^b f g \text{ d } t | \\
\leq & M \sum w_k ( g ) \text{ d } t + \sum w_k ( fg ) \Delta t_i
\end{aligned}</script><p>这个当然趋向于$0$.</p>
<p>使用abel求和法则,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( FG ) \mid_a^b & = \sum_k ( F ( x_k ) G ( x_k ) - F ( x_{ k - 1 } ) G ( x_{ k - 1 } ) ) \\
& = \sum_k ( F ( x_k ) G ( x_k ) - F ( x_{ k - 1 } ) G ( x_k ) + F ( x_{ k - 1 } ) G ( x_k ) - F ( x_{ k - 1 } ) G ( x_{ k - 1 } ) ) \\
& = \sum_{ k }^n G ( x_k ) ( F ( x_k ) - F ( x_{ k - 1 } ) ) + \sum_{ k } F ( x_{ k - 1 } ) ( G ( x_i ) - G ( x_{ i - 1 } ) ) \\
& = \sum_k G ( x_i ) \int_{ x_{ i - 1 } }^{ x_i } f ( x ) \text{ d } x + \sum_{ k }^n F ( x_{ i - 1 } ) \int_{ x_{ i - 1 } }^{ x_i } g ( x ) \text{ d } x
\end{aligned}</script><p>使用引理就完事了.</p>
<h6><span id="example1">Example1</span></h6><p>求证:</p>
<script type="math/tex; mode=display">
\int_a^x ( \int_a^t f ( u ) \text{ d } u ) \text{ d } t = \int_a^x ( x - t ) f ( t ) \text{ d } t</script><p>令$F ( x ) = \int_a^t f ( t ) \text{ d } t$,$g ( x ) = 1 , G ( x ) = x - a$就可以直接套用分部积分公式得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
LHS & = \int_a^x F ( t ) g ( t ) \text{ d } t \\
& = FG \mid_a^x - \int_a^x f ( t ) G ( t ) \text{ d } t \\
& = ( x - a ) \int_a^x f ( t ) \text{ d } t - \int_a^x f ( t ) ( t - a ) \text{ d } t \\

\end{aligned}</script><p>这样就做完了.</p>
<p>或者设$F ( a ) = 0$,将上式记作:</p>
<script type="math/tex; mode=display">
\int_a^x F ( t ) \mathrm{ d } t = \int_a^x ( x - t ) F ' ( t ) \mathrm{ d } t</script><h6><span id="example2">Example2</span></h6><p>求$I = \int_0^{ \frac{ \pi }{ 2 } } \frac{ x \sin x \cos x }{ ( a^2 \cos^2 x + b^2 \sin^2 x )^2 } \text{ d } x$,其中$a , b &gt; 0$.</p>
<p>有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \frac{ \pi }{ 2 } } \frac{ x \sin x \cos x }{ ( a^2 \cos^2 x + b^2 \sin^2 x )^2 } \text{ d } x \\
= & \frac{ - 1 }{ 2 ( b^2 - a^2 ) } \int_0^{ \frac{ \pi }{ 2 } } x \text{ d } ( \frac{ 1 }{ a^2 + ( b^2 - a^2 ) \sin^2 x } ) \\
= & \frac{ - 1 }{ 2 ( b^2 - a^2 ) } ( \frac{ \pi }{ 2 b^2 } - \int_0^{ \frac{ \pi }{ 2 } } \frac{ \text{ d } x }{ a^2 \cos^2 x + b^2 \sin^2 x } ) \\
= & \frac{ 1 }{ 2 ( b^2 - a^2 ) } ( - \frac{ \pi }{ 2 b^2 } + \int_0^{ \frac{ \pi }{ 2 } } \frac{ \text{ d } \tan x }{ a^2 + b^2 \tan^2 x } ) \\
= & \frac{ 1 }{ 2 ( b^2 - a^2 ) } ( - \frac{ \pi }{ 2 b^2 } + \frac{ \pi }{ 2 ab } ) \\
= & \frac{ \pi }{ 4 ab^2 ( a + b ) }
\end{aligned}</script><h6><span id="example3wallis公式">Example3(Wallis公式)</span></h6><p>求$I_n = \int_0^{ \frac{ \pi }{ 2 } } \sin^n x \text{ d } x$.</p>
<p>换元后直接分部积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = - \int_0^{ \frac{ \pi }{ 2 } } \sin^{ n - 1 } x \text{ d } \cos x \\
& = \int_0^{ \frac{ \pi }{ 2 } } \cos x \text{ d } ( \sin^{ n - 1 } x ) \\
& = ( n - 1 ) \int_0^{ \frac{ \pi }{ 2 } } \sin^{ n - 2 } x ( 1 - \sin^2 x ) \text{ d } x \\
& = ( n - 1 ) I_{ n - 2 } - ( n - 1 ) I_n \\

\end{aligned}</script><p>于是$I_n = \frac{ n - 1 }{ n } I_{ n - 2 }$.</p>
<p>注意到$I_0 = \frac{ \pi }{ 2 } , I_1 = 1$,所以$I_{ 2 m } = \frac{ ( 2 m - 1 ) ! ! }{ ( 2 m ) ! ! } \frac{ \pi }{ 2 } , I_{ 2 m + 1 } = \frac{ ( 2 m ) ! ! }{ ( 2 m + 1 ) ! ! }$.</p>
<p>然而注意到$I_n$随着$n$增大而减小,于是应该有$I_{ 2 m + 1 } \leq I_{ 2 m } \leq I_{ 2 m - 1 }$,展开得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \frac{ 1 }{ 2 n + 1 } ( \frac{ ( 2 n ) ! ! }{ ( 2 n - 1 ) ! ! } )^2 \\
& \leq \frac{ \pi }{ 2 } \leq \\
\frac{ 1 }{ 2 n } ( \frac{ ( 2 n ) ! ! }{ ( 2 n - 1 ) ! ! } )^2 & = b_n
\end{aligned}</script><p>而$\lim a_n = \lim b_n$,因此$\lim a_n = \lim b_n = \frac{ \pi }{ 2 }$.</p>
<h5><span id="泰勒公式的积分余项">泰勒公式的积分余项</span></h5><p>回忆到泰勒公式的余项:</p>
<p>设$f ( x )$在$a$处有$n$阶导数,则$f ( x ) = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( a ) }{ k ! } ( x - a )^k + o ( ( x - a )^n )$.</p>
<p>设$f ( x )$在$( \alpha , \beta )$上有$n + 1$阶导数,则$f ( x ) = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( a ) }{ k ! } ( x - a )^k + \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - a )^{ n + 1 }$.</p>
<p>事实上还可以写积分余项,若$f^{ ( n + 1 ) } \in R [ \alpha , \beta ]$,则$f ( x ) = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( a ) }{ k ! } ( x - a )^k + \frac{ 1 }{ n ! } \int_a^x ( x - t )^n f^{ ( n + 1 ) } ( t ) \text{ d } t$.</p>
<p>首先能写出$f ( x ) = f ( a ) + \int_a^x f ‘ ( t ) \text{ d } t$,考虑不断展开后面那一项,用分部积分注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^x f^{ ( m + 1 ) } ( t ) \frac{ ( x - t )^m }{ m ! } \text{ d } t \\
= & \int_a^x f^{ ( m + 1 ) } ( t ) \text{ d } ( - \frac{ ( x - t )^{ m + 1 } }{ ( m + 1 ) ! } ) \\
= & f^{ ( m + 1 ) } ( a ) \frac{ ( x - a )^{ m + 1 } }{ ( m + 1 ) ! } + \frac{ 1 }{ ( m + 1 ) ! } \int_a^x ( x - t )^{ m + 1 } f^{ ( m + 2 ) } ( t ) \text{ d } t
\end{aligned}</script><h6><span id="example1">Example1</span></h6><p>函数$f ( x )$在$[ a , b ]$上各阶导数存在且非负,求证:</p>
<script type="math/tex; mode=display">
f ( x ) = \sum_{ n = 0 }^\infty \frac{ f^{ ( n ) } ( a ) }{ n ! } ( x - a )^n</script><p>其实这个题应该放到幂级数那里,不过确实和积分余项关系更大.分析的话首先会发现要证两边相等一定要搞定余项对吧,但是拉格朗日余项要求对所有的点的任意阶导数都存在一个控制,但这是做不到的,原函数对导函数的控制只能是在一段连续区间上的控制(用NL公式),而做不到对所有单点的控制.因此使用积分余项,一个自然的想法是除了$b$端点以外的误差应该都比$b$处的误差要小,注意到:</p>
<script type="math/tex; mode=display">
\frac{ x - t }{ x - a } \leq \frac{ b - t }{ b - a }</script><p>所以:</p>
<script type="math/tex; mode=display">
\begin{aligned}
R_n ( x ) & = \frac{ 1 }{ n ! } \int_a^x f^{ ( n + 1 ) } ( t ) ( x - t )^n \mathrm{ d } t \\
& \leq \frac{ ( x - a )^n }{ ( b - a )^n } \frac{ 1 }{ n ! } \int_a^x f^{ ( n + 1 ) } ( t ) ( b - t )^n \mathrm{ d } t \\
& \leq \frac{ ( x - a )^n }{ ( b - a )^n } R_n ( b )
\end{aligned}</script><p>接下来如果能控制$R_n ( b )$就万事大吉,发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
R_n ( b ) & = \frac{ 1 }{ n ! } \int_a^b f^{ ( n + 1 ) } ( t ) ( b - t )^n \mathrm{ d } t \\
& = \frac{ 1 }{ n ! } \int_a^b ( b - t )^n \mathrm{ d } f^{ ( n ) } ( t ) \\
& = - \frac{ ( b - a )^n }{ n ! } f^{ ( n ) } ( a ) + \frac{ 1 }{ ( n - 1 ) ! } \int_a^b ( b - t )^{ n - 1 } f^{ ( n ) } ( t ) \\
& \leq R_{ n - 1 } ( b ) \\
& \leq \cdots \leq f ( b ) - f ( a )
\end{aligned}</script><p>这就搞定了,当$x \in [ a , b )$的时候,由于$\frac{ ( x - a )^n }{ ( b - a )^n } \to 0$而自然完事.而单调函数的端点是随便延拓的,写下来的话,如果端点处不满足则必然端点处不收敛,意味着:</p>
<script type="math/tex; mode=display">
\lim_{ x \to b - 0 } \sum_{ n = 0 }^\infty \frac{ f^{ ( n ) } ( a ) }{ n ! } ( x - a )^n = + \infty</script><p>但这不可能,因为左边的恰好是原本收敛的那个函数$x \to b - 0$处的表现.</p>
<h5><span id="积分第一中值定理">积分第一中值定理</span></h5><p>设$f , g \in R [ a , b ]$并且$g$不变号.不妨设$f$的连续点集为$A$,称它的<strong>本性上界</strong>为$M = \inf_{ x \in A } ( f ( x ) )$,同理定义<strong>本性下界</strong>$m$.则$\exists \mu \in [ m , M ]$使得:</p>
<script type="math/tex; mode=display">
\int_a^b fg ( x ) \text{ d } x = \mu \int_a^b g ( x ) \text{ d } x</script><p>来证明这个事,不妨设$g ( x ) \geq 0$.</p>
<p>当$\int_a^b g ( x ) \text{ d } x = 0$的时候,此时由于$g ( x ) \geq 0$,因此$g ( x )$一定几乎处处为零(否则,存在一个$g$的连续点处不为$0$,在这个点邻域附近卡一下就能卡掉),那左右两边都等于$0$.</p>
<p>当$\int_a^b g ( x ) \text{ d } x &gt; 0$的时候,由于$mg \leq gf \leq Mg$对于$f$的连续点集$A$成立,而这是个稠密集,立刻见到$\int_a^b mg \text{ d } x \leq \int_a^b gf \text{ d } x \leq \int_a^b Mg \text{ d } x$.于是$\mu = \frac{ \int_a^b f g \text{ d } x }{ \int_a^b g \text{ d } x } \in [ m , M ]$.</p>
<p>作为更加常见的版本,当$f \in C [ a , b ]$的时候,$\exists \xi \in ( a , b )$使得:</p>
<script type="math/tex; mode=display">
\int_a^b fg ( x ) \text{ d } x = f ( \xi ) \int_a^b g ( x ) \text{ d } x</script><p>该版本与之前的区别在于要断言$\xi \ne a , \xi \ne b$.使用反证法,在$\int_a^b g ( x ) \text{ d } x &gt; 0$的时候,不妨假设$\xi = b$,此时前面$( a , b )$中不能有和$f ( b )$相同的,又因为其是连续函数,因此不妨设$( a , b )$中$f ( x )$均比$f ( b )$要小,用极限把端点用保号性卡出来就知道$[ a , b ]$中$f ( x ) \leq f ( b )$.</p>
<p>由于此时$\int_a^b g ( x ) \text{ d } x &gt; 0$,于是一定存在一个$x_0 , g ( x_0 ) &gt; 0$,并且$x_0$是一个连续点.此时就存在其一个小邻域都$&gt; \frac{ 1 }{ 2 } g ( x_0 ) &gt; 0$,并且这个邻域上的$f ( x ) &lt; f ( b )$.在这个邻域上立刻可以发现:</p>
<script type="math/tex; mode=display">
\int_a^b ( M - f ( x ) ) g ( x ) \text{ d } x > 0</script><p>这就有了矛盾.</p>
<h6><span id="example1">Example1</span></h6><p>$f \in R [ 0 , 1 ]$,$f ( + 0 )$存在,则:</p>
<script type="math/tex; mode=display">
\lim_{ n \to + \infty } \int_0^1 \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x = \frac{ \pi }{ 2 } f ( + 0 )</script><p>不妨设$f ( 0 ) = f ( + 0 )$,因为改变有限个点的取值是不会改变其积分的.</p>
<p>此时:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^1 \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x \\
= & \int_0^{ \frac{ 1 }{ \sqrt{ n } } } \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x + \int_{ \frac{ 1 }{ \sqrt{ n } } }^{ 1 } \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x
\end{aligned}</script><p>而考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \frac{ 1 }{ \sqrt{ n } } } \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x \\
= & \mu \int_0^{ \frac{ 1 }{ \sqrt{ n } } } \frac{ n }{ 1 + n^2 x^2 } \text{ d } x \\
= & \mu \arctan \sqrt{ n } \to f ( 0 ) \frac{ \pi }{ 2 }
\end{aligned}</script><p>而后者:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_{ \frac{ 1 }{ \sqrt{ n } } }^{ 1 } \frac{ n f ( x ) }{ 1 + n^2 x^2 } \text{ d } x | \\
\leq & \sup | f | ( \arctan ( nx ) \mid_{ \frac{ 1 }{ \sqrt{ n } } }^1 ) \\
= & \sup | f | \arctan ( \frac{ n - \sqrt{ n } }{ 1 + n \sqrt{ n } } ) \to 0
\end{aligned}</script><p>这样就做完了.这里拆成两部分可能是难以想到的,事实上这么做的意义是使得$\mu \to f ( 0 )$而放缩,其中这个$nx$的变化量很大,因此可以稍微匀一下变化.</p>
<h6><span id="example2">Example2</span></h6><p>设$f$二阶可导,并且一,二阶导可积,则$\exists \xi \in ( a , b )$,使得$\int_a^b f ( x ) \text{ d } x = ( b - a ) f ( \frac{ a + b }{ 2 } ) + \frac{ ( b - a )^3 }{ 24 } f ‘ ‘ ( \xi )$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f ( x ) \text{ d } x \\
= & \int_{ a }^{ \frac{ a + b }{ 2 } } f ( x ) \text{ d } x + \int_{ \frac{ a + b }{ 2 } }^{ b } f ( x ) \text{ d } x \\
= & \int_0^{ \frac{ b - a }{ 2 } } f ( a + t ) \text{ d } t + \int_0^{ \frac{ b - a }{ 2 } } f ( b - t ) \text{ d } t \\
= & \int_0^{ \frac{ b - a }{ 2 } } f ( a + t ) + f ( b - t ) \text{ d } t \\
= & t ( f ( a + t ) + f ( b - t ) ) \mid_0^{ \frac{ b - a }{ 2 } } - \int_0^{ \frac{ b - a }{ 2 } } t ( f ' ( a + t ) - f ' ( b - t ) ) \text{ d } t \\
= & ( b - a ) f ( \frac{ a + b }{ 2 } ) - \int_0^{ \frac{ b - a }{ 2 } } t ( f ' ( a + t ) - f ' ( b - t ) ) \text{ d } t
\end{aligned}</script><p>前半部分已经完事了,接下来看后半部分,继续分部积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \frac{ b - a }{ 2 } } t ( f ' ( a + t ) - f ' ( b - t ) ) \text{ d } t \\
= & \frac{ 1 }{ 2 } \int_0^{ \frac{ b - a }{ 2 } } ( f ' ( a + t ) - f ' ( b - t ) ) \text{ d } ( t^2 ) \\
= & \left ( \frac{ t^2 }{ 2 } ( f ' ( a + t ) - f ' ( b - t ) ) \right ) \mid_{ 0 }^{ \frac{ b - a }{ 2 } } - \int_0^{ \frac{ b - a }{ 2 } } \frac{ t^2 }{ 2 } ( f ' ' ( a + t ) + f ' ' ( b - t ) ) \text{ d } t \\
= & - \int_0^{ \frac{ b - a }{ 2 } } \frac{ t^2 }{ 2 } ( f ' ' ( a + t ) + f ' ' ( b - t ) ) \text{ d } t \\
= & \mu \int_0^{ \frac{ b - a }{ 2 } } \frac{ t^2 }{ 2 } \text{ d } t \\
= & \mu \frac{ ( b - a )^3 }{ 48 }
\end{aligned}</script><p>接下来看$\mu$,$\mu \in [ \inf ( f ‘ ‘ ( a + t ) + f ‘ ‘ ( b - t ) ) , \sup ( f ‘ ‘ ( a + t ) + f ‘ ‘ ( b - t ) ) ]$,由导函数介值性,意味着必然$\exists \xi_1 \in [ 0 , \frac{ b - a }{ 2 } ]$使得$\mu = f ‘ ‘ ( a + \xi_1 ) + f ‘ ‘ ( b - \xi_1 )$.再用一次$2 f ‘ ‘$的介值性得到$\mu = 2 f ‘ ‘ ( \xi ) , \xi \in ( a + \xi_1 , b - \xi_1 ) \subseteq ( a , b )$.</p>
<h5><span id="积分第二中值定理">积分第二中值定理</span></h5><p>设$g \in R [ a , b ] , f \geq 0$,并且$f$单调,则:</p>
<ol>
<li><p>$f$单调递减时,$\exists \xi \in [ a , b ]$,$\int_a^b f g \text{ d } x = f ( a + 0 ) \int_a^\xi g ( x ) \text{ d } x$.</p>
</li>
<li><p>$f$单调递增时,$\exists \xi \in [ a , b ]$,$\int_a^b f g \text{ d } x = f ( b - 0 ) \int_\xi^b g ( x ) \text{ d } x$.</p>
</li>
<li><p>$\exists \xi \in [ a , b ]$,$\int_a^b f g \text{ d } x = f ( a + 0 ) \int_a^\xi g \text{ d } x + f ( b - 0 ) \int_\xi^b g \text{ d } x$.</p>
</li>
<li><p>在上述基础上,如果$f$不是几乎常值函数,那么上述的$\xi \in ( a , b )$.</p>
</li>
</ol>
<p>(1)(2)相似,下面只对(1)进行证明:</p>
<p>不妨设$f ( a ) = f ( a + 0 ) , G = \int_a^x g ( x ) \text{ d } x$是$g$的广义原函数,其满足$G ( a ) = 0$,不妨设$M = \sup G , m = \inf G$,回忆到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b f g \text{ d } x & = \lim_{ \lambda ( \Delta ) \to 0 } \sum_{ i = 1 }^n f ( x_{ i - 1 } ) \int_{ x_{ i - 1 } }^{ x_i } g \text{ d } x \\
& = \sum_{ i = 1 }^n f ( x_{ i - 1 } ) ( G ( x_i ) - G ( x_{ i - 1 } ) ) \\
& = f ( x_{ n - 1 } ) G ( x_n ) + \sum_{ i = 1 }^{ n - 1 } ( f ( x_{ i - 1 } ) - f ( x_{ i } ) ) G ( x_i ) \\
& \leq f ( a ) M
\end{aligned}</script><p>在最后一步放缩进行修改就可以改为$\geq f ( a ) m$,而我们已经得知$G$的连续性,因此用介值性就可以解决上述问题.</p>
<p>难点在于(4)如何证明.</p>
<p>当其不是几乎常值函数的时候,应该满足$f ( a + 0 ) &gt; f ( b - 0 )$.</p>
<p>当$\int_a^b f g \text{ d } x = 0$的时候,如果迫不得已必须取端点就应当有$\forall \xi \in ( a , b )$,都有$\int_a^\xi g \text{ d } x \ne 0$,由于其连续导出的介值性那就当然拿到了$G$的保号性.我们上面已经用Abel变换得到了:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b f g \text{ d } x & = \sum_{ i = 1 }^n f ( x_{ i - 1 } ) ( G ( x_i ) - G ( x_{ i - 1 } ) ) \\
& = f ( x_{ n - 1 } ) G ( x_n ) + \sum_{ i = 1 }^{ n - 1 } ( f ( x_{ i - 1 } ) - f ( x_{ i } ) ) G ( x_i ) \\

\end{aligned}</script><p>此时考虑取$c , d$使得$a &lt; c &lt; d &lt; b$,并且满足$f ( c ) &gt; f ( d )$,由于$f$并不是几乎常值函数,这当然可以做到,上式每一项都是$\geq 0$的,那就可以把区间从$[ a , b ]$重新控制到$[ c , d ]$中.于是此时上式立刻:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f g \text{ d } x \\
\geq & ( f ( c ) - f ( d ) ) \min_{ [ c , d ] } G ( x ) > 0
\end{aligned}</script><p>然而我们假设中$\int_a^b f g \text{ d } x = 0$,这样就导出了矛盾.</p>
<p>接下来考虑$\int_a^b f g \text{ d } x \ne 0$的情况,如果其迫不得已必须取在端点的话当然要取到右端点此时应该有$\int_a^b f g \text{ d } x = f ( a ) \int_a^b g \text{ d } x$.</p>
<p>仍然看上面的Abel变换后的结果,同时按照上面同样的办法取出一个子区间$[ c , d ]$.回忆到为了保证前面都没有能和$G ( b )$相同的,因此$G ( b )$必然是前面的最大值.再回忆到$G ( a ) = 0$,立刻能得到$G ( b ) &gt; \sup_{ [ a , c ] } G ( x )$,设后者为$M$,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f g \text{ d } x \\
= & f ( x_{ n - 1 } ) G ( b ) + \sum_{ i = 1 }^{ n - 1 } ( f ( x_{ i - 1 } ) - f ( x_{ i } ) ) G ( x_i ) \\
\leq & f ( x_{ n - 1 } ) G ( b ) + M ( f ( a ) - f ( c ) ) + G ( b ) ( f ( c ) - f ( b ) ) \\

\end{aligned}</script><p>这里这个$f ( x_{ n - 1 } )$很烦,但是当$\lambda ( \Delta ) \to 0$的时候当然会使得$f ( x_{ n - 1 } ) \to f ( b - 0 )$,上式变更为:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f g \text{ d } x \\
\leq & f ( b ) G ( b ) + M ( f ( a ) - f ( c ) ) + G ( b ) ( f ( c ) - f ( b ) ) \\
= & M ( f ( a ) - f ( c ) ) + G ( b ) f ( c ) \\
< & f ( a ) G ( b )
\end{aligned}</script><p>这就导出了矛盾.</p>
<p>最后来看(3),不妨设$f$单减,设$\varphi ( x ) = f ( x ) - f ( b ) \geq 0$且单减,用(1)的结论得到$\exists \xi \in [ a , b ]$使得$\int_a^b \varphi g \text{ d } x = \varphi ( a ) \int_a^\xi g \text{ d } x$.变形后就可以得到原本的式子.单增是同理的.总之,(3)是(1)(2)的一个更为优美的推论.</p>
<h6><span id="example1">Example1</span></h6><p>设$f \in C^1 [ a , b ]$,并且满足$f ‘$单调递减,且$f ‘ ( b ) \geq M &gt; 0$.求证:$| \int_a^b \cos f ( x ) \text{ d } x | \leq \frac{ 2 }{ M }$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b \cos f ( x ) \text{ d } x \\
= & \int_a^b \frac{ f ' \cos f }{ f ' } \text{ d } x \\
= & \frac{ 1 }{ f ' ( b ) } \int_\xi^b f ' \cos f \text{ d } x \\
= & \frac{ 1 }{ f ' ( b ) } ( \sin f ( b ) - \sin f ( \xi ) ) \\

\end{aligned}</script><p>这就完事了.</p>
<h5><span id="有界变差函数">有界变差函数</span></h5><p>对于一个$f : [ a , b ] \to R$的函数,做分划$\Delta : a = x_0 &lt; \cdots &lt; x_n = b$,定义其变差为$V_\Delta = \sum_k | f ( x_i ) - f ( x_{ i - 1 } ) |$,定义其全变差为$V_{ [ a , b ] } ( f ) = \sup_\Delta V_\Delta$.当全变差为有限的时候,称$f$是有界变差函数.容易见到由介值定理,如果$f$可导而且$f ‘$可积,则$V_{ [ a , b ] } ( f ) = \int_a^b | f ‘ | \mathrm{ d } x$.</p>
<p>应当容易见到,闭区间上的单调函数是有界变差的,且$V_{ | f | } \leq V_f , V_{ f + g } \leq V_f + V_g$.</p>
<p>接下来我们来证明:$f$是有界变差函数,当且仅当$f$是两个单调(不一定严格)函数的差.或者更严格一点,可以写成两个单调不减函数的差.另外,作为这个命题的平凡推论,我们知道有界变差函数几乎处处可导,并且有至多可数个间断点,且只有第一类间断点.</p>
<p>充分性显然,下面来看必要性.假设$f$是有界变差的,此时类似积分可以定义一个变上限函数$V_f ( x ) = V_f [ a , x ]$,其显然是单调不降的.</p>
<p>接下来定义$g = V_f ( x ) - f ( x )$,我们来说明它一定也是单调不减的.</p>
<p>那考虑当$x_2 &gt; x_1$时,观察$g ( x_2 ) - g ( x_1 ) = V_f ( x_2 ) - V_f ( x_1 ) - ( f ( x_2 ) - f ( x_1 ) )$.</p>
<p>既然全变差的定义依赖于分划,我们当然可以加分点,自然有$V_f ( x_2 ) - V_f ( x_1 ) = V_{ f , [ x_1 , x_2 ] } \geq | f ( x_2 ) - f ( x_1 ) | \geq f ( x_2 ) - f ( x_1 )$.</p>
<p>自然得证.</p>
<p>可应当意识到连续函数不一定是有界变差函数,原因仍然考虑$f ( x ) = \begin{cases}0 &amp; x = 0 \ x \sin \frac{ 1 }{ x } &amp; \text{ otherwise }\end{cases}$.在闭区间$[ 0 , 1 ]$上取$x_k = \frac{ 1 }{ ( k + \frac{ 1 }{ 2 } ) \pi }$,这样$\sin \frac{ 1 }{ x_i }$的取值正负交替,容易见到出现了调和级数.</p>
<p>然而,稍微加点条件,我们可以证明李氏连续是有界变差的.可以直接套用定义,也可以回忆到$f ( x ) = f ( x ) - Lx + Lx = Lx - ( Lx - f ( x ) )$.因此导函数有界就一定有界变差.并且此时,可以让其拆出两个不降的可导函数.</p>
<h5><span id="定积分的应用">定积分的应用</span></h5><h6><span id="example1图形证明不等式">Example1(图形证明不等式)</span></h6><p>回忆到我们证明积分形式的柯西不等式的时候,证明了当$\frac{ 1 }{ p } + \frac{ 1 }{ q } = 1$时,$a^{ \frac{ 1 }{ p } } b^{ \frac{ 1 }{ q } } = e^{ \frac{ \ln a }{ p } + \frac{ \ln b }{ q } } \leq \frac{ a }{ p } + \frac{ b }{ q }$.</p>
<p>下面可以用类似的策略理解这个式子,首先等价于证明$ab \leq \frac{ a^p }{ p } + \frac{ b^q }{ q }$.原因是考虑设$S_1 = \frac{ a^p }{ p } , S_2 = \frac{ b^q }{ q }$,设$f ( x ) = x^{ p - 1 }$,留意到$f ( x )$的积分表示出了$S_1$,而$f^{ - 1 } ( x )$恰好表示出了$S_2$.</p>
<h6><span id="example2参数方程曲线面积">Example2(参数方程曲线面积)</span></h6><p>回忆到换元法,取参数方程$\begin{cases}x = x ( t ) \ y = y ( t )\end{cases}$,此时不妨假设$x ( \alpha ) = a , x ( \beta ) = b$,且$x ( t )$单调递增且连续,$x ‘ ( t )$除有限点外都存在且黎曼可积.那当然应当有:</p>
<script type="math/tex; mode=display">
\int_a^b f ( x ) \text{ d } x = \int_\alpha^\beta y ( t ) x ' ( t ) \text{ d } t</script><p>注意到如果反之条件使得$x ( \alpha ) = b , x ( \beta ) = a$,则需要补一个$- 1$.</p>
<p>由此可见,对于不自交的任意参数方程表示的曲线,直接积分的正负号一抵消,仍然可以求出曲线下方的面积.如果自交,就是要把自交部分的面积减去.顺便而言,简单封闭曲线(例如圆或者椭圆)当然是上述我们所说的特殊情况.</p>
<p>不过对于封闭曲线,由于转一圈会回到同一个点处,使用分部积分得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_\alpha^\beta y x ' \text{ d } t \\
= & \int_\alpha^\beta y \text{ d } x \\
= & xy |_a^b - \int_\alpha^\beta xy ' \text{ d } t \\
= & - \int_\alpha^\beta xy ' \text{ d } t
\end{aligned}</script><p>兼顾一下对称性,可以写作$S = \frac{ 1 }{ 2 } | \int_\alpha^\beta ( x ‘ y - y ‘ x ) \text{ d } t |$.由此立刻得到椭圆面积为$ab \pi$.</p>
<h6><span id="example3极坐标的面积">Example3(极坐标的面积)</span></h6><p>设$r = r ( \theta ) , \theta \in [ \alpha , \beta ] , r ( \theta ) \in C ( \alpha , \beta )$.</p>
<p>此时考虑对$\theta$做划分,取$\Delta : \alpha = \theta_0 &lt; \cdots &lt; \theta_n = \beta$,并取$m_i = \inf_{ [ \theta_{ i - 1 } , \theta_i ] } r , M_i = \sup_{ [ \theta_{ i - 1 } , \theta_i ] }$,立刻得到$\frac{ 1 }{ 2 } m_i^2 \Delta \theta_i \leq \Delta S_i \leq \frac{ 1 }{ 2 } \sum M_i^2 \Delta \theta_i$,这样加密后得到$S = \frac{ 1 }{ 2 } \int_\alpha^\beta r^2 ( \theta ) \text{ d } \theta$.</p>
<h6><span id="example4参数方程曲线的弧长">Example4(参数方程曲线的弧长)</span></h6><p>取参数方程$\begin{cases}x = x ( t ) \ y = y ( t )\end{cases}$,并且假设$x , y$均连续.首先我们应当定义其”弧长”的含义.</p>
<p>可以使用折线逼近的策略定义弧长.具体而言,直接取分划$\Delta : \alpha = t_0 &lt; \cdots &lt; t_n = \beta$.定义一个点$P_i = ( x ( t_i ) , y ( t_i ) )$,这样我们当然就得到了若干个点,在这些点上就可以将相邻两个点求出折线,设折线长为$\overline{ M_{ i - 1 } M_i }$.</p>
<p>接下来,称曲线是可求长的,当且仅当取出的折线的上确界是有限的,并将此上确界定义为曲线长.</p>
<p>我们接下来证明,其可求长当且仅当$x ( t )$和$y ( t )$都是有界变差的.</p>
<p>先看必要性,任取分划$\Delta : \alpha = t_0 &lt; \cdots &lt; t_n = \beta$.立刻得到$V_\Delta ( x ) = \sum | x_i - x_{ i - 1 } | \leq \sum \overline{ M_{ i - 1 } M_i }$,当然是有界的,对于$y ( t )$同理.</p>
<p>另外,斜边小于两条直角边的和(三角形不等式),于是充分性也显然.</p>
<p>然而真要实际应用需要稍加条件,即:$x ( t ) , y ( t )$可导且导函数黎曼可积(说明其导函数有界,为李氏连续函数,那自然是有界变差函数).则弧长为$\int_\alpha^\beta \sqrt{ ( x ‘ ( t ) )^2 + ( y ‘ ( t ) )^2 } \text{ d } t$.</p>
<p>证明比较容易,考虑勾股定理,$\overline{ M_{ i - 1 } M_i } = \sqrt{ ( x ( t_i ) - x ( t_{ i - 1 } ) )^2 + ( y ( t_i ) - y ( t_{ i - 1 } ) )^2 }$.使用微分中值定理,得到其等于$\Delta t_i \sqrt{ ( x ‘ ( \xi_i ) )^2 + ( y ‘ ( \eta_i ) )^2 }$.这里强行换成一个东西,于是就会得到$\Delta t_i \sqrt{ ( x ‘ ( \xi_i ) )^2 + ( y ‘ ( \xi_i ) )^2 } + w_i$的形式,其中$w_i$恰为两项之差.然后换黎曼和,只需证明后者$w_i$随着加密而趋向于$0$.而这个根号差可以做分子有理化.具体而言:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w_i & = \Delta t_i \left ( \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \eta_i ) )^2 } - \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \xi_i ) )^2 } \right ) \\
& = \Delta t_i \frac{ y ' ( \eta_i )^2 - y ' ( \xi_i )^2 }{ \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \eta_i ) )^2 } + \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \xi_i ) )^2 } } \\
& = \Delta t_i \frac{ ( y ' ( \eta_i ) + y ' ( \xi_i ) ) }{ \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \eta_i ) )^2 } + \sqrt{ ( x ' ( \xi_i ) )^2 + ( y ' ( \xi_i ) )^2 } } ( y ' ( \eta_i ) - y ' ( \xi_i ) ) \\
& \leq \Delta t_i ( y ' ( \eta_i ) - y ' ( \xi_i ) )
\end{aligned}</script><p>最后会得到$\leq \sum \omega_{ y ‘ } \Delta t_i$,立刻得到其趋向于$0$.顺便还要证明这个是上确界,只需要证明加点后答案增加即可,然后用黎曼积分那一部分的对划分取并的技巧即可.</p>
<p>由此应当能推出直角坐标系下弧长公式,即$l = \int_a^b \sqrt{ 1 + ( f ‘ ( x ) )^2 } \text{ d } x$.</p>
<h6><span id="example5极坐标下的弧长公式">Example5(极坐标下的弧长公式)</span></h6><p>此时应当有$x ‘ = r ‘ \cos \theta - r \sin \theta , y ‘ = r ‘ \sin \theta + r \cos \theta$,注意到$( x ‘ )^2 + ( y ‘ )^2 = r^2 + ( r ‘ )^2$,于是极坐标下的公式当然是$l = \int_\alpha^\beta \sqrt{ r^2 + ( r ‘ )^2 } \text{ d } \theta$.</p>
<h6><span id="example6等周不等式">Example6(等周不等式)</span></h6><p>求给定长度的闭合曲线能围出的最大面积.</p>
<p>设$\Gamma$是一个周长为$l$的简单可求长闭曲线,其面积为$A$,我们下面证明$A \leq \frac{ l^2 }{ 4 \pi }$.</p>
<p>先考虑$\Gamma$比较光滑的情况,也就是其有导函数且导函数可积.参数方程给出$l = \int_\alpha^\beta \sqrt{ ( x ‘ )^2 + ( y ‘ )^2 } \text{ d } \theta$而$A = \int_\alpha^\beta xy ‘ \text{ d } \theta$.注意这里假设曲线是逆时针方向旋转的.</p>
<p>接下来,考虑在原基础上画个圆,这个圆的参数方程横坐标继承自上述$x ( \theta )$而纵坐标由圆定义为$\bar{ y } = \pm \sqrt{ r^2 - x^2 }$,这里的$2 r = \sup x - \inf x$.也就是横着的最长距离.为了使得这个圆转起来是合理的,实际上应该找到上述曲线的左右端点然后分段函数定义,我们这里略去此细节.</p>
<p>然后呢,此时观察到应当有$\pi r^2 = - \int_\alpha^\beta \bar{ y } x ‘ \text{ d } \theta$,发挥注意力得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
2 \sqrt{ A \pi r^2 } & \leq A + \pi r^2 \\
& = \int_\alpha^\beta ( xy ' + \bar{ y } x ' ) \text{ d } \theta \\
& \leq \int_\alpha^\beta \sqrt{ x^2 + ( \bar{ y } )^2 } \sqrt{ y '^2 + x '^2 } \text{ d } t \\
& = rl
\end{aligned}</script><p>于是证毕.</p>
<p>那么不光滑怎么办呢?可以用分段光滑函数(比如折线)逼近,这样就行了.</p>
<h6><span id="example7求多面体体积">Example7(求多面体体积)</span></h6><p>体积的定义无非类似面积,用夹逼定理定义任意形状的体积.</p>
<p>考虑对于每个$x$,在$x$那里做截面,设得到的截面面积是$S ( x )$,那么体积感觉上应当是$V = \int_a^b S ( x ) \text{ d } x$.</p>
<p>然而这个结论的准确证明可能需要一些重积分知识.我们尝试越级打怪,加一个很神秘的条件:就是两个截面之间一定存在包含关系以及$S ( x )$是关于$x$连续变化的.然后看看能不能把这个结论证出来.</p>
<p>考虑$x$的范围是$[ a , b ]$,接下来对其作分划$\Delta : a = x_0 &lt; \cdots &lt; x_n = b$.接下来取$\eta_i , \xi_i$满足$S ( \xi_i ) = \max_{ [ x_{ i - 1 } , x_i ] } S ( x ) , S ( \eta_i ) = \min_{ [ x_{ i - 1 } , x_i ] } S ( x )$.此时回忆到包含关系,那么我们拿出来的$\xi_i$和$\eta_i$当然就是包含别人以及被包含的两个截面,以它们为底面积做柱体,留意到此时当然有:</p>
<script type="math/tex; mode=display">
S ( \eta_i ) ( x_{ i } - x_{ i - 1 } ) \leq V_{ [ x_{ i - 1 } , x_i ] } \leq S ( \xi_i ) ( x_i - x_{ i - 1 } )</script><p>回忆到假设$S ( x )$是连续变化的因此黎曼可积,于是这个东西两边其实就是达布上下和,立刻得到积分的结论.</p>
<p>旋转体当然满足以上条件,易见旋转体的体积为$\pi \int_a^b f^2 ( x ) \mathrm{ d } x$,参数方程同理.</p>
<h6><span id="example8旋转体的侧面积公式">Example8(旋转体的侧面积公式)</span></h6><p>曲面的面积难以定义,所以我们现在暂时成为物理系学生.下面只考虑旋转体.</p>
<p>对于旋转体来说,先用折线逼近原曲线,然后旋转后得到若干圆台,用圆台的侧面积之和去逼近旋转体的侧面积.</p>
<p>对于$[ a , b ]$,我们先做一个分划$\Delta : a = x_0 &lt; \cdots &lt; x_n = b$,$y_i = f ( x_i )$.圆台侧面积给出$\Delta S_i = \pi ( y_{ i - 1 } + y_i ) | \overline{ M_{ i - 1 } M_i } | = \pi ( y_{ i - 1 } + y_i ) \sqrt{ 1 + ( \cfrac{ y_i - y_{ i - 1 } }{ x_i - x_{ i - 1 } } )^2 } \Delta x_i$,利用微分中值定理,就有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_i & = \pi ( y_{ i - 1 } + y_i ) \sqrt{ 1 + ( f ' ( \xi_i ) )^2 } \Delta x_i \\
& = 2 \pi f ( \xi_i ) \sqrt{ 1 + ( f ' ( \xi_i ) )^2 } \Delta x_i + ( y_i + y_{ i - 1 } - 2 \pi f ( \xi_i ) ) \sqrt{ 1 + ( f ' ( \xi_i ) )^2 } \Delta x_i
\end{aligned}</script><p>加密后第二项可以用振幅控制住,所以答案就是$2 \pi \int_a^b f ( x ) \sqrt{ 1 + ( f ‘ ( x ) )^2 } \mathrm{ d } x$.</p>
<p>对于参数方程当然也是平凡的,答案应当是$2 \pi \int_a^b y \sqrt{ 1 + ( \frac{ y ‘ }{ x ‘ } )^2 } x ‘ \mathrm{ d } t = 2 \pi \int_a^b y \sqrt{ ( x ‘ )^2 + ( y ‘ )^2 } \mathrm{ d } t$,注意这里是按照$x$轴翻转.应当看到由此一段球面上的环的面积就是$2 \pi r \Delta x$.</p>
<h6><span id="example9pi的无理性证明">Example9($\pi$的无理性证明)</span></h6><p>假设$\pi = \frac{ p }{ q } \in \mathbb{ Q }$并且$p \bot q , p , q \in \mathbb{ N_+ }$.</p>
<p>考虑设$f_n ( x ) = q^n x^n ( p - qx )^n$,留意到$\forall 0 \leq i \leq n - 1$,有$f_n^{ ( i ) } ( 0 ) = f_n^{ ( i ) } ( \pi ) = 0$.</p>
<p>接下来考察$\forall n \leq i \leq 2 n$,此时留意到$f_n^{ ( i ) } ( 0 )$和$f_n^{ ( i ) } ( \pi )$都应当是整数并且是$n !$的倍数(是$0$也是$n !$的倍数).</p>
<p>考虑积分$I_n = \frac{ 1 }{ n ! } \int_0^\pi f_n ( x ) \sin x \mathrm{ d } x &gt; 0$.对其狂暴使用分部积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_n & = \frac{ 1 }{ n ! } \int_0^\pi f_n ( x ) \sin x \mathrm{ d } x \\
& = \frac{ 1 }{ n ! } \int_0^\pi f_n ( x ) \mathrm{ d } ( - \cos x ) \\

\end{aligned}</script><p>不断做分部积分,前面扔出来的项也就是$f_n^{ ( i ) } ( 0 )$或者$f_n^{ ( i ) } ( \pi )$然后再乘上$\sin , \cos$在$0 , \pi$之类取值的问题.总之,这个东西算出来一定是$n !$的倍数,前面乘了个$\frac{ 1 }{ n ! }$,他就一定是整数.又因为其大于$0$,他就一定$\geq 1$.</p>
<p>那么矛盾在哪呢?留意到$f_n = ( qx ( p - qx ) )^n \leq ( \frac{ p }{ 2 } )^{ 2 n } , \sin x \leq 1$,所以$I_n \leq \frac{ 1 }{ n ! } ( \frac{ p }{ 2 } )^{ 2 n } \pi \to 0$.</p>
<h6><span id="example10古鲁金第一定理">Example10(古鲁金第一定理)</span></h6><p>躲开微元法,要证明一些东西可以扔进去的话(比如密度函数),应当可以通过”平均密度”的概念用之前那个引理(分部积分那里,步骤是先积分,乘系数,后求和),总之都是平凡的.</p>
<p>考虑一个旋转体,反正用上面那套东西,搞出来质心应当有$\bar{ y } = \frac{ \int_\alpha^\beta y \sqrt{ x ‘^2 + y ‘^2 } \mathrm{ d } t }{ l }$.移项得到$2 \pi \bar{ y } l = 2 \pi \int_\alpha^\beta y \sqrt{ x ‘^2 + y ‘^2 } \mathrm{ d } t$.也就是:旋转线转一圈,质心周长乘以曲线的弧长等于侧面积.</p>
<h6><span id="example11古鲁金第二定理">Example11(古鲁金第二定理)</span></h6><p>考虑两条曲线夹起来的部分,也就是设$[ a , b ]$上有$f ( x ) \geq g ( x ) \geq 0$,那这两条线就会围出一块二维出来.这一块的质心能不能求呢?当然也可以,只不过略有区别,$\bar{ x } = \frac{ \int_a^b x ( f ( x ) - g ( x ) \mathrm{ d } x ) }{ S }$,而$\bar{ y } = \frac{ 1 }{ 2 } \frac{ \int_a^b ( f^2 ( x ) - g^2 ( x ) \mathrm{ d } x ) }{ S }$.移项得到$2 S \bar{ y } = \int_a^b ( f^2 ( x ) - g^2 ( x ) \mathrm{ d } x )$,也就是旋转面转一圈,质心周长乘以面积等于体积.</p>
<h6><span id="example12转动惯量">Example12(转动惯量)</span></h6><p>定义为$J = \int mr^2$.</p>
<p>考虑以$x$轴为旋转轴,先考虑线的情况,无非是分成小段每一段分别处理,对于每一段用长度和密度的乘积来逼质量,关于$x$轴的转动惯量$J = \int_\alpha^\beta y^2 ( t ) \rho ( t ) \sqrt{ ( x ‘ ( t ) )^2 + ( y ‘ ( t ) )^2 } \text{ d } t$.</p>
<h6><span id="example13">Example13</span></h6><p>设$F$是所有满足$f \in C^1 [ 0 , 1 ] \mid f ( 0 ) = 0 , f ( 1 ) = 1 , f ‘ \geq 0$,$f ‘$单调不降的函数$f$组成的集合,记$S_f$为$f ( x )$绕$x$轴转一圈得到的侧面积,求$\sup_{ f \in F } S_f$和$\inf_{ f \in F } S_f$.</p>
<p>先猜下确界是$\pi$,上确界是$\sqrt{ 2 } \pi$.</p>
<p>先证明下界是对的,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_f & = 2 \pi \int_0^1 f \sqrt{ 1 + ( f ' )^2 } \mathrm{ d } x \geq 2 \pi \int_0^1 f \cdot f ' \mathrm{ d } x \\
& = \pi
\end{aligned}</script><p>怎么逼近呢?这个当然是直接平的是最优秀的对吧,考虑$f_n ( x ) = x^n$,发现:</p>
<script type="math/tex; mode=display">
\pi \leq S_{ f_n } \leq 2 \pi \int_0^1 f_n ( 1 + f_n ' ) \mathrm{ d } x = \pi + 2 \pi \int_0^1 f_n \mathrm{ d } x = \pi + \frac{ 2 \pi }{ n + 1 } \to \pi</script><p>上界怎么搞定呢?考虑肯定是$f ( x ) = x$是最好的,我们下面证明任意一段曲线,如果把曲线拉直就更优秀.</p>
<p>也就是考虑$( 0 , 0 )$和$( x_0 , f ( x_0 ) )$的连线$y = \frac{ f ( x_0 ) }{ x_0 } x$,容易见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ x_0 } y \sqrt{ 1 + ( y ' )^2 } \mathrm{ d } x \\
= & \int_0^{ x_0 } \frac{ f ( x_0 ) }{ x_0 } x \sqrt{ 1 + ( \frac{ f ( x_0 ) }{ x_0 } )^2 } \mathrm{ d } x \\
= & \frac{ 1 }{ 2 } f ( x_0 ) \sqrt{ x_0^2 + f ( x_0 )^2 }
\end{aligned}</script><p>只要我们证明:</p>
<script type="math/tex; mode=display">
\int_0^x f ( t ) \sqrt{ 1 + ( f ' ( t ) )^2 } \mathrm{ d } t \leq \frac{ 1 }{ 2 } f ( x ) \sqrt{ x^2 + f^2 ( x ) }</script><p>即可.注意到它们在零点的取值相同,因此直接算导数之差,要证:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ 2 } f ' \sqrt{ x^2 + f^2 } + \frac{ x + f \cdot f ' }{ 2 \sqrt{ x^2 + f^2 } } f - f \sqrt{ 1 + ( f ' )^2 } & \geq 0 \\
2 f \sqrt{ 1 + ( f ' )^2 } \sqrt{ x^2 + f^2 } & \leq ( x^2 + 2 f^2 ) f ' + xf
\end{aligned}</script><p>敢算就敢赢,两边平方得到:</p>
<script type="math/tex; mode=display">
3 f^2 x^2 + 4 f^4 \leq x^4 ( f ' )^2 + 2 x^3 f \cdot f ' + 2 xf^3 f '</script><p>注意到下凸函数满足$f ‘ \geq \frac{ f }{ x }$,上述结论刚刚好得证,出这个题的lwg老师真是高人了.</p>
<h5><span id="定积分近似计算">定积分近似计算</span></h5><p>考虑对$\int_a^b f ( x ) \mathrm{ d } x$做数值近似,将$[ a , b ]$等分,取$x_k = a + \frac{ k }{ n } ( b - a )$,其中$0 \leq k \leq n$,而$\Delta x = \frac{ b - a }{ n }$,$x_{ k - \frac{ 1 }{ 2 } } = \frac{ x_k + x_{ k - 1 } }{ 2 }$.</p>
<p>那么用黎曼和逼积分,那么无非三种方式:要么算左端点的函数值,要么算右端点的函数值,要么算中间点的函数值.</p>
<p>问题在于计算误差,我们下面证明,如果$f$一阶可导,则:</p>
<ol>
<li><p>$\int_a^b f ( x ) \mathrm{ d } x = \frac{ b - a }{ n } \sum_{ k = 1 }^n y_k - \frac{ ( b - a )^2 }{ 2 n } f ‘ ( \xi )$</p>
</li>
<li><p>$\int_a^b f ( x ) \mathrm{ d } x = \frac{ b - a }{ n } \sum_{ k = 1 }^n y_{ k - 1 } + \frac{ ( b - a )^2 }{ 2 n } f ‘ ( \eta )$</p>
</li>
</ol>
<p>两个是类似的,只证第一个,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f ( x ) \mathrm{ d } x - \frac{ b - a }{ n } \sum_{ k = 1 }^n y_k \\
= & \sum_{ k = 1 }^n \int_{ x_{ k - 1 } }^{ x_k } ( f ( x ) - f ( x_k ) ) \mathrm{ d } x \\
= & \sum_{ k = 1 }^n \int_{ x_{ k - 1 } }^{ x_k } ( f ( x ) - f ( x_k ) ) \mathrm{ d } ( x - x_{ k - 1 } ) \\
= & - \sum_{ k = 1 }^n \int_{ x_{ k - 1 } }^{ x_k } ( x - x_{ k - 1 } ) f ' ( x ) \mathrm{ d } x \\
= & - \sum_{ k = 1 }^n f ' ( \xi_k ) \int_{ x_{ k - 1 } }^{ x_k } ( x - x_{ k - 1 } ) \mathrm{ d } x \\
= & - \sum_{ k = 1 }^n f ' ( \xi_k ) \frac{ ( b - a )^2 }{ 2 n^2 } \\
= & - \frac{ ( b - a )^2 }{ 2 n } f ' ( \xi )
\end{aligned}</script><p>最后一步是因为求均值也可以用介值定理.</p>
<p>那么在中点估计会怎么样呢?考虑给$f$更好的条件,让$f$二阶可导,则:</p>
<script type="math/tex; mode=display">
\int_a^b f ( x ) \mathrm{ d } x = \frac{ b - a }{ n } \sum_{ k = 1 }^n y_{ k - \frac{ 1 }{ 2 } } - \frac{ ( b - a )^3 }{ 24 n^2 } f ' ' ( \xi )</script><p>在$x_{ k - \frac{ 1 }{ 2 } }$处做泰勒展开,应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) - f ( x_{ k - \frac{ 1 }{ 2 } } ) & = ( x - x_{ k - \frac{ 1 }{ 2 } } ) f ' ( x_{ k - \frac{ 1 }{ 2 } } ) + \frac{ 1 }{ 2 } ( x - x_{ k - \frac{ 1 }{ 2 } } )^2 f ' ' ( \xi_k ) \\

\end{aligned}</script><p>不妨设$m_k \leq f ‘ ‘ ( \xi_k ) \leq M_k$,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_{ x_{ k - 1 } }^{ x_k } ( f ( x ) - f ( x_{ k - \frac{ 1 }{ 2 } } ) ) \mathrm{ d } x & \leq \frac{ M_k }{ 2 } \int_{ x_{ k - 1 } }^{ x_k } ( x - x_{ k - \frac{ 1 }{ 2 } } )^2 \mathrm{ d } x \\
& = M_k \frac{ ( b - a )^3 }{ 24 n^3 }
\end{aligned}</script><p>用介值定理就可以求和,原命题自然得证.</p>
<p>而上面的做法是矩形逼近,能不能用梯形逼近呢?用梯形逼近的话其实无非是$\frac{ b - a }{ n } ( \frac{ y_0 + y_n }{ 2 } \sum_{ k = 1 }^{ n - 1 } y_k )$,然而,对于$f \in C^2 [ a , b ]$,我们声明:</p>
<script type="math/tex; mode=display">
\int_a^b f ( x ) \mathrm{ d } x = \frac{ b - a }{ n } ( \frac{ y_0 + y_n }{ 2 } \sum_{ k = 1 }^{ n - 1 } y_k ) - \frac{ ( b - a )^3 }{ 12 n^2 } f ' ' ( \xi )</script><p>证明当然还是分部积分,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ x_{ k - 1 } }^{ x_k } f ( x ) \mathrm{ d } x \\
= & \int_{ x_{ k - 1 } }^{ x_k } f ( x ) \mathrm{ d } ( x - x_{ k - 1 } ) \\
= & f ( x_k ) \frac{ b - a }{ n } - \int_{ x_{ k - 1 } }^{ x_k } ( x - x_{ k - 1 } ) f ' ( x ) \mathrm{ d } x \\
= & f ( x_k ) \frac{ b - a }{ n } - \frac{ 1 }{ 2 } \int_{ x_{ k - 1 } }^{ x_k } f ' ( x ) \mathrm{ d } ( x - x_{ k - 1 } )^2 \\
= & f ( x_k ) \frac{ b - a }{ n } - \frac{ 1 }{ 2 } f ' ( x_k ) ( \frac{ b - a }{ n } )^2 + \frac{ 1 }{ 2 } \int_{ x_{ k - 1 } }^{ x_k } f ' ' ( x ) ( x - x_{ k - 1 } )^2 \mathrm{ d } x \\

\end{aligned}</script><p>同理,在上面换$x - x_k$而非$x - x_{ k - 1 }$,就可以得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ x_{ k - 1 } }^{ x_k } f ( x ) \mathrm{ d } x \\
= & f ( x_{ k - 1 } ) \frac{ b - a }{ n } + \frac{ 1 }{ 2 } f ' ( x_{ k - 1 } ) ( \frac{ b - a }{ n } )^2 + \frac{ 1 }{ 2 } \int_{ x_{ k - 1 } }^{ x_k } f ' ' ( x ) ( x - x_{ k } )^2 \mathrm{ d } x \\

\end{aligned}</script><p>此时用NL公式,应当能见到把上面两式子相加可以得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ x_{ k - 1 } }^{ x_k } f ( x ) \mathrm{ d } x \\
= & \frac{ f ( x_{ k - 1 } ) + f ( x_k ) }{ 2 } \frac{ b - a }{ n } + \frac{ 1 }{ 4 } \int_{ x_{ k - 1 } }^{ x_k } f ' ' ( x ) ( ( x - x_{ k } )^2 + ( x - x_{ k - 1 } )^2 - ( \frac{ b - a }{ n } )^2 ) \mathrm{ d } x \\
= & \frac{ f ( x_{ k - 1 } ) + f ( x_k ) }{ 2 } \frac{ b - a }{ n } + \frac{ 1 }{ 2 } \int_{ x_{ k - 1 } }^{ x_k } f ' ' ( x ) ( x - x_k ) ( x - x_{ k - 1 } ) \mathrm{ d } x \\
= & \frac{ f ( x_{ k - 1 } ) + f ( x_k ) }{ 2 } \frac{ b - a }{ n } + \frac{ 1 }{ 2 } f ' ' ( \xi_k ) \int_{ x_{ k - 1 } }^{ x_k } ( x - x_k ) ( x - x_{ k - 1 } ) \mathrm{ d } x \\
= & \frac{ y_{ k - 1 } + y_k }{ 2 } \Delta x - \frac{ 1 }{ 12 } f ' ' ( \xi_k ) \frac{ ( b - a )^3 }{ n^3 }
\end{aligned}</script><p>这样就完事了,接下来对$n$求个和就能得到之前的公式.</p>
<p>接下来是二次曲线逼近.考虑用$( x_{ k - 1 } , y_{ k - 1 } ) , ( x_{ k - \frac{ 1 }{ 2 } } , y_{ k - \frac{ 1 }{ 2 } } ) , ( x_k , y_k )$三个点确定一条二次曲线.不妨设这条二次曲线为$Q_k ( x ) = px^2 + qx + r$.然而,此时观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ x_{ k - 1 } }^{ x_k } Q_k ( x ) \mathrm{ d } x \\
= & \frac{ p }{ 3 } ( x_k^3 - x_{ k - 1 }^3 ) + \frac{ q }{ 2 } ( x_k^2 - x_{ k - 1 }^2 ) + r ( x_k - x_{ k - 1 } ) \\
= & \frac{ x_k - x_{ k - 1 } }{ 6 } ( Q_k ( x_k ) + Q_k ( x_{ k - 1 } ) + Q_k ( x_{ k - \frac{ 1 }{ 2 } } ) ) \\
= & \frac{ b - a }{ 6 n } ( y_{ k - 1 } + y_k + 4 y_{ k - \frac{ 1 }{ 2 } } )
\end{aligned}</script><p>这也很合理,观察一下就可以知道这个恰好是在尝试把梯形逼近和中点逼近两种方式尝试约掉后面的误差项系数.</p>
<p>定理是,如果$f \in C^4 [ a , b ]$,误差项为$- \frac{ ( b - a )^5 }{ 2880 n^4 } f^{ ( 4 ) } ( \xi )$.这就是所谓辛普森积分法.</p>
<h5><span id="广义积分">广义积分</span></h5><p>考虑函数$f : [ a , + \infty ) \to \mathbb{ R }$,如果其$\forall b &gt; a$,$f \in R [ a , b ]$,我们称其<strong>内闭可积</strong>.那我们就定义其广义积分为$\int_a^{ + \infty } f \mathrm{ d } x = \lim_{ b \to + \infty } \int_a^b f \mathrm{ d } x$,当后者极限存在时.同理当然可以定义区间$( - \infty , b ]$上的广义积分.而如果$\int_0^{ + \infty } f \mathrm{ d } x$和$\int_{ - \infty }^0 f \mathrm{ d } x$都收敛,则定义它们的和为$\int_{ - \infty }^{ + \infty } f \mathrm{ d } x$.</p>
<p>称一个函数的<strong>瑕点</strong>为其局部无界的点,则考虑$f : [ a , b ) \to \mathbb{ R }$,其中$b$是$f$的瑕点,且$f$内闭可积,则$\int_a^b f ( x ) \mathrm{ d } x = \lim_{ A \to b - 0 } \int_a^A f ( x ) \mathrm{ d } x$,若后者极限存在.瑕积分和上述广义积分并无明显区别,下述也不再区分.</p>
<p>在进一步讨论前,我们应当再仔细研究一下广义积分的收敛性,也就是当什么时候其极限存在呢?我们有以下命题:</p>
<ol>
<li><p>$f ( x ) \geq 0 , x \in [ a , + \infty )$时,$F ( A ) = \int_a^A f ( x ) \mathrm{ d } x$单增.那么此时$F ( + \infty )$存在当且仅当$F ( A )$有界.</p>
</li>
<li><p>比较原理:$0 \leq f \leq cg , c &gt; 0$,若$\int_a^{ + \infty } g \mathrm{ d } x$收敛,则$\int_a^{ + \infty } f \mathrm{ d } x$收敛.该结论可以移植到瑕积分上.</p>
</li>
<li><p>比较原理的推论:$f , g \geq 0 , 0 &lt; c_1 \leq \frac{ f }{ g } \leq c_2$,则$\int f \mathrm{ d } x , \int g \mathrm{ d } x$收敛性相同.进一步地,如果$f , g \geq 0$,在趋近于某个瑕点的时候,$\frac{ f }{ g }$趋近于某个非零常数,那它们在这一点的收敛性相同.</p>
</li>
</ol>
<p>(1)是根据单调收敛准则,而(2)则是(1)的推论,只是给出了一个界.</p>
<p>定义函数$f$是<strong>绝对收敛</strong>,当$\int_a^{ + \infty } | f | \mathrm{ d } x &lt; \infty$时.而考虑$f = | f | - ( | f | - f )$,而$0 \leq | f | - f \leq 2 | f |$,所以绝对收敛可以推出收敛,但反之不可.因此,我们将收敛但不绝对收敛的函数称为<strong>条件收敛</strong>.该结论也可以移植到瑕积分上.</p>
<p>接下来,我们有<strong>柯西收敛原理</strong>:$\int_a^{ + \infty } f \mathrm{ d } x$收敛的充要条件是对于$\forall \epsilon &gt; 0 , \exists M &gt; a$使得$\forall A &gt; B \geq M$,都有$| \int_{ B }^A f \mathrm{ d } x | &lt; \epsilon$.</p>
<p>证明当然无非是函数部分柯西收敛准则的重复应用.</p>
<p>柯西收敛原理推到瑕积分上的话,考虑$F ( x ) = \int_a^x f ( t ) \mathrm{ d } t$,则瑕积分$\lim_{ t \to b - 0 } F ( t )$存在当且仅当$\forall \epsilon &gt; 0$,$\exists \delta &gt; 0$,当$x_1 , x_2 \in ( b - \delta , b )$的时候,有$| F ( x_1 ) - F ( x_2 ) | &lt; \epsilon$.</p>
<p>接下来还有<strong>Dirichlet-Abel判别法</strong>,设$f , g : [ a , + \infty ) \to \mathbb{ R }$内闭可积,$f$单调,那有:</p>
<ol>
<li><p>Dirichlet判别法:如果$f ( + \infty ) = 0$,$G ( A ) = \int_a^A g \mathrm{ d } x$有界,则$\int_a^{ + \infty } fg \mathrm{ d } x$收敛.</p>
</li>
<li><p>Abel判别法:如果$f$有界,$\int_a^{ \infty } g \mathrm{ d } x$收敛,则$\int_a^{ + \infty } fg \mathrm{ d } x$收敛.</p>
</li>
</ol>
<p>用第二积分中值定理,就有$\int_A^B f g \mathrm{ d } x = f ( A ) \int_A^\xi g \mathrm{ d } x + f ( B ) \int_{ \xi }^B g \mathrm{ d } x$.用柯西收敛原理则上述两条均为显然.结论当然可以推广到瑕积分上.</p>
<h6><span id="example1">Example1</span></h6><p>设$f$在$( - \infty , + \infty )$上内闭可积,且$f ( + \infty ) = A , f ( - \infty ) = B$,对于$a &gt; 0$,求证$\int_{ - \infty }^{ + \infty } \left ( f ( x + a ) - f ( x ) \right ) \mathrm{ d } x$收敛并求其值.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^{ C } \left ( f ( x + a ) - f ( x ) \right ) \mathrm{ d } x & = \int_{ a }^{ C + a } f ( x ) \mathrm{ d } x - \int_0^C f ( x ) \mathrm{ d } x \\
& = \int_{ C }^{ C + a } f ( x ) \mathrm{ d } x - \int_0^a f ( x ) \mathrm{ d } x \\
& \to aA - \int_0^a f ( x ) \mathrm{ d } x
\end{aligned}</script><p>另一侧同理为:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_{ - C }^{ 0 } \left ( f ( x + a ) - f ( x ) \right ) \mathrm{ d } x & = \int_{ - C + a }^{ a } f ( x ) \mathrm{ d } x - \int_{ - C }^0 f ( x ) \mathrm{ d } x \\
& = - \int_{ - C }^{ - C + a } f ( x ) \mathrm{ d } x + \int_0^a f ( x ) \mathrm{ d } x \\
& \to - aB + \int_0^a f ( x ) \mathrm{ d } x
\end{aligned}</script><p>于是答案是$a ( A - B )$.</p>
<h6><span id="example2">Example2</span></h6><p>求证:</p>
<script type="math/tex; mode=display">
\int_{ 1 }^{ + \infty } \frac{ \mathrm{ d } x }{ x^p } = \begin{cases}
\lt \infty & p \gt 1 \\
\infty & p \leq 1
\end{cases}</script><p>显然.</p>
<h6><span id="example3">Example3</span></h6><p>求证:$\int_a^{ + \infty } \frac{ \sin^2 x }{ x^2 } \mathrm{ d } x$收敛.</p>
<p>原因是由比较原理,所以$0 \leq \frac{ \sin^2 x }{ x^2 } \leq \frac{ 1 }{ x^2 }$,立刻知其收敛性.</p>
<h6><span id="example4">Example4</span></h6><p>判断$\int_0^{ + \infty } \frac{ x \mathrm{ d } x }{ 1 + x^4 \sin^2 x }$的收敛性.</p>
<p>考虑取$F ( A ) = \int_0^A \frac{ x \mathrm{ d } x }{ 1 + x^4 \sin^2 x }$,接下来考虑$F ( n \pi ) = \sum_{ k = 1 }^n U_k$,其中$U_k = \int_{ ( k - 1 ) \pi }^{ k \pi } \frac{ x \mathrm{ d } x }{ 1 + x^4 \sin^2 x }$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
U_k & = \int_{ ( k - 1 ) \pi }^{ k \pi } \frac{ x \mathrm{ d } x }{ 1 + x^4 \sin^2 x } \\
& \geq \int_{ ( k - 1 ) \pi }^{ k \pi } \frac{ x \mathrm{ d } x }{ 1 + ( k \pi )^4 \sin^2 x } \\
& \geq 2 ( k - 1 ) \pi \int_{ 0 }^{ \frac{ \pi }{ 2 } } \frac{ x \mathrm{ d } x }{ 1 + ( k \pi )^4 ( \sin x )^2 } \\
& \geq 2 ( k - 1 ) \pi \int_{ 0 }^{ \frac{ \pi }{ 2 } } \frac{ x \mathrm{ d } x }{ 1 + ( k \pi )^4 x^2 } \\
& = \frac{ 2 ( k - 1 ) \pi }{ k^2 \pi^2 } \arctan ( k^2 \pi^2 x ) |_0^{ \frac{ \pi }{ 2 } } \\
& \geq \frac{ 2 ( k - 1 ) \pi }{ k^2 \pi^2 } \arctan ( \frac{ \pi^3 }{ 2 } ) \\
& = O ( \frac{ 1 }{ k } )
\end{aligned}</script><p>这就证完了,必然发散.</p>
<h6><span id="example5">Example5</span></h6><p>$f : ( - \infty , + \infty ) \to \mathbb{ R }$且内闭可积,$p &gt; 0$,并且$\int_{ - \infty }^{ + \infty } | f |^p \mathrm{ d } x &lt; \infty$,求证$\lim_{ h \to 0 } \int_{ - \infty }^{ + \infty } \left | f ( x + h ) - f ( x ) \right |^p \mathrm{ d } x$收敛.</p>
<p>既然$\int_{ - \infty }^{ + \infty } | f |^p \mathrm{ d } x &lt; \infty$,那么一定存在一个足够大的$A$,使得$\int_{ A }^{ + \infty } | f |^p \mathrm{ d } x$足够小,不妨取足够大的$A &gt; 0$使得$\int_{ A - 1 }^{ + \infty } | f |^p \mathrm{ d } x &lt; \epsilon_1$.</p>
<p>事实上考虑$| u + v | \leq | u | + | v | \leq 2 \max ( | u | , | v | )$,那么$| u + v |^p \leq 2^p ( | u |^p + | v |^p )$,取$| h | &lt; 1$,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ A }^{ + \infty } \left | f ( x + h ) - f ( x ) \right |^p \mathrm{ d } x \\
\leq & 2^p \int_{ A }^{ + \infty } | f ( x + h ) |^p \mathrm{ d } x + 2^p \int_{ A }^{ + \infty } | f ( x ) |^p \mathrm{ d } x \\
= & 2^p \int_{ A + h }^{ + \infty } | f ( x ) |^p \mathrm{ d } x + 2^p \int_{ A }^{ + \infty } | f ( x ) |^p \mathrm{ d } x \\
\leq & 2^{ p + 1 } \int_{ A - 1 }^{ + \infty } | f |^p \mathrm{ d } x \\
\leq & 2^{ p + 1 } \epsilon_1
\end{aligned}</script><p>同理,另一侧也可以放掉.现在的问题在于$( - A + 1 , A - 1 )$中间这一段.</p>
<p>考虑用一个线性函数逼近,做分划$\Delta : - A + 1 = x_0 &lt; \cdots &lt; x_n = A - 1$,取线性函数逼近,策略为$x \in [ x_{ k - 1 } , x_k ]$的时候$g ( x ) = \frac{ f ( x_k ) - f ( x_{ k - 1 } ) }{ x_k - x_{ k - 1 } } ( x - x_{ k - 1 } ) + f ( x_{ k - 1 } )$.接下来考虑对于每一段,设$M_k = \sup_{ [ x_{ k - 1 } , x_k ] } f , m_k = \inf_{ [ x_{ k - 1 } , x_k ] } f$,则每一段可以被控制为$M_k - m_k$.我们早在之前就提过黎曼可积的函数可被线性函数逼近,然而疑问是这种逼近能否在$p$次方意义下满足,于是取足够小的划分使得$\sum_{ k = 1 }^n ( M_k - m_k ) \Delta x_k &lt; \epsilon_2^2$.</p>
<p>接下来常规分治,取$C = \{ 1 \leq k \leq n | M_k - m_k \geq \epsilon_2 \}$而$B = \{ 1 \leq k \leq n | M_k - m_k &lt; \epsilon_2 \}$.见到$\sum_{ k \in C } \Delta x_k &lt; \epsilon_2$.不妨设$M = \sup_{ [ - A + 1 , A - 1 ] } f , m = \inf_{ [ - A + 1 , A - 1 ] } f$立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ - A + 1 }^{ A - 1 } \left | f - g \right |^p \mathrm{ d } x \\
\leq & \sum_{ k } | M_k - m_k |^p \Delta x_k \\
= & \sum_{ k \in C } | M_k - m_k |^p \Delta x_k + \sum_{ k \in B } | M_k - m_k |^p \Delta x_k \\
\leq & | M - m |^p \epsilon_2 + \epsilon_2^p ( 2 A - 2 )
\end{aligned}</script><p>这样这里就被限制住了,而考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ - \infty }^{ + \infty } \left | f ( x + h ) - f ( x ) \right |^p \mathrm{ d } x \\
\leq & \int_{ - \infty }^{ + \infty } 3^p \left ( \left | f ( x + h ) - g ( x + h ) \right |^p + \left | g ( x + h ) - g ( x ) \right |^p + \left | f ( x ) - g ( x ) \right |^p \right ) \mathrm{ d } x \\

\end{aligned}</script><p>前后两项都能被上述控制住,只剩中间的$| g ( x + h ) - g ( x ) |^p$是$O ( h^p )$的,只需调整$h$就能控制住.</p>
<h6><span id="example6">Example6</span></h6><p>求证:$\int_1^{ + \infty } \frac{ \sin x }{ x } \mathrm{ d } x$是条件收敛的.</p>
<p>用DA判别法,取$f = \frac{ 1 }{ x }$当然趋近于$0$,而$| \int_1^A \sin x \mathrm{ d } x | \leq 2$,于是收敛.</p>
<p>那接下来就要证明它并非绝对收敛.只需考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_1^{ + \infty } \frac{ | \sin x | }{ x } \mathrm{ d } x \\
\geq & \int_1^{ + \infty } \frac{ \sin^2 x }{ x } \mathrm{ d } x \\
= & \int_1^{ + \infty } \frac{ 1 - \cos^2 x }{ x } \mathrm{ d } x
\end{aligned}</script><p>当然并不绝对收敛.</p>
<p>事实上还可以直接求出来这个积分的值.</p>
<p>接下来考虑$f ( x ) = \begin{cases}0 &amp; x = 0 \ \frac{ 1 }{ x } - \frac{ 1 }{ 2 \sin \frac{ x }{ 2 } } &amp; x \in [ - \pi , \pi ] \setminus \{ 0 \}\end{cases}$.只需泰勒展开就知道它是解析的.回忆到黎曼引理:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ \infty } \frac{ \sin x }{ x } \mathrm{ d } x \\
= & \lim_{ n \to + \infty } \int_{ 0 }^{ ( n + \frac{ 1 }{ 2 } ) \pi } \frac{ \sin x }{ x } \mathrm{ d } x \\
= & \lim_{ n \to + \infty } \int_{ 0 }^{ \pi } \frac{ \sin ( ( n + \frac{ 1 }{ 2 } ) t ) }{ t } \mathrm{ d } t \\
= & \lim_{ n \to + \infty } \int_{ 0 }^{ \pi } \left ( f ( t ) + \frac{ 1 }{ 2 \sin \frac{ t }{ 2 } } \right ) \sin ( ( n + \frac{ 1 }{ 2 } ) t ) \mathrm{ d } t \\
= & \lim_{ n \to + \infty } \int_{ 0 }^{ \pi } \frac{ 1 }{ 2 \sin \frac{ t }{ 2 } } \sin ( ( n + \frac{ 1 }{ 2 } ) t ) \mathrm{ d } t \\
= & \lim_{ n \to + \infty } \int_{ 0 }^{ \pi } \left ( \frac{ 1 }{ 2 } + \sum_{ k = 1 }^n \cos ( kt ) \right ) \mathrm{ d } t \\
= & \frac{ \pi }{ 2 }
\end{aligned}</script><h6><span id="example7">Example7</span></h6><p>给定$f \in C [ 0 , + \infty ]$,$\int_0^{ + \infty } f^2 \mathrm{ d } x &lt; + \infty , f ( 0 ) = 0$,取$g ( x ) = \int_0^x f ( t ) \mathrm{ d } t$,求证:$\int_0^{ + \infty } \frac{ g^2 ( x ) }{ x^2 } \mathrm{ d } x \leq 4 \int_0^{ + \infty } f^2 \mathrm{ d } x$以证明前者存在.</p>
<p>当然是分部积分,用洛必达法则知道$\lim_{ x \to 0 } \frac{ g }{ x } \to 0$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^A \frac{ g^2 }{ x^2 } \mathrm{ d } x & = \int_0^A g^2 \mathrm{ d } ( - \frac{ 1 }{ x } ) \\
& = - \frac{ g^2 ( x ) }{ x } |_0^A + \int_0^A \frac{ 2 gf }{ x } \mathrm{ d } x \\
& = - \frac{ g^2 ( A ) }{ A } + 2 \int_0^A \frac{ g }{ x } f \mathrm{ d } x \\
& \leq 2 ( \int_0^A \frac{ g^2 }{ x^2 } \mathrm{ d } x )^{ \frac{ 1 }{ 2 } } ( \int_0^A f^2 \mathrm{ d } x )^{ \frac{ 1 }{ 2 } }
\end{aligned}</script><p>整理一下就做完了.</p>
<h6><span id="example8欧拉积分">Example8(欧拉积分)</span></h6><p>求$\int_0^{ + \infty } \frac{ x^{ p - 1 } }{ 1 + x } \mathrm{ d } x , 0 &lt; p &lt; 1$的收敛性和值.</p>
<p>考虑$\frac{ x^{ p - 1 } }{ 1 + x }$在$x \to 0$的时候趋近于$x^{ p - 1 }$,而在$x \to \infty$的时候趋近于$x^{ p - 2 }$,因此绝对收敛.</p>
<p>难点在于把这个东西求出来.接下来将采取一些不严谨的说法.</p>
<p>考虑$0 \leq x &lt; 1$的时候,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ x^{ p - 1 } }{ 1 + x } & = x^{ p - 1 } \sum_{ j = 0 }^\infty ( - x )^j \\
& = \sum_{ j = 0 } ( - 1 )^j x^{ p + j - 1 } \\

\end{aligned}</script><p>暂时抛开多余的思量,两边做积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^1 \frac{ x^{ p - 1 } }{ 1 + x } \mathrm{ d } x & = \sum_{ j = 0 } ( - 1 )^j \int_0^1 x^{ p + j - 1 } \mathrm{ d } x \\
& = \sum_{ j = 0 } ( - 1 )^j \frac{ 1 }{ p + j }
\end{aligned}</script><p>另一边,其实只需换元,可以发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_1^{ + \infty } \frac{ x^{ p - 1 } }{ 1 + x } \mathrm{ d } x \\
= & \int_0^1 \frac{ t^{ 1 - p } }{ 1 + t^{ - 1 } } \frac{ \mathrm{ d } t }{ t^2 } \\
= & \int_0^1 \frac{ t^{ - p } }{ 1 + t } \mathrm{ d } t \\
= & \int_0^1 \frac{ t^{ 1 - p - 1 } }{ 1 + t } \mathrm{ d } t \\
= & \sum_{ j = 0 }^{ \infty } ( - 1 )^j \frac{ 1 }{ 1 - p + j } \\
= & \sum_{ j = 0 }^{ \infty } ( - 1 )^{ j + 1 } \frac{ 1 }{ p - ( j + 1 ) } \\
= & \sum_{ j = 1 }^{ \infty } ( - 1 )^{ j } \frac{ 1 }{ p - j } \\

\end{aligned}</script><p>结合起来,答案当然就是$\sum_{ j = - \infty }^{ + \infty } \frac{ ( - 1 )^j }{ p + j }$.</p>
<p>我们暂且断言上面那个无穷级数等于$\frac{ \pi }{ \sin ( p \pi ) }$,原因是我们权且承认下述级数是正确的:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ \sin t } = \sum_{ j = - \infty }^{ + \infty } \frac{ ( - 1 )^j }{ p + j \pi }</script><h6><span id="example9frullani积分">Example9(Frullani积分)</span></h6><p>当$f \in C [ 0 , + \infty )$,且$\int_0^{ + \infty } \frac{ f ( x ) }{ x } \mathrm{ d } x$收敛,求证$\int_0^{ + \infty } \frac{ f ( ax ) - f ( bx ) }{ x } \mathrm{ d } x = f ( 0 ) \ln \frac{ b }{ a }$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_A^{ B } \frac{ f ( ax ) - f ( bx ) }{ x } \mathrm{ d } x \\
= & \int_{ aA }^{ aB } \frac{ f ( x ) }{ x } \mathrm{ d } x - \int_{ bA }^{ bB } \frac{ f ( x ) }{ x } \mathrm{ d } x \\
= & \int_{ aA }^{ bA } \frac{ f ( x ) }{ x } \mathrm{ d } x - \int_{ aB }^{ bB } \frac{ f ( x ) }{ x } \mathrm{ d } x \\
= & \int_{ a }^{ b } \frac{ f ( Ax ) }{ x } \mathrm{ d } x - \int_{ aB }^{ bB } \frac{ f ( x ) }{ x } \mathrm{ d } x \\

\end{aligned}</script><p>前者当$A \to 0$的时候当然转化为$\int_{ a }^{ b } \frac{ f ( 0 ) }{ x } \mathrm{ d } x$,而后者用柯西判准知道趋近于$0$,立刻完事.</p>
<h6><span id="example10">Example10</span></h6><p>求$I = \int_0^{ \frac{ \pi }{ 2 } } \ln ( \sin x ) \mathrm{ d } x$.</p>
<p>考虑$x \to 0$的时候,$\ln ( \sin x ) \sim \ln x$,而$\int \ln x = x \ln x - x$,因此是绝对收敛的.</p>
<p>那怎么求这个积分呢?考虑一些对称技巧,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = \int_0^{ \frac{ \pi }{ 2 } } \ln ( \sin x ) \mathrm{ d } x \\
& = \int_{ \frac{ \pi }{ 2 } }^{ \pi } \ln ( \sin x ) \mathrm{ d } x \\
& = \int_{ 0 }^{ \frac{ \pi }{ 2 } } \ln ( \cos x ) \mathrm{ d } x \\

\end{aligned}</script><p>那么:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I & = \frac{ 1 }{ 2 } \int_0^\pi \ln ( \sin x ) \mathrm{ d } x \\
& = \int_0^{ \frac{ \pi }{ 2 } } \ln ( \sin 2 t ) \mathrm{ d } t \\
& = \int_0^{ \frac{ \pi }{ 2 } } \left ( \ln 2 + \ln ( \sin t ) + \ln ( \cos t ) \right ) \mathrm{ d } t \\
& = \frac{ \pi }{ 2 } \ln 2 + 2 I
\end{aligned}</script><p>所以$I = - \frac{ \pi }{ 2 } \ln 2$.</p>
<h6><span id="example11">Example11</span></h6><p>讨论$\int_0^1 \frac{ \ln x }{ x^{ \alpha } } , \alpha &gt; 0$的收敛性.</p>
<p>考虑$x \in ( 0 , 1 ]$的时候,$\frac{ \ln x }{ x^{ \alpha } } \leq 0$,因此其收敛性当然等价于绝对收敛性.取$x \to 0$的部分,而考虑:</p>
<p>当$0 &lt; \alpha &lt; 1$,任取一个足够小的$\delta &gt; 0$使得$0 &lt; \alpha + \delta &lt; 1$,都可以取足够逼近的$x \to 0$使得$| \frac{ \ln x }{ x^{ \alpha } } | &lt; \frac{ 1 }{ x^{ \alpha + \delta } }$.于是此时绝对收敛.反之,当$\alpha \geq 1$的时候,$| \frac{ \ln x }{ x^\alpha } | &gt; \frac{ 1 }{ x }$,此时发散.</p>
<h6><span id="example12">Example12</span></h6><p>讨论$p , q &gt; 0$,$\int_2^{ + \infty } \frac{ \mathrm{ d } x }{ x^p \ln^q x }$的收敛性.</p>
<p>当$p &gt; 1$的时候,显然$\frac{ 1 }{ x^p \ln^q x } &lt; \frac{ 1 }{ x^p }$,因此当然绝对收敛.</p>
<p>当$p &lt; 1$的时候,同Example11,只需放掉$\ln x$就行,因此是发散的.</p>
<p>当$p = 1$的时候,估计出了点问题,此时做换元$t = \ln x$,则原式变为:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ \ln 2 }^{ + \infty } e^{ - t } e^{ t } \frac{ 1 }{ t^q } \mathrm{ d } t \\
= & \int_{ \ln 2 }^{ + \infty } \frac{ 1 }{ t^q } \mathrm{ d } t \\

\end{aligned}</script><p>所以当$q &gt; 1$的时候收敛,当$q \leq 1$的时候发散.</p>
<h6><span id="example13">Example13</span></h6><p>讨论$I = \int_0^{ \frac{ \pi }{ 2 } } \frac{ \sin x }{ x^p } \mathrm{ d } x$的收敛性.</p>
<p>设$f = \frac{ \sin x }{ x }$,容易见到$f$在$( 0 , \frac{ \pi }{ 2 } )$上是单调递减的,那就应当有:</p>
<script type="math/tex; mode=display">
\frac{ 2 }{ \pi } \frac{ 1 }{ x^{ p - 1 } } \leq \frac{ \sin x }{ x^p } = \frac{ \sin x }{ x } \frac{ 1 }{ x^{ p - 1 } } \leq \frac{ 1 }{ x^{ p - 1 } }</script><p>因此其收敛性等价于$\int_{ 0 }^{ \frac{ \pi }{ 2 } } \frac{ 1 }{ x^{ p - 1 } }$的收敛性,当$p &lt; 2$时收敛.</p>
<h6><span id="example14">Example14</span></h6><p>设$f \in C^2 [ a , + \infty )$,若$\int_a^{ + \infty } f^2 ( x ) \mathrm{ d } x &lt; + \infty , \int_a^{ + \infty } ( f ‘ ‘ )^2 ( x ) \mathrm{ d } x &lt; + \infty$,求证$\int_a^{ + \infty } ( f ‘ )^2 ( x ) \mathrm{ d } x &lt; + \infty$.</p>
<p>此时考虑做分部积分,当然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^x f ( t ) f ' ' ( t ) \mathrm{ d } t & = f ( x ) f ' ( x ) - f ( a ) f ' ( a ) - \int_a^x ( f ' ( t ) )^2 \mathrm{ d } t \\
f ( x ) f ' ( x ) & = f ( a ) f ' ( a ) + \int_a^x f ( t ) f ' ' ( t ) \mathrm{ d } t + \int_a^x ( f ' ( t ) )^2 \mathrm{ d } t \\

\end{aligned}</script><p>此时回忆到柯西不等式:</p>
<script type="math/tex; mode=display">
( \int_a^x f ( t ) f ' ' ( t ) \mathrm{ d } t ) \leq ( \int_a^x f^2 ( t ) \mathrm{ d } t ) ( \int_a^x ( f ' ' ( t ) )^2 \mathrm{ d } t )</script><p>因此这一项被控制住了,于是我们知道$f ( x ) f ‘ ( x )$和$\int_a^x ( f ‘ ( t ) )^2 \mathrm{ d } t$收敛性相同.</p>
<p>接下来反证原结论,假设后者并不收敛而是趋近$+ \infty$.那$f ( x ) f ‘ ( x ) \to + \infty$,对其做积分,则:</p>
<script type="math/tex; mode=display">
\int_a^{ + \infty } f ( x ) f ' ( x ) \mathrm{ d } x = \int_a^{ + \infty } f ( x ) \mathrm{ d } f ( x ) = f^2 ( x ) - f^2 ( a )</script><p>因此$f^2 ( x ) \to + \infty$,这当然与$\int_a^{ + \infty } f^2 ( x ) \mathrm{ d } x &lt; + \infty$相违背.</p>
<h6><span id="example15">Example15</span></h6><p>判断$\int_1^{ + \infty } \tan \left ( \cfrac{ \sin x }{ x } \right ) \mathrm{ d } x$的收敛性.</p>
<p>考虑$\int_1^{ + \infty } \frac{ \sin x }{ x } \mathrm{ d } x$当然是收敛的,而对$\tan \frac{ \sin x }{ x }$做泰勒展开应该和$\frac{ \sin x }{ x }$同阶,于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_1^{ + \infty } \tan \left ( \cfrac{ \sin x }{ x } \right ) \mathrm{ d } x \\
= & \int_1^{ + \infty } \frac{ \sin x }{ x } \mathrm{ d } x + \int_1^{ + \infty } \left ( \tan \left ( \cfrac{ \sin x }{ x } \right ) - \frac{ \sin x }{ x } \right ) \mathrm{ d } x \\

\end{aligned}</script><p>前半部分当然收敛,后半部分取绝对值放缩后是$O ( \frac{ 1 }{ x^2 } )$的,当然也收敛.</p>
<h6><span id="example16">Example16</span></h6><p>讨论$\int_1^{ + \infty } \frac{ \sin x }{ x^p } \arctan x \mathrm{ d } x , p &gt; 0$的收敛性.</p>
<p>$\int_1^{ + \infty } \frac{ \sin x }{ x^p } \mathrm{ d } x$收敛,而$\arctan x$单调有界,立刻知道收敛.</p>
<h6><span id="example17">Example17</span></h6><p>讨论$\int_2^{ + \infty } \frac{ \cos \sqrt{ x } }{ x^p \ln x } \mathrm{ d } x$的收敛性.</p>
<p>当然先做换元$t = \sqrt{ x }$,那么原式变成:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ \sqrt{ 2 } }^{ + \infty } \frac{ 2 t \cos t \mathrm{ d } t }{ t^{ 2 p } \ln t^2 } \\
= & \int_{ \sqrt{ 2 } }^{ + \infty } \frac{ \cos t \mathrm{ d } t }{ t^{ 2 p - 1 } \ln t } \\

\end{aligned}</script><p>$2 p - 1 &gt; 1 , p &gt; 1$的时候当然绝对收敛,而$0 \leq 2 p - 1 \leq 1$的时候用DA判准知道收敛,$2 p - 1 &lt; 0$的时候当然发散.</p>
<h6><span id="example18磨光核函数">Example18(磨光核函数)</span></h6><p>构造一个$C^{ \infty }$的函数$g ( x )$,满足当$x \leq 0$的时候,$g ( x ) = 0$;而当$x \geq 1$的时候,$g ( x ) = 1$.也就是你要造一个函数把两段直线焊接起来.</p>
<p>考虑$h ( x ) = \begin{cases}e^{ - \frac{ 1 }{ x^2 } } &amp; x \ne 0 \ 0 &amp; x = 0\end{cases}$.这个$h ( x )$容易检验是$C^{ \infty }$的,只需看$0$点处的可导性即可.</p>
<p>取$H ( x ) = \int_{ - \infty }^x h ( t ) h ( 1 - t ) \mathrm{ d } t$.容易见到这函数在$0$处和$1$处都无穷阶可导.稍微乘下常数就可以搞定.</p>
<h6><span id="example19">Example19</span></h6><p>$\int_0^{ + \infty } f ( x ) \mathrm{ d } x$收敛,$xf ( x )$单调,求证:$\lim_{ x \to \inf } xf ( x ) \ln x = 0$.</p>
<p>首先容易证明$xf ( x )$单调递减趋于$0$.那么:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ x_0 }^{ x_0^2 } f ( x ) \mathrm{ d } x \\
= & \int_{ x_0 }^{ x_0^2 } f ( x ) \frac{ x }{ x } \mathrm{ d } x \\
= & \int_{ x_0 }^{ x_0^2 } xf ( x ) \mathrm{ d } \ln x \\
\geq & x_0^2 f ( x_0^2 ) \ln x_0 \\
= & \frac{ 1 }{ 2 } x_0^2 f ( x_0^2 ) \ln x_0^2
\end{aligned}</script><p>令$x_0 \to \inf$用柯西准则证毕.</p>
<h6><span id="example20">Example20</span></h6><p>求证:当$\int_a^b | f | &lt; \infty$的时候,黎曼引理仍然成立.</p>
<p>回忆到黎曼引理要求$f \in R [ a , b ]$,但这里的确可以推广,原因是瑕积分肯定只有有限个瑕点(有无限个瑕点能立刻证明发散),只需要用足够小的区间把这有限个瑕点盖住,用柯西准则就可以证明这部分很小,而外面的部分当然是正常的黎曼引理.</p>
<h4><span id="rs积分">RS积分</span></h4><p>设$\alpha ( x ) : [ a , b ] \to \mathbb{ R }$是一个单调不减的函数,对于有界函数$f ( x ) : [ a , b ] \to \mathbb{ R }$,考虑一个分划$P : a = x_0 &lt; \cdots &lt; x_n = b$,定义$\Delta \alpha_k = \alpha ( x_k ) - \alpha ( x_{ k - 1 } ) \geq 0$,并定义$M_k = \sup_{ [ x_{ k - 1 } , x_k ] } f ( x ) , m_k = \inf_{ [ x_{ k - 1 } , x_k ] } f ( x )$.在此基础上定义<strong>上和</strong>$U ( P , f , \alpha ) = \sum_{ k = 1 }^n M_k \Delta \alpha_k$,同理定义<strong>下和</strong>$L ( P , f , \alpha ) = \sum_{ k = 1 }^n m_k \Delta \alpha_k$.定义<strong>上积分</strong>$\overline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha = \inf_P{ U ( P , f , \alpha ) }$,同理定义<strong>下积分</strong>$\underline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha = \inf_P{ L ( P , f , \alpha ) }$.那么如果有以下$\overline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha = \underline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha$,称$f$在$[ a , b ]$上关于$\alpha$<strong>RS可积</strong>,记作$f \in{ R }_\alpha [ a , b ]$,而将此值称作$f$关于$\alpha$的RS积分,记作$\int_a^b f ( x ) \mathrm{ d } \alpha$.</p>
<p>类比黎曼积分那套理论,应当有以下显而易见的性质:</p>
<ol>
<li><p>分划$P^<em>$如果是$P$的加密,那么$L ( P , f , \alpha ) \leq L ( P^</em> , f , \alpha ) , U ( P , f , \alpha ) \geq U ( P^* , f , \alpha )$.</p>
</li>
<li><p>$L ( P_1 , f , \alpha ) \leq U ( P_2 , f , \alpha )$.</p>
</li>
<li><p>$\underline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha \leq \overline{ \int_{ a }^b } f ( x ) \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f \in{ R }_\alpha$,其充要条件是$\forall \epsilon &gt; 0$,存在分划$P$使得$0 \leq U ( P , f , \alpha ) - L ( P , f , \alpha ) &lt; \epsilon$.</p>
</li>
</ol>
<p>接下来考虑证明一些性质:</p>
<ol>
<li><p>$f_1 , f_2 \in{ R }_\alpha [ a , b ]$,则$f_1 + f_2 \in{ R }_\alpha [ a , b ]$,并且$\int_a^b ( f_1 + f_2 ) \mathrm{ d } \alpha = \int_a^b f_1 \mathrm{ d } \alpha + \int_a^b f_2 \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ]$,则$cf \in{ R }_\alpha [ a , b ]$,并且$\int_a^b ( cf ) \mathrm{ d } \alpha = c \int_a^b f \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f_1 , f_2 \in{ R }_\alpha [ a , b ] , f_1 \leq f_2$,则$\int_a^b f_1 \mathrm{ d } \alpha \leq \int_a^b f_2 \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ] , c \in [ a , b ]$,那么$f \in{ R }_\alpha [ a , c ] , f \in{ R }_\alpha [ c , b ]$,且$\int_a^b f \mathrm{ d } \alpha = \int_a^c f \mathrm{ d } \alpha + \int_c^b f \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ] , | f | \leq M$,则$| \int_a^b f \mathrm{ d } \alpha | \leq M \left ( \alpha ( b ) - \alpha ( a ) \right )$.</p>
</li>
<li><p>$f \in{ R }_{ \alpha_1 } [ a , b ]$并且$f \in{ R }_{ \alpha_2 } [ a , b ]$,则$f \in{ R }_{ \alpha_1 + \alpha_2 } [ a , b ]$,并且$\int_a^b f \mathrm{ d } ( \alpha_1 + \alpha_2 ) = \int_a^b f \mathrm{ d } \alpha_1 + \int_a^b f \mathrm{ d } \alpha_2$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ] , c &gt; 0$.则$f \in{ R }_{ c \alpha } [ a , b ]$,并且$\int_a^b f \mathrm{ d } ( c \alpha ) = c \int_a^b f \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ] , m \leq f \leq M , g \in C [ m , M ]$.则$g ( f ( x ) ) \in{ R }_\alpha [ a , b ]$.</p>
</li>
<li><p>$f \in{ R }_\alpha [ a , b ]$,则$| f | \in{ R }_\alpha [ a , b ]$,且$| \int_a^b f \mathrm{ d } \alpha | \leq \int_a^b | f | \mathrm{ d } \alpha$.</p>
</li>
<li><p>$f_1 , f_2 \in{ R }_\alpha [ a , b ]$,则$f_1 f_2 \in{ R }_\alpha [ a , b ]$.</p>
</li>
<li><p>如果极限$\lim_{ \lambda ( P ) \to 0 } ( \sum f ( t_k ) \Delta \alpha_k ) , t_k \in [ x_{ k - 1 } , x_k ]$存在,则$f \in{ R }_\alpha [ a , b ]$并且其RS积分就是上述极限.然而,逆命题未必成立.</p>
</li>
</ol>
<p>对于(1),考虑对于分划$P_1 , P_2$而言:</p>
<script type="math/tex; mode=display">
\begin{aligned}
L ( P_1 , f_1 , \alpha ) + L ( P_2 , f_2 , \alpha ) & \leq L ( P_1 \cup P_2 , f_1 , \alpha ) + L ( P_1 \cup P_2 , f_2 , \alpha ) \\
& \leq L ( P_1 \cup P_2 , f_1 + f_2 , \alpha ) \\
& \leq U ( P_1 \cup P_2 , f_1 + f_2 , \alpha ) \\
& \leq U ( P_1 \cup P_2 , f_1 , \alpha ) + U ( P_1 \cup P_2 , f_2 , \alpha ) \leq U ( P_1 , f_1 , \alpha ) + U ( P_2 , f_2 , \alpha )
\end{aligned}</script><p>对此式子两边同取上下确界可以证明$\forall \epsilon &gt; 0 , U ( P_1 \cup P_2 , f_1 + f_2 , \alpha ) - L ( P_1 \cup P_2 , f_1 + f_2 , \alpha ) &lt; \epsilon$,即可得证(1).</p>
<p>对于(2),显然$U ( P , cf , \alpha ) = cU ( P , f , \alpha )$,下和同理,于是立即得证.</p>
<p>对于(3),由(1),显然$f_2 \geq f_1$时,$\int_a^b ( f_2 - f_1 ) \mathrm{ d } \alpha \geq 0$,于是$\int_a^b f_2 \mathrm{ d } \alpha \geq \int_a^b f_1 \mathrm{ d } \alpha$.</p>
<p>对于(4),考虑既然$f \in R_\alpha [ a , b ]$,那么$\forall \epsilon &gt; 0$,都应该$\exists P$使得$U_{ [ a , b ] } ( P , f , \alpha ) - L_{ [ a , b ] } ( P , f , \alpha ) &lt; \epsilon$,而令$P ‘ = P \cup \{ c \}$,也就是将$c$强行作为一个分点,上式仍然成立,而可以将$P ‘$拆分为两个部分,不妨记作$P_1 , P_2$,应该有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& U_{ [ a , b ] } ( P ' , f , \alpha ) - L_{ [ a , b ] } ( P ' , f , \alpha ) \\
= & U_{ [ a , c ] } ( P_1 , f , \alpha ) - L_{ [ a , c ] } ( P_1 , f , \alpha ) + U_{ [ c , b ] } ( P_2 , f , \alpha ) - L_{ [ c , b ] } ( P_2 , f , \alpha ) < \epsilon
\end{aligned}</script><p>此二项均为正,因此分别$&lt; \epsilon$,那也就说明了$f \in R_\alpha [ a , c ]$且$f \in R_\alpha [ c , b ]$,并且仍然是钦定$c$为分点就可以见到$\int_a^b f \mathrm{ d } \alpha = \int_a^c f \mathrm{ d } \alpha + \int_c^b f \mathrm{ d } \alpha$.</p>
<p>对于(5),由(3)可以得知:</p>
<script type="math/tex; mode=display">
- \int_a^b M \mathrm{ d } \alpha \leq \int_a^b f \mathrm{ d } \alpha \leq \int_a^b M \mathrm{ d } \alpha</script><p>而由定义立刻见到$\int_a^b M \mathrm{ d } \alpha = M ( \alpha ( b ) - \alpha ( a ) )$.</p>
<p>对于(6),考虑$\Delta ( \alpha_1 + \alpha_2 )_k = \Delta \alpha_1 + \Delta \alpha_2$,因此$U ( P , f , \alpha_1 + \alpha_2 ) = U ( P , f , \alpha_1 ) + U ( P , f , \alpha_2 )$.因此证明与(4)无异.</p>
<p>对于(7),只需考虑$\Delta ( c \alpha ) = c \Delta \alpha$,于是$U ( P , f , c \alpha ) = cU ( P , f , \alpha )$,于是证明与(2)无异.</p>
<p>考虑(8)的证明,由于$g$是闭区间上的连续函数,立刻知道其一致连续.也就是$\forall \epsilon &gt; 0 , \exists 0 &lt; \delta &lt; \epsilon$,使得$| s - t | &lt; \delta$时一定有$| g ( s ) - g ( t ) | &lt; \epsilon$.接下来考虑由于$f \in R_\alpha [ a , b ]$,应当可以取一组划分$P : a = x_0 &lt; \cdots &lt; x_n = b$,使得$U ( P , f , \alpha ) - L ( P , f , \alpha ) &lt; \delta^2$.考虑将划分分为两类:$A = \{ 1 \leq k \leq n \mid M_k - m_k &lt; \delta \}$和$B = \{ 1 \leq k \leq n \mid M_k - m_k \geq \delta \}$.这个思路就会和根号分治很像.那接下来考虑定义$M_k^<em> = \sup_{ [ x_{ k - 1 } , x_k ] } g ( f ( x ) ) , m_k^</em> = \inf_{ [ x_{ k - 1 } , x_k ] } g ( f ( x ) )$.</p>
<p>那这就会使得当$k \in A$的时候,由于$g$的一致连续性,立刻可以知道$M_k^<em> - m_k^</em> \leq \epsilon$.而当$k \in B$的时候,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\delta \sum_{ k \in B } \Delta \alpha_k & \leq \sum_{ k \in B } ( M_k - m_k ) \Delta \alpha_k \\
& = U ( P , f , \alpha ) - L ( P , f , \alpha ) < \delta^2
\end{aligned}</script><p>于是$\sum_{ k \in B } \Delta \alpha_k &lt; \delta$.如此一来:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& U ( P , g \circ f , \alpha ) - L ( P , g \circ f , \alpha ) \\
= & \sum_{ k \in A } ( M_k^* - m_k^* ) \Delta \alpha_k + \sum_{ k \in B } ( M_k^* - m_k^* ) \Delta \alpha_k \\
< & \epsilon ( \alpha ( b ) - \alpha ( a ) ) + 2 ( \sup | g | ) \delta \\
< & \epsilon \left ( \alpha ( b ) - \alpha ( a ) + 2 \sup | g | \right )
\end{aligned}</script><p>这样就证毕了.</p>
<p>考虑(9)的证明,首先由(8)知道$| f | \in{ R }_\alpha [ a , b ]$.而我们可以说存在$c = \pm 1$,使得$| \int_a^b f \mathrm{ d } \alpha | = c ( \int_a^b f \mathrm{ d } \alpha )$.而$cf ( x ) \leq | f ( x ) |$,由(3)的保序性得证.</p>
<p>考虑(10)的证明,嵌套函数$g = x^2$并利用(9),则我们可以知道如果$f \in{ R }_\alpha [ a , b ]$,那么$f^2 \in{ R }_\alpha [ a , b ]$.此时观察到$4 f_1 f_2 = ( f_1 + f_2 )^2 - ( f_1 - f_2 )^2$,立即得证.</p>
<p>(11)的证明比较显然.(11)直接的逆命题的话有个反例是考虑$f ( x ) = \begin{cases}1 &amp; x \geq 0 \ 0 &amp; x &lt; 0\end{cases} , \alpha ( x ) = \begin{cases}1 &amp; x &gt; 0 \ 0 &amp; x \leq 0\end{cases}$.此时会发现$x = 0$这个点取不取在分划里是重要的,只要不取在分划里,怎么加密也没有用.</p>
<p>接下来当然应当研究一下连续性对RS可积的意义.我们声明:</p>
<ol>
<li><p>如果$f \in C [ a , b ]$,则$f \in{ R }_\alpha [ a , b ]$且对$\forall \epsilon &gt; 0 , \exists \delta &gt; 0$,并且只要$\lambda ( P ) &lt; \delta$,那么$| \sum f ( t_k ) \Delta \alpha_k - \int_a^b f \mathrm{ d } \alpha | &lt; \epsilon$,其中$t_k \in [ x_{ k - 1 } , x_k ]$.</p>
</li>
<li><p>(1)中的条件如果改成$f \in R_\alpha [ a , b ] , \alpha \in C [ a , b ]$,结论仍然成立.</p>
</li>
<li><p>如果$f$单调,但是$\alpha$连续,则我们也能证明$f_\alpha \in{ R }_\alpha [ a , b ]$.</p>
</li>
<li><p>作为(3)的推论,如果$f$是有界变差函数,$\alpha$连续,也能证明$f_\alpha \in{ R }_\alpha [ a , b ]$.</p>
</li>
<li><p>如果$[ a , b ]$上的有界函数$f$只有有限个间断点,并且$f$和$\alpha$的间断点集交集为空,则$f \in R_\alpha [ a , b ]$.同时,(1)中的性质仍然成立.</p>
</li>
</ol>
<p>(1)的证明,考虑$\forall \epsilon &gt; 0$,取$\gamma &gt; 0$,使得$\left ( \alpha ( b ) - \alpha ( a ) \right ) \gamma &lt; \epsilon$.此时,$f$是闭区间上的连续函数,那它就一定是一致连续的函数.那么$\exists \delta &gt; 0$,当$| x - y | &lt; \delta$的时候,有$| f ( x ) - f ( y ) | &lt; \gamma$.此时只需考虑$U ( P , f , \alpha ) - L ( P , f , \alpha ) &lt; \epsilon$就做完了.</p>
<p>(2)的证明,考虑既然$f \in R_{ \alpha } [ a , b ]$,因此一定存在一组分划$P^<em>$使得$U ( P^</em> , f , \alpha ) &lt; \int_a^b f \mathrm{ d } \alpha + \epsilon$.</p>
<p>那么接下来对于任意一组分划$P : a = x_0 &lt; \cdots &lt; x_m = b$,将其分为两组:一组是$A = \{ k \mid \exists i , x_i^<em> \in ( x_{ k - 1 } , x_k ) \}$,$B = \{ 1 , 2 , \cdots , m \} \setminus A$.也即$B$中的每个区间都被包含在$P^</em>$的分划中.既然如此,在$B$上的和的部分当然就要$\leq U ( P^* , f , \alpha ) &lt; \int_a^b f \mathrm{ d } \alpha + \epsilon$.只要我们能证明$A$能被控制住即可.</p>
<p>而由于$\alpha$连续,其在$[ a , b ]$上绝对连续,可以取足够小的分划使得$\Delta \alpha$足够小.既然如此,$\sum_{ k \in A } f ( t_k ) \Delta \alpha_k \leq nM \max \{ \Delta \alpha_k \}$,其中$M$是$f$在$[ a , b ]$上的上界,这个立刻可以被$\max \{ \Delta \alpha_k \}$控制住.</p>
<p>(3)的证明,不妨设$f$单调不降,此时考虑取足够大的$n$使得$\frac{ \alpha ( b ) - \alpha ( a ) }{ n } ( f ( b ) - f ( a ) ) &lt; \epsilon$.那么由于$\alpha$连续,所以其有介值性,可以通过选取划分使得$\Delta \alpha_k \equiv \frac{ \alpha ( b ) - \alpha ( a ) }{ n } ( f ( b ) - f ( a ) )$,那还是考虑$U ( P , f , \alpha ) - L ( P , f , \alpha ) &lt; \epsilon$即可.</p>
<p>(5)的证明相当平凡,只需用闭区间上的连续函数是一致连续处理间断点即可,在此略过.</p>
<p>于上述基础上进一步拓展,可以拓展到$\alpha$是有界变差的情况.原因是有界变差函数可以表示为两个不降函数的差,不妨设$\alpha ( x ) = \beta ( x ) - \gamma ( x )$,则我们定义$\int_a^b f \mathrm{ d } \alpha = \int_a^b f \mathrm{ d } \beta - \int_a^b f \mathrm{ d } \gamma$.</p>
<p>这个还要证明是良定的,原因是如果一个有界变差函数能表示成两种情形,有$\beta_1 ( x ) - \gamma_1 ( x ) = \beta_2 ( x ) - \gamma_2 ( x )$,那么$\beta_1 ( x ) + \gamma_2 ( x ) = \beta_2 ( x ) + \gamma_1 ( x )$,这两边都是不降函数,那根据$\alpha$部分可以加减的性质就完事了.</p>
<p>既然如此,对拓展的版本进一步寻找性质,不妨设$V ( x ) = V_a^x \alpha$.</p>
<ol>
<li><p>$f \in C [ a , b ]$且$\alpha$是有界变差,或$f , \alpha$都是有界变差且$f$连续时,$| \int_a^b f \mathrm{ d } \alpha | \leq \int_a^b f \mathrm{ d } V$</p>
</li>
<li><p>作为(1)的推论,上述条件时,$| \int_a^b f \mathrm{ d } \alpha | \leq \sup | f | \times V_a^b \alpha$</p>
</li>
<li><p>(分部积分):当$\alpha , f$都是有界变差,并且它们有一个是连续的时候,$\int_a^b f \mathrm{ d } \alpha = f \alpha \mid_a^b - \int_a^b \alpha \mathrm{ d } f$.应当见到其实该定理只需要$\alpha , f$有一个是连续就行.</p>
</li>
<li><p>(第一积分中值定理):$f \in C [ a , b ]$且$\alpha$不降,则$\int_a^b f \mathrm{ d } \alpha = f ( \xi ) \left ( \alpha ( b ) - \alpha ( a ) \right )$.</p>
</li>
<li><p>(第二积分中值定理):$f$在$[ a , b ]$上单调,$\alpha$是连续有界变差.则$\int_a^b f \mathrm{ d } \alpha = f ( a ) \left ( \alpha ( \xi ) - \alpha ( a ) \right ) + f ( b ) \left ( \alpha ( b ) - \alpha ( \xi ) \right )$.</p>
</li>
<li><p>(变量替换公式):如果$f , g \in C [ a , b ]$并且$g$严格增,取$h = g^{ - 1 }$,$c = g ( a ) , d = g ( b )$,那么$\int_a^b f ( x ) \mathrm{ d } x = \int_c^d f ( h ( y ) ) \mathrm{ d } h ( y )$.</p>
</li>
<li><p>(和黎曼可积的关系):$f \in R [ a , b ]$,$\alpha$可导并且$\alpha ‘ \in R [ a , b ]$,则$f \in R_\alpha [ a , b ]$,且$\int_a^b f \mathrm{ d } \alpha = \int_a^b f \alpha ‘ \mathrm{ d } x$</p>
</li>
</ol>
<p>考虑(1)的证明,由于此时已经可以使用求和来逼近,那不妨考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| S ( P , f , \alpha ) | & = | \sum f ( t_k ) \Delta \alpha_k | \\
& \leq | \sum f ( t_k ) | \cdot | \Delta \alpha_k | \\
& \leq | \sum f ( t_k ) | \Delta V_k
\end{aligned}</script><p>于是证毕.(2)自是(1)的推论.</p>
<p>(3)的话,当然是Abel求和,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S ( P , f , \alpha ) & = \sum_{ k = 1 }^n f ( t_k ) ( \alpha ( x_k ) - \alpha ( x_{ k - 1 } ) ) \\
& = f ( b ) \alpha ( b ) - f ( a ) \alpha ( a ) - \sum_{ k = 1 }^{ n + 1 } \alpha ( x_{ k - 1 } ) ( f ( t_k ) - f ( t_{ k - 1 } ) ) \\
& = f \alpha |_a^b - S ( Q , \alpha , f )
\end{aligned}</script><p>容易见到$| P | \to 0$会导致$| Q | \to 0$,便是显然.</p>
<p>考虑(4),由于$f$是连续的,直接取$f$的上下界并介值定理一下即是显然.</p>
<p>考虑(5),用分部积分公式,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b f \mathrm{ d } \alpha & = f ( b ) \alpha ( b ) - f ( a ) \alpha ( a ) - \int_a^b \alpha \mathrm{ d } f \\
& = f ( b ) \alpha ( b ) - f ( a ) \alpha ( a ) - \alpha ( \xi ) ( f ( b ) - f ( a ) )
\end{aligned}</script><p>整理一下即可.</p>
<p>考虑(6),由于连续性,因此对$x$做的划分同样通过一个$h$成为了新的一组划分,而且由于闭区间上的连续函数是一致连续的,这个划分当然也趋近于$0$,立即见到成立.</p>
<p>对于(7),首先用介值定理得到$\Delta \alpha_k = \alpha ‘ ( \xi_k ) \Delta x_k$,那当然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S ( P , f , \alpha ) & = \sum f ( t_k ) \Delta \alpha_k \\
& = \sum f ( t_k ) \alpha ' ( t_k ) \Delta x_k + \sum f ( t_k ) ( \alpha ' ( \xi_k ) - \alpha ' ( t_k ) ) \Delta x_k
\end{aligned}</script><p>而后面那一项绝对值不超过$| \sup f | \sum \omega_{ \alpha ‘ }$,当然趋近于$0$.</p>
<h3><span id="级数">级数</span></h3><p>对于数列$\{ a_n \}$,定义$S_n = \sum_{ k = 1 }^n a_k$.如果$\lim_{ n \to \infty } S_n$存在,则称级数$\sum_{ k = 1 }^{ \infty } a_n$<strong>收敛</strong>,记作$S = \sum_{ k }^{ \infty } a_n$,否则如若上述极限不存在,称其<strong>发散</strong>.</p>
<p>容易见到以下性质显然成立,然而逆命题并不总是成立:</p>
<ol>
<li><p>$\sum^{ + \infty } a_n = A , \sum^{ + \infty } b_n = B$,则$\sum^{ + \infty } ( a_n + b_n ) = A + B$.</p>
</li>
<li><p>$\sum^{ + \infty } a_n = A$,则$\sum^{ + \infty } c a_n = cA$.</p>
</li>
<li><p>结合律:$\sum^{ + \infty } a_n = A$,若$\{ n_k \}$是递增正整数序列且$n_0 = 1$,设$C_k = \sum_{ n = n_{ k - 1 } }^{ n_k - 1 } a_n$,则$\sum_k^{ + \infty } C_k = A$.</p>
</li>
</ol>
<p>(1)(2)显然,(3)当然是因为原数列收敛立刻能推出其子列收敛.</p>
<p>如果$\sum | a_n | &lt; \infty$,则称此级数<strong>绝对收敛</strong>.考虑$a_n = | a_n | - ( | a_n | - a_n )$,前后两者都是正项数列而且$| a_n | - a_n \leq 2 | a_n |$,所以绝对收敛当然能推出收敛,而反之不可.将收敛但不绝对收敛的级数称作<strong>条件收敛</strong>.绝对收敛的两个级数之和当然也绝对收敛,乘一个系数后也绝对收敛.</p>
<p>我们有<strong>柯西收敛原理</strong>:$\sum a_n$收敛的充要条件是$\forall \epsilon &gt; 0$,$\exists N &gt; 0 , \forall m &gt; n \geq N$,$| \sum_{ k = n }^m a_k | &lt; \epsilon$.用柯西准则立刻见到如若$\lim_{ n \to \infty } S_n$收敛则必有$\lim_{ n \to \infty } a_n = 0$.但反命题当然不成立.这是相当重要的,正是因为$\lim_{ n \to \infty } a_n = 0$,所以我们才总能使用泰勒展开等手段进行估计和放缩.</p>
<p>再还有Abel-Dirichlet判别法,设$a_n$单调,$B_n = \sum_{ k = 1 }^n b_k$,$B_n$有界,$| B_n | \leq M$:</p>
<ol>
<li><p>引理:$| \sum_{ k = 1 }^n a_k b_k | \leq M ( | a_1 | + 2 | a_n | ) \leq 2 M ( | a_1 | + | a_n | )$.</p>
</li>
<li><p>Dirichlet判别法:若$a_n \to 0$,$B_n$有界,则$\sum a_k b_k$收敛.</p>
</li>
<li><p>Abel判别法:若$B_n$收敛,$a_n$有界,则$\sum a_k b_k$收敛.</p>
</li>
</ol>
<p>(1)的话当然只需使用Abel变换,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ k = 1 }^n a_k b_k & = \sum_{ k = 1 }^n a_k ( B_k - B_{ k - 1 } ) \\
& = a_n B_n + \sum_{ k = 1 }^{ n - 1 } ( a_k - a_{ k + 1 } ) B_k
\end{aligned}</script><p>则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = 1 }^n a_k b_k | \\
\leq & | a_n B_n | + \sum_{ k = 1 }^{ n - 1 } | a_k - a_{ k + 1 } | \cdot | B_k | \\
\leq & M ( | a_1 - a_n | + | a_n | ) \\
\leq & M ( | a_1 | + 2 | a_n | )
\end{aligned}</script><p>(2)(3)的话用柯西判准,考虑任意一段求和$| B_{ n + p } - B_{ n - 1 } | \leq 2 M$,于是:</p>
<script type="math/tex; mode=display">
| \sum_{ k = n }^{ n + p } a_k b_k | \leq 2 M ( | a_n | + 2 | a_{ n + p } | )</script><p>则属显然.</p>
<p>DA判别法的一个推论是,对于$\sum b_k$和$\sum c_k$来说,如果$\frac{ b_k }{ c_k }$单调有界且不趋于$0$,那么它们敛散性相同.</p>
<h6><span id="example1">Example1</span></h6><p>求$\sum \frac{ \sin ( nx ) }{ n }$的收敛性.</p>
<p>首先当$x = 2 k \pi$的时候当然收敛,否则使用DA判别法,考虑证明$\sum \sin ( nx )$有界.</p>
<p>用积化和差,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| \sum_{ k = 1 }^n \sin ( kx ) | & = \left | \frac{ \sum 2 \sin \frac{ x }{ 2 } \sin ( kx ) }{ 2 \sin ( \frac{ x }{ 2 } ) } \right | \\
& = \left | \frac{ \sum \cos ( k - \frac{ 1 }{ 2 } ) x - \cos ( k + \frac{ 1 }{ 2 } ) x }{ 2 \sin ( \frac{ x }{ 2 } ) } \right | \\
& \leq \frac{ 1 }{ | \sin \frac{ x }{ 2 } | }
\end{aligned}</script><p>这就完事.</p>
<p>能不能进一步把上面的这个级数求出来呢?考虑欧拉公式,令$z = e^{ ix }$,知道$e^{ inx } = \cos ( nx ) + i \sin ( nx )$,所以$\sum \frac{ z^n }{ n } = - \ln ( 1 - z )$的虚部就是所求.</p>
<p>而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
- \ln ( 1 - z ) & = - \ln ( 1 - \cos x - i \sin x ) \\
& = - \ln \left ( 2 ( \sin \frac{ x }{ 2 } ) ( \sin \frac{ x }{ 2 } - i \cos \frac{ x }{ 2 } ) \right ) \\
& = - \ln \left ( 2 ( \sin \frac{ x }{ 2 } ) e^{ \frac{ x - \pi }{ 2 } i } \right ) \\
& = - \ln ( 2 \sin \frac{ x }{ 2 } ) + \frac{ \pi - x }{ 2 } i
\end{aligned}</script><p>这就顺便解决了$\sum \frac{ \cos ( nx ) }{ n }$的情况.</p>
<h6><span id="example2">Example2</span></h6><p>判断$\sum \frac{ ( - 1 )^n }{ n^p + ( - 1 )^n } , p &gt; 0$的收敛性.</p>
<p>观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ ( - 1 )^n }{ n^p + ( - 1 )^n } \\
= & \frac{ ( - 1 )^n }{ n^p } \frac{ 1 }{ 1 + \frac{ ( - 1 )^n }{ n^p } } \\
= & \frac{ ( - 1 )^n }{ n^p } \frac{ 1 - \frac{ ( - 1 )^n }{ n^p } }{ 1 - \frac{ 1 }{ n^{ 2 p } } } \\
= & \frac{ ( - 1 )^n }{ n^p - \frac{ 1 }{ n^p } } - \frac{ 1 }{ n^{ 2 p } - 1 }
\end{aligned}</script><p>前半部分当然收敛,于是$p \leq \frac{ 1 }{ 2 }$的时候发散,$\frac{ 1 }{ 2 } &lt; p \leq 1$的时候条件收敛.</p>
<h6><span id="example3">Example3</span></h6><p>求$\sum \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p + \sin ( \frac{ n \pi }{ 4 } ) }$的敛散性.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p + \sin ( \frac{ n \pi }{ 4 } ) } \\
= & \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p } \frac{ 1 }{ 1 + \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p } } \\
= & \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p } \left ( 1 - \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p } + o ( \frac{ 1 }{ n^p } ) \right ) \\
= & \frac{ \sin ( \frac{ n \pi }{ 4 } ) }{ n^p } - \frac{ \sin^2 ( \frac{ n \pi }{ 4 } ) }{ n^{ 2 p } } + o ( \frac{ 1 }{ n^{ 2 p } } )
\end{aligned}</script><p>见到应该是$p \leq \frac{ 1 }{ 2 }$发散,$\frac{ 1 }{ 2 } &lt; p \leq 1$的时候条件收敛,$p &gt; 1$的时候绝对收敛.</p>
<h4><span id="正项级数">正项级数</span></h4><ol>
<li><p>当$a_n \geq 0$的时候,$S_n$有界$\Leftrightarrow$S_n</p>
</li>
<li><p>当$0 \leq a_n \leq b_n$,若$\sum^{ + \infty } b_n &lt; \infty$,则$\sum^{ + \infty } a_n &lt; \infty$.</p>
</li>
<li><p>若$a_n , b_n &gt; 0$,则若$\varlimsup_{ n \to \infty } \frac{ a_n }{ b_n } &lt; \infty$,则$\sum^{ + \infty } b_n &lt; \infty \Rightarrow \sum^{ + \infty } a_n &lt; \infty$.</p>
</li>
<li><p>若$a_n , b_n &gt; 0$,则若$\varliminf_{ n \to \infty } \frac{ a_n }{ b_n } &gt; 0$,则$\sum^{ + \infty } b_n = \infty \Rightarrow \sum^{ + \infty } a_n = \infty$.</p>
</li>
<li><p>若$a_n$单调递减趋近于$0$.则$\sum^{ + \infty }_n a_n &lt; \infty \Leftrightarrow \sum_{ k }^{ + \infty } 2^k a_{ 2^k } &lt; \infty$.</p>
</li>
<li><p>$\sum_{ k = 1 }^{ + \infty } \frac{ 1 }{ n^p }$,当$p \leq 1$的时候发散,而当$p &gt; 1$的时候收敛.</p>
</li>
<li><p>$\sum_{ k = 2 }^{ + \infty } \frac{ 1 }{ n \ln^p n }$,当$p \leq 1$的时候发散,而当$p &gt; 1$的时候收敛.</p>
</li>
<li><p>设单调递减连续正函数$f ( x )$满足$a_n = f ( n )$,则$\sum_{ k = 1 }^{ + \infty } a_k &lt; \infty \Leftrightarrow \int_1^{ + \infty } f ( x ) \mathrm{ d } x &lt; \infty$.</p>
</li>
<li><p>比值判别法:对于$a_n &gt; 0$,如果$\varlimsup_{ n \to \infty } \frac{ a_{ n + 1 } }{ a_n } &lt; 1$,则$\sum a_n &lt; \infty$.</p>
</li>
<li><p>比值判别法:对于$a_n &gt; 0$,如果$\varliminf_{ n \to \infty } \frac{ a_{ n + 1 } }{ a_n } &gt; 1$,则$\sum a_n = \infty$.</p>
</li>
<li><p>根值判别法:对于$a_n &gt; 0$,设$l = \varlimsup_{ n \to \infty } ( a_n )^{ \frac{ 1 }{ n } }$,如果$l &lt; 1$,则$\sum a_n &lt; \infty$;若$l &gt; 1$,则$\sum a_n = \infty$.</p>
</li>
<li><p>对于$a_n &gt; 0$,如果$\varliminf_{ n \to \infty } n \ln \frac{ a_n }{ a_{ n + 1 } } &gt; 1$,则$\sum a_n &lt; \infty$.</p>
</li>
<li><p>对于$a_n &gt; 0$,如果$\varlimsup_{ n \to \infty } n \ln \frac{ a_n }{ a_{ n + 1 } } &lt; 1$,则$\sum a_n = \infty$.</p>
</li>
<li><p>拉贝判别法:对于$a_n &gt; 0$,若$\varliminf_{ n \to \infty } n ( \frac{ a_n }{ a_{ n + 1 } } - 1 ) &gt; 1$,则$\sum a_n &lt; \infty$.</p>
</li>
<li><p>拉贝判别法:对于$a_n &gt; 0$,若$\varlimsup_{ n \to \infty } n ( \frac{ a_n }{ a_{ n + 1 } } - 1 ) &lt; 1$,则$\sum a_n = \infty$.</p>
</li>
</ol>
<p>(1)当然是单调收敛准则.(2)只是(1)的推论.</p>
<p>(3)(4)只需套用定义即可.</p>
<p>(5)的话,不妨设$S_n = \sum_{ k = 1 }^n a_k$而$T_n = \sum_{ k = 1 }^n 2^k a_{ 2^k }$考虑当$2^k \leq n$的时候,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n & \geq \sum_{ j = 1 }^{ 2^k } a_j \\
& = a_1 + \sum_{ j = 0 }^{ k - 1 } \sum_{ i = 2^j + 1 }^{ 2^{ j + 1 } } a_i \\
& \geq \frac{ 1 }{ 2 } T_k
\end{aligned}</script><p>当$n &lt; 2^{ k + 1 }$的时候,则有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n & \leq \sum_{ j = 1 }^{ 2^k } a_j \\
& = \sum_{ j = 0 }^{ k - 1 } \sum_{ i = 2^j }^{ 2^{ j + 1 } - 1 } a_i \\
& \leq T_k
\end{aligned}</script><p>(6)的话,首先$p \leq 1$的时候$\frac{ 1 }{ n^p } \geq \frac{ 1 }{ n }$于是显然,而当$p &gt; 1$的时候,考虑用(5),观察$\sum 2^k \frac{ 1 }{ 2^{ pk } } = \sum 2^{ ( 1 - p ) k }$,当然收敛.</p>
<p>(7)的话亦然考虑(5),等价于$\sum 2^k \frac{ 1 }{ 2^k k^p \ln^p 2 } = \sum \frac{ 1 }{ k^p \ln^p 2 }$,等价于(6)了.这个结论还可以推广到$\sum \frac{ 1 }{ n \ln n ( \ln \ln n )^p }$,总之都是类似的做法,结论也类似.</p>
<p>(8)的证明只需考虑:</p>
<script type="math/tex; mode=display">
a_{ n + 1 } = f ( n + 1 ) \leq \int_n^{ n + 1 } f ( t ) \mathrm{ d } t \leq f ( n ) = a_n</script><p>立刻证毕.</p>
<p>而且这个估计还可以更精细,事实上我们可以证明下列极限总是存在:</p>
<script type="math/tex; mode=display">
\lim_{ n \to \infty } ( \sum_{ k = m }^n f ( k ) - \int_m^n f ( x ) \mathrm{ d } x ) = \alpha</script><p>而且还满足$0 \leq \alpha \leq f ( m )$.</p>
<p>考虑固定$m$,设$g ( n ) = \sum_{ k = m }^n f ( k ) - \int_m^n f ( x ) \mathrm{ d } x$,用单调收敛准则,我们先证明它单调递减且有下界,注意到:</p>
<script type="math/tex; mode=display">
g ( n ) - g ( n + 1 ) = - f ( n + 1 ) + \int_{ n }^{ n + 1 } f ( x ) \mathrm{ d } x \geq 0</script><p>这就证明了其单调递减,而又有:</p>
<script type="math/tex; mode=display">
g ( n ) = \sum_{ k = m }^{ n - 1 } \left ( f ( k ) - \int_{ k }^{ k + 1 } f ( x ) \mathrm{ d } x \right ) + f ( n ) \geq f ( n ) \geq 0</script><p>因此有下界.同时注意到$g ( m ) = f ( m )$,因此总有$0 \leq \alpha \leq f ( m )$成立.</p>
<p>不仅如此,如果$f ( n )$还满足$\lim_{ x \to \infty } f ( x ) = 0$,我们还可以把这个极限收敛的速度求出来.我们有:</p>
<script type="math/tex; mode=display">
| \sum_{ k = m }^n f ( k ) - \int_m^n f ( x ) \mathrm{ d } x - \alpha | \leq f ( n )</script><p>干脆令$l &gt; n$,考虑LHS应该是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ k = m }^n f ( k ) - \int_m^n f ( x ) \mathrm{ d } x - \alpha \\
= & \sum_{ k = m }^n f ( k ) - \int_m^n f ( x ) \mathrm{ d } x - \left ( \lim_{ l \to \infty } ( \sum_{ k = m }^l f ( k ) - \int_m^l f ( x ) \mathrm{ d } x ) \right ) \\
= & \lim_{ l \to \infty } \left ( \int_n^l f ( x ) \mathrm{ d } x - \sum_{ k = n + 1 }^l f ( k ) \right ) \\
= & \lim_{ l \to \infty } \left ( \sum_{ k = n + 1 }^l ( \int_{ k - 1 }^k f ( k ) \mathrm{ d } x - f ( k ) ) \right ) \\
\leq & \lim_{ l \to \infty } \left ( \sum_{ k = n + 1 }^l ( f ( k - 1 ) - f ( k ) ) \right ) \\
\leq & f ( n )
\end{aligned}</script><p>而上式换个方向放缩就可以知道$\geq 0$,这就搞定.</p>
<p>(9)(10)类似(3)(4),用等比数列控制住即可.</p>
<p>(11)的话,如若$l = \varlimsup_{ n \to \infty } ( a_n )^{ \frac{ 1 }{ n } }$.</p>
<p>当$l &lt; 1$的时候,取$\epsilon &gt; 0$使得$l + \epsilon &lt; 1$,则$\exists N_0 &gt; 0$,$\forall n \geq N_0$,$( a_n )^{ \frac{ 1 }{ n } } &lt; l + \epsilon$,意味着$a_n &lt; ( l + \epsilon )^n$,立刻见到其收敛.</p>
<p>当$l &gt; 1$的时候,取$\epsilon &gt; 0$使得$l - \epsilon &gt; 1$,则存在原数列的一个无穷子列$\{ n_k \}$,使得$a_{ n_k } &gt; ( l - \epsilon )^{ n_k } \to \infty$,当然发散.</p>
<p>而注意到根据Stolz定理:</p>
<script type="math/tex; mode=display">
\varliminf \frac{ a_{ n + 1 } }{ a_n } \leq \varliminf \sqrt[n]{ a_n } \leq \varlimsup \sqrt[n]{ a_n } \leq \varlimsup \frac{ a_{ n + 1 } }{ a_n }</script><p>这就意味着根值判别法理论上严格强于比值判别法.</p>
<p>(12)(13)的证明,考虑当$l = \varliminf_{ n \to \infty } n \ln \frac{ a_n }{ a_{ n + 1 } } &gt; 1$的时候,取$\epsilon &gt; 0 , p = l - \epsilon &gt; 1$,那么就有$\exists N_0 &gt; 0 , \forall n \geq N_0$,都有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
n \ln \frac{ a_n }{ a_{ n + 1 } } & > p \\
\frac{ a_n }{ a_{ n + 1 } } & > e^{ \frac{ p }{ n } } > \left ( ( 1 + \frac{ 1 }{ n } )^n \right )^{ \frac{ p }{ n } } \\
\frac{ a_{ n + 1 } }{ a_n } & < \cfrac{ \frac{ 1 }{ ( n + 1 )^p } }{ \frac{ 1 }{ n^p } }
\end{aligned}</script><p>取$b_n = \frac{ 1 }{ n^p }$,由上见到$a_n &lt; \frac{ a_{ N_0 } }{ b_{ N_0 } } b_n$,这就控制住了.(13)同理.控制$e$的时候改用不等式$e &lt; ( 1 + \frac{ 1 }{ n - 1 } )^n$即可.</p>
<p>(14)(15)仍然类似,设$b_n = n ( \frac{ a_n }{ a_{ n + 1 } } - 1 )$.</p>
<p>当$l = \varliminf_{ n \to \infty } b_n &gt; 1$的时候,取$\epsilon &gt; 0$,$l - \epsilon &gt; 1$,则$\exists N_0 &gt; 0 , \forall n \geq N_0$,$b_n &gt; l - \epsilon = l ‘$.而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ a_n }{ a_{ n + 1 } } & = 1 + \frac{ b_n }{ n } \\
\ln \frac{ a_n }{ a_{ n + 1 } } & = \ln ( 1 + \frac{ b_n }{ n } ) > \ln ( 1 + \frac{ l ' }{ n } ) \\
\varliminf n \ln \frac{ a_n }{ a_{ n + 1 } } & \geq \varliminf \ln ( 1 + \frac{ l ' }{ n } )^{ n } = l ' > 1
\end{aligned}</script><p>这就做完了.(15)同理.</p>
<h6><span id="example1">Example1</span></h6><p>斐波那契数列$f_0 = 0 , f_1 = 1$,求$\sum \frac{ 1 }{ f_k }$的收敛性.</p>
<p>考虑$f_{ n - 1 } \leq 2 f_{ n - 2 }$,所以$f_n = f_{ n - 1 } + f_{ n - 2 } \geq \frac{ 3 }{ 2 } f_{ n - 1 } \geq ( \frac{ 3 }{ 2 } )^{ n - 1 }$.这就做完了.</p>
<h6><span id="example2">Example2</span></h6><p>假设$0 &lt; a_n$单调递增且有界,求证:$\sum ( 1 - \frac{ a_k }{ a_{ k + 1 } } ) &lt; \infty$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum ( 1 - \frac{ a_k }{ a_{ k + 1 } } ) \\
= & \sum{ a_k } ( \frac{ 1 }{ a_k } - \frac{ 1 }{ a_{ k + 1 } } ) \\
\leq & \sup{ a } \sum ( \frac{ 1 }{ a_k } - \frac{ 1 }{ a_{ k + 1 } } ) \\
\leq & \frac{ \sup{ a } }{ a_1 }
\end{aligned}</script><h6><span id="example3">Example3</span></h6><p>求$\sum \frac{ 1 }{ n^p - n^q } , p &gt; q &gt; 0$的收敛性.</p>
<p>直接考虑$\lim_{ n \to \infty } \cfrac{ \frac{ 1 }{ n^p - n^q } }{ \frac{ 1 }{ n^p } } = 1$,所以$p \leq 1$的时候发散,$p &gt; 1$的时候收敛.</p>
<h6><span id="example4">Example4</span></h6><p>求$\sum \sin \frac{ 1 }{ n^2 }$的收敛性.</p>
<p>直接考虑$\lim_{ n \to \infty } \cfrac{ \sin \frac{ 1 }{ n^2 } }{ \frac{ 1 }{ n^2 } } = 1$,所以收敛.</p>
<h6><span id="example5">Example5</span></h6><p>$a_n = ( 1 - \sqrt[3]{ \frac{ n - 1 }{ n + 1 } } )^p , p &gt; 0$,讨论$\sum a_n$的敛散性.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sqrt[3]{ \frac{ n - 1 }{ n + 1 } } & = ( 1 - \frac{ 1 }{ n } )^{ \frac{ 1 }{ 3 } } ( 1 + \frac{ 1 }{ n } )^{ - \frac{ 1 }{ 3 } } \\
& = ( 1 - \frac{ 1 }{ 3 n } + O ( \frac{ 1 }{ n^2 } ) ) ( 1 - \frac{ 1 }{ 3 n } + O ( \frac{ 1 }{ n^2 } ) ) \\
& = 1 - \frac{ 2 }{ 3 n } + O ( \frac{ 1 }{ n^2 } )
\end{aligned}</script><p>所以$a_n$和$\frac{ 1 }{ n^p }$同敛散.</p>
<h6><span id="example6">Example6</span></h6><p>求$S_n = \sum_{ k = 1 }^n \frac{ 1 }{ \sqrt{ k } } - 2 \sqrt{ n }$的敛散性.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_{ n + 1 } & = S_{ n + 1 } - S_n \\
& = \frac{ 1 }{ \sqrt{ n + 1 } } - 2 \sqrt{ n + 1 } + 2 \sqrt{ n } \\
& = \frac{ 1 }{ \sqrt{ n + 1 } } - \frac{ 2 }{ \sqrt{ n + 1 } + \sqrt{ n } } \\
& = \frac{ \sqrt{ n } - \sqrt{ n + 1 } }{ \sqrt{ n + 1 } ( \sqrt{ n + 1 } + \sqrt{ n } ) } \\
& = \frac{ - 1 }{ \sqrt{ n + 1 } ( \sqrt{ n + 1 } + \sqrt{ n } )^2 } = O ( - n^{ - \frac{ 3 }{ 2 } } )
\end{aligned}</script><p>所以收敛.</p>
<h6><span id="example7">Example7</span></h6><p>求$a_n = \frac{ 1 }{ \sqrt{ n } } - \sqrt{ \ln ( 1 + \frac{ 1 }{ n } ) }$的级数和收敛性.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \frac{ 1 }{ \sqrt{ n } } - \sqrt{ \ln ( 1 + \frac{ 1 }{ n } ) } \\
& = \frac{ 1 }{ \sqrt{ n } } - \sqrt{ \frac{ 1 }{ n } - \frac{ 1 }{ 2 n^2 } + o ( \frac{ 1 }{ n^2 } ) } \\
& = \frac{ 1 }{ \sqrt{ n } } - \frac{ 1 }{ \sqrt{ n } } \left ( 1 - \frac{ 1 }{ 2 n } + o ( \frac{ 1 }{ n } ) \right )^{ \frac{ 1 }{ 2 } } \\
& = \frac{ 1 }{ \sqrt{ n } } - \frac{ 1 }{ \sqrt{ n } } \left ( 1 - \frac{ 1 }{ 4 n } + o ( \frac{ 1 }{ n } ) \right ) \\
& = O ( n^{ - \frac{ 3 }{ 2 } } )
\end{aligned}</script><p>所以收敛.</p>
<h6><span id="example8">Example8</span></h6><p>设$\zeta ( a ) = \sum_{ k = 1 }^{ \infty } \frac{ 1 }{ k^a }$,求$\lim_{ \sigma \to 0 + 0 } \sigma \zeta ( 1 + \sigma )$和$\lim_{ \sigma \to 0 + 0 } \left ( \zeta ( 1 + \sigma ) - \frac{ 1 }{ \sigma } \right )$.</p>
<p>取$f ( x ) = \frac{ 1 }{ x^{ 1 + \sigma } }$,设$F ( x ) = \int_1^x f ( t ) \mathrm{ d } t$考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ k = n + 1 }^{ \infty } a_k & \leq F ( + \infty ) - F ( n ) \leq \sum_{ k = n }^{ \infty } a_k \\
F ( + \infty ) - F ( n + 1 ) & \leq \sum_{ k = n + 1 }^{ \infty } a_k \leq F ( + \infty ) - F ( n ) \\
\frac{ 1 }{ \sigma } \frac{ 1 }{ ( n + 1 )^\sigma } & \leq \sum_{ k = n + 1 }^{ \infty } a_k \leq \frac{ 1 }{ \sigma } \frac{ 1 }{ n^\sigma } \\
\frac{ 1 }{ ( n + 1 )^\sigma } & \leq \sigma \sum_{ k = n + 1 }^{ \infty } a_k \leq \frac{ 1 }{ n^\sigma }
\end{aligned}</script><p>取$n = 0$和$n = 1$得到$1 \leq \sigma \zeta ( 1 + \sigma ) \leq \sigma + 1$,于是$\lim_{ \sigma \to 0 + 0 } \sigma \zeta ( 1 + \sigma ) = 1$.</p>
<p>而同理,见到:</p>
<script type="math/tex; mode=display">
\zeta ( 1 + \sigma ) = 1 + \frac{ 1 }{ 2^{ 1 + \sigma } } + \cdots + \frac{ 1 }{ n^{ 1 + \sigma } } + \sum_{ k = n + 1 }^{ \infty } \frac{ 1 }{ k^{ 1 + \sigma } }</script><p>而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& 1 + \frac{ 1 }{ 2^{ 1 + \sigma } } + \cdots + \frac{ 1 }{ n^{ 1 + \sigma } } + \frac{ 1 }{ \sigma } \frac{ 1 }{ ( n + 1 )^\sigma } \\
\leq & \zeta ( 1 + \sigma ) \leq \\
1 + \frac{ 1 }{ 2^{ 1 + \sigma } } + \cdots + \frac{ 1 }{ n^{ 1 + \sigma } } + \frac{ 1 }{ \sigma } \frac{ 1 }{ n^\sigma } \\

\end{aligned}</script><p>用上述不等式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& 1 + \frac{ 1 }{ 2^{ 1 + \sigma } } + \cdots + \frac{ 1 }{ n^{ 1 + \sigma } } + \frac{ 1 }{ \sigma } \left ( \frac{ 1 }{ ( n + 1 )^\sigma } - 1 \right ) \\
\leq & \zeta ( 1 + \sigma ) - \frac{ 1 }{ \sigma } \leq \\
1 + \frac{ 1 }{ 2^{ 1 + \sigma } } + \cdots + \frac{ 1 }{ n^{ 1 + \sigma } } + \frac{ 1 }{ \sigma } \left ( \frac{ 1 }{ n^\sigma } - 1 \right ) \\

\end{aligned}</script><p>两边对$\sigma \to 0 + 0$取极限,见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& 1 + \frac{ 1 }{ 2 } + \cdots + \frac{ 1 }{ n } - \ln ( n + 1 ) \\
\leq & \varliminf_{ \sigma \to 0 + 0 } ( \zeta ( 1 + \sigma ) - \frac{ 1 }{ \sigma } ) \leq \varlimsup_{ \sigma \to 0 + 0 } ( \zeta ( 1 + \sigma ) - \frac{ 1 }{ \sigma } ) \leq \\
1 + \frac{ 1 }{ 2 } + \cdots + \frac{ 1 }{ n } - \ln ( n )
\end{aligned}</script><p>两边对$n$取极限得到$\lim_{ \sigma \to 0 + 0 } \zeta ( 1 + \sigma ) - \frac{ 1 }{ \sigma } = \gamma$.</p>
<h6><span id="example9">Example9</span></h6><p>$a_n &gt; 0$,证明:若$\varlimsup_{ n \to \infty } a_n^{ \frac{ 1 }{ \ln n } } &lt; \frac{ 1 }{ e }$则收敛.若$\varliminf_{ n \to \infty } a_n^{ \frac{ 1 }{ \ln n } } &gt; \frac{ 1 }{ e }$则发散.</p>
<p>只证前者,则存在$p &gt; 1$使得$\varlimsup_{ n \to \infty } a_n^{ \frac{ 1 }{ \ln n } } &lt; \frac{ 1 }{ e^p }$,两边取$\ln$就做完了.</p>
<h6><span id="example10">Example10</span></h6><p>$a_n &gt; 0$,证明:若$\varliminf_{ n \to \infty } \cfrac{ \ln \frac{ 1 }{ a_n } }{ \ln n } &gt; 1$则收敛.若$\varlimsup_{ n \to \infty } \cfrac{ \ln \frac{ 1 }{ a_n } }{ \ln n } &lt; 1$则发散.</p>
<p>只证前者,考虑前者等价于$\varlimsup_{ n \to \infty } \ln a_n^{ \frac{ 1 }{ \ln n } } &lt; - 1$,转化为Example9.</p>
<h6><span id="example11">Example11</span></h6><p>数列$\{ a_n \}$恒正,数列$b_n = \frac{ a_n }{ a_{ n + 1 } } - 1 - \frac{ 1 }{ n }$的部分和有界,求证$\sum a_n$发散.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ a_n }{ a_{ n + 1 } } & = 1 + \frac{ 1 }{ n } + b_n \leq e^{ \frac{ 1 }{ n } + b_n } \\
\frac{ a_1 }{ a_{ n + 1 } } & \leq e^{ \ln n + \gamma + M } = cn \\
a_n & \geq \frac{ ca_1 }{ n }
\end{aligned}</script><p>这就搞定.</p>
<h4><span id="交错级数">交错级数</span></h4><p>考虑$\sum ( - 1 )^{ n - 1 } a_n$,其中$a_n &gt; 0$.</p>
<p>Leibniz定理:如果$a_n$单调下降趋近于$0$,则交错级数收敛.</p>
<p>考虑$S_{ 2 n } = ( a_1 - a_2 ) + ( a_3 - a_4 ) + \cdots$而$S_{ 2 n + 1 } = a_1 - ( a_2 - a_3 ) - ( a_4 - a_5 ) - \cdots$,所以见到$S_{ 2 n }$单调上升,$S_{ 2 n + 1 }$单调下降.并且显然$S_{ 2 n } &lt; S_{ 2 n + 1 }$.而且$S_{ 2 n + 1 } - S_{ 2 n } = a_{ 2 n + 1 } \to 0$,所以二者均收敛且极限相同极限相同.</p>
<p>当然,这也只是DA判别法的一个特例.</p>
<p>Leibniz定理还可以如此理解:由于后面的项正负抵消,我们发现:</p>
<script type="math/tex; mode=display">
| \sum_{ k = n }^\infty ( - 1 )^k a_k | \leq a_n \to 0</script><p>也就是后面的交错都可以被首项控制住.</p>
<h6><span id="example1">Example1</span></h6><p>考虑$\sum ( - 1 )^{ n } \frac{ \ln^2 n }{ n }$的收敛性.</p>
<p>取$f ( x ) = \frac{ \ln^2 x }{ x }$,则$f ‘ = \frac{ 2 \ln x - \ln^2 x }{ x^2 }$,显然当$x$足够大的时候$f ‘ ( x ) &lt; 0$且$f ( + \infty ) = 0$,所以原式收敛.</p>
<h6><span id="example2">Example2</span></h6><p>设$a_n &gt; 0$,求证:若$\varliminf n ( \frac{ a_n }{ a_{ n + 1 } } - 1 ) &gt; 0$,则$\sum ( - 1 )^n a_n$收敛.</p>
<p>考虑$n$足够大的时候$\exists \epsilon &gt; 0$,使得$n ( \frac{ a_n }{ a_{ n + 1 } } - 1 ) &gt; \epsilon$,也就是$\frac{ a_{ n + 1 } }{ a_n } &lt; \frac{ n }{ n + \epsilon } &lt; 1$,这就能证明$a_n$单调递减.下面只需要证明$\lim a_n = 0$即可.</p>
<p>而考虑取定$N &gt; 0$,对于$n \geq N$,有$\frac{ a_n }{ a_N } = \prod_{ k = N }^{ n - 1 } \frac{ a_{ k + 1 } }{ a_{ k } }$,$a_N$是定死的,下面只需要证明后面那个乘积趋近于$0$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \prod_{ k = N }^{ n - 1 } \frac{ a_{ k + 1 } }{ a_{ k } } \\
< & \prod_{ k = N }^{ n - 1 } \frac{ n }{ n + \epsilon } \\
= & \prod_{ k = N }^{ n - 1 } \frac{ 1 }{ 1 + \frac{ \epsilon }{ n } } \\

\end{aligned}</script><p>然而注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \prod_{ k = N }^{ n - 1 } ( 1 + \frac{ \epsilon }{ n } ) \\
\geq & 1 + \frac{ \epsilon }{ N } + \cdots + \frac{ \epsilon }{ n - 1 } \to \infty
\end{aligned}</script><p>这就完事.</p>
<h6><span id="example3">Example3</span></h6><p>取$f ( x ) = \sum_{ n = 1 }^\infty \frac{ ( - 1 )^{ n - 1 } }{ n^x } , x \in ( 0 , \infty )$,求$\sup f$和$\inf f$.</p>
<p>首先显然能搞出$f ( x ) \in C^\infty ( 0 , + \infty )$,原因是能证明其和其若干阶导数都内闭一致收敛(用DA判法).</p>
<p>首先交错级数的绝对值要$\leq$首项,所以先猜$\sup f = 1$.考虑:</p>
<script type="math/tex; mode=display">
f ( x ) = 1 - \sum_{ n = 1 }^\infty \left ( \frac{ 1 }{ ( 2 n )^x } - \frac{ 1 }{ ( 2 n + 1 )^x } \right )</script><p>容易见到只要让$x \to \infty$那就逐项趋近于$0$.</p>
<p>还有一个问题是$\inf f$.考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^x } - \frac{ 1 }{ ( 2 n + 1 )^x } \\
= & \sum_{ n = 1 }^\infty \int_{ 2 n }^{ 2 n + 1 } \frac{ x \mathrm{ d } t }{ t^{ x + 1 } } \\

\end{aligned}</script><p>这里注意到我们积分的那几段都是$[ 2 n , 2 n + 1 ]$,我们可以把奇数段补上,因为$x &gt; 0$,所以补的那一段更大,自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ n = 1 }^\infty \int_{ 2 n }^{ 2 n + 1 } \frac{ x \mathrm{ d } t }{ t^{ x + 1 } } \\
\leq & \frac{ 1 }{ 2 } \int_1^{ + \infty } \frac{ \mathrm{ d } t }{ t^{ x + 1 } } = \frac{ 1 }{ 2 }
\end{aligned}</script><p>而$f ( x ) = 1 - \sum_{ n = 1 }^\infty \left ( \frac{ 1 }{ ( 2 n )^x } - \frac{ 1 }{ ( 2 n + 1 )^x } \right )$,所以$f ( x ) \geq \frac{ 1 }{ 2 }$.</p>
<p>接下来来证明其能取到,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^x } - \frac{ 1 }{ ( 2 n + 1 )^x } \\
= & \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^x } \left ( 1 - \frac{ 1 }{ ( 1 + \frac{ 1 }{ 2 n } )^x } \right ) \\
= & \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^x } \left ( \frac{ x }{ 2 n } + O ( \frac{ x }{ n^2 } ) \right ) \\
= & \frac{ x }{ 2^{ x + 1 } } \zeta ( x + 1 ) + xO ( 1 ) \\
\to & \frac{ 1 }{ 2 }
\end{aligned}</script><p>原因是$\lim_{ x \to 0 + 0 } x \zeta ( x + 1 ) \to 1$,这个结论我们之前搞定过.</p>
<h4><span id="积分判别法">积分判别法</span></h4><p>取$\omega_n = \sup_{ [ n , n + 1 ] } f - \inf_{ [ n , n + 1 ] } f \geq 0$.我们声称若$\sum \omega_n &lt; \infty$,则$\int_1^{ \infty } f ( x ) \mathrm{ d } x$与$\sum f ( n )$收敛性相同.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ k = 1 }^n f_k - \int_1^{ n + 1 } f ( x ) \mathrm{ d } x \\
= & \sum_{ k = 1 }^n \int_k^{ k + 1 } ( f ( k ) - f ( x ) ) \mathrm{ d } x \\

\end{aligned}</script><p>考虑证明右式绝对收敛,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ k = 1 }^n \int_k^{ k + 1 } | f ( k ) - f ( x ) | \mathrm{ d } x \\
\leq & \sum_{ k = 1 }^n \int_k^{ k + 1 } \omega_k \mathrm{ d } x \\
= & \sum_{ k = 1 }^{ n + 1 } \omega_k
\end{aligned}</script><p>这就证毕.</p>
<p>问题又来到如何搞定$\sum \omega_n &lt; \infty$的条件,其实只要有界变差就行了对吧,我们断言:如果$f$可导,$f ‘$可积且$\int_1^{ \infty } | f ‘ | \mathrm{ d } x &lt; \infty$则$\sum \omega_n &lt; \infty$.</p>
<p>对于$\omega_n$,不妨$[ n , n + 1 ]$的上界在$x_1$处取到,下界在$x_2$处取到,于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\omega_n & = f ( x_1 ) - f ( x_2 ) \\
& = | \int_{ x_1 }^{ x_2 } f ' \mathrm{ d } x | \\
& \leq | \int_{ x_1 }^{ x_2 } | f ' | \mathrm{ d } x | \\
& \leq \int_{ n }^{ n + 1 } | f ' | \mathrm{ d } x \\

\end{aligned}</script><p>于是$\sum \omega \leq \int_1^{ + \infty } | f ‘ | \mathrm{ d } x$.</p>
<h6><span id="example1">Example1</span></h6><p>求$\sum \frac{ \sin ( n^\alpha x ) }{ n^\beta }$的收敛性,其中$\beta &gt; \alpha &gt; 0 , \alpha + \beta &gt; 1$.</p>
<p>用积分判别法,考虑取$f ( t ) = \frac{ \sin ( t^\alpha x ) }{ t^\beta }$,考虑:</p>
<script type="math/tex; mode=display">
f ' ( t ) = \frac{ x \alpha t^{ \alpha - 1 + \beta } \cos ( t^\alpha x ) - \beta t^{ \beta - 1 } \sin ( t^\alpha x ) }{ t^{ 2 \beta } }</script><p>逐项观察,都是$O ( \frac{ 1 }{ t^{ \beta - \alpha + 1 } } )$级别,这样$\int | f ‘ | \mathrm{ d } t$就收敛了.</p>
<p>那就只需要看积分的收敛性,取$s = t^\alpha$考察:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_1^{ \infty } f ( t ) \mathrm{ d } t & = \int_1^{ \infty } \frac{ \sin ( t^\alpha x ) }{ t^\beta } \mathrm{ d } t \\
& = \int_1^{ \infty } \frac{ \sin ( s x ) \frac{ 1 }{ \alpha } s^{ \frac{ 1 }{ \alpha } - 1 } }{ s^\frac{ \beta }{ \alpha } } \mathrm{ d } s \\
& = \int_1^{ \infty } \frac{ \sin ( s x ) }{ \alpha s^\frac{ \beta + \alpha - 1 }{ \alpha } } \mathrm{ d } s \\

\end{aligned}</script><p>后者用DA判法知道收敛.</p>
<h4><span id="级数的交换顺序">级数的交换顺序</span></h4><p>定义$\mathbb{ N }_+$的一个重排$f : \mathbb{ N }_+ \to \mathbb{ N }_+$,当且仅当$f ( 1 ) , f ( 2 ) , \cdots$这个数列中,每个正整数都恰好出现一次.</p>
<p>我们声称正项级数满足:$\sum a_n = \sum a_{ f ( n ) }$.</p>
<p>如何证明呢?</p>
<p>当$\sum a_n &lt; \infty$的时候,考虑设$A_n = \sum_{ k = 1 }^n a_k , B_n = \sum_{ k = 1 }^n a_{ f ( k ) }$.考虑取$N_n = \max_{ 1 \leq k \leq n } f ( k )$,那就有:</p>
<script type="math/tex; mode=display">
B_n = \sum_{ k = 1 }^n a_{ f ( k ) } \leq A_{ N_n } \leq \sum_{ 1 }^{ \infty } a_n</script><p>于是$B_n$当然是收敛的,并且$\sum a_{ f ( n ) } \leq \sum a_n$,而如果$a_{ f ( n ) }$是$a_n$的重排,那么反之,$a_n$是$a_{ f ( n ) }$的重排,于是$\sum a_{ f ( n ) } \geq \sum a_n$,这就证明了二者相同.</p>
<p>既如此,如果$\sum a_n$发散的时候,就可以反证法证明$\sum a_{ f ( n ) }$不可能收敛.这样就完成了证明.</p>
<p>下面我们证明,如果$\sum a_n$绝对收敛,换言之$\sum | a_n | &lt; \infty$,那么仍有$\sum a_n = \sum a_{ f ( n ) }$.</p>
<p>考虑取$a_n^+ = \frac{ | a_n | + a_n }{ 2 } , a_n^- = \frac{ | a_n | - a_n }{ 2 }$.那考虑$0 \leq a_n^+ \leq | a_n | , 0 \leq a_n^- \leq | a_n |$,所以它们当然都绝对收敛,那当然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum a_n & = \sum ( a_n^+ - a_n^- ) \\
& = ( \sum a_n^+ ) - ( \sum a_n^- )
\end{aligned}</script><p>而后者当然可以随意重排.</p>
<p>那么对于条件收敛呢?我们有<strong>黎曼重排定理</strong>:如果$\sum a_n$条件收敛,则$\forall B \leq A$,其中$A , B \in \mathbb{ R } \cup \{ \pm \infty \}$,则存在重排$f$,令$S_n = \sum_{ k = 1 }^n a_{ f ( k ) }$,有:</p>
<script type="math/tex; mode=display">
\varliminf S_n = B , \varlimsup S_n = A</script><p>为证明此,考虑设$I_+ = \{ n \in \mathbb{ N }_+ \mid a_n \geq 0 \} = \{ n_1 &lt; n_2 \cdots \}$,$I_-$类似设出.</p>
<p>容易见到首先$\lim a_n \to 0$,并且$\sum_{ n \in I_+ } a_n = + \infty , \sum_{ n \in I_- } a_n = - \infty$.</p>
<p>考虑先从$I_+$里取数,然后不断加加加加加直到超过$A$,由于正的部分相加是正无穷,这当然能做到,然后就继续从$I_-$里取数开始回退,退退退退到$B$之下,再重复上述过程.由于$a_n \to 0$,这玩意当然会满足条件.</p>
<p>那么如果$A$是正无穷呢?那没关系,我就每次加数的时候变化$A$,第一次个循环令$A = 1$,第二次令$A = 2$,以此类推.由此见上述命题的合理性.而且具体的论证过程只需要对这上面写抽象语言就行.</p>
<p>可是,难道一般的级数就真的不能交换顺序了嘛?事实上使用柯西准则,我们可以证明如果重排是局部的,或者说$\exists M &gt; 0 , \forall n , | n - f ( n ) | \leq M &lt; \infty$,换言之交换的距离有上界,那交换后敛散性不变.</p>
<p>这个怎么证明呢?首先如果原级数收敛的话,用柯西准则,因为通项趋于$0$,所以往外扩张适当有界长度(实际上就是$M$)应当无影响.如果原级数发散的话,如果通项还是不趋于$0$那当然还是完蛋,否则的话还可以用上面的证明.这就证毕了.</p>
<h6><span id="example">Example</span></h6><p>$a_n &gt; 0$,当$\sum \frac{ 1 }{ a_n } &lt; \infty$的时候,求证$\sum \frac{ n }{ \sum_{ k = 1 }^n a_k } &lt; \infty$.</p>
<p>首先考虑$\{ a_n \}$单增的情况,如果不单增的话,可以直接对其进行排序.</p>
<p>考虑$\frac{ 2 n }{ \sum_{ k = 1 }^{ 2 n } a_k } &lt; \frac{ 2 n }{ na_n } = \frac{ 2 }{ a_n }$,同理$\frac{ 2 n - 1 }{ \sum_{ k = 1 }^{ 2 n } a_k } &lt; \frac{ 2 n - 1 }{ na_n } &lt; \frac{ 2 }{ a_n }$,于是证毕.</p>
<h4><span id="级数的乘法">级数的乘法</span></h4><p>考虑$( \sum a_j ) ( \sum b_k ) = \sum a_j b_k$,首要的问题在于如何指定后者的求和顺序.</p>
<p>柯西策略是,考虑取$c_n = \sum_{ j + k = n + 1 } a_j b_k$,然后取原式顺序为$\sum c_n$.此好处是可以求解生成函数乘积,$( \sum a_j x^j ) ( \sum b_k x^k )$.</p>
<p>矩形策略是,考虑取$c_n = \sum_{ \max ( j , k ) = n } a_j b_k$,然后取原式顺序为$\sum c_n$.此好处是它的求和天然是$( \sum_{ j = 1 }^n a_j ) ( \sum_{ k = 1 }^n b_k )$的极限.所以此方法天然有如果$\sum a_j = A , \sum b_k = B$,则$\sum c = AB$.</p>
<p>接下来我们证明,如果$\sum a$和$\sum b$都绝对收敛,那它们的乘积任意排列都是相等的.换言之只要双重指标集合$\{ ( j_i , k_i ) \} = \{ ( j , k ) \}$那就都收敛于同一值.</p>
<p>证明策略类似,取$N_n = \max_{ 1 \leq i \leq n } ( j_i , k_i )$,那么当然有:</p>
<script type="math/tex; mode=display">
\sum_{ i = 1 }^n | a_{ j_i } b_{ k_i } | \leq ( \sum_{ j = 1 }^{ N_n } | a_{ j } | ) ( \sum_{ k = 1 }^{ N_n } | b_{ k } | )</script><p>那当然就绝对收敛,再类似之前的可以证明其与顺序无关,这个时候用矩形策略就可以知道最终就收敛于$( \sum a ) ( \sum b )$.</p>
<p>如果是条件收敛,矩形和当然没问题,仍然收敛,难点当然在于柯西和何时收敛?我们声称:如果$\sum a_n$收敛,$\sum | b_n | &lt; \infty$,也就是一个收敛一个绝对收敛,我们就能推出柯西和是收敛的而且就等于矩形和.</p>
<p>考虑设矩形法的$u_k = \sum_{ \max ( i , j ) = k } a_i b_j$,柯西法的$c_k = \sum_{ i + j = k + 1 } a_i b_j$,考虑求:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = 1 }^n u_k - c_k | \\
= & | \sum_{ i_j > n + 1 , i \leq n , j \leq n } a_i b_j | \\
\leq & \sum_{ i = 2 }^n | b_i | | \sum_{ j = n - i + 2 }^n a_j | \\
= & \sum_{ i = 2 }^N | b_i | | \sum_{ j = n - i + 2 }^n a_j | + \sum_{ i = N + 1 }^n | b_i | | \sum_{ j = n - i + 2 }^n a_j |
\end{aligned}</script><p>接下来用柯西收敛原理,先取$N$,只要$N$足够大,由于$| \sum_{ j = n - i + 2 }^n a_j |$当然是有界的,因为$\sum a$收敛,只要$N$足够大,不管$n$如何,$\sum_{ i = N + 1 }^n | b_i |$用柯西收敛原理就足够小.这样后半项就解决了.</p>
<p>前半项同理,在$N$取定的时候$\sum_{ i = 2 }^N | b_i |$就取定有界了.而只要在此基础上使得$n$尽可能大,$| \sum_{ j = n - i + 2 }^n a_j |$用柯西收敛原理就控制住了,于是整体就很小.那就证明了此时柯西和恰好就是矩形和.</p>
<p>一般的柯西和没有这么好的结论,但其实证明可以类似上面,具体地,我们取$A_n = \sum_{ k = 1 }^n a_k , B_n = \sum_{ k = 1 }^n b_k$并且$\lim A , \lim B$都存在,取柯西和$c_n = \sum_{ k = 1 }^n a_k b_{ n - k + 1 }$,我们断言$C_n = \sum_{ k = 1 }^n c_k$收敛当且仅当极限$\lim_{ n \to \infty } \sum_{ k = 1 }^n a_k \sum_{ j = n - k + 1 }^n b_j$存在.</p>
<p>原因是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ k = 1 }^n a_k \sum_{ j = n - k + 1 }^n b_j \\
= & \sum_{ k = 1 }^n a_k ( B_n - B_{ n - k } ) \\
= & B_n A_n - ( \sum_{ k = 1 }^{ n - 1 } a_k B_{ n - k } ) \\
= & B_n A_n - C_{ n - 1 }
\end{aligned}</script><p>这就证毕,而且当然见到只有上述极限为$0$的时候,柯西和才会有$\lim C = ( \lim A ) ( \lim B )$.</p>
<h4><span id="无穷乘积">无穷乘积</span></h4><p>对于数列$\{ a_n \}$,设$A_n = \prod_{ k = 1 }^n a_k$,若$\lim_{ n \to \infty } A_n$存在且非零,则称$\prod_{ k = 1 }^{ + \infty } a_k$收敛.为什么这里要求非零呢?因为我们希望类似无穷和,这里去掉前有限项后,敛散性不变.这就要求我们最好判掉零的情况.如若其极限为$0$,则仍称其发散,但有的时候发散到零也会有一些性质,到时我们会单独讨论.</p>
<p>既然如此,不妨设$a_n \ne 0$.有以下性质:</p>
<ol>
<li><p>若$\prod a_n$收敛,则$\lim a_n = 1$.既然如此,$a_n$从某一项开始就满足$a_n &gt; 0$.之后不妨干脆设$a_n &gt; 0$.</p>
</li>
<li><p>$A_n$有非$0$极限当且仅当$\ln A_n$有极限.</p>
</li>
<li><p>柯西收敛准则:$A_n$有非零极限的必要条件是$\forall \epsilon &gt; 0 , \exists N , \forall N \leq n \leq m$,$| 1 - \prod_{ k = n }^m a_k | &lt; \epsilon$.特别地,如果$\forall a_n \ne 0$,则上式为充要条件.</p>
</li>
</ol>
<p>(1)(2)显然.</p>
<p>(3)的话也比较显然.</p>
<p>总之,既然$\lim a_n \to 1$,不妨干脆设其为$1 + a_n$,其中$\lim a_n = 0$,从而原本要研究的$\prod ( 1 + a_n )$可以转为研究$\sum \ln ( 1 + a_n )$.</p>
<ol>
<li><p>当$a_n$定号的时候,$\sum \ln ( 1 + a_n )$和$\sum a_n$的敛散性相同.</p>
</li>
<li><p>当$a_n$不定号的时候,若$\sum a_n^2 &lt; \infty$,则$\sum \ln ( 1 + a_n )$和$\sum a_n$的敛散性相同.同理如若$\sum a_n^2$发散,则上述两个级数至少一个发散.</p>
</li>
<li><p>$\sum | \ln ( 1 + a_n ) |$和$\sum | a_n |$的敛散性相同.</p>
</li>
</ol>
<p>(1)是因为$\lim \frac{ \ln ( 1 + a_n ) }{ a_n } = 1$.</p>
<p>(2)是因为$a_n - \ln ( 1 + a_n )$可以被$a_n^2$控制住,原因是$a_n \to 0$,换言之存在$c_1 , c_2$使得$c_1 x^2 &lt; a_n - \ln ( 1 + a_n ) &lt; c_2 x^2$,只需要对$0$附近做个简单放缩.既然它们的差收敛,那它们当然敛散性相同.</p>
<p>(3)还是因为$\lim \frac{ | \ln ( 1 + x ) | }{ | x | } = 1$.</p>
<h6><span id="example1">Example1</span></h6><p>当$| x | &lt; 1$的时候,求$\prod_{ k = 1 } ( 1 + x^{ 2^{ k - 1 } } )$的极限.</p>
<p>容易见到$A_n = \prod_{ k = 1 }^n ( 1 + x^{ 2^{ k - 1 } } ) = \frac{ 1 - x^{ 2^n } }{ 1 - x }$,这样自然就收敛了.</p>
<h6><span id="example2">Example2</span></h6><p>求$\prod_{ k = 1 } \cos \frac{ \varphi }{ 2^k }$.</p>
<p>当$\varphi \ne 0$的时候,考虑$A_n = \prod_{ k = 1 }^n \cos \frac{ \varphi }{ 2^k } = \frac{ \sin \varphi }{ 2^n \sin \frac{ \varphi }{ 2^n } }$.虽然这里当$\varphi = 2^k \pi$的时候会有若干项分母为$0$,但由于我们可以干脆去掉这前几项,而只看后几项分母均不为$0$,当然收敛于$\frac{ \sin \varphi }{ \varphi }$.</p>
<p>而$\varphi = 0$的时候每一项都是$1$,乘起来仍然收敛.</p>
<h6><span id="example3">Example3</span></h6><p>考虑$\Gamma ( x ) = \frac{ 1 }{ x } \prod_{ n = 1 }^{ \infty } \frac{ ( 1 + \frac{ 1 }{ n } )^x }{ 1 + \frac{ x }{ n } }$敛散性,其中$x \ne 0 , - 1 , - 2 , \cdots$.</p>
<p>直接泰勒展开,见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ ( 1 + \frac{ 1 }{ n } )^x }{ 1 + \frac{ x }{ n } } \\
= & ( 1 + \frac{ x }{ n } + \frac{ x ( x - 1 ) }{ 2 n^2 } + o ( \frac{ 1 }{ n^2 } ) ) ( 1 - \frac{ x }{ n } + \frac{ x^2 }{ n^2 } + o ( \frac{ 1 }{ n^2 } ) ) \\
= & 1 + \frac{ x ( x - 1 ) }{ 2 n^2 } + o ( \frac{ 1 }{ n^2 } )
\end{aligned}</script><p>这就绝对收敛了.</p>
<p>而我们观察$A_n$,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A_n & = \frac{ 1 }{ x } \prod_{ k = 1 }^{ n } \frac{ ( \frac{ k + 1 }{ k } )^x }{ 1 + \frac{ x }{ k } } \\
& = \frac{ ( n + 1 )^x }{ x ( 1 + \frac{ x }{ 1 } ) \cdots ( 1 + \frac{ x }{ n } ) } \\
& = ( \frac{ n + 1 }{ n } )^x \frac{ n ! n^x }{ x^{ \overline{ n + 1 } } } \\

\end{aligned}</script><p>于是见到:</p>
<script type="math/tex; mode=display">
\frac{ \Gamma ( x + 1 ) }{ \Gamma ( x ) } = \lim_{ n \to \infty } \frac{ ( n + 1 ) x }{ x + 1 + n } = x</script><p>所以$\Gamma ( x + 1 ) = x \Gamma ( x )$,而且$\Gamma ( 1 ) = 1$,所以$\Gamma ( n ) = n !$,这实际上是阶乘函数的一个推广.</p>
<p>而此时有$\Gamma ( x + 1 ) = x \Gamma ( x ) = \prod_{ n = 1 }^\infty \frac{ ( 1 + \frac{ 1 }{ n } )^x }{ 1 + \frac{ x }{ n } }$.</p>
<p>而观察这个级数:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \prod_{ n = 1 }^\infty \frac{ e^{ \frac{ 1 }{ n } } }{ 1 + \frac{ 1 }{ n } } \\
= & \frac{ e^{ 1 + \frac{ 1 }{ 2 } + \cdots + \frac{ 1 }{ n } } }{ n + 1 } \\
= & \frac{ e^{ \ln n + \gamma + c_n } }{ n + 1 } \to e^\gamma
\end{aligned}</script><p>其中$\gamma$是欧拉常数,误差项$c_n = H_n - \ln n - \gamma \to 0$.</p>
<p>从而观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& e^{ \gamma x } \Gamma ( x + 1 ) \\
= & \prod_{ n = 1 }^\infty \frac{ e^{ \frac{ x }{ n } } }{ 1 + \frac{ x }{ n } }
\end{aligned}</script><p>从而$\frac{ 1 }{ \Gamma ( x + 1 ) } = e^{ \gamma x } \prod_{ n = 1 }^\infty ( 1 + \frac{ x }{ n } ) e^{ - \frac{ x }{ n } }$.</p>
<p>在此基础上,如若设$b_n = \frac{ n ! n^x }{ x^{ \overline{ n + 1 } } }$.容易见到$\lim b_n = \lim A_n = \Gamma ( x )$,而观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ b_{ n + 1 } }{ b_n } & = \frac{ ( 1 + \frac{ 1 }{ n } )^{ x + 1 } }{ 1 + \frac{ x + 1 }{ n } } \\
& = 1 + \frac{ x ( x + 1 ) }{ 2 n^2 } + o ( \frac{ 1 }{ n^2 } ) \\
& \to 1
\end{aligned}</script><p>而且如若$x ( x + 1 ) &gt; 0$,并且取$n$足够大,则上式大于$1$,反之上式小于$1$.因此当$n$足够大的时候$b_n$单调有界(原因是其极限存在).</p>
<p>因此还可以得到结论:$\sum \frac{ n ! a_n }{ x^{ \overline{ n + 1 } } }$和$\sum \frac{ a_n }{ n^x }$敛散性相同,其中$x \ne 0 , - 1 , - 2 , \cdots$.原因只是因为这俩的比值恰好是$b_n$单调有界,根据DA判别法知道二者同敛散.</p>
<h6><span id="example4">Example4</span></h6><p>求$\sum_{ n = 1 }^\infty \frac{ ( nx )^n }{ n ! }$的收敛性.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\frac{ a_{ n + 1 } }{ a_n } = ( \frac{ n + 1 }{ n } )^n x \to ex</script><p>根据比值判法,当$| x | &lt; \frac{ 1 }{ e }$的时候绝对收敛,而当$| x | &gt; \frac{ 1 }{ e }$的时候发散,问题只在于$| x | = \frac{ 1 }{ e }$的时候如何.</p>
<p>当$x = \frac{ 1 }{ e }$的时候,使用拉贝判法:</p>
<script type="math/tex; mode=display">
\begin{aligned}
n ( \frac{ a_n }{ a_{ n + 1 } } - 1 ) & = n ( ( 1 - \frac{ 1 }{ n + 1 } )^n e - 1 ) \\
& = n ( e^{ n \ln ( 1 - \frac{ 1 }{ n + 1 } ) + 1 } - 1 ) \\
& = n ( e^{ n ( - \frac{ 1 }{ n + 1 } - \frac{ 1 }{ 2 ( n + 1 )^2 } + o ( \frac{ 1 }{ n^2 } ) ) + 1 } - 1 ) \\
& = n ( e^{ \frac{ 1 }{ n + 1 } - \frac{ n }{ 2 ( n + 1 )^2 } + o ( \frac{ 1 }{ n } ) } - 1 ) \\
& = n ( \frac{ 1 }{ n + 1 } - \frac{ n }{ 2 ( n + 1 )^2 } + o ( \frac{ 1 }{ n } ) ) \\
& \to \frac{ 1 }{ 2 } < 1
\end{aligned}</script><p>所以发散.</p>
<p>当$x = - \frac{ 1 }{ e }$的时候,使用DA判法:应当见到$a_n = ( - 1 )^n | a_n |$,此时$| a_n |$单调递减且趋于$0$,用DA判法知道其收敛.</p>
<p>所以条件收敛.</p>
<h6><span id="example5">Example5</span></h6><p>求证$\sum a_n ( x^2 - 1 ) ( x^2 - 2^2 ) \cdots ( x^2 - n^2 )$对$\forall x \notin \mathbb{ Z }$,其都有相同的敛散性.就是对于一个确定的$\{ a_n \}$,对所有的$x$,要么都收敛,要么都发散.</p>
<p>考虑设$f_n ( x ) = ( x^2 - 1 ) ( x^2 - 2^2 ) \cdots ( x^2 - n^2 )$,观察到:</p>
<script type="math/tex; mode=display">
\frac{ f_n ( x ) }{ f_n ( x_0 ) } = \frac{ ( x^2 - 1 ) ( x^2 - 2^2 ) \cdots ( x^2 - n^2 ) }{ ( x_0^2 - 1 ) ( x_0^2 - 2^2 ) \cdots ( x_0^2 - n^2 ) }</script><p>这当然是个无穷乘积,观察到$\frac{ x^2 - n^2 }{ x_0^2 - n^2 } = 1 + \frac{ x^2 - x_0^2 }{ x_0^2 - n^2 } = 1 + O ( \frac{ 1 }{ n^2 } )$,所以$\lim_{ n \to \infty } \frac{ f_n ( x ) }{ f_n ( x_0 ) }$存在且非零.</p>
<p>而且,当$n$足够大的时候,或者更进一步说$| n | &gt; \max ( | x | , | x_0 | )$的时候$\frac{ f_n ( x ) }{ f_n ( x_0 ) }$当然就定号了,而且$\frac{ x^2 - n^2 }{ x_0^2 - n^2 } = 1 + \frac{ x^2 - x_0^2 }{ x_0^2 - n^2 }$,其与$1$比较只取决于$x^2 - x_0^2$,这就意味着$\frac{ f_n ( x ) }{ f_n ( x_0 ) }$在$n$足够大的时候是单调有界非零的,于是DA判法知道同敛散.</p>
<h6><span id="example6">Example6</span></h6><p>求证$\sin x = x \prod_{ k = 1 }^{ \infty } ( 1 - \frac{ x^2 }{ k^2 \pi^2 } )$.</p>
<p>先看$\sin x = 0$的根,假设其根为$u + iv$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sin x & = \frac{ e^{ ix } - e^{ - ix } }{ 2 i } = 0 \\
e^{ 2 ix } & = 1 \\
e^{ 2 iu - 2 v } & = 1 \\
| e^{ 2 iu - 2 v } | & = 1 \\
e^{ - 2 v } & = 1 \\
v & = 0
\end{aligned}</script><p>所以其只有实根,用多项式理论知道如若$\sin x$的根只有$2 k \pi$,应该有:</p>
<script type="math/tex; mode=display">
\sin x = cx \prod_{ k = 1 }^{ \infty } ( 1 - \frac{ x^2 }{ k^2 \pi^2 } )</script><p>容易见到这个无穷乘积的确收敛,而$x \to 0$的时候$\frac{ \sin x }{ x } = 1$,所以$c = 1$.</p>
<p>那么考虑$\sin x$的泰勒展开,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
1 - \frac{ x^2 }{ 6 } + \cdots & = \prod_{ k = 1 } ( 1 - \frac{ x^2 }{ k^2 \pi^2 } ) \\
& = 1 - ( \frac{ 1 }{ \pi^2 } \sum_k \frac{ 1 }{ k^2 } ) x^2 + \cdots
\end{aligned}</script><p>这就能知道$\sum_{ k = 1 }^\infty \frac{ 1 }{ k^2 } = \frac{ \pi^2 }{ 6 }$.</p>
<p>然而上述的多项式理论还是太过粗糙,下面提供一种更加严谨的证明:</p>
<p>我们有欧拉公式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( \cos x + i \sin x )^{ 2 n + 1 } & = \cos ( 2 n + 1 ) x + i \sin ( 2 n + 1 ) x \\

\end{aligned}</script><p>然而左侧可以使用二项式定理展开,有:</p>
<script type="math/tex; mode=display">
( \cos x + i \sin x )^{ 2 n + 1 } = \sum \binom{ 2 n + 1 }{ k } \cos^k x ( i \sin x )^{ 2 n + 1 - k }</script><p>容易见到为了贡献虚部,$k$必须是偶数,那此时$\cos^k x = ( 1 - \sin^2 x )^{ \frac{ k }{ 2 } }$,总之,我们发现应该存在一个$n$次多项式$P_n$,使得:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sin ( 2 n + 1 ) x & = ( \sin x ) P_n ( \sin^2 x ) \\

\end{aligned}</script><p>这个多项式的根应该怎么取呢?考虑当$\varphi_k = \frac{ k \pi }{ 2 n + 1 } , 1 \leq k \leq n$的时候,左侧为$0$,而右侧$\sin \varphi_k$不该为$0$,更进一步地,$\sin^2 \varphi_k$两两不同,这就知道它们确实是$P_n$的$n$个根.同时见到$P ( 0 ) = \lim_{ x \to 0 } P_n ( \sin^2 x ) = 2 n + 1$,从而我们已经能唯一确定这个有限项多项式$P_n ( x ) = ( 2 n + 1 ) \prod_{ k = 1 }^n ( 1 - \frac{ x }{ \sin^2 \varphi_k } )$.</p>
<p>接下来,将原本上式中的$x$换成$\frac{ x }{ 2 n + 1 }$,我们就能得到:</p>
<script type="math/tex; mode=display">
\sin x = ( 2 n + 1 ) \sin ( \frac{ x }{ 2 n + 1 } ) \prod_{ k = 1 }^n ( 1 - \frac{ \sin^2 \frac{ x }{ 2 n + 1 } }{ \sin^2 \varphi_k } )</script><p>这里已经十分接近我们想要的答案了,但是这个项数和$n$一起增大,策略当然是大小步极限,考虑取:</p>
<script type="math/tex; mode=display">
\begin{aligned}
U_m & = ( 2 n + 1 ) \sin \frac{ x }{ 2 n + 1 } \prod_{ k = 1 }^m ( 1 - \frac{ \sin^2 \frac{ x }{ 2 n + 1 } }{ \sin^2 \varphi_k } ) \\
V_m & = \prod_{ k = m + 1 }^n ( 1 - \frac{ \sin^2 \frac{ x }{ 2 n + 1 } }{ \sin^2 \varphi_k } ) \\

\end{aligned}</script><p>取定$m$,当然总能取足够大的$n$使得$U_m \to x \prod_{ k = 1 }^m ( 1 - \frac{ x^2 }{ k^2 \pi^2 } )$.</p>
<p>而用柯西准则,当$m$足够大的时候,如果能证明$V_m \to 1$就完事了.我们考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
1 & \geq V_m \geq \prod_{ k = m + 1 }^\infty ( 1 - \frac{ \sin^2 \frac{ x }{ 2 n + 1 } }{ \sin^2 \varphi_k } ) \\

\end{aligned}</script><p>而回忆到当$\sin^2 x \leq x^2$恒成立,在$x \in [ 0 , \frac{ \pi }{ 2 } ]$的时候,$\sin x \geq \frac{ 2 }{ \pi } x$也成立,所以:</p>
<script type="math/tex; mode=display">
\begin{aligned}
V_m & \geq \prod_{ k = m + 1 }^\infty ( 1 - \frac{ \sin^2 \frac{ x }{ 2 n + 1 } }{ \sin^2 \varphi_k } ) \\
& \geq \prod_{ k = m + 1 }^\infty ( 1 - \frac{ x^2 }{ 4 k^2 } ) \\

\end{aligned}</script><p>此时回忆到$\prod_{ k = 1 }^\infty ( 1 - \frac{ x^2 }{ 4 k^2 } )$是收敛的,所以由柯西准则,当$m$足够大的时候,$\prod_{ k = m + 1 }^\infty ( 1 - \frac{ x^2 }{ 4 k^2 } )$趋近于$1$,这就证毕了.</p>
<h3><span id="函数项数列">函数项数列</span></h3><p>也就是每一项都是一个函数的数列,假设定义域在$I \subseteq \mathbb{ R }$上,写作$\{ f_n ( x ) \}$.此时对于一个固定的$x_0 \in I$,则$\{ f_n ( x_0 ) \}$就是一个普通的数列.当然不一定$I$中的每一个$x_0$都收敛,我们将<strong>收敛点</strong>的集合称为函数项级数的<strong>收敛域</strong>,其它的点称为<strong>发散点</strong>,发散点组成的集合称为<strong>发散域</strong>.</p>
<p>对于收敛域,直接记$f ( x ) = \lim_{ n \to \infty } f_n ( x )$,我们将这里的$f ( x )$就是这个函数列的<strong>极限函数</strong>.既然有了极限就可以定义级数,也就是可以定义$S_n = \sum_{ k = 1 }^n f_k ( x )$,然后取其极限拿到$\sum_{ k = 1 }^\infty f_n ( x ) = S ( x )$.</p>
<p>我们要解决的问题大概有以下三个:</p>
<ol>
<li><p>如果$f_n$均是连续的,那么要求什么条件,可以满足$f$连续.也就是两层极限什么时候可以交换顺序.</p>
</li>
<li><p>如果$f_n$均是黎曼可积的,那么要求什么条件,可以满足$f$黎曼可积并且$\lim \int f_n = \int f$,也就是极限和积分什么时候可以交换顺序.</p>
</li>
<li><p>如果$f_n$均可导,那么什么时候$f$也可导,并且$\lim f_n ‘ = f ‘$,也就是极限和导数什么时候可以交换顺序.</p>
</li>
</ol>
<p>如果不加条件,上述三条全都是不满足的,下述Example会给出若干例子.</p>
<h6><span id="example1">Example1</span></h6><p>取$f_n ( x ) = x^n , x \in [ 0 , 1 ]$,求其极限函数.</p>
<p>显然$f ( x ) = \begin{cases}1 &amp; x = 1 \ 0 &amp; \text{ otherwise }\end{cases}$,由此可以见到,连续函数的极限函数不一定连续.</p>
<h6><span id="example2">Example2</span></h6><p>取$f_n ( x ) = \begin{cases}1 &amp; ( n ! ) x \in \mathbb{ Z } \ 0 &amp; \text{ otherwise }\end{cases}$,求其极限函数.</p>
<p>显然是迪利克雷函数.</p>
<p>则$f_n ( x )$只有有限个间断点,容易见到其黎曼可积,然而迪利克雷函数并不黎曼可积.可积函数的极限函数不一定可积.</p>
<h6><span id="example3">Example3</span></h6><p>取$f_n ( x ) = nx ( 1 - x^2 )^n , x \in [ 0 , 1 ]$,求其极限函数.</p>
<p>容易见到$\lim f_n ( x ) = 0$,也就是这个函数处处收敛到$0$.</p>
<p>然而,对其求积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^1 f_n ( x ) \mathrm{ d } x & = \int_0^1 nx ( 1 - x^2 )^n \mathrm{ d } x \\
& = - \frac{ n }{ 2 } \int_0^1 ( 1 - x^2 )^n \mathrm{ d } ( 1 - x^2 ) \\
& = - \frac{ n }{ 2 ( n + 1 ) } ( 1 - x^2 )^{ n + 1 } |_0^1 \\
& = \frac{ n }{ 2 ( n + 1 ) } \to \frac{ 1 }{ 2 }
\end{aligned}</script><p>由此见到,极限函数的积分不一定等于积分的极限.极限和积分不一定可交换.</p>
<h6><span id="example4">Example4</span></h6><p>考虑$f_n ( x ) = \begin{cases}2 n^2 x \ x \in [ 0 , \frac{ 1 }{ 2 n } ] \ 2 n^2 ( x - \frac{ 1 }{ n } ) &amp; x \in ( \frac{ 1 }{ 2 n } , \frac{ 1 }{ n } ] \ 0 &amp; \text{ otherwise }\end{cases}$,也就是这个函数在$\frac{ 1 }{ 2 n }$处高度为$n$,底长为$\frac{ 1 }{ n }$的一个小三角形.求其极限函数.</p>
<p>对于每一个点,这个函数当然逐点收敛于$0$.然而也可以见到,这个函数的积分对于每一个$n$来说都是$\frac{ 1 }{ 2 }$.</p>
<p>再次说明了极限函数的积分不一定等于积分的极限.极限和积分不一定可交换.</p>
<h6><span id="example5">Example5</span></h6><p>考虑$f_n ( x ) = \frac{ \sin ( nx ) }{ \sqrt{ n } }$,求其极限函数.</p>
<p>当然逐点收敛于$0$,然而观察到$f_n ‘ ( x ) = \sqrt{ n } \cos nx$,$f ‘ ( x ) = 0$.因此,光滑函数列的导数的极限又不一定等于极限的导数.</p>
<h4><span id="一致收敛">一致收敛</span></h4><p>我们称一列函数$\{ f_n ( x ) \}$是<strong>一致收敛</strong>到$f ( x )$,当且仅当$\forall \epsilon &gt; 0$,$\exists N = N ( \epsilon )$,使得当$n \geq N$的时候,$| f ( x ) - f_n ( x ) | &lt; \epsilon , \forall x \in I$.注意这里的$N$不取决于$x$的选取,这就是和极限不同的地方,一致收敛要求整个函数都在逐步地贴向最终的函数.此时,记$f_n ( x ) \rightrightarrows f ( x )$.还可以定义<strong>内闭一致收敛</strong>的概念,也就是对于一个$I$的任意的子紧集(在$\mathbb{ R }$上表现为有界闭集)都一致收敛.</p>
<p>一致收敛的等价定义当然是,取$M_n = \sup_{ x \in I } | f_n ( x ) - f ( x ) |$,那么一致收敛等价于$\lim M_n = 0$.</p>
<p>一致收敛强大的地方在于,对于收敛来说,是取定了$x$再挪动$n$,因此$n$可以控制$x$.然而,一致收敛要求先取定$n$再挪动$x$.这种天然的交换能力赋予了一致收敛的强大.另外还容易见到,当$I$的点集是有限的时候,一定一致收敛.</p>
<p>我们还可以定义<strong>一致有界</strong>的概念,当存在一个上界$M$,使得$\forall n , | f_n | \leq M$恒成立.显然,如果一个函数列一致有界,则极限函数肯定有界.</p>
<p>另外,我们可以见到,如果$f_n \rightrightarrows f$,那么如果$f$有界,则$f_n$一致有界.反之,如果$f_n$有界,则$f_n$一致有界.</p>
<p>考虑前者,是因为:</p>
<script type="math/tex; mode=display">
| f_n | \leq | f_n - f | + | f |</script><p>这俩当然是有界的.</p>
<p>对于后者,考虑反证,假设$f$无界(因为如果有界则前者即可推出),那么:</p>
<script type="math/tex; mode=display">
| f | \leq | f - f_n | + | f_n |</script><p>由于$| f - f_n |$必然需要有界,因此前者无界,后者无论对于哪个$n$来说,必然也得无界.</p>
<p>我们有以下性质:</p>
<ol>
<li><p>$f_n \rightrightarrows f , g_n \rightrightarrows g , x \in I$,则$c_1 f_n + c_2 g_n \rightrightarrows c_1 f + c_2 g , x \in I$.</p>
</li>
<li><p>$f_n \rightrightarrows f , g_n \rightrightarrows g , x \in I$,而且$f , g$有界,则$f_n g_n \rightrightarrows fg , x \in I$.</p>
</li>
<li><p>如果$x \in I$的时候$f_n \rightrightarrows f$,$x \in J$的时候也$f_n \rightrightarrows f$,则当$x \in I \cup J$的时候也有$f_n \rightrightarrows f$.</p>
</li>
</ol>
<p>对于(1),考虑令$M_{ n } = \sup | f_n - f | , K_n = \sup | g_n - g |$,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | ( c_1 f_n + c_2 g_n ) - ( c_1 f + c_2 g ) | \\
\leq & | c_1 | M_n + | c_2 | K_n \to 0
\end{aligned}</script><p>立刻证毕.</p>
<p>对于(2),经典的做法:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | f_n g_n - fg | \\
= & | f_n ( g_n - g ) + g ( f_n - f ) | \\
\leq & | f_n | \cdot | g_n - g | + | g | \cdot | f_n - f |
\end{aligned}</script><p>而$| f_n |$一致有界,$| g_n |$一致有界得到$| g |$有界,所以上式就被控制住了.</p>
<p>对于(3),只需要把两部分的$\sup$分开算就可以见到仍能被控制住.</p>
<p>这里也有<strong>柯西准则</strong>:对于一列函数$\{ f_n \}$,其一致收敛的充要条件是,$\forall \epsilon &gt; 0 , \exists N , \forall n , m \geq N , | f_n ( x ) - f_m ( x ) | &lt; \epsilon$.</p>
<p>必要性显然,只证充分性,对于此时固定一个确定的$x$,那么$\{ f_n ( x ) \}$就是一个柯西列且存在极限.逐点取极限就可以拿到$f ( x ) = \lim_{ n \to \infty } f_n ( x )$.而$| f_n ( x ) - f_m ( x ) | &lt; \epsilon$中只需要让$m \to \infty$就拿到了$| f_n ( x ) - f ( x ) | \leq \epsilon$,这恰好是一致收敛的定义.</p>
<h6><span id="example1">Example1</span></h6><p>求证:$f_n ( x ) = \frac{ x }{ 1 + n^2 x^2 }$一致收敛.</p>
<p>当然处处收敛于$0$了,考虑用均值不等式,有$| f_n ( x ) | \leq \frac{ | x | }{ 2 n | x | } = \frac{ 1 }{ 2 n }$,这就搞定.</p>
<h6><span id="example2">Example2</span></h6><p>求证:$f_n ( x ) = x^n , x \in [ 0 , 1 )$并不一致收敛.</p>
<p>当然处处收敛到$0$,但是$\sup f_n ( x ) = 1$,所以并不一致收敛.</p>
<h6><span id="example3">Example3</span></h6><p>取$f_n ( x ) = \frac{ 1 }{ n } , g_n ( x ) = x , x \in ( 0 , + \infty )$,容易见到$f_n \rightrightarrows 0 , g_n \rightrightarrows x$.而且$f_n ( x )$当然一致有界.然而,$f_n g_n \not \rightrightarrows 0$.</p>
<h6><span id="example4">Example4</span></h6><p>当$g \in C [ 0 , 1 ] , g ( 1 ) = 0$,求证:$f_n ( x ) = g ( x ) x^n \rightrightarrows 0$.</p>
<p>由于$g$在闭区间上连续,则其必然在闭区间上一致连续.因此$\forall \epsilon &gt; 0$,取$\delta \in ( 0 , 1 )$,使得$x \in [ \delta , 1 ]$的时候,$| g ( x ) | &lt; \epsilon$,而取$M = \sup_{ [ 0 , 1 ] } | g |$,那么$| f_n ( x ) | \leq M \delta^n + \epsilon$,注意这里的$\delta$不取决于$n$的选取这就搞定.</p>
<h6><span id="example5">Example5</span></h6><p>设$f_n ( x ) = n \left ( \sqrt{ x + \frac{ 1 }{ n } } - \sqrt{ x } \right ) , x \in ( 0 , + \infty )$,判断其收敛性.</p>
<p>容易发现$f_n ( x ) = \frac{ 1 }{ \sqrt{ x + \frac{ 1 }{ n } } + \sqrt{ x } } \to \frac{ 1 }{ 2 \sqrt{ x } }$,因此其收敛.问题在于判断其是否一致收敛.</p>
<p>观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | f_n ( x ) - \frac{ 1 }{ 2 \sqrt{ x } } | \\
= & \frac{ \sqrt{ x + \frac{ 1 }{ n } } - \sqrt{ x } }{ 2 \sqrt{ x } \left ( \sqrt{ x + \frac{ 1 }{ n } } + \sqrt{ x } \right ) } \\
= & \frac{ 1 }{ 2 n \sqrt{ x } \left ( \sqrt{ x + \frac{ 1 }{ n } } + \sqrt{ x } \right )^2 }
\end{aligned}</script><p>一个策略是直接对此式子求导,但也可以采取另一种分析策略,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sqrt{ x + \frac{ 1 }{ n } } & = \sqrt{ x } \left ( 1 + \frac{ 1 }{ nx } \right )^{ \frac{ 1 }{ 2 } } \\
& = \sqrt{ x } \left ( 1 + \frac{ 1 }{ 2 nx } + O ( \frac{ 1 }{ n^2 } ) \right )
\end{aligned}</script><p>所以当$x$足够小的时候可能会出问题,直接取$x = \frac{ 1 }{ n }$,误差为:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ 2 \sqrt{ n } \left ( \frac{ 1 + \sqrt{ 2 } }{ \sqrt{ n } } \right )^2 } = O ( \sqrt{ n } )</script><p>这就证明了并非一致收敛.</p>
<h6><span id="example6">Example6</span></h6><p>$[ 0 , 1 ]$上的$f_n ( x )$满足$\exists L &gt; 0 , \forall x \ne y , | f_n ( x ) - f_n ( y ) | \leq L | x - y |$.并且$\forall x \in [ 0 , 1 ] , f_n ( x ) \to f ( x )$.求证:$f_n ( x ) \rightrightarrows f ( x )$.也就是:一致李氏连续的收敛函数列一定一致收敛.</p>
<p>李氏连续意味着我们可以用控制自变量的方式控制因变量.回忆到定义在有限集上的收敛函数列一定是一致收敛的.因此我们选择在数轴上打足够密的点来控制.</p>
<p>具体地,$\forall \epsilon &gt; 0$,我们将$[ 0 , 1 ]$拆为长度不超过$\frac{ \epsilon }{ 3 L }$的小区间.假设分点是$x_1 , \cdots , x_K$.这当然对于一个$\epsilon$来说是有限个点,我们可以让它们同时趋近于一致收敛,用柯西准则,也就是拿到一个$N$,使得$\forall n , m \geq N$,$| f_n ( x_i ) - f_m ( x_i ) | &lt; \frac{ \epsilon }{ 3 }$.</p>
<p>现在$\forall x \in [ 0 , 1 ] , \exists x_i , | x - x_i | &lt; \frac{ \epsilon }{ 3 L }$.于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | f_n ( x ) - f_m ( x ) | \\
\leq & | f_n ( x ) - f_n ( x_i ) | + | f_n ( x_i ) - f_m ( x_i ) | + | f_m ( x_i ) - f_m ( x ) | \\
< & \epsilon
\end{aligned}</script><p>这就搞定.</p>
<h4><span id="函数项级数">函数项级数</span></h4><p>函数项级数上也有柯西准则,也就是函数项级数的一致收敛性等价于$\forall \epsilon , \exists N , \forall n , m \geq N , | \sum_{ k = n }^m f_k ( x ) | &lt; \epsilon , \forall x \in I$.</p>
<p>还可以在这里定义<strong>绝对收敛</strong>:也就是$\sum | f_n ( x ) |$收敛.当然仍有绝对收敛推收敛.如果$\sum | f_n ( x ) |$还一致收敛,则称原级数<strong>绝对一致收敛</strong>.注意,这里的绝对一致收敛是定义在$| f_n |$的基础上.也就是说,一个函数既绝对收敛,又一致收敛,但它可能并不绝对一致收敛.然而反之是成立的,如果一个函数绝对一致收敛,可以推出它一致收敛,原因是$\sum | f_n | \geq | \sum f_n |$,用柯西准则就可以得知.</p>
<p>另外,用柯西准则可以见到如果$\sum f_n \rightrightarrows f$,那么$f_n ( x ) \rightrightarrows 0$.</p>
<h6><span id="example1">Example1</span></h6><p>考虑函数项级数$\sum ( - x )^n ( 1 - x ) , x \in [ 0 , 1 ]$.</p>
<p>直接考虑其余项,$R_n ( x ) = \sum_{ k = n + 1 }^\infty ( - x )^k ( 1 - x ) = \frac{ ( - x )^{ n + 1 } ( 1 - x ) }{ 1 + x }$.此时考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| R_n | & \leq x^{ n + 1 } ( 1 - x ) \\
& = \frac{ 1 }{ n + 1 } ( n + 1 ) ( 1 - x ) x^{ n + 1 } \\
& \leq \frac{ 1 }{ n + 1 } ( \frac{ n + 1 }{ n + 2 } )^{ n + 2 } \\
& \leq \frac{ 1 }{ n + 1 } \to 0
\end{aligned}</script><p>所以该级数一致收敛.</p>
<p>那么是否绝对收敛呢?考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ k = 1 }^n | ( - x )^n ( 1 - x ) | \\
= & \sum_{ k = 1 }^n ( x^k - x^{ k + 1 } ) \\
= & x - x^{ n + 1 }
\end{aligned}</script><p>所以当然也绝对收敛到$\begin{cases}x &amp; x \in [ 0 , 1 ) \ 0 &amp; x = 1\end{cases}$.</p>
<p>可是,它并不是绝对一致收敛的.考虑$\sup_{ [ 0 , 1 ) } | S ( x ) - S_n ( x ) | = \sup_{ [ 0 , 1 ) } | x^{ n + 1 } | = 1$.</p>
<h6><span id="example2">Example2</span></h6><p>求$\sum \left ( \cos \frac{ \pi x }{ n } \right )^{ n^3 }$的收敛域.</p>
<p>不妨设$u_n ( x ) = \left ( \cos \frac{ \pi x }{ n } \right )^{ n^3 }$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sqrt[n]{ u_n ( x ) } & = \left ( \cos \frac{ \pi x }{ n } \right )^{ n^2 } \\
& = \left ( 1 - \frac{ \pi^2 x^2 }{ 2 n^2 } + O ( \frac{ 1 }{ n^4 } ) \right )^{ n^2 } \\
& = \exp ( n^2 \ln \left ( 1 - \frac{ \pi^2 x^2 }{ 2 n^2 } + O ( \frac{ 1 }{ n^4 } ) \right ) ) \\
& = \exp ( n^2 \left ( - \frac{ \pi^2 x^2 }{ 2 n^2 } + O ( \frac{ 1 }{ n^4 } ) \right ) ) \\
& = \exp ( - \frac{ \pi^2 x^2 }{ 2 } + O ( \frac{ 1 }{ n^2 } ) ) \\
& \to e^{ - \frac{ \pi^2 x^2 }{ 2 } }
\end{aligned}</script><p>所以最后模拟成了一个等比数列,那收敛域就是$\mathbb{ R } \setminus \{ 0 \}$.</p>
<h5><span id="m判别法">M判别法</span></h5><p>若$| f_n ( x ) | \leq a_n , x \in I$,如果$\sum a_n &lt; \infty$,则$\sum f_n ( x )$绝对一致收敛.</p>
<p>证明的话,考虑用一般级数可以拿到$\forall \epsilon &gt; 0 , \exists N , \forall n , m \geq N , \sum_{ k = n }^m | a_n | &lt; \epsilon$,但又有$\forall x \in I , \sum_{ k = n }^m | f_n ( x ) | \leq \sum_{ k = n }^m a_k$,这就知道其绝对一致收敛.</p>
<h5><span id="da判别法">DA判别法</span></h5><p>假设$\{ a_n ( x ) \} , \{ b_n ( x ) \}$是两个函数列.对于任意固定的$x \in I$,$\{ a_n ( x ) \}$是一个单调数列.注意这里其实不要求大家都递增或递减,只要对于每一个点都是单调的.而取$B_n ( x ) = \sum_{ k = 1 }^n b_k ( x )$.则当:</p>
<ol>
<li><p>Dirichlet判别法:当$a_n ( x ) \rightrightarrows 0$,$B_n ( x )$一致有界时,则$\sum a_n b_n$一致收敛.</p>
</li>
<li><p>Able判别法:当$\{ a_n ( x ) \}$一致有界,$B_n ( x )$一致收敛时,则$\sum a_n b_n$一致收敛.</p>
</li>
</ol>
<p>证明和级数部分完全一样,只需要对于任意的$x$都这么搞即可:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = n + 1 }^{ n + p } a_k ( x ) b_k ( x ) | \\
= & | \sum_{ k = n + 1 }^{ n + p } a_k ( x ) ( B_{ k } ( x ) - B_{ k - 1 } ( x ) ) | \\
= & | a_{ n + p } B_{ n + p } ( x ) + \sum_{ k = n + 1 }^{ n + p - 1 } ( a_k ( x ) - a_{ k + 1 } ( x ) ) B_k ( x ) | \\
\leq & M ( a_{ n + 1 } ( x ) + 2 a_{ n + p } ( x ) )
\end{aligned}</script><p>其中$M = \sup_{ 1 \leq i \leq p } \{ | \sum_{ k = n + 1 }^{ n + i } b_k ( x ) | \}$.</p>
<h6><span id="example1">Example1</span></h6><p>当$b_n$单调下降趋近于$0$的时候,求证:$\sum_{ k = 1 }^\infty b_n \sin ( nx ) , x \in \mathbb{ R }$一致收敛的充要条件是$b_n = o ( \frac{ 1 }{ n } )$.</p>
<p>先证必要性,设$S_{ n , p } = \sum_{ k = n }^p b_k \sin ( kx )$.由柯西原理,$\forall \epsilon &gt; 0 , \exists N , \forall n , p \geq N , | S_{ n , p } | &lt; \epsilon$.此时取$p = 2 n - 1 , x = \frac{ \pi }{ 4 n }$,此时当$n \leq k \leq p$的时候,$\sin ( k \pi ) &gt; \sin \frac{ \pi }{ 4 }$,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\epsilon & > | S_{ n , p } ( x ) | \\
& > nb_{ 2 n } \sin \frac{ \pi }{ 4 } = \frac{ \sqrt{ 2 } }{ 2 } n b_{ 2 n }
\end{aligned}</script><p>这就搞定了$b_{ 2 n } = o ( \frac{ 1 }{ n } )$,又因为$b_n$是单调下降的,那当然搞定了.</p>
<p>再证充分性,只要证明在$[ 0 , \pi ]$上一致收敛,由于$\sin ( nx )$是奇函数,那么在$[ - \pi , 0 ]$上当然也一致收敛,那就搞定了.</p>
<p>设$\mu_n = \max_{ m \geq n }{ mb_m }$,注意到$\mu_n$单调下降趋近于$0$.下面开始讨论:</p>
<p>当$x \in [ 0 , \frac{ \pi }{ p } ]$的时候,此时$S_{ n , p }$中的每一项都同号.自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ k = n }^p b_k \sin ( kx ) & \leq \sum_{ k = n }^p b_k kx \\
& \leq \frac{ \pi }{ p } \sum_{ k = n }^p b_k k \\
& \leq \frac{ \pi }{ p } ( p - n ) \mu_n \\
& \leq \pi \mu_n
\end{aligned}</script><p>这就完事.</p>
<p>当$x \in [ \frac{ \pi }{ n } , \pi ]$的时候,和差化积公式给出:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = 1 }^n \sin ( kx ) | \\
= & \left | \frac{ \cos ( k - \frac{ 1 }{ 2 } ) x - \cos ( k + \frac{ 1 }{ 2 } ) }{ 2 \sin \frac{ x }{ 2 } } \right | \\
\leq & \frac{ 1 }{ | \sin \frac{ x }{ 2 } | } \\
< & n
\end{aligned}</script><p>原因是当$\frac{ x }{ 2 } \leq \frac{ \pi }{ 2 }$的时候,$\sin \frac{ x }{ 2 } \geq \frac{ 2 }{ \pi } \frac{ x }{ 2 } \geq n$.</p>
<p>回忆到Abel变换给出$| S_{ n , p } | \leq n ( 2 b_n + b_p ) &lt; 3 nb_n \to 0$.这就搞定.</p>
<p>当$x \in ( \frac{ \pi }{ p } , \frac{ \pi }{ n } )$的时候,取$m = \lfloor \frac{ \pi }{ x } \rfloor \leq \frac{ \pi }{ x }$.那我们就有:$\frac{ \pi }{ m + 1 } \leq x \leq \frac{ \pi }{ m }$.</p>
<p>当$k \in [ n , m ]$的时候,$kx \leq \pi$,那$\sin ( kx ) \leq kx$就成立,那么和上面一样:</p>
<script type="math/tex; mode=display">
| S_{ n , m } | \leq \pi \mu_n</script><p>当$k \in [ m + 1 , p ]$的时候,此时$\frac{ 1 }{ | \sin \frac{ x }{ 2 } | } \geq \frac{ 1 }{ m + 1 }$,因此:</p>
<script type="math/tex; mode=display">
| S_{ m + 1 , p } | \leq ( m + 1 ) ( 2 b_{ m + 1 } + b_p ) < 3 \mu_{ m + 1 }</script><p>则:</p>
<script type="math/tex; mode=display">
| S_{ n , p } | \leq | S_{ n , m } | + | S_{ m + 1 , p } | < \pi \mu_n + 3 \mu_{ m + 1 }</script><p>这就搞定.</p>
<h4><span id="连续性">连续性</span></h4><p>我们还可以定义<strong>等度连续</strong>的概念:我们说$f_n$等度连续,当$\forall \epsilon &gt; 0 , \exists \delta &gt; 0$,使得$\forall x , y$,若$| x - y | &lt; \delta$,则$\forall n , | f_n ( x ) - f_n ( y ) | &lt; \epsilon$.其实就是某种一致(函数列)的一致(定义域上)连续.</p>
<p>我们可以证明:如果$f_n ( x ) \in C [ a , b ]$,而且其等度连续,则如果$\lim_{ n \to \infty } f_n ( x ) = f ( x ) , x \in [ a , b ]$,则$f_n \rightrightarrows f , x \in [ a , b ]$.</p>
<p>证明与前述Example6证明一致李氏连续类似,事实上Example6是这个的一个推论.我们取定$\delta$,使得$| x - y | &lt; \delta$时一定有$\forall n , | f_n ( x ) - f_n ( y ) | &lt; \frac{ \epsilon }{ 3 }$,此时再令$n \to \infty$,就有$| f ( x ) - f ( y ) | \leq \frac{ \epsilon }{ 3 }$,再取一个分划$\Delta : a = x_0 &lt; \cdots &lt; x_m = b$并要求$\lambda ( \Delta ) &lt; \delta$.</p>
<p>自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f_n ( x ) - f ( x ) | & \leq | f_n ( x ) - f_n ( x_i ) | + | f_n ( x_i ) - f ( x_i ) | + | f ( x_i ) - f ( x ) | \\
& \leq \epsilon
\end{aligned}</script><p>原因仍是有限点集上的收敛一定是一致收敛.</p>
<p>下面要探索的就是一致连续是否保持了原函数项级数的作用.</p>
<p>先看一个引理:当$x_0 \in [ a , b ]$的时候,如若当$x \in [ a , b ] \setminus \{ x_0 \}$,$f_n ( x ) \rightrightarrows f ( x )$,已知$\lim_{ x \to x_0 } f_n ( x ) = \alpha_n$存在.则$\lim_{ n \to \infty } \alpha_n$存在而且$\lim_{ x \to x_0 } f ( x ) = \lim_{ n \to \infty } \alpha_n$.换言之,$\lim_{ x \to x_0 } \lim_{ n \to \infty } f_n ( x ) = \lim_{ n \to \infty } \lim_{ x \to x_0 } f_n ( x )$.</p>
<p>证明的话,首先要证明$\lim_{ n \to \infty } \alpha_n$存在,考虑$\forall \epsilon &gt; 0 , \exists N , \forall n , m \geq N$,有$| f_n ( x ) - f_m ( x ) | &lt; \frac{ \epsilon }{ 3 }$,取极限知道$| \alpha_n - \alpha_m | \leq \frac{ \epsilon }{ 3 }$,这说明$\{ \alpha_n \}$是柯西列,当然收敛.不妨设$\alpha = \lim_{ n \to \infty } \alpha_n$.</p>
<p>此时有:</p>
<script type="math/tex; mode=display">
| f ( x ) - \alpha | \leq | f ( x ) - f_N ( x ) | + | f_N ( x ) - \alpha_N | + | \alpha_N - \alpha |</script><p>两边一取极限使得$x \to x_0$,立刻见到$| f ( x ) - \alpha | &lt; \epsilon$.这已经能看出一致连续的强大了.正是因为一致连续可以先固定$N$,我们才可以在这里对$x \to x_0$取极限.所以这里有一个天然的可交换性.</p>
<p>这个引理的一个推论是:如果$f_n \rightrightarrows f , x \in [ a , b ]$,则对于$x_0 \in [ a , b ]$,如果$f_n ( x )$在$x_0$处连续,则$f$也在$x_0$处连续.原因是既然连续,则$\alpha_n = \lim_{ x \to x_0 } f_n ( x ) = f_n ( x_0 )$,所以$\lim_{ x \to x_0 } f ( x ) = \lim_{ n \to \infty } f_n ( x_0 ) = f ( x_0 )$.这就说明在$x_0$处连续.更有推论:如果$f_n \in C [ a , b ] , f_n \rightrightarrows f$,则$f \in C [ a , b ]$.从而还可以见到,如果一串连续函数收敛到一个不连续函数,那这肯定也不是一致收敛的.</p>
<p>那么反过来,如果连续函数列收敛到连续函数,能不能推出一致收敛呢?我们事实上有<strong>迪尼定理</strong>:如果$f_n ( x ) \in C [ a , b ]$,当$n &lt; m$的时候,$\forall x \in [ a , b ] , f_n ( x ) \leq f_m ( x )$,此时如若$f_n \rightarrow f$,而且$f \in C [ a , b ]$,则$f_n \rightrightarrows f$.也就是只要有一定的单调性,我们就可以说一致连续是连续函数列收敛到连续函数的充要条件.</p>
<p>取$R_n ( x ) = f ( x ) - f_n ( x ) \geq 0$,注意到$\lim_{ n \to \infty } R ( x ) = 0$而且$R_n ( x )$连续且逐点随$n$单调递减,则必有$R_n \to 0$.如果我们能证明$R_n ( x ) \rightrightarrows 0$,那就万事大吉.不妨设$M_n = \max_{ x \in [ a , b ] } R_n ( x ) = R_n ( x_n )$,那么只要证明$M_n \to 0$就可以搞定一致收敛.然而$M_n$本身是单调下降的.反证,如果$\lim_{ n \to \infty } M_n = c &gt; 0$,此时观察$x_n \in [ a , b ]$,既然如此,$\{ x_n \}$必定有收敛子列,任取一个收敛子列$\{ x_{ n_k } \}$并假设其收敛到$x_0$,接下来看:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \lim_{ m \to \infty } R_m ( x_0 ) \\
= & \lim_{ m \to \infty } \lim_{ x_{ n_k } \to x_0 } R_m ( x_{ n_k } ) \\
\geq & \lim_{ m \to \infty } \lim_{ n_k > m , x_{ n_k } \to x_0 } R_{ n_k } ( x_{ n_k } ) \\
= & \lim_{ x_{ n_k } \to x_0 } R_{ n_k } ( x_{ n_k } ) > 0
\end{aligned}</script><p>可这就出事了.于是矛盾,反证成立.</p>
<p>迪尼定理的一个推论是如果$f_n ( x ) \geq 0$,那么此时$S_n ( x ) = \sum_k^n f ( x )$就是逐点单调的了.因此我们可以看到此时$\sum f_n$一致收敛性也就等价于其连续性.</p>
<h6><span id="example1">Example1</span></h6><p>考虑$f_n \geq 0$,而且$\forall n , f_n$单增的时候,如若$\sum f_n ( x ) \leq M , \forall x \in [ a , b )$.求证此时$\lim_{ x \to b - 0 } \sum_{ n = 1 }^\infty f_n ( x ) = \sum_{ n = 1 }^\infty f_n ( b - 0 )$.</p>
<p>设$S_n = \sum_k^n f_k ( x )$,取定$m$,此时$\forall x \in [ a , b )$,$S ( x ) \geq S_m ( x )$.令$x \to b - 0$,自然有$\sum_{ n = 1 }^m f_n ( b - 0 ) \leq \lim_{ x \to b - 0 } S ( x )$.直接令$S ( b - 0 ) = \lim_{ x \to b - 0 } S ( x )$,这个极限存在,原因是$S ( x )$是单调的.从而取极限得到$\sum_{ n = 1 }^\infty f_n ( b - 0 ) \leq S ( b - 0 )$.</p>
<p>接下来另一个方向,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ n = 1 }^m f_n ( x ) & \leq \sum_{ n = 1 }^m f_n ( b - 0 ) \leq \sum_{ n = 1 }^\infty f_n ( b - 0 ) \\
S ( x ) & \leq \sum_{ n = 1 }^\infty f_n ( b - 0 ) \\
S ( b - 0 ) & \leq \sum_{ n = 1 }^\infty f_n ( b - 0 )
\end{aligned}</script><p>这就搞定.</p>
<h6><span id="example2">Example2</span></h6><p>$f_n$在$[ a , b ]$上可微而且$f_n ‘ \in R [ a , b ]$,若$\forall x \in [ a , b ] , \forall n , | \sum_{ k = 1 }^n f_k ‘ ( x ) | \leq M$,$\sum f_n ( x )$在$[ a , b ]$上收敛.求证其在$[ a , b ]$上一致收敛.</p>
<p>容易观察到$\sum f_n ( x )$一致李氏连续,用之前等度连续的结论就可以做掉.</p>
<h4><span id="可积性">可积性</span></h4><p>如果$f_n \in R [ a , b ] , f_n \rightrightarrows f$,则我们声明$f \in R [ a , b ]$且$\int_a^b f \mathrm{ d } x = \lim_{ n \to \infty } \int_a^b f_n \mathrm{ d } x$.</p>
<p>考虑证明,首先$f_n$是有界的,又因为一致收敛,所以能推出$f$也是有界的.</p>
<p>一个想法是使用勒贝格定理.直接取$K_n$是$f_n$的间断点集,立刻得到$K_n$是零测集.接下来令$K = \bigcup K_n$,那$K$还是零测集(可数个零测集的并),此时对于$\forall x \in [ a , b ] \setminus K$,$\forall n , f_n$都在$x$处连续,那$f$肯定也在$x$处连续,所以$f$的间断点集就一定被包含于零测集$K$,所以黎曼可积.</p>
<p>接下来的问题是是否积分相等,取$M_n = \sup_{ [ a , b ] } | f - f_n |$,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_a^b f \mathrm{ d } x - \int_a^b f_n \mathrm{ d } x | \\
\leq & \int_a^b | f - f_n | \mathrm{ d } x \\
\leq & \int_a^b M_n \mathrm{ d } x \\
= & M_n ( b - a ) \to 0
\end{aligned}</script><p>这就搞定.然而注意到这里需要依赖于$b - a$的有界性.</p>
<p>另一个策略是直接用分划达布和证明$f \in R [ a , b ]$.不妨设$| f_n | \leq M , | f | \leq M$.则$\forall \epsilon &gt; 0 , \exists n$,$| f_n ( x ) - f ( x ) | &lt; \epsilon$.由于$f_n ( x ) \in R [ a , b ]$,可以取定分划$\Delta : a = x_0 &lt; \cdots &lt; x_p = b$,使得$\sum ( M_i - m_i ) \Delta x_i &lt; \epsilon$.</p>
<p>于此,我们取$\bar{ M }_i = \sup_{ [ x_{ i - 1 } , x_i ] } f ( x ) , \bar{ m }_i$同理.观察到$\forall x \in [ x_{ i - 1 } , x_i ] , f ( x ) \leq f_n ( x ) + \epsilon \leq M_i + \epsilon$,所以一定有$\bar{ M }_i \leq M_i + \epsilon$.对于$\bar{ m }_i$同理.此时:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum ( \bar{ M }_i - \bar{ m }_i ) \Delta x_i \\
\leq & \sum ( M_i - m_i ) \Delta x_i + 2 \epsilon ( b - a ) \\
\leq & \epsilon ( 1 + 2 ( b - a ) )
\end{aligned}</script><p>这就搞定.</p>
<p>事实上这个结论可以更强,可以放弃一致收敛的条件.我们有<strong>控制收敛定理</strong>:假设$f_n \in R [ a , b ]$,而且它们一致有界,$\forall n , \forall x \in [ a , b ] , | f_n | \leq M$.并且$f ( x ) = \lim_{ n \to \infty } f_n ( x ) \in R [ a , b ]$,则$\int_a^b f ( x ) \mathrm{ d } x = \lim_{ n \to \infty } \int_a^b f_n ( x ) \mathrm{ d } x$.</p>
<p>为证明此,先引入一些相关的定义:</p>
<p>定义<strong>阶梯函数</strong>为分段常值函数,假设$f \in R [ a , b ]$,则我们可以用阶梯函数逼近$f$,具体而言,假设$g$是阶梯函数,并且$g \leq f$,那么我们可以将$g$类似达布下和而分划够细,以使得$\int_a^b f \mathrm{ d } x = \sup_{ g \leq f , \text{ g is a step function } } \{ \int_a^b g ( x ) \mathrm{ d } x \}$.</p>
<p>定义<strong>初等集</strong>:有限个不交区间的并,可以见到其测度$m ( E )$就是所有不交区间的长度之和.</p>
<p>定义<strong>闭初等集</strong>:有限个不交闭区间的并.</p>
<p>定义<strong>有界闭初等集列</strong>:$A_n$是闭初等集.容易见到,如果$A_n \ne \emptyset$,而且$A_{ n + 1 } \subseteq A_n$,则$\bigcap_{ n = 1 }^\infty A_n \ne \emptyset$,证明的话只需类似区间套定理,每个$A_n$内取一个点,这个点列是有界的,那它就一定有收敛子列,收敛到的那个点一定被含在每一个$A_n$中.这就搞定.</p>
<p>不妨设$A_n$是有界非空集列,满足$A_{ n + 1 } \subseteq A_n , A_n \ne \emptyset , \bigcap_{ n = 1 }^\infty A_n = \emptyset$.此时定义$\alpha_n = \sup \{ m ( E ) \mid E \subseteq A_n , \text{ E is a closed elementary set } \}$.我们下面证明$\lim_{ n \to \infty } \alpha_n = 0$.</p>
<p>首先显然$\alpha_n$单调递减.如若其不以$0$为极限,则一定有正下界$\alpha_n &gt; \delta &gt; 0$.我们可以取$A_n$的闭初等子集$E_n \subseteq A_n$满足$m ( E_n ) &gt; \alpha_n - \frac{ \delta }{ 2^n }$.</p>
<p>接下来定义$H_n = \bigcap_{ k = 1 }^n E_k$,这当然是初等集,此时见到$H_{ n + 1 } \subseteq H_n$.接下来对$A_n \setminus H_n$的任意初等子集$E$,显然:</p>
<script type="math/tex; mode=display">
\begin{aligned}
E & = E \setminus H_n \\
& = E \setminus ( \bigcap_{ k = 1 }^n E_k ) \\
& = \bigcup_{ k = 1 }^n ( E \setminus E_k )
\end{aligned}</script><p>而$E \subseteq A_n \subseteq A_k$,所以$E_k$和$E \setminus E_k$都是$A_k$的初等子集.所以:</p>
<script type="math/tex; mode=display">
\begin{aligned}
m ( E \setminus E_k ) + m ( E_k ) & \leq \alpha_k \\
m ( E \setminus E_k ) & \leq \frac{ \delta }{ 2^k }
\end{aligned}</script><p>所以$m ( E ) \leq \delta$.如果$H_n = \emptyset$,那么$m ( E ) = \alpha_n$,这就不符.所以$H_n \ne \emptyset$,所以$\bigcap_{ n = 1 }^\infty H_n \ne \emptyset$,所以$\bigcap A_n \ne \emptyset$.矛盾,这就证明了原本的结论.</p>
<p>接下来考虑$f ( x ) - f_n ( x )$,当没有一致连续的条件时,可能出现问题的地方在于有的地方两者不一定靠的足够近,想办法让这种地方所占的长度尽可能小就行.</p>
<p>对于$\forall \epsilon &gt; 0 , A_n = \{ x \in [ a , b ] \mid \exists j \geq n , | f_j ( x ) - f ( x ) | \geq \epsilon \}$.容易见到$A_{ n + 1 } \subseteq A_n$,由于$f_n \to f$,所以$\bigcap_{ n = 1 }^\infty A_n = \emptyset$.引理告诉我们$\alpha_n \to 0$.既然如此,存在$N$,使得$\forall n \geq N$,$A_n$的任意初等子集$E$都有$m ( E ) &lt; \epsilon$.取$F = [ a , b ] \setminus E$.这其实更像是取$[ a , b ]$的一个分划,因此如果我们在上面取阶梯函数的话,完全可以让阶梯函数所需的那个分划和这个分划并起来,从而完全由上述结果取到阶梯函数,此外我们的$A_n \setminus E$的部分由于落在$F$里而需要被$\epsilon$控制.</p>
<p>此时取阶梯函数$S ( x )$满足$0 \leq S ( x ) \leq | f ( x ) - f_n ( x ) |$.这个时候看$S ( x )$的积分:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b S ( x ) \mathrm{ d } x & = \int_E S ( x ) \mathrm{ d } x + \int_F S ( x ) \mathrm{ d } x \\
& \leq 2 M \epsilon + \epsilon ( b - a )
\end{aligned}</script><p>这个对任意$S ( x )$都成立,由于我们之前说的阶梯函数的上界可以逼近原函数,所以这就意味着:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_a^b f_n ( x ) - f ( x ) \mathrm{ d } x | \\
\leq & \int_a^b | f_n ( x ) - f ( x ) | \mathrm{ d } x \\
\leq & 2 M \epsilon + \epsilon ( b - a )
\end{aligned}</script><p>这就搞定.不过细心的读者也许会注意到一些问题,首先是这里用内测度逼近疑似有点神秘,然而如果用勒贝格测度的定义直接跑其实一眼就能看出来上面的结论.</p>
<p>还有另一个结论:假设$f_n \in R [ a , b ] , | f_n | \leq M$,已知$\lim_{ n \to \infty } f_n ( x ) = f ( x )$存在(注意这里并不要求$f ( x ) \in R [ a , b ]$),我们就可以证明$\lim_{ n \to \infty } \int_a^b f_n ( x ) \mathrm{ d } x$存在.</p>
<p>考虑$| \int_a^b f_n \mathrm{ d } x | \leq M ( b - a )$有界,所以其可以取上下极限操作.令$\overline{ F } = \varlimsup_{ n \to \infty } \int_a^b f_n \mathrm{ d } x , \underline{ F } = \varliminf_{ n \to \infty } \int_a^b f_n \mathrm{ d } x$.既然如此,就一定存在两列$\{ n_k \}$和$\{ m_k \}$,使得$\overline{ F } = \lim_{ k \to \infty } \int_a^b f_{ n_k } \mathrm{ d } x , \underline{ F } = \lim_{ k \to \infty } \int_a^b f_{ m_k } \mathrm{ d } x$.然而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\overline{ F } - \underline{ F } & = \lim_{ k \to \infty } \int_a^b ( f_{ n_k } - f_{ m_k } ) \mathrm{ d } x \\
& = \int_a^b \lim_{ k \to \infty } ( f_{ n_k } - f_{ m_k } ) \mathrm{ d } x = 0
\end{aligned}</script><p>这你就可以见到,我们其实可以把这个极限干脆定义成$f$的积分.这实际上就是勒贝格积分.</p>
<h6><span id="example1">Example1</span></h6><p>求证:$\int_0^1 \frac{ 1 }{ x^x } \mathrm{ d } x = \sum_{ n = 1 }^\infty \frac{ 1 }{ n^n }$.</p>
<p>展开:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ x^x } & = e^{ - x \ln x } \\
& = \sum_{ n \geq 0 } \frac{ ( - x \ln x )^n }{ n ! }
\end{aligned}</script><p>容易证明这个函数项级数是一致收敛的,那我们就可以逐项积分,而且积分内可以做多少次分部积分都无所谓(反正是有限逼近无限).</p>
<p>那么:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^1 \frac{ 1 }{ x^x } \mathrm{ d } x \\
= & \int_0^1 \sum_{ n \geq 0 } \frac{ ( - x \ln x )^n }{ n ! } \mathrm{ d } x \\
= & \sum_{ n \geq 0 } \int_0^1 \frac{ ( - x \ln x )^n }{ n ! } \mathrm{ d } x
\end{aligned}</script><p>令$x = e^{ - t }$,换元:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ n \geq 0 } \int_0^1 \frac{ ( - x \ln x )^n }{ n ! } \mathrm{ d } x \\
= & - \sum_{ n \geq 0 } \frac{ 1 }{ n ! } \int_0^{ + \infty } e^{ - ( n + 1 ) t } t^n \mathrm{ d } t
\end{aligned}</script><p>而考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^{ + \infty } e^{ - ( n + 1 ) t } t^n \mathrm{ d } t \\
= & \frac{ - 1 }{ n + 1 } \int_0^{ + \infty } t^n \mathrm{ d } e^{ - ( n + 1 ) t } \\
= & \frac{ - 1 }{ n + 1 } \left ( e^{ - ( n + 1 ) t } t^{ n } |_0^{ + \infty } - n \int_0^{ + \infty } e^{ - ( n + 1 ) t } t^{ n - 1 } \right ) \\
= & \frac{ n }{ n + 1 } \int_0^{ + \infty } e^{ - ( n + 1 ) t } t^{ n - 1 } \\
= & \cdots \\
= & \frac{ n ! }{ ( n + 1 )^{ n } } \int_0^{ + \infty } e^{ - ( n + 1 ) t } \mathrm{ d } t \\
= & - \frac{ n ! }{ ( n + 1 )^{ n + 1 } }
\end{aligned}</script><p>和上面结合一下就证毕.</p>
<h6><span id="example2">Example2</span></h6><p>设函数列$\{ f_n ( x ) \}$任意内闭可积,并且$\{ f_n ( x ) \}$在$\mathbb{ R }$上一致收敛到$f ( x )$,再设存在函数$g ( x )$满足:</p>
<script type="math/tex; mode=display">
| f_n ( x ) | \leq g ( x )</script><p>并且$\int_{ - \infty }^{ + \infty } g ( x ) \mathrm{ d } x &lt; + \infty$.求证下列积分收敛而且:</p>
<script type="math/tex; mode=display">
\int_{ - \infty }^{ + \infty } f ( x ) \mathrm{ d } x = \lim_{ n \to \infty } \int_{ - \infty }^{ + \infty } f_n ( x ) \mathrm{ d } x</script><p>首先要证明$\int_{ - \infty }^{ + \infty } f ( x ) \mathrm{ d } x$收敛.只需观察到$| f_n | \leq g$两遍取极限就可以拿到$| f | \leq g$,所以绝对收敛.</p>
<p>接下来考虑如何证明相等,这里的问题在于虽然$f ( x ) \rightrightarrows f$,但是由于区间长度无限长,因此这个控制会被放大.于此我们的策略是考虑将区间分成三段:$[ - \infty , - A ] , [ - A , A ] , [ A , + \infty ]$,对于中间的部分用一致收敛控制住,对于前后的部分用柯西准则控制住.</p>
<p>具体而言,$| f ( x ) - f_n ( x ) | \leq 2 g ( x )$取足够大的$A$使得$\int_{ A }^{ + \infty } g ( x ) \mathrm{ d } x \leq \frac{ \epsilon }{ 6 }$以及$\int_{ - \infty }^{ - A } g ( x ) \mathrm{ d } x \leq \frac{ \epsilon }{ 6 }$,接下来考虑取足够大的$n$使得在$[ - A , A ]$上,$| f_n ( x ) - f ( x ) | &lt; \frac{ \epsilon }{ 6 A }$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_{ - \infty }^{ + \infty } f_n ( x ) - f ( x ) \mathrm{ d } x | \\
\leq & | \int_{ - A }^{ + A } f_n ( x ) - f ( x ) \mathrm{ d } x | + | \int_{ - \infty }^{ - A } f_n ( x ) - f ( x ) \mathrm{ d } x | + | \int_{ + A }^{ + \infty } f_n ( x ) - f ( x ) \mathrm{ d } x | \\
\leq & 2 A \frac{ \epsilon }{ 6 A } + \frac{ \epsilon }{ 6 } \times 4 \\
= & \epsilon
\end{aligned}</script><p>这就搞定了.</p>
<h4><span id="可微性">可微性</span></h4><p>先看一个平凡的命题:假设$f_n \in C^1 [ a , b ] , x_0 \in [ a , b ]$,已知$\{ f_n ( x_0 ) \}$收敛,而且$f_n ‘ \rightrightarrows g$.则$f_n \rightrightarrows f$,其中$f \in C^1 [ a , b ]$,并且恰好满足$f ‘ = g$.</p>
<p>考虑$g ( x ) = \lim_{ n \to \infty } f_n ‘ ( x ) , x \in [ a , b ]$当然能得到$g ( x )$是连续函数.</p>
<p>接下来考虑NL公式给出:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_n ( x ) & = f_n ( x_0 ) + \int_{ x_0 }^x f '_n ( t ) \mathrm{ d } t \\
\lim_{ n \to \infty } f_n ( x ) & = \lim_{ n \to \infty } f_n ( x_0 ) + \lim_{ n \to \infty } \int_{ x_0 }^x f '_n ( t ) \mathrm{ d } t \\
\lim_{ n \to \infty } f_n ( x ) & = \lim_{ n \to \infty } f_n ( x_0 ) + \int_{ x_0 }^x \lim_{ n \to \infty } f '_n ( t ) \mathrm{ d } t \\
f ( x ) & = \lim_{ n \to \infty } f_n ( x_0 ) + \int_{ x_0 }^x g ( t ) \mathrm{ d } t \\

\end{aligned}</script><p>这就见到$f_n \to f , f \in C^1 [ a , b ]$而且$f ‘ = g$.现在的问题是能否推出一致收敛$f_n \rightrightarrows f$.有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | f_n ( x ) - f ( x ) | \\
= & | f_n ( x_0 ) + \int_{ x_0 }^x f_n ' ( t ) \mathrm{ d } t - f ( x_0 ) - \int_{ x_0 }^x g ( t ) | \\
\leq & | f_n ( x_0 ) - f ( x_0 ) | + | \int_{ x_0 }^x f_n ' ( t ) \mathrm{ d } t - \int_{ x_0 }^x g ( t ) | \\
\leq & | f_n ( x_0 ) - f ( x_0 ) | + ( b - a ) \sup | f_n ' - g |
\end{aligned}</script><p>这就完事.</p>
<p>上述结果能不能加强呢?事实上有一个更一般的结果:假设对于一串连续函数$f_n ( x ) \in C [ a , b ]$,已知$\exists x_0 \in [ a , b ]$,$\lim_{ n \to \infty } f_n ( x_0 )$存在.若对于$\forall \epsilon &gt; 0$,$\exists N &gt; 0 , \forall n , m \geq N$,函数$g ( x ) = f_n ( x ) - f_m ( x )$的李氏常数$&lt; \epsilon$.则我们可以推出$\{ f_n ( x ) \}$一致收敛,设$f_n ( x ) \rightrightarrows f ( x )$,若对于某个$x \in [ a , b ]$,如果$f_n ‘ ( x )$恒存在,而且$\lim_{ n \to \infty } f_n ‘ ( x )$存在,则$f ‘ ( x )$存在而且$f ‘ ( x ) = \lim_{ n \to \infty } f_n ‘ ( x )$.</p>
<p>这个结论的正确性比较直观,就是用李氏连续的性质限制整个函数的波动.这个结论当然要严格强于原本的结论,因为闭区间上的可导函数自然是李氏连续函数,如若$f_n ‘ ( x )$一致连续,当然能推出上述的李氏连续性质,立刻得到原本结论.</p>
<p>下面考虑证明:$\forall \epsilon &gt; 0 , \exists N , \forall n , m \geq N$,都有$| f_n ( x_0 ) - f_m ( x_0 ) | &lt; \frac{ \epsilon }{ 2 }$,并且$f_n ( x ) - f_m ( x )$的李氏常数$&lt; \frac{ \epsilon }{ 2 ( b - a ) }$.注意到此时:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | f_n ( x ) - f_m ( x ) | \\
\leq & | f_n ( x ) - f_m ( x ) - ( f_n ( x_0 ) - f_m ( x_0 ) ) | + | f_n ( x_0 ) - f_m ( x_0 ) | \\
< & \frac{ \epsilon }{ 2 ( b - a ) } | x - x_0 | + \frac{ \epsilon }{ 2 } \leq \epsilon
\end{aligned}</script><p>这就证明了$f_n$一致收敛,不妨设$f_n \rightrightarrows f$.</p>
<p>接下来对于某个$x \in [ a , b ]$,定义$\varphi_n ( t ) = \frac{ f_n ( t ) - f_n ( x ) }{ t - x } , t \in [ a , b ] \setminus \{ x \}$,并补定义$\varphi ( t ) = \frac{ f ( t ) - f ( x ) }{ t - x } , t \in [ a , b ] \setminus \{ x \}$.显然$\varphi_n ( t ) \in C [ a , b ] \setminus \{ x \}$</p>
<p>首先注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \varphi_n ( t ) - \varphi_m ( t ) | \\
= & \frac{ 1 }{ | t - x | } | f_n ( t ) - f_m ( t ) - ( f_n ( x ) - f_m ( x ) ) | \\
\leq & \frac{ 1 }{ | t - x | } \frac{ \epsilon }{ 2 ( b - a ) } | t - x | \\
= & \frac{ \epsilon }{ 2 ( b - a ) }
\end{aligned}</script><p>于是$\varphi_n ( t )$一致收敛,而且容易见到$\varphi_n \rightrightarrows \varphi$.从而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' ( x ) & = \lim_{ t \to x } \varphi ( t ) \\
& = \lim_{ t \to x } \lim_{ n \to \infty } \varphi_n ( t ) \\
& = \lim_{ n \to \infty } \lim_{ t \to x } \varphi_n ( t ) \\
& = \lim_{ n \to \infty } f_n ' ( x )
\end{aligned}</script><p>这就搞定了.</p>
<p>容易发现上述的推论是可导函数列的收敛性质(并不需要$C^1$).而且我们还可以推出一个推论:那就是导函数一致收敛到的函数也是导函数.</p>
<h6><span id="example1">Example1</span></h6><p>假设$\{ q_n \}$是$[ 0 , 1 ]$中的全体有理数排成的数列.定义$f ( x ) = \sum_{ n = 1 }^\infty \frac{ | x - q_n | }{ 3^n } , x \in [ 0 , 1 ]$.</p>
<p>首先用大M判别法,注意到$\frac{ | x - q_n | }{ 3^n } \leq \frac{ 1 }{ 3^n }$,而每一项都是连续的,所以总的$f ( x )$是连续函数,而且这个定义也是收敛的.而且对于$x_0 \in [ 0 , 1 ] \setminus \mathbb{ Q }$,$f_n ‘ ( x_0 )$当然都是存在的,而且见到$f_n ‘ ( x_0 ) = \sum_{ k = 1 }^n \frac{ \text{ sgn } ( x_0 - q_k ) }{ 3^k }$,并且这个导数还足够小.因此立刻见到当$n , m$足够大的时候,立刻见到$f_n - f_m$的李氏常数可以尽可能小.</p>
<p>于是套用上面的结论可以知道$f ( x )$在$[ 0 , 1 ] \setminus \mathbb{ Q }$处可导.那么其在$\mathbb{ Q } \cap [ 0 , 1 ]$上可导么?如若$x \in \mathbb{ Q }$,不妨设$x = q_n$,则考虑$f ( x ) = \frac{ | x - q_n | }{ 3^n } + \sum_{ k \ne n } \frac{ | x - q_k | }{ 3^k }$,前半部分在$q_n$处不可导可后半部分在$q_n$处可导,于是总和当然不可导.</p>
<h6><span id="example2">Example2</span></h6><p>设$f ( x ) = \sum_{ n = 1 }^\infty \frac{ \sin ( nx ) }{ n^3 }$,求其导函数.</p>
<p>观察到$\sum_{ n = 1 }^\infty | ( \frac{ \sin ( nx ) }{ n^3 } ) ‘ | \leq \sum \frac{ 1 }{ n^2 } &lt; \infty$,所以其导函数也绝对一致收敛.立刻能推出$f \in C^1 ( - \infty , + \infty )$,而且导函数就是逐项求导的$f ‘ ( x ) = \sum_{ n = 1 }^\infty \frac{ \cos ( nx ) }{ n^2 }$.</p>
<h4><span id="部分应用">部分应用</span></h4><h5><span id="borel引理">Borel引理</span></h5><p>对任何一个实数列$\{ a_n \}$,都存在一个函数$f ( x ) \in C^{ \infty } ( \mathbb{ R } )$,满足$f^{ ( n ) } ( 0 ) = a_n$.</p>
<p>考虑造一个$g ( x ) = \begin{cases}1 &amp; 0 \leq x \leq \frac{ 1 }{ 2 } \ 0 &amp; x \geq 1\end{cases}$,其中中间少了一段用磨光核连起来.考虑造一个单调递增无界正数列$\{ \lambda_n \}$,并取:</p>
<script type="math/tex; mode=display">
f ( x ) = \sum_{ n = 0 }^\infty \frac{ a_n x^n }{ n ! } g ( \lambda_n | x | )</script><p>这个的好处是什么呢?我们发现当$\lambda_n | x | \geq 1$,$| x | \geq \frac{ 1 }{ \lambda_n }$的时候$g ( \lambda_n | x | ) = 0$,又因为$\lambda_n$单调递增趋近于无穷,所以除了$0$以外的所有点上都是有限和,因此全都收敛而且全都可导,所以$f \in C^{ \infty } ( \mathbb{ R } \setminus \{ 0 \} )$.</p>
<p>考虑$f_n ( x ) = \frac{ a_n x^n }{ n ! } g ( \lambda_n | x | )$,这个当然是$C^{ \infty }$的.并且当然有$f_n^{ ( n ) } ( 0 ) = a_n$.现在如果我们能搞定这个导数级数的收敛性就搞定了$0$处的可导性了对吧.取$M_k = \max_{ 0 \leq l \leq k } | g^{ ( l ) } |$,当$k \leq n$的时候考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f_n^{ ( k ) } ( x ) | & \leq \frac{ | a_n | }{ n ! } \sum_{ m = 0 }^k \left | \binom{ k }{ m } n^{ \underline{ k - m } } x^{ n - k + m } g^{ ( m ) } ( \lambda_n | x | ) \lambda_n^m \right | \\
& \leq \frac{ | a_n | }{ n ! } \sum_{ m = 0 }^k \left | \binom{ k }{ m } n^{ \underline{ k - m } } x^{ n - k + m } M_k \lambda_n^m \right | \\

\end{aligned}</script><p>注意这里的$x$一定很小,$| x | &lt; \frac{ 1 }{ \lambda_n }$的时候上式才有意义,开始放缩:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f_n^{ ( k ) } ( x ) | & \leq \frac{ | a_n | }{ n ! } \sum_{ m = 0 }^k \left | \frac{ k ! }{ m ! ( k - m ) ! } n^{ \underline{ k - m } } M_k \frac{ 1 }{ \lambda_n^{ n - k } } \right | \\
& \leq \frac{ | a_n | }{ n ! } \sum_{ m = 0 }^k \left | \frac{ k ! }{ m ! ( k - m ) ! } n^{ \underline{ k - m } } M_k \frac{ 1 }{ \lambda_n^{ n - k } } \right | \\
& = \frac{ | a_n | }{ n ! } \sum_{ m = 0 }^k \left | \frac{ k ! }{ m ! ( k - m ) ! } \frac{ n ! }{ ( n - k + m ) ! } M_k \frac{ 1 }{ \lambda_n^{ n - k } } \right | \\
& \leq | a_n | M_k \frac{ 1 }{ \lambda_n^{ n - k } } k !
\end{aligned}</script><p>显然只需取足够小的$\lambda_n$就用大M判别法控制住了.</p>
<h5><span id="维尔斯特拉斯函数">维尔斯特拉斯函数</span></h5><p>考虑造一个处处连续处处不可导的函数,首先它应该在任何一个区间上都没有单调性(因为单调函数几乎处处可导).</p>
<p>首先造一个连续的$2$周期函数$h ( x ) = \begin{cases}x &amp; 0 \leq x \leq 1 \ 2 - x &amp; 1 \leq x \leq 2 \ h ( x - 2 ) &amp; \text{ otherwise }\end{cases}$.或者我们干脆定义$h ( x ) = \sin ( \frac{ \pi }{ 2 } 4^n x )$,这样这个函数更光滑一点,但对论证几乎没有区别.</p>
<p>考虑造$f ( x ) = \sum_{ n = 0 }^{ \infty } ( \frac{ 3 }{ 4 } )^n h ( 4^n x )$,注意到:</p>
<script type="math/tex; mode=display">
f ( x ) \leq \sum ( \frac{ 3 }{ 4 } )^n < \infty</script><p>根据大M判别法,所以这个函数的确绝对一致收敛.那这个函数就确实继承了连续性.</p>
<p>首先有引理:如果$f ‘ ( x_0 )$存在,而且$\alpha_n \leq x_0 \leq \beta_n , 0 &lt; \beta_n - \alpha_n \to 0$,则$\lim_{ n \to \infty } \frac{ f ( \beta_n ) - f ( \alpha_n ) }{ \beta_n - \alpha_n } \to f ‘ ( x_0 )$.取$\lambda_n = \frac{ \beta_n - x_0 }{ \beta_n - \alpha_n }$,容易见到$0 \leq \lambda_n \leq 1$,见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ f ( \beta_n ) - f ( \alpha_n ) }{ \beta_n - \alpha_n } - f ' ( x_0 ) \\
= & \lambda_n ( \frac{ f ( \beta_n ) - f ( x_0 ) }{ \beta_n - x_0 } - f ' ( x_0 ) ) + ( 1 - \lambda_n ) ( \frac{ \alpha_n - f ( x_0 ) }{ \alpha_n - x_0 } - f ' ( x_0 ) )
\end{aligned}</script><p>容易见到趋近于$0$.不过要简单判断一下$\alpha_n = x_0$的情况.</p>
<p>既然如此,$\forall x \in \mathbb{ R }$,考虑定义$\alpha_m = \frac{ \lfloor 4^m x \rfloor }{ 4^m } , \beta_m = \alpha_m + \frac{ 1 }{ 4^m }$,容易见到$\alpha_m \leq x &lt; \beta_m$.并且当$n \leq m$的时候，$( 4^n \alpha_m , 4^n \beta_m )$上不存在整数.</p>
<p>见到:</p>
<script type="math/tex; mode=display">
4^n ( \beta_m - \alpha_m ) = \begin{cases}
\in 4 \mathbb{ N } & n > m \\
1 & n = m \\
< 1 & \text{ otherwise }
\end{cases}</script><p>于是:</p>
<script type="math/tex; mode=display">
| h ( 4^n \beta_m ) - h ( 4^n \alpha_m ) | = \begin{cases}
0 & n > m \\
| 4^n \beta_m - 4^n \alpha_m | = 4^{ n - m } & n \leq m
\end{cases}</script><p>把$n &lt; m$的地方往负了放,自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f ( \beta_m ) - f ( \alpha_m ) | & = \sum_{ n = 0 }^m ( \frac{ 3 }{ 4 } )^n ( h ( 4^n \beta_m ) - h ( 4^n \alpha_m ) ) \\
& \geq ( \frac{ 3 }{ 4 } )^m - \sum_{ n = 0 }^{ m - 1 } ( \frac{ 3 }{ 4 } )^n 4^{ n - m } \\
& = ( \frac{ 3 }{ 4 } )^m - \frac{ 1 }{ 4^m } \frac{ 3^m - 1 }{ 2 } \\
& = \frac{ 1 }{ 4^m } \frac{ 3^m + 1 }{ 2 }
\end{aligned}</script><p>所以:</p>
<script type="math/tex; mode=display">
\frac{ | f ( \beta_m ) - f ( \alpha_m ) | }{ \beta_m - \alpha_m } \geq \frac{ 3^m + 1 }{ 2 }</script><p>然而如若这点导数存在,那么这里的导数就是$\lim_{ m \to \infty } \frac{ 3^m + 1 }{ 2 } = \infty$,这就矛盾了.因此这个函数处处不可导.</p>
<h5><span id="连续曲线充满平面">连续曲线充满平面</span></h5><p>存在充满$[ 0 , 1 ] \times [ 0 , 1 ]$的连续曲线.连续曲线在这里定义为$( x ( t ) , y ( t ) ) , t \in [ 0 , 1 ]$满足$x ( t ) , y ( t ) \in C [ 0 , 1 ]$,任意$( a , b ) \in [ 0 , 1 ] \times [ 0 , 1 ]$,都存在$t$使得$a = x ( t ) , b = y ( t )$.</p>
<p>搞一个连续函数$g ( t )$满足:</p>
<script type="math/tex; mode=display">
g ( t ) = \begin{cases}
0 & t \in [ 0 , \frac{ 1 }{ 3 } ] \cup [ \frac{ 5 }{ 3 } , 2 ] \\
3 t - 1 & t \in [ \frac{ 1 }{ 3 } , \frac{ 2 }{ 3 } ] \\
1 & t \in [ \frac{ 2 }{ 3 } , \frac{ 4 }{ 3 } ] \\
3 t + 5 & t \in [ \frac{ 4 }{ 3 } , \frac{ 5 }{ 3 } ] \\

\end{cases}</script><p>并且满足$g ( t + 2 ) = g ( t )$,也就是一个周期梯形函数.</p>
<p>接下来定义:</p>
<script type="math/tex; mode=display">
\begin{aligned}
x ( t ) & = \sum_{ n = 1 }^\infty \frac{ 1 }{ 2^n } g ( 3^{ 2 n - 2 } t ) \\
y ( t ) & = \sum_{ n = 1 }^\infty \frac{ 1 }{ 2^n } g ( 3^{ 2 n - 1 } t )
\end{aligned}</script><p>容易发现$0 \leq x ( t ) , y ( t ) \leq \sum_{ n = 1 }^\infty \frac{ 1 }{ 2^n } = 1$,所以的确绝对一致收敛,继承了连续性而且确实在$[ 0 , 1 ] \times [ 0 , 1 ]$中.</p>
<p>接下来$\forall ( a , b ) \in [ 0 , 1 ] \times [ 0 , 1 ]$,我们尝试找到一个$t$使得$a = x ( t ) , b = y ( t )$.考虑取二者的二进制表示$a = \sum_{ n = 1 }^\infty \frac{ a_n }{ 2^n } , b = \sum_{ n = 1 }^\infty \frac{ b_n }{ 2^n }$,其中$a_n , b_n \in \{ 0 , 1 \}$.取一个新的数列$c_{ 2 n - 1 } = a_n , c_{ 2 n } = b_n$.取$0 \leq c = 2 \sum_{ n = 1 }^\infty \frac{ c_n }{ 3^n } \leq 1$,下面我们证明$x ( c ) = a , x ( c ) = b$.</p>
<p>考虑$3^k c = 2 \sum_{ n = 1 }^k \frac{ c_n }{ 3^{ n - k } } + 2 \sum_{ n = k + 1 }^\infty \frac{ c_n }{ 3^{ n - k } }$.其中前半部分是个偶整数,因此在带入函数$g$后会消失,观察后半部分,容易见到:如果$c_{ k + 1 } = 0$,则后半部分$\leq \frac{ 1 }{ 3 }$;如果$c_{ k + 1 } = 1$,则后半部分$\geq \frac{ 2 }{ 3 }$,因此$g ( 3^k c ) = c_{ k + 1 }$.带入原式定义就看到$x ( c ) = a , y ( c ) = b$.</p>
<p>甚至说,这里的$c$其实就在康托尔三分集中,所以事实上这个曲线上的零测集就足以覆盖整个平面.</p>
<h4><span id="幂级数">幂级数</span></h4><p>我们把形如$f ( x ) = \sum_{ n = 0 }^{ \infty } a_n ( x - x_0 )^n$的函数项级数称作<strong>幂级数</strong>,由于可以做自变量平移,不妨假设$x_0 = 0$而$f ( x ) = \sum_{ n = 0 }^{ \infty } a_n x^n$.</p>
<p>一个最先遇到的问题当然是幂级数的收敛范围,首先$x = 0$肯定收敛.其次我们可以发现如果$f ( r )$收敛,那么$\forall x \in \mathbb{ R } , | x | &lt; | r |$都有$f ( x )$收敛,原因是:</p>
<script type="math/tex; mode=display">
\sum | a_n x^n | = \sum | a_n r^n | \cdot | \frac{ x }{ r } |^n</script><p>由于$\sum a_n r^n$收敛,所以其通项$\lim_{ n \to \infty } a_n r^n = 0$,那至少是有界的,而$| \frac{ x }{ r } |^n$又是个无穷递降等比数列,那就肯定收敛.既然如此,取$R = \sup \{ | x | , x \in \mathbb{ R } | f ( x ) \text{ is converge } \}$.由上面的结论我们知道$\forall x \in ( - R , R )$都有$f ( x )$收敛,另外$\forall x , | x | &gt; R$都有$f ( x )$发散.既然如此,我们将$( - R , R )$称作幂级数的<strong>收敛区间</strong>,容易见到收敛域和收敛区间最多只可能差两个点,换言之设收敛域为$E$,则自然有$( - R , R ) \subseteq E \subseteq [ - R , R ]$.</p>
<p>取$\rho = \varlimsup_{ n \to + \infty } \sqrt[n]{ | a_n | }$,则$R = \rho^{ - 1 }$(这里要做一些约定:不妨设$\inf^{ - 1 } = 0$和$0^{ - 1 } = \inf$).原因是$\varlimsup_{ n \to + \infty } \sqrt[n]{ | a_n x^n | } = | x | \rho$,用根值判别法就显然了.</p>
<p>这里还有一个更弱的比值判别法的版本:如若$a_n \ne 0$,$\rho = \lim_{ n \to \infty } \left | \frac{ a_{ n + 1 } }{ a_n } \right |$存在,则$R = \rho^{ - 1 }$.原因是Stolz定理给出:</p>
<script type="math/tex; mode=display">
\varliminf \frac{ | a_{ n + 1 } | }{ | a_n | } \leq \varliminf \sqrt[n]{ | a_n | } \leq \varlimsup \sqrt[n]{ | a_n | } \leq \varlimsup \frac{ | a_{ n + 1 } | }{ | a_n | }</script><p>下面我们证明,在收敛区间的内部$( - R , R )$内,$\sum a_n x^n$是内闭绝对一致收敛的.而如果其在端点处也收敛,例如在$x = R$时收敛的话,则其在$[ 0 , R ]$上一致收敛.</p>
<p>前者的话,只需用大M判别法即可,任取$[ - r , r ] \subseteq ( - R , R )$然后看$| a_n x^n | \leq | a_n r^n |$.</p>
<p>而对于后者的话,考虑$\sum a_n x^n = \sum a_n R^n ( \frac{ x }{ R } )^n$,而$( \frac{ x }{ R } )^n$是单调一致有界,而$\sum a_n R^n$收敛,用DA判法则搞定.</p>
<p>上述结论的一个显然推论是幂级数是收敛域上的连续函数(因为在收敛域上都是一致连续的).</p>
<h6><span id="example1">Example1</span></h6><p>假设$R = 1$,既然有一致连续性,若$\sum a_n$收敛,则极限存在有$\lim_{ x \to 1 - 0 } f ( x ) = f ( 1 ) = \sum a_n$.然而这个结论反过来不成立,例如$f ( x ) = \sum ( - x )^n = \frac{ 1 }{ 1 + x }$,容易见到极限为$\frac{ 1 }{ 2 }$可是$f ( 1 )$并不收敛.</p>
<p>上述结论能不能加点条件使得反之成立呢?我们下面证明若$a_n = o ( \frac{ 1 }{ n } )$,若$\lim_{ x \to 1 - 0 } f ( x ) = S$存在,则$\sum a_n = S$.</p>
<p>考虑取$\sigma_n = \frac{ 1 }{ n } \sum_{ k = 0 }^n k | a_k |$,由Stolz定理知道$\lim \sigma_n = \lim n | a_n | = 0$.取$S_n = \sum_{ k = 1 }^n a_k$,我们要证明的就是当$n \to \inf$的时候$| S - S_n |$尽可能小.当$x \in ( - 1 , 1 )$的时候,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n - S & = f ( x ) - S - \sum_{ k = n + 1 }^\infty a_k x^k + \sum_{ k = 0 }^n a_k ( 1 - x^k ) \\
& = f ( x ) - S - \sum_{ k = n + 1 }^\infty a_k x^k + \sum_{ k = 0 }^n a_k ( 1 - x ) ( 1 + x + \cdots + x^{ k - 1 } ) \\
& \leq f ( x ) - S - \sum_{ k = n + 1 }^\infty a_k x^k + ( 1 - x ) \sum_{ k = 0 }^n ka_k \\

\end{aligned}</script><p>$\forall \epsilon &gt; 0$,取足够大的$n$使得$\sigma_n &lt; \frac{ \epsilon }{ 3 }$而且使得$| na_n | &lt; \frac{ \epsilon }{ 3 }$总成立,那么:</p>
<script type="math/tex; mode=display">
| S_n - S | \leq | f ( x ) - S | + ( 1 - x ) n \sigma_n + \frac{ \epsilon }{ 3 n } \frac{ x^{ n + 1 } }{ 1 - x }</script><p>取$x = 1 - \frac{ 1 }{ n }$,即可得证.</p>
<p>如果加点单调性也可以.设$a_n &gt; 0$,如果$f ( x ) = \sum_n a_n x^n$满足$f ( 1 - )$存在,则$\sum a_n = f ( 1 - )$.</p>
<p>这个结论与之前的一致收敛那里的单调性质完全相似.首先由$\sum_n a_n \leq f ( 1 - )$得到这个级数收敛,然后又可以放到$\sum a_n x^n \leq \sum_n a_n$,让左边趋近一下得到$f ( 1 - ) \leq \sum_n a_n$.</p>
<h5><span id="柯西和">柯西和</span></h5><p>设$\sum a_n = A , \sum b_n = B$,设$c_n = \sum_{ k = 0 }^n a_{ n - k } b_k$,我们下面证明若$\sum c_n$收敛,则$\sum c_n = AB$.</p>
<p>考虑设$f ( x ) = \sum a_n x^n , g ( x ) = \sum b_n x^n$,则其收敛半径肯定$\geq 1$,既然如此在任何内闭区间$[ - r , r ] \subseteq ( - 1 , 1 )$,$f , g$都在$[ - r , r ]$上绝对一致收敛,既然如此我们就可以把这个乘积随便打乱顺序,得到$f ( x ) g ( x ) = \sum c_n x^n , \forall x \in [ - r , r ]$.而我们又有$\sum c_n$收敛,既然如此$\sum c_n = h ( 1 ) = \lim_{ x \to 1 - 0 } h ( x ) = ( \lim_{ x \to 1 - 0 } f ( x ) ) ( \lim_{ x \to 1 - 0 } g ( x ) ) = AB$,则搞定.</p>
<p>其中$\sum c_n$收敛这个条件是必须的,如果去掉后结论不成立,有如下反例:</p>
<p>设$a_n = b_n$考虑对$( 1 + x )^{ - \frac{ 1 }{ 2 } }$做泰勒展开,得到$f ( x ) = g ( x ) = \sum a_n x^n = \frac{ 1 }{ \sqrt{ 1 + x } }$此时$f ( 1 ) , g ( 1 )$都收敛,原因是$a_n = ( - 1 )^n \frac{ ( 2 n - 1 ) ! ! }{ 2^n n ! }$,用DA判法知道其收敛.然而$f ( x ) g ( x ) = \frac{ 1 }{ 1 + x }$,$c_n = ( - 1 )^n$,因此$\sum c_n$不收敛,这就完蛋了.</p>
<h5><span id="逐项微积分">逐项微积分</span></h5><p>既然幂级数在收敛域上一致收敛,那当然可以逐项积分.而且注意到$\varlimsup \sqrt[n + 1]{ \frac{ | a_n | }{ n + 1 } } = \varlimsup \sqrt[n]{ | a_n | }$,原因是$\lim \sqrt[n]{ n } = 1$,因此收敛半径不变,然而积分后,端点处有可能被包含入收敛域,原因是DA判法,原本的$a_n x^n$之和如果有界,配了一个多的下降$\frac{ 1 }{ n }$就会收敛,例如$\sum \frac{ x^n }{ n }$.</p>
<p>同理,对于逐项求导也可以发现收敛半径不变.所以幂级数可以在收敛域上逐项积分任意多次,也可以在收敛区间内逐项求导任意多次.</p>
<h6><span id="example1">Example1</span></h6><p>求$\sum_{ n = 0 }^\infty \frac{ ( - 1 )^n }{ 3 n + 1 }$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & = \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n }{ 3 n + 1 } x^{ 3 n + 1 } \\
& = \sum_{ n = 0 }^\infty \int_0^x ( - 1 )^n t^{ 3 n } \mathrm{ d } t \\

\end{aligned}</script><p>我们想让这里的求和和积分交换顺序对吧!那首先得规定$x \in ( - 1 , 1 )$而取不到$1$,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & = \sum_{ n = 0 }^\infty \int_0^x ( - 1 )^n t^{ 3 n } \mathrm{ d } t \\
& = \int_0^x \sum_{ n = 0 }^\infty ( - t )^{ 3 n } \mathrm{ d } t \\
& = \int_0^x \frac{ \mathrm{ d } t }{ 1 + t^3 }
\end{aligned}</script><p>后面那个可以积出来,而且$f ( x )$在$( - 1 , 1 )$上取值就是如此.而发现$f ( x )$在$1$处收敛,因此拿这个积出来的结果极限逼近一下就行.</p>
<h5><span id="泰勒级数">泰勒级数</span></h5><p>对于一个$f \in C^\infty$,考虑泰勒展开有:</p>
<script type="math/tex; mode=display">
f ( x ) = \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( x_0 ) }{ k ! } ( x - x_0 )^k + r_n ( x )</script><p>其中依照拉格朗日余项,$r_n ( x ) = \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - x_0 )^{ n + 1 }$,若存在$\delta &gt; 0$,当$x \in ( x_0 - \delta , x_0 + \delta )$的时候,$\lim_{ n \to \infty } r_n = 0$,则称该函数在$x_0$处解析,也就是可以用泰勒级数逼近它.</p>
<p>我们有一个命题:如果$f ( x )$在$x_0$处解析,则其在$x_0$附近的一个小邻域上解析(证明可以参考Example15).因此解析的概念以拓宽到区间上,如果其在一个开区间$I$上解析,则称其$\in C^\omega ( I )$.</p>
<p>而且我们还可以见到,如果$f^{ ( n ) } ( x )$一致有界(或者至少与$n$无关),则由于$( x - x_0 )^n$会被$\frac{ 1 }{ ( n + 1 ) ! }$控制住,所以其在$\mathbb{ R }$上都是解析的.所以$\sin x , \cos x$都是解析的,另外$e^x , \ln x$的导数大小与$n$无关,所以也解析.</p>
<p>当$f , g$在$x_0$处解析的时候,应当有$f \pm g , fg , \frac{ f }{ g }$都是解析的.而且如果$f$在$g ( x_0 )$处解析,则$f ( g ( x ) )$也在$x_0$处解析.这个太难算了,我们承认这个事实好了,反正就是硬算.</p>
<h6><span id="example1广义二项式定理">Example1(广义二项式定理)</span></h6><p>求$f ( x ) = ( 1 + x )^\alpha$在$0$处的解析性.</p>
<p>也就是要证明$f ( x ) = ( 1 + x )^\alpha = \sum_{ n = 0 }^\infty \frac{ \alpha^{ \underline{ n } } }{ n ! } x^n$.</p>
<p>用比值法,观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \frac{ \binom{ \alpha }{ n } }{ \binom{ \alpha }{ n + 1 } } | \\
= & | \frac{ n + 1 }{ \alpha - n } | \to 1
\end{aligned}</script><p>所以右端收敛半径为$1$.既然如此先搞定右端那个幂级数,设$g ( x ) = \sum_{ n = 0 }^\infty \binom{ \alpha }{ n } x^n , x \in ( - 1 , 1 )$.观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ' ( x ) & = \sum_{ n = 1 }^\infty n \binom{ \alpha }{ n } x^{ n - 1 } \\
( 1 + x ) g ' ( x ) & = \sum_{ n = 1 }^\infty n \binom{ \alpha }{ n } x^{ n - 1 } + \sum_{ n = 1 }^\infty n \binom{ \alpha }{ n } x^{ n } \\
& = \alpha + \sum_{ n = 1 }^\infty \left ( n \binom{ \alpha }{ n } + ( n + 1 ) \binom{ \alpha }{ n + 1 } \right ) x^n \\
& = \alpha + \alpha \sum_{ n = 1 }^\infty \binom{ \alpha }{ n } x^n \\
& = \alpha g
\end{aligned}</script><p>此时见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \left ( \frac{ g }{ ( 1 + x )^\alpha } \right ) ' \\
= & - \alpha ( 1 + x )^{ - \alpha - 1 } g + ( 1 + x )^{ - \alpha } g ' \\
= & ( 1 + x )^{ - \alpha - 1 } ( - \alpha g + ( 1 + x ) g ' ) \equiv 0
\end{aligned}</script><p>所以$\frac{ g }{ ( 1 + x )^\alpha }$是一常数,演算$x = 0$的部分就可以知道当$x \in ( - 1 , 1 )$的时候它俩相等.</p>
<p>最后再补一下端点,</p>
<p>当$\alpha &gt; 0 , x = \pm 1$的时候,下面直接证明它绝对收敛,也就是证明$\sum | \binom{ \alpha }{ n } | &lt; \inf$.,考虑拉贝判法:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& n \left ( \frac{ | \binom{ \alpha }{ n } | }{ | \binom{ \alpha }{ n + 1 } | } - 1 \right ) \\
= & n ( \frac{ n + 1 }{ n - \alpha } - 1 ) \to 1 + \alpha > 0
\end{aligned}</script><p>所以此时收敛域是$[ - 1 , 1 ]$.</p>
<p>当$- 1 &lt; \alpha &lt; 0$的时候,估一下发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| \binom{ \alpha }{ n } | & = | ( 1 - \frac{ \alpha + 1 }{ 1 } ) \cdots ( 1 - \frac{ \alpha + 1 }{ n } ) | \\
& = e^{ \sum_k \ln | 1 - \frac{ 1 + \alpha }{ k } | } \\
& \approx e^{ - \sum_k \frac{ 1 + \alpha }{ k } } \\
& \approx \frac{ 1 }{ n^{ 1 + \alpha } }
\end{aligned}</script><p>而且此时$\binom{ \alpha }{ n }$本身是个交错级数,所以在$- 1$处不收敛而在$1$处收敛.同理当$\alpha \leq - 1$的时候,$| \binom{ \alpha }{ n } |$并不趋向于$0$所以两端都不收敛.</p>
<h6><span id="example2反三角函数">Example2(反三角函数)</span></h6><p>考虑由Example1,当$| x | &lt; 1$的时候:</p>
<script type="math/tex; mode=display">
( 1 - x^2 )^{ - \frac{ 1 }{ 2 } } = 1 + \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! } x^{ 2 n }</script><p>两遍逐项积分,有:</p>
<script type="math/tex; mode=display">
\arcsin x = x + \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! } \frac{ x^{ 2 n + 1 } }{ 2 n + 1 }</script><p>继续用拉贝判别法,注意到:</p>
<script type="math/tex; mode=display">
n \left ( \frac{ a_n }{ a_{ n + 1 } } - 1 \right ) \to \frac{ 3 }{ 2 }</script><p>所以收敛.而且还可以发现这一下积分使得端点处也搞定了,所以上式对$[ - 1 , 1 ]$都成立.</p>
<h6><span id="example3平方倒数和">Example3(平方倒数和)</span></h6><p>还可再整点活,令$x = \sin t$带入上式,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
t & = \sin t + \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! } \frac{ \sin^{ 2 n + 1 } t }{ 2 n + 1 } \\

\end{aligned}</script><p>两遍在$[ 0 , \frac{ \pi }{ 2 } ]$上积分,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ \pi^2 }{ 8 } & = 1 + \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! ( 2 n + 1 ) } \frac{ ( 2 n ) ! ! }{ ( 2 n + 1 ) ! ! } \\
& = 1 + \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n + 1 )^2 } \\
& = \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n - 1 )^2 }
\end{aligned}</script><p>所以奇数的平方和是$\frac{ \pi^2 }{ 8 }$,那么:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } & = \frac{ \pi^2 }{ 8 } + \frac{ 1 }{ 4 } \sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } \\
\sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } & = \frac{ \pi^2 }{ 6 }
\end{aligned}</script><h6><span id="example4">Example4</span></h6><p>当$c &gt; 0$的时候,求证存在多项式列$\{ P_n ( x ) \} \rightrightarrows | x | , x \in [ - c , c ]$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| x | & = ( x^2 )^{ \frac{ 1 }{ 2 } } \\
& = ( c^2 - ( c^2 - x^2 ) )^{ \frac{ 1 }{ 2 } } \\
& = c ( 1 - \left ( 1 - \frac{ x^2 }{ c^2 } \right ) )^{ \frac{ 1 }{ 2 } }
\end{aligned}</script><p>由于$1 - \frac{ x^2 }{ c^2 } \in [ 0 , 1 ] , \frac{ 1 }{ 2 } &gt; 0$,只需要对此用广义二项式定理即可.</p>
<h6><span id="example5">Example5</span></h6><p>求$\int_0^\pi \frac{ \ln ( 1 + a \cos x ) }{ \cos x } \mathrm{ d } x$.</p>
<p>对着上面那个$\ln$做泰勒级数,自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^\pi \frac{ \ln ( 1 + a \cos x ) }{ \cos x } \mathrm{ d } x \\
= & \int_0^\pi a + \sum_{ n = 1 }^\infty ( - 1 )^n \frac{ a^{ n + 1 } \cos^n x }{ n + 1 } \\

\end{aligned}</script><p>而回忆到$\int_0^\pi \cos^m x \mathrm{ d } x$在$m$是奇数的时候当然为$0$,偶数的时候转化为$\sin x$,答案是$\frac{ ( m - 1 ) ! ! }{ m ! ! } \pi$.</p>
<p>所以原式变成:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^\pi a + \sum_{ n = 1 }^\infty ( - 1 )^n \frac{ a^{ n + 1 } \cos^n x }{ n + 1 } \\
= & \pi ( a + \sum_{ m = 1 }^\infty \frac{ ( 2 m - 1 ) ! ! }{ ( 2 m ) ! ! } \frac{ a^{ 2 m + 1 } }{ 2 m + 1 } ) \\
= & \pi \arcsin a
\end{aligned}</script><h6><span id="example6">Example6</span></h6><p>求$S = \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n ( n + 1 )^3 }{ n ! }$.</p>
<p>见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n ( n + 1 )^3 }{ n ! } e^{ ( n + 1 ) x } \\
= & \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n }{ n ! } ( e^{ ( n + 1 ) x } ) ' ' ' \\

\end{aligned}</script><p>取$f ( x ) = \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n }{ n ! } e^{ ( n + 1 ) x }$,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & = \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n }{ n ! } e^{ ( n + 1 ) x } \\
& = e^x \sum_{ n = 0 }^\infty \frac{ ( - e^x )^n }{ n ! } \\
& = e^{ x - e^x }
\end{aligned}</script><p>则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ' & = ( 1 - e^x ) f \\
f ' ' & = ( 1 - 3 e^x + e^{ 2 x } ) f \\
f ' ' ' & = ( - 3 e^x + 2 e^{ 2 x } ) f + ( 1 - e^x ) ( 1 - 3 e^x + e^{ 2 x } ) f \\
f ' ' ' ( 0 ) & = - f ( 0 ) = - \frac{ 1 }{ e }
\end{aligned}</script><p>这就搞定.</p>
<h6><span id="example7">Example7</span></h6><p>求$\sum_{ n = 1 }^\infty \frac{ \cos ( nx ) }{ n }$.</p>
<p>取$t \in ( - 1 , 1 ]$,设:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( t ) & = \sum_{ n = 1 }^\infty \frac{ \cos ( nx ) }{ n } t^n \\
f ' & = \sum_{ n = 1 }^\infty \cos ( nx ) t^{ n - 1 } \\
& = \Re \sum_{ n = 1 }^\infty t^{ n - 1 } e^{ inx } \\
& = \Re \frac{ e^{ ix } }{ 1 - te^{ ix } } \\
& = \Re \frac{ \cos x + i \sin x }{ 1 - t \cos x - it \sin x } \\
& = \Re \frac{ ( \cos x + i \sin x ) ( 1 - t \cos x + it \sin x ) }{ ( 1 - t \cos x )^2 + t^2 \sin^2 x } \\
& = \frac{ \cos x ( 1 - t \cos x ) - t \sin^2 x }{ ( 1 - t \cos x )^2 + t^2 \sin^2 x } \\
& = \frac{ \cos x - t }{ 1 - 2 t \cos x + t^2 } \\

\end{aligned}</script><p>此时应当有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( t ) & = f ( 0 ) + \int_0^t f ' ( t ) \mathrm{ d } t \\
& = - \frac{ 1 }{ 2 } \ln ( 1 - 2 t \cos x + t^2 )
\end{aligned}</script><p>而$f ( 1 ) = - \ln 2 - \ln | \sin \frac{ x }{ 2 } |$,这就求出了原式.</p>
<h6><span id="example8">Example8</span></h6><p>考虑$\zeta ( x ) = \sum_{ n = 1 }^\infty \frac{ 1 }{ n^x }$,有定理说:</p>
<script type="math/tex; mode=display">
\zeta ( x ) = \frac{ 1 }{ x - 1 } + \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n \gamma_n }{ n ! } ( x - 1 )^n</script><p>其中后半部分是整个复平面上的解析函数,并有:</p>
<script type="math/tex; mode=display">
\gamma_n = \lim_{ m \to \infty } \left ( \sum_{ k = 1 }^m \frac{ ( \ln k )^n }{ k } - \frac{ ( \ln m )^{ n + 1 } }{ n + 1 } \right )</script><h6><span id="example9">Example9</span></h6><p>求$S ( x ) = 1 + \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! } x^n$,其中$| x | &lt; 1$.</p>
<p>容易见到其收敛半径是$1$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S ' ( x ) & = \frac{ 1 }{ 2 } + \sum_{ n = 1 }^\infty \frac{ ( 2 n + 1 ) ! ! }{ ( 2 n + 2 ) ! ! } ( n + 1 ) x^n \\
2 S ' ( x ) & = 1 + \sum_{ n = 1 }^\infty \frac{ ( 2 n + 1 ) ! ! }{ ( 2 n ) ! ! } x^{ n } \\
2 xS ' ( x ) & = \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n - 2 ) ! ! } x^n \\
2 xS ' ( x ) & = \sum_{ n = 1 }^\infty \frac{ ( 2 n - 1 ) ! ! }{ ( 2 n ) ! ! } 2 nx^n \\
2 S ' ( x ) - 2 xS ' ( x ) & = S ( x ) \\
\frac{ \mathrm{ d } x }{ 2 ( 1 - x ) } & = \frac{ \mathrm{ d } S ( x ) }{ S ( x ) } \\
- \frac{ 1 }{ 2 } \ln ( 1 - x ) & = \ln S ( x ) \\
S ( x ) & = \frac{ 1 }{ \sqrt{ 1 - x } }
\end{aligned}</script><h6><span id="example10">Example10</span></h6><p>当$| x | &lt; 1$,求$S ( x ) = \sum_{ n = 0 }^\infty \frac{ ( - 1 )^n x^n }{ 2 n + 1 }$.</p>
<p>容易见到收敛半径为$1$,令$x = t^2$,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S ( t^2 ) = \sum_{ n = 0 }^\infty ( - 1 )^n \frac{ 1 }{ t } \int_0^t u^{ 2 n } \mathrm{ d } u \\
= \frac{ 1 }{ t } \int_0^t \sum_{ n = 0 }^\infty ( - 1 )^n u^{ 2 n } \mathrm{ d } u \\
= \frac{ 1 }{ t } \int_0^t \frac{ \mathrm{ d } u }{ 1 + u^2 } \\
= \frac{ \arctan t }{ t } \\

\end{aligned}</script><p>所以$S ( x ) = \frac{ \arctan \sqrt{ x } }{ \sqrt{ x } }$.</p>
<h6><span id="example11">Example11</span></h6><p>求$\sum_{ n = 2 }^\infty \frac{ ( - 1 )^n }{ n^2 + n - 2 }$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S ( x ) = \sum_{ n = 2 }^\infty \frac{ ( - 1 )^n x^{ n - 1 } }{ n^2 + n - 2 } \\
= \sum_{ n = 2 }^\infty \frac{ ( - 1 )^n x^{ n - 1 } }{ 3 } \left ( \frac{ 1 }{ n - 1 } - \frac{ 1 }{ n + 2 } \right ) \\
= \frac{ 1 }{ 3 } \sum_{ n = 2 }^\infty \frac{ ( - 1 )^n x^{ n - 1 } }{ n - 1 } - \frac{ 1 }{ 3 x^3 } \sum_{ n = 2 }^\infty \frac{ ( - 1 )^n x^{ n + 2 } }{ n + 2 } \\
= \frac{ 1 }{ 3 } \ln ( 1 + x ) - \frac{ 1 }{ 3 x^3 } \left ( - \ln ( 1 + x ) + x - \frac{ x^2 }{ 2 } + \frac{ x^3 }{ 3 } \right )
\end{aligned}</script><p>而注意到带入$x = 1$的时候$S ( x )$收敛,这就搞定了,带入$x = 1$就行.</p>
<h6><span id="example12">Example12</span></h6><p>求$\sum_{ n = 1 }^\infty \frac{ n }{ ( n + 1 ) ! }$.</p>
<p>设$S ( x ) = \sum_{ n = 0 }^\infty \frac{ ( n + 1 ) x^n }{ ( n + 2 ) ! }$,显然收敛,直接逐项积分.</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^x S ( t ) \mathrm{ d } t & = \sum_{ n = 0 }^\infty \frac{ x^{ n + 1 } }{ ( n + 2 ) ! } \\
& = \sum_{ n = 1 }^\infty \frac{ x^{ n } }{ ( n + 1 ) ! } \\
x ( \int_0^x S ( t ) \mathrm{ d } t + 1 ) & = e^x - 1 \\
S ( x ) & = \left ( \frac{ e^x - 1 }{ x } \right ) ' = \frac{ xe^x - e^x + 1 }{ x^2 }
\end{aligned}</script><p>这就搞定了.</p>
<h6><span id="example13">Example13</span></h6><p>求$\int_0^\infty \frac{ x \mathrm{ d } x }{ e^{ 2 \pi x } - 1 }$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^\infty \frac{ x \mathrm{ d } x }{ e^{ 2 \pi x } - 1 } \\
= \int_0^\infty \frac{ xe^{ - 2 \pi x } \mathrm{ d } x }{ 1 - e^{ - 2 \pi x } } \\
= \int_0^{ \infty } xe^{ - 2 \pi x } \sum_{ n = 0 }^\infty e^{ - 2 \pi n x } \mathrm{ d } x \\
= \sum_{ n = 0 }^\infty \int_0^{ + \infty } xe^{ - 2 \pi ( n + 1 ) x } \mathrm{ d } x \\
= \sum_{ n = 0 }^\infty \frac{ 1 }{ - 2 \pi ( n + 1 ) } \int_0^{ + \infty } x \mathrm{ d } e^{ - 2 \pi ( n + 1 ) x } \\
= \sum_{ n = 0 }^\infty \frac{ 1 }{ 2 \pi ( n + 1 ) } \int_0^{ + \infty } e^{ - 2 \pi ( n + 1 ) x } \mathrm{ d } x \\
= \sum_{ n = 0 }^\infty \frac{ 1 }{ 4 \pi^2 ( n + 1 )^2 } \\
= \frac{ 1 }{ 24 }
\end{aligned}</script><p>其中中间的交换积分号和求和号是源于所有的部分和都可以小于等于$g ( x )$,并且$\int_0^{ \infty } g$收敛.</p>
<h6><span id="example14">Example14</span></h6><p>求$\int_0^1 \frac{ \ln ( 1 + x ) }{ x } \mathrm{ d } x$.</p>
<p>直接展开对吧,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_0^1 \frac{ \ln ( 1 + x ) }{ x } \mathrm{ d } x \\
= & \int_0^1 \sum_{ n = 1 }^\infty \frac{ ( - 1 )^{ n - 1 } x^{ n - 1 } }{ n } \\
= & \sum_{ n = 1 }^\infty \int_0^1 \frac{ ( - 1 )^{ n - 1 } x^{ n - 1 } }{ n } \mathrm{ d } x \\
= & \sum_{ n = 1 }^\infty \frac{ ( - 1 )^{ n - 1 } }{ n^2 } \\
= & \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n - 1 )^2 } - \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^2 } \\
= & \sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } - 2 \sum_{ n = 1 }^\infty \frac{ 1 }{ ( 2 n )^2 } \\
= & \frac{ 1 }{ 2 } \sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } \\
= & \frac{ \pi^2 }{ 12 }
\end{aligned}</script><h6><span id="example15">Example15</span></h6><p>设$I$是开区间,$f \in C^\infty ( I )$,求证$f \in C^\omega ( I )$当且仅当$\forall x_0 \in I , \exists M , B , r &gt; 0$,使得$\forall | x - x_0 | &lt; r , | f^{ ( n ) } ( x ) | \leq MB^n n !$.就是说对于区间内任何一个点,在它的小邻域处,任意阶导数都可以被和$n$有关的一个速率控制住.</p>
<p>充分性比较简单,考虑取$S ( x ) = \sum \frac{ f^{ ( n ) } ( x_0 ) }{ n ! } ( x - x_0 )^n$对其取$| \sqrt[n]{ \frac{ f^{ ( n ) } ( x_0 ) }{ n ! } } | \leq \sqrt[n]{ MB^n } = \sqrt[n]{ M } B &lt; + \infty$,所以总之收敛半径不为$0$.那就总能取一个足够小的$r &lt; \frac{ 1 }{ B }$.此时用泰勒展开的拉格朗日余项:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\left | f ( x ) - \sum_{ k = 0 }^n \frac{ f^{ ( k ) } ( x_0 ) }{ k ! } ( x - x_0 )^k \right | & = \left | \frac{ f^{ ( n + 1 ) } ( \xi ) }{ ( n + 1 ) ! } ( x - x_0 )^{ n + 1 } \right | \\
& \leq | B^{ n + 1 } ( x - x_0 )^{ n + 1 } M | \\
& \leq | ( Br )^{ n + 1 } M | \to 0
\end{aligned}</script><p>这就搞定.</p>
<p>接下来是必要性.考虑$\varlimsup_{ n \to \infty } \sqrt[n]{ | \frac{ f^{ ( n ) } ( x_0 ) | }{ n ! } } = \frac{ 1 }{ R } &gt; 0$,那就可以取$0 &lt; r &lt; M &lt; R$,存在一个$N$,使得$\forall n \geq N$都有$| f^{ ( n ) } ( x_0 ) | \leq n ! ( \frac{ 1 }{ M } )^n$.</p>
<p>接下来想要把这个性质挪到$x_0$周围小邻域上对吧.于此我们考虑先逼近后逐项求导:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f^{ ( n ) } ( x ) | & = | \sum_{ k = 0 }^\infty \frac{ f^{ ( n + k ) } ( x_0 ) }{ k ! } ( x - x_0 )^k | \\
& \leq \sum_{ k = 0 }^\infty \frac{ | f^{ ( n + k ) } ( x_0 ) | }{ k ! } | x - x_0 |^k \\
& \leq \sum_{ k = 0 }^\infty \frac{ ( n + k ) ! }{ k ! M^{ n + k } } r^k \\
& = \frac{ n ! }{ M^n } \sum_{ k = 0 }^\infty \frac{ ( n + k )^{ \underline{ k } } }{ k ! } ( \frac{ r }{ M } )^k \\
& = \frac{ n ! }{ M^n } \sum_{ k = 0 }^\infty \frac{ ( - n - 1 )^{ \underline{ k } } }{ k ! } ( \frac{ - r }{ M } )^k \\
& = \frac{ n ! }{ M^n } ( 1 - \frac{ r }{ M } )^{ - n - 1 } \\
& = Mn ! ( M - r )^{ - ( n + 1 ) }
\end{aligned}</script><p>这就搞定了.</p>
<h6><span id="example16">Example16</span></h6><p>若非常数$f$在$( a , b )$的每一点都解析,则其零点集在$( a , b )$内无聚点.</p>
<p>考虑如果一个点$c \in ( a , b )$是$f$的聚点的话,那么$c$一定是$f$的任意阶导数的聚点.由于任意阶导数都是连续的,因此$c$处的任意阶导数都是$0$.又因为$f$解析,所以$c$周围的一个小邻域必然全部为$0$.既如此取最长的小邻域为$( \alpha , \beta )$,下面我们证明$( \alpha , \beta ) = ( a , b )$,不妨假设$a \ne \alpha$,由于连续性得知$f$在$[ \alpha , \beta )$上取值为$0$,然而这意味着$\alpha$必然也是零点集的聚点,因此它还可以继续往左延申一个小邻域,这就与$a$是最靠左的矛盾了.</p>
<p>不过这个做法不能推广到复平面上,原因是平面上的介值定理难搞一点啊.</p>
<p>提供另一种证明方法,考虑$f$在$( a , b )$上的零点的聚点$x_0$,如果$x_0$的任意阶导数都是$0$的话,那还是按照上面一样往外面扩就行了对吧.反之,设$f ( x_0 ) = f^{ ( 1 ) } ( x_0 ) = \cdots = f^{ ( N - 1 ) } ( x_0 ) = 0 , f^{ ( N ) } ( x_0 ) \ne 0$,此时考虑$f ( x ) = ( x - x_0 )^{ N + 1 } \sum_{ n = 0 }^\infty \frac{ f^{ ( N + n + 1 ) } }{ ( N + n + 1 ) ! } ( x - x_0 )^n$,不妨设$g ( x ) = \sum_{ n = 0 }^\infty \frac{ f^{ ( N + n + 1 ) } }{ ( N + n + 1 ) ! } ( x - x_0 )^n$,容易发现$g ( x_0 ) \ne 0$,既然如此,$g$肯定在$x_0$的一个小邻域(要与解析的那个邻域取交)上非$0$,设为$( x_0 - \delta , x_0 + \delta )$上非零,可这样$f ( x )$在$( x_0 - \delta , x_0 ) \cup ( x_0 , x_0 + \delta )$上必然非零,这与$x_0$是零点聚点矛盾了.</p>
<h5><span id="多项式逼近">多项式逼近</span></h5><p>如果对于函数$f ( x ) : [ a , b ] \to \mathbb{ R }$,存在一个多项式列可以一致收敛到$f ( x )$,则称其可以被多项式<strong>一致逼近</strong>.容易见到一个必要条件是$f ( x ) \in C [ a , b ]$.</p>
<p>事实上我们有<strong>维尔斯特拉斯定理</strong>:有界闭区间上的连续函数可由多项式一致连续逼近.首先不妨假设$[ a , b ] = [ 0 , 1 ]$.下面给出两种证明:</p>
<p>其一是构造性证明,我们有<strong>Bernstein多项式</strong>:</p>
<script type="math/tex; mode=display">
B_n ( f ) = \sum_{ p = 0 }^n \binom{ n }{ p } f ( \frac{ p }{ n } ) x^p ( 1 - x )^{ n - p }</script><p>这个多项式有很多性质,首先随便放缩一下就知道这个多项式在$[ 0 , 1 ]$上有界,更具体地有$\min f \leq B_n \leq \max f$,原因是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
B_n ( f ) & \leq \sum_p \binom{ n }{ p } f ( \frac{ p }{ n } ) x^p ( 1 - x )^{ n - p } \\
& \leq ( \max f ) \sum_p \binom{ n }{ p } x^p ( 1 - x )^{ n - p } \\
& = \max f
\end{aligned}</script><p>另一边同理.</p>
<p>其次有$\deg ( B_n ) \leq n$.以及这个甚至是$f$的线性映射,或言$B_n ( \alpha f + \beta g ) = \alpha B_n ( f ) + \beta B_n ( g )$.</p>
<p>取$r_p ( x ) = \binom{ n }{ p } x^p ( 1 - x )^{ n - p }$,注意到:</p>
<ol>
<li><p>$\sum_p r_p ( x ) = 1$.</p>
</li>
<li><p>$\sum_p pr_p ( x ) = nx$.</p>
</li>
<li><p>$\sum_p p ( p - 1 ) r_p ( x ) = n ( n - 1 ) x^2$.</p>
</li>
<li><p>$\sum_p p^2 r_p ( x ) = n ( n - 1 ) x^2 + nx$.</p>
</li>
<li><p>$\sum_{ p = 0 }^n ( p - nx )^2 r_p ( x ) \leq \frac{ n }{ 4 }$.</p>
</li>
</ol>
<p>前四条类似,以(3)为例,证明的话考虑对$( x + y )^n = \sum_p \binom{ n }{ p } x^p y^{ n - p }$两边对$x$求两次导数:</p>
<script type="math/tex; mode=display">
n ( n - 1 ) x^2 ( x + y )^{ n - 2 } = \sum_p^n \binom{ n }{ p } p ( p - 1 ) x^p y^{ n - p }</script><p>带入$y = 1 - x$即可.</p>
<p>(5)的话也只需要计算,观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ p = 0 }^n ( p - nx )^2 r_p ( x ) \\
= & \sum_p p^2 r_p - 2 nx \sum_p pr_p + n^2 x^2 \sum r_p \\
= & n ( n - 1 ) x^2 + nx - 2 n^2 x^2 + n^2 x^2 \\
= & nx ( 1 - x ) \leq \frac{ n }{ 4 }
\end{aligned}</script><p>我们见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| B_n ( f ) - f | & = \left | \sum_{ p = 0 }^n \binom{ n }{ p } f ( \frac{ p }{ n } ) x^p ( 1 - x )^{ n - p } - \sum_{ p = 0 }^n \binom{ n }{ p } f ( x ) x^p ( 1 - x )^{ n - p } \right | \\
& \leq \sum_{ p = 0 }^n \binom{ n }{ p } | f ( \frac{ p }{ n } ) - f ( x ) | x^p ( 1 - x )^{ n - p } \\

\end{aligned}</script><p>既然$f ( x )$闭区间上连续则有一致连续,$\forall \epsilon &gt; 0$,取$\delta &gt; 0$,使得只要$| x - x ‘ | &lt; \delta , | f ( x ) - f ( x ‘ ) | &lt; \frac{ \epsilon }{ 2 }$,那有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| B_n ( f ) - f | & \leq \sum_{ p = 0 }^n \binom{ n }{ p } | f ( \frac{ p }{ n } ) - f ( x ) | x^p ( 1 - x )^{ n - p } \\
& = \sum_{ | \frac{ p }{ n } - x | < \delta }^n \binom{ n }{ p } | f ( \frac{ p }{ n } ) - f ( x ) | x^p ( 1 - x )^{ n - p } + \sum_{ | \frac{ p }{ n } - x | \geq \delta }^n \binom{ n }{ p } | f ( \frac{ p }{ n } ) - f ( x ) | x^p ( 1 - x )^{ n - p } \\
& \leq \frac{ \epsilon }{ 2 } + \frac{ 2 \max | f | }{ n^2 \delta^2 } \sum_{ p = 0 }^n ( p - nx )^2 r_p ( x ) \\
& \leq \frac{ \epsilon }{ 2 } + \frac{ \max | f | }{ 2 n \delta^2 }
\end{aligned}</script><p>倒数第二步是由于当$| \frac{ p }{ n } - x | \geq \delta$,所以$\frac{ ( p - nx )^2 }{ n^2 \delta^2 } \geq 1$.</p>
<p>最后一步是因为当$\epsilon$确定的时候,$\delta$就已经确定了,然而$n$可以足够大,这就控制住了.</p>
<p>再给另一个存在性证明.回忆到$[ a , b ]$上的连续函数组成的集合$C [ a , b ]$是一个完备线性空间.称$A \subseteq C [ a , b ]$是一个<strong>代数</strong>当且仅当$\forall f , g \in A$,$\forall c \in \mathbb{ R }$,$f + g , fg , cf \in A$.容易见到如果$P$是一个有限项多项式,$f \in A$,则$P ( f ) \in A$.</p>
<p>在此基础上定义$\bar{ A }$为$A$的<strong>闭包</strong>,定义为:</p>
<script type="math/tex; mode=display">
\bar{ A } = \{ f \in C [ a , b ] | \exists \{ f_n \} \in A , f_n \rightrightarrows f \}</script><p>容易见到$A \subseteq \bar{ A }$.而且容易见到$\bar{ A }$肯定也是一个代数.而见到$\overline{ ( \bar{ A } ) } = \bar{ A }$,原因是柯西列导出的已经是闭的了,无法再往外拓展.</p>
<p>回忆到绝对值函数可以由多项式函数逼近,所以如果$f \in \bar{ A }$,则$| f | \in \bar{ A }$.更进一步,如果$f , g \in \bar{ A }$,由于$\max ( f , g ) = \frac{ f + g }{ 2 } + \frac{ | f - g | }{ 2 }$,所以$\max ( f , g ) \in \bar{ A }$,同理$\min ( f , g ) \in \bar{ A }$.</p>
<p>我们有一个定理说:设$A \subseteq C [ a , b ]$是一个代数,并且$f ( x ) = c \in A$.并且$\forall x , y \in [ a , b ] , x \ne y , \exists f \in A , f ( x ) \ne f ( y )$则$\bar{ A } = C [ a , b ]$.容易见到这个定理强于维尔斯特拉斯定理.这个定理叫<strong>Stone-Weierstrass定理</strong>.</p>
<p>下面我们来证明这个结论.</p>
<p>先搞一个引理:$\forall x_1 , x_2 \in [ a , b ] , x_1 \ne x_2 , \forall \alpha , \beta \in \mathbb{ R }$,则$\exists h \in A , h ( x_1 ) = \alpha , h ( x_2 ) = \beta$.</p>
<p>证明的话,考虑由已知$\exists \varphi \in A , \varphi ( x_1 ) \ne \varphi ( x_2 )$.此时把这个函数给挪一下,取$h ( x ) = \alpha + ( \beta - \alpha ) \frac{ \varphi ( x ) - \varphi ( x_1 ) }{ \varphi ( x_2 ) - \varphi ( x_1 ) }$.(其实这个应该是双传递性,但是我目前没看出如何用双传递性来解释证明过程.)</p>
<p>接下来考虑证明原定理,来证明$\forall f \in C [ a , b ] , \forall n , \exists g_n \in \bar{ A } , | f ( x ) - g_n ( x ) | &lt; \frac{ 1 }{ n }$,由于我们刚才的引理,$\forall x , y \in [ a , b ] , \exists h_{ x , y } ( z ) \in A , h_{ x , y } ( x ) = f ( x ) , h_{ x , y } ( y ) = f ( y )$.这个函数由$x , y$所确定.</p>
<p>固定$x$不动,对$\forall y \in [ a , b ]$,$\exists \delta = \delta ( y )$,由于一致连续性,当$z \in I_y = ( y - \delta , y + \delta )$的时候,$h_{ x , y } ( z ) &lt; f ( z ) + \frac{ 1 }{ n }$.而这里的$I_y$构成了一个开覆盖(边界上可能需要挪一下,但反正能做到),用有限覆盖定理拿到有限个区间$I_{ y_1 , } , \cdots , I_{ y_m }$覆盖了$[ a , b ]$.此时取$h_x ( z ) = \min \{ h_{ x , y_1 } , \cdots , h_{ x , y_m } \}$,见到$h_x ( z ) &lt; f ( z ) + \frac{ 1 }{ n } , \forall z \in [ a , b ]$.而且$h_x ( x ) = f ( x )$.</p>
<p>既然$h_x ( x ) = f ( x )$,考虑$\exists \delta , I_x = ( x - \delta , x + \delta )$使得$h_x ( z ) &gt; f ( z ) - \frac{ 1 }{ n } , \forall z \in I_x$.对此再做有限覆盖得到$h_{ x_1 } , \cdots , h_{ x_l }$,取$g_n = \max \{ h_{ x_1 } , \cdots , h_{ x_l } \}$.显然:</p>
<script type="math/tex; mode=display">
f ( z ) - \frac{ 1 }{ n } < g_n ( z ) < f ( z ) + \frac{ 1 }{ n }</script><p>搞定了.</p>
<p>那么,这个多项式能不能再来点限制呢?比如说我不许在多项式里出现$x^2$项可以吗?也可以.考虑$f \in C [ a , b ]$,则$f ( x^{ \frac{ 1 }{ 3 } } ) \in C [ a^{ \frac{ 1 }{ 3 } } , b^{ \frac{ 1 }{ 3 } } ]$,所以存在一个多项式$P ( x ) \rightrightarrows f ( x^{ \frac{ 1 }{ 3 } } )$,意味着$P ( x^3 ) \rightrightarrows f ( x ) , x \in [ a , b ]$.而$P ( x^3 )$当然没有$x^2$项.</p>
<p>也就是说这些多项式很多都是浪费的.那么有没有一个非常厉害的结论能告诉我什么样的多项式可以呢?考虑在$[ 0 , 1 ]$上,$\mathrm{ Span } \{ 1 , x^{ \lambda_1 } , \cdots \}$张成的多项式,其中$0 &lt; \lambda_1 &lt; \lambda_2 &lt; \cdots$,其中$\lambda_n \to \infty$.注意这里不要求$\lambda_i$是整数,如果其闭包能张成$C [ 0 , 1 ]$,当且仅当$\sum \frac{ 1 }{ \lambda_i } = + \infty$.这被称为<strong>Muntz定理</strong>,(其一个更强的推广是去掉$\lambda_n \to \infty$的结论,取而代之的是需要满足$\sum \frac{ \lambda_i }{ 1 + \lambda_i^2 } = + \infty$)</p>
<p>这个定理的必要性我们目前难以证明,先证明其充分性.</p>
<p>考虑$\forall m \in \mathbb{ N }_+ \setminus \{ \lambda_i \}$,都可以定义一个函数列,其中$Q_0 ( x ) = x^m , Q_n ( x ) = ( \lambda_n - m ) x^{ \lambda_n } \int_x^1 Q_{ n - 1 } ( t ) t^{ - 1 - \lambda_n } \mathrm{ d } t$.我们先证明$Q_n$一定长成$x^m - \sum_{ i = 1 }^n a_{ n , i } x^{ \lambda_i }$的形式.</p>
<p>数学归纳证明此结论,设$Q_n = x^m - \sum_{ i = 1 }^n a_{ n , i } x^{ \lambda_i }$,来看$Q_{ n + 1 }$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
Q_{ n + 1 } ( x ) & = ( \lambda_{ n + 1 } - m ) x^{ \lambda_{ n + 1 } } \int_x^1 Q_{ n } ( t ) t^{ - 1 - \lambda_{ n + 1 } } \mathrm{ d } t \\
& = ( \lambda_{ n + 1 } - m ) x^{ \lambda_{ n + 1 } } \int_x^1 ( t^m - \sum_{ i = 1 }^n a_{ n , i } t^{ \lambda_i } ) t^{ - 1 - \lambda_{ n + 1 } } \mathrm{ d } t \\

\end{aligned}</script><p>后面那部分直接积出来就是了,然后前面有一个$\lambda_{ n + 1 }$,这样就搞定了.</p>
<p>下面定义一个函数的模长$\Vert Q \Vert = \max_{ [ 0 , 1 ] } | Q ( x ) |$,此时:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| Q_n ( x ) | & \leq | \lambda_n - m | x^{ \lambda_n } \Vert Q_{ n - 1 } \Vert \int_x^1 t^{ - 1 - \lambda_n } \mathrm{ d } t \\
& = | \lambda_n - m | x^{ \lambda_n } \cdot \Vert Q_{ n - 1 } \Vert \frac{ x^{ - \lambda_n } - 1 }{ \lambda_n } \\
& = | 1 - \frac{ m }{ \lambda_n } | \cdot \Vert Q_{ n - 1 } \Vert ( 1 - x^{ \lambda_n } ) \\
& \leq | 1 - \frac{ m }{ \lambda_n } | \cdot \Vert Q_{ n - 1 } \Vert \\
& \leq \prod_{ i = 1 }^n | 1 - \frac{ m }{ \lambda_i } |
\end{aligned}</script><p>然而回忆到$\sum \frac{ 1 }{ \lambda_i }$发散.所以后面那个连乘积必然发散,但是容易见到$m$取死后,其从$\lambda_i &gt; m$的时候就是单调递减的,那又发散必然知道其趋近于$0$.所以$\lim \Vert Q_n \Vert = 0$.那又回忆到$Q_n = x^m - \sum_{ i = 1 }^n a_{ n , i } x^{ \lambda_i }$,这已经说明$x^m$可以被$\{ x^{ \lambda_i } \}$一致逼近,原命题充分性搞定.</p>
<p>现在来看固定在$\lambda_i \in \mathbb{ N }_+$的情形,能否给出一个充要条件呢?我们下面证明对于互异的$\{ \lambda_i \} \in \mathbb{ N }_+$,$C [ a , b ] = \overline{ \mathrm{ span } } \{ x^{ \lambda_i } , 1 \}$的充要条件是:</p>
<ol>
<li><p>如果$0 \notin ( a , b )$,当$\sum \frac{ 1 }{ \lambda_i } = + \infty$.</p>
</li>
<li><p>如果$a &lt; 0 &lt; b$,要求$\sum_{ \lambda_i \in \mathrm{ even } } \frac{ 1 }{ \lambda_i } = + \infty , \sum_{ \lambda_i \in \mathrm{ odd } } \frac{ 1 }{ \lambda_i } = + \infty$.</p>
</li>
</ol>
<p>先证这个命题的充分性,对于$0 \notin ( a , b )$,不妨设$0 \leq a &lt; b = 1$,容易发现此时的确满足$\lim \lambda_n = + \infty$而且$\sum_i \frac{ 1 }{ \lambda_i } = + \infty$,这就搞定了.</p>
<p>对于$a &lt; 0 &lt; b$,我们只要证明在$C [ - 1 , 1 ]$上的函数都可以被一致逼近即可对吧.考虑$g_1 ( x ) = \frac{ f ( x ) + f ( - x ) }{ 2 }$是其偶函数部分,自然可以被偶次的部分逼近(原因是只需要逼近$[ 0 , 1 ]$上就可以延拓).反之亦然同理,$g_2 ( x ) = \frac{ f ( x ) - f ( - x ) }{ 2 }$也可以被奇数次的部分逼近并且延拓,这也就搞定.</p>
<p>回忆到如果一个函数如果在一个无穷区间上可以被有限次多项式一致逼近,用柯西准则做那个函数列就可以证明这个函数一定是一个多项式.下面我们来推广这个结论.</p>
<p>设$V$是一个内积空间,其中$g , f_1 , \cdots , f_n \in V$是其中的$n$个向量,设$E = \mathrm{ Span } \{ f_1 , \cdots , f_n \}$,回忆到$g$到$E$的距离定义为:</p>
<script type="math/tex; mode=display">
d = \min_{ p \in E } \Vert g - p \Vert = \sqrt{ \cfrac{ G ( g , f_1 , \cdots , f_n ) }{ G ( f_1 , \cdots , f_n ) } }</script><p>其中$G ( f_1 , \cdots , f_n ) = \det | ( f_i | f_j ) |$.</p>
<p>而考虑取两列数列$\{ \alpha_i \} , \{ \beta_j \}$,回忆到李文威考试题给出过:</p>
<script type="math/tex; mode=display">
\det ( \frac{ 1 }{ \alpha_i + \beta_j } ) = \cfrac{ \prod_{ 1 \leq i < j \leq n } ( \alpha_j - \alpha_i ) ( \beta_j - \beta_i ) }{ \prod_{ 1 \leq i , j \leq n } ( \alpha_i + \beta_j ) }</script><p>又回忆到$C [ 0 , 1 ]$也是一个内积空间,可以定义$( f | g ) = \int_0^1 fg \mathrm{ d } x$.容易见到$( x^a | x^b ) = \frac{ 1 }{ a + b + 1 }$.现在我们就可以用上面的行列式硬算了.考虑取$E = \mathrm{ span } \{ x^{ \lambda_1 } , \cdots , x^{ \lambda_n } \}$,取$d = ( x^{ \lambda } , E )$,容易见到:</p>
<script type="math/tex; mode=display">
d ( x^\lambda , E ) = \frac{ 1 }{ \sqrt{ 2 \lambda + 1 } } \prod_{ i = 1 }^n \left | \frac{ \lambda - \lambda_i }{ \lambda + \lambda_i + 1 } \right |</script><p>下面我们引进一个引理:</p>
<p>对于数列$\{ \lambda_i \} &gt; 0$且单增,如果$c = \inf_{ i \geq 1 } \{ \lambda_{ i + 1 } - \lambda_i \} &gt; 0$,如果$\sum_{ i = 1 }^\infty \frac{ 1 }{ \lambda_i } &lt; \infty$,则$\lim_{ m \to \infty } \frac{ 1 }{ \lambda_m } \sum_{ i = 1 , i \ne m }^\infty \ln \left | \frac{ \lambda_i + \lambda_m }{ \lambda_i - \lambda_m } \right | = 0$.</p>
<p>这个定理的详细证明较为麻烦,而且与主线无关,将在下述Example3处讲解.</p>
<p>考虑取$P ( x ) \in \mathrm{ Span }_{ i \ne m } \{ x^{ \lambda_i } \}$,由于子空间只有有限项非零,所以$\exists n$使得$P ( x ) \in E = \mathrm{ Span }_{ i \ne m , i \leq n } \{ x^{ \lambda_i } \}$,此时观察到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& d ( x^{ \lambda_m } , P ( x ) ) \\
\geq & d ( x^\lambda_m , E ) \\
= & \frac{ 1 }{ \sqrt{ 2 \lambda_m + 1 } } \prod_{ i = 1 , i \ne m }^n \left | \frac{ \lambda_m - \lambda_i }{ \lambda_m + \lambda_i + 1 } \right | \\
\geq & \frac{ 1 }{ \sqrt{ 2 \lambda_m + 1 } } \prod_{ i = 1 , i \ne m }^{ \infty } \left | \frac{ \lambda_m - \lambda_i }{ \lambda_m + \lambda_i + 1 } \right | \\

\end{aligned}</script><p>由上述引理,我们知道最后那一项取$\ln$后是一个$o ( \lambda_m )$的东西,不妨将后面那一项记作$e^{ - l_m \lambda_m }$,其中$l_m &gt; 0 , \lim_{ m \to \infty } l_m = 0$.</p>
<p>为了简化说明引进$\lambda_0 = 0$,</p>
<p>再来一个引理:对$\forall \epsilon &gt; 0$,$\exists C_\epsilon &gt; 0$,满足$\forall P ( x ) \in \mathrm{ Span }_{ i \geq 0 } \{ x^{ \lambda_i } \} , \lambda_0 = 0$,不妨设$P ( x ) = \sum_{ i = 0 }^n a_i x^{ \lambda_i }$,我们有$| a_m | \leq C_\epsilon ( 1 + \epsilon )^{ \lambda_m } \Vert P \Vert$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ P ( x ) }{ a_m } & = x^{ \lambda_i } + \sum_{ i \leq n , i \ne m }^n \frac{ a_i }{ a_m } x^{ \lambda_m } \\
\frac{ \Vert P ( x ) \Vert }{ | a_m | } & \geq d ( x^{ \lambda_m } , E ) \geq e^{ - l_m \lambda_m } \\
| a_m | & \leq e^{ l_m \lambda_m } \Vert P ( x ) \Vert
\end{aligned}</script><p>而当$m$充分大的时候,当然有$e^{ l_m } \leq 1 + \epsilon$,这就证毕了.</p>
<p>万事俱备,下面我们来证明必要性:办法是使用反证法,假设$f \in C [ 0 , 1 ]$,当$\lambda_0 = 0 , \sum_{ i = 1 }^\infty \frac{ 1 }{ \lambda_i } &lt; \infty$时,并且$P_n ( x ) = \sum_{ i = 0 }^n a_{ i , n } x^{ \lambda_i } \rightrightarrows f ( x )$.则当然也有$\Vert P_n \Vert \to \Vert f \Vert$,那$\Vert P_n \Vert$就有界了,既然如此,$a_{ i , n } \leq C_\epsilon ( 1 + \epsilon )^{ \lambda_i }$,也就是说所有的$a_{ i , n }$都是有界的.</p>
<p>我们想要求出一个子列$\{ n_k \}$,使得$\forall i , \lim_{ k \to \infty } a_{ i , n_k }$收敛于某个数$a_i$,方法是对角线法则,对于第一行其肯定存在收敛子列,取其第一个数为$n_1$,对于第二行,在第一行对应下来的元素中肯定也有收敛子列,取其第一个元素作为$n_2$,依次类推.这样我们就得到了一个新的函数列$P_{ n_k } \to g ( x ) = \sum_{ i = 0 }^\infty a_i x^{ \lambda_i }$.此时考虑$\varlimsup \sqrt[\lambda_i]{ | a_i | } \leq 1 + \epsilon$,因此$g ( x )$收敛半径$\geq 1$.然而,$P_{ n_k } \to f ( x )$,因此$f ( x ) = g ( x )$.然而$g ( x )$的收敛半径$\geq 1$,因此一般的函数当然不能被一致逼近.</p>
<p>另一个问题是如果$a &lt; 0 &lt; b$该怎么办,接下来假设$\sum_{ \lambda_i \in \mathrm{ even } } \frac{ 1 }{ \lambda_i } &lt; \infty$.放缩一下边界,我们下面来证明此时不能逼近$C [ - 1 , 1 ]$上的偶函数.</p>
<p>假设$f \in C [ - 1 , 1 ]$并且是偶函数,对于一列函数列,可以拆成偶函数$g_n$和奇函数$h_n$部分,前者只包含偶数次后者只包含奇数次.此时有$g_n + h_n \rightrightarrows f$,由于是偶函数,换号得到$g_n - h_n \rightrightarrows f$,这就必然得到$g_n \rightrightarrows f$,但$g_n$并不能逼近所有的,这就矛盾了.</p>
<h6><span id="example1">Example1</span></h6><p>若$f ( x )$在无穷区间上可以用多项式一致逼近,求证$f$为多项式.</p>
<p>考虑多项式列$\{ P_n \}$上有柯西准则,所以当$N$足够大的时候,$\forall n , m \geq N$,$\sup | P_n - P_m |$足够小,然而由于无穷区间,如果$\deg ( P_n - P_m ) &gt; 0$就完蛋了,所以从某一项开始,这个多项式列的两两之间一定之差一个常数.不妨干脆设$P_n = P + c_n$的形式,既然$P_n$收敛,那么$c_n$肯定收敛,设其收敛于$c$,则$f ( x ) = P + c$.</p>
<h6><span id="example2">Example2</span></h6><p>若$f \in C [ a , b ]$,$\{ p_n \} \rightrightarrows f$,并且$\{ p_n \}$为次数一致有界的多项式列,求证$f$为多项式.</p>
<p>设次数上界为$n$,一个想法是说我这些多项式是有限多个的,你直接拿切比雪夫多项式作为基,既然现在都是有限和的情况了,那在线性空间上收敛当然是在每一个基对应的系数都收敛,这就意味着$f$肯定是多项式.</p>
<h6><span id="example3lemma">Example3(Lemma)</span></h6><p>对于数列$\{ \lambda_i \} &gt; 0$且单增,如果$c = \inf_{ i \geq 1 } \{ \lambda_{ i + 1 } - \lambda_i \} &gt; 0$,如果$\sum_{ i = 1 }^\infty \frac{ 1 }{ \lambda_i } &lt; \infty$,则$\lim_{ m \to \infty } \frac{ 1 }{ \lambda_m } \sum_{ i = 1 , i \ne m }^\infty \ln \left | \frac{ \lambda_i + \lambda_m }{ \lambda_i - \lambda_m } \right | = 0$.</p>
<p>考虑证明,由于每一项都是正的,因此我们分别证明后面的无穷和部分在$[ 1 , m - 1 ]$和$[ m + 1 , + \infty )$上均为$0$.</p>
<p>思路呼之欲出,将$\lambda_i$按照与$\lambda_m$的比例分为两段:任意取定常数$\epsilon &gt; 0$,下面开始分析.</p>
<p>设当$i \geq N_1$的时候有$\lambda_i \geq ( 1 - \epsilon ) \lambda_m$成立,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ N_1 - 1 } \ln ( 1 + \frac{ 2 \lambda_i }{ \lambda_m - \lambda_i } ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ N_1 - 1 } \frac{ 2 \lambda_i }{ \lambda_m - \lambda_i } \\
= & \sum_{ i = 1 }^{ N_1 - 1 } \frac{ 2 \lambda_i }{ ( \lambda_m - \lambda_i ) \lambda_m } \\
= & 2 \sum_{ i = 1 }^{ N_1 - 1 } ( \frac{ 1 }{ \lambda_m - \lambda_i } - \frac{ 1 }{ \lambda_m } ) \\
\leq & 2 \sum_{ i = 1 }^{ N_1 - 1 } \frac{ 1 }{ \epsilon \lambda_m } - \frac{ 1 }{ \lambda_m } \\
= & \frac{ N_1 - 1 }{ \lambda_m } ( \frac{ 2 }{ \epsilon } - 1 ) \\
\leq & \frac{ m }{ \lambda_m } ( \frac{ 2 }{ \epsilon } - 1 )
\end{aligned}</script><p>然而注意到$\{ \frac{ 1 }{ \lambda_m } \}$单调递减,用柯西准则得到:</p>
<script type="math/tex; mode=display">
\sum_{ k = m + 1 }^{ 3 m } \frac{ 1 }{ \lambda_k } \geq \frac{ m }{ \lambda_{ 2 m } }</script><p>所以得到$\lim_{ m \to + \infty } \frac{ m }{ \lambda_m } \to 0$.</p>
<p>然后考虑设$i &gt; N_2$时有$( 1 + \epsilon ) \lambda_m \leq \lambda_i$,设$( 1 + \epsilon ) = \frac{ 1 }{ 1 - \epsilon_2 }$,则$\lambda_m \leq ( 1 - \epsilon_2 ) \lambda_i$留神到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \lambda_m } \sum_{ i = N_2 + 1 }^{ + \infty } \ln ( 1 + \frac{ 2 \lambda_m }{ \lambda_i - \lambda_m } ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = N_2 + 1 }^{ + \infty } \frac{ 2 \lambda_m }{ \lambda_i - \lambda_m } \\
= & \sum_{ i = N_2 + 1 }^{ + \infty } \frac{ 2 }{ \lambda_i - \lambda_m } \\
\leq & \sum_{ i = N_2 + 1 }^{ + \infty } \frac{ 4 }{ \epsilon_2 \lambda_i } \\
\leq & \sum_{ i = m }^{ + \infty } \frac{ 4 }{ \epsilon_2 \lambda_i } \\

\end{aligned}</script><p>由柯西准则就可以知道其趋近于$0$.</p>
<p>由上面的分析见到如果预先取定$\epsilon$,再移动$m$,开头结尾两端都可以尽可能小对吧.最后我们要做的就是中间很靠近$\lambda_m$的两段了,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \lambda_m } \sum_{ i = N_1 }^{ m - 1 } \ln ( \frac{ 2 \lambda_m }{ \lambda_m - \lambda_i } - 1 ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = N_1 }^{ m - 1 } \ln ( \frac{ 2 \lambda_m }{ c ( m - i ) } - 1 ) \\

\end{aligned}</script><p>不妨设$M = m - N_1$,上式变为:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \lambda_m } \sum_{ i = N_1 }^{ m - 1 } \ln ( \frac{ 2 \lambda_m }{ c ( m - i ) } - 1 ) \\
= & \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ N } \ln ( \frac{ 2 \lambda_m }{ ic } - 1 ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ N } \ln ( \frac{ 2 \lambda_m }{ ic } ) \\

\end{aligned}</script><p>而</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \lambda_m } \sum_{ i = m + 1 }^{ N_2 } \ln ( 1 + \frac{ 2 \lambda_m }{ \lambda_i - \lambda_m } ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = m + 1 }^{ N_2 } \ln ( 1 + \frac{ 2 \lambda_m }{ c ( i - m ) } ) \\
\leq & \frac{ 1 }{ \lambda_m } \sum_{ i = m + 1 }^{ N_2 } \ln ( \frac{ 2 \lambda_m + cm }{ c ( i - m ) } )
\end{aligned}</script><p>然而$\frac{ m }{ \lambda_m } \to 0$,于是后面的主要项仍是$\ln ( \frac{ \lambda_m }{ ic } )$形状,而考虑$\max ( N_2 - m , m - N_1 ) \leq \frac{ \epsilon \lambda_m }{ c }$,接下来只要证明:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln ( \frac{ \lambda_m }{ ic } ) \to 0</script><p>就做完了对吧,发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln ( \frac{ \lambda_m }{ ic } ) & = \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln ( \lambda_m ) - \frac{ 1 }{ \lambda_m } \sum_{ i = 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln ( ic ) \\
& = \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) - \frac{ 1 }{ \lambda_m } \sum_{ i = 2 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln ( i ) \\
& = \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) - \frac{ 1 }{ \lambda_m } \sum_{ i = 2 }^{ \lfloor \frac{ \epsilon \lambda_m }{ c } \rfloor } \int_{ i - 1 }^{ i } \ln ( i ) \mathrm{ d t } \\
& \leq \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) - \frac{ 1 }{ \lambda_m } \int_{ 1 }^{ \frac{ \epsilon \lambda_m }{ c } - 1 } \ln t \mathrm{ d t } \\
& = \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) - \frac{ 1 }{ \lambda_m } \int_{ 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln t \mathrm{ d t } + \frac{ 1 }{ \lambda_m } \int_{ \frac{ \epsilon \lambda_m }{ c } - 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln t \mathrm{ d } t \\
& \leq \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) - \frac{ 1 }{ \lambda_m } \int_{ 1 }^{ \frac{ \epsilon \lambda_m }{ c } } \ln t \mathrm{ d t } + \frac{ \ln ( \frac{ \epsilon \lambda_m }{ c } ) }{ \lambda_m } \\
& = \frac{ \epsilon }{ c } \ln ( \frac{ \lambda_m }{ c } ) + \frac{ \ln ( \frac{ \epsilon \lambda_m }{ c } ) }{ \lambda_m } - \frac{ 1 }{ \lambda_m } ( \frac{ \epsilon \lambda_m }{ c } \ln ( \frac{ \epsilon \lambda_m }{ c } ) - 1 ) \\
& = \frac{ \epsilon }{ c } \ln \epsilon + \frac{ 1 + \ln ( \frac{ \epsilon \lambda_m }{ c } ) }{ \lambda_m }
\end{aligned}</script><p>由于$\epsilon$在$m$之前决定,因此$\lambda_m \to \infty$的时候可以让后者趋近于$0$,此时再让$\epsilon \to 0$可以让前者为$0$,这就搞定了.</p>
<h6><span id="example4黎曼引理">Example4(黎曼引理)</span></h6><p>求证:$f \in C [ a , b ]$,$\lim_{ n \to \infty } \int_a^b f ( x ) \sin ( nx ) \mathrm{ d } x = 0$.</p>
<p>当$f \in C^1 [ a , b ]$的时候,由于:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b f ( x ) \sin ( nx ) \mathrm{ d } x \\
= & - \frac{ 1 }{ n } \int_a^b f \mathrm{ d } \cos ( nx ) \\
= & - \frac{ 1 }{ n } f \cos ( nx ) |_a^b + \frac{ 1 }{ n } \int_a^b \cos ( nx ) f ' \mathrm{ d } x
\end{aligned}</script><p>两边取绝对值然后让$n \to \infty$就搞定.</p>
<p>既然如此,考虑当$f \in C [ a , b ]$的时候,用多项式逼近$f$,有$| f - P | &lt; \epsilon$,当然:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \varlimsup_{ n \to \infty } | \int_a^b f \sin ( nx ) \mathrm{ d } x | \\
\leq & \varlimsup_{ n \to \infty } | \int_a^b | f - P | \sin ( nx ) \mathrm{ d } x | \\
\leq & \epsilon ( b - a )
\end{aligned}</script><h6><span id="example5">Example5</span></h6><p>当$f \in C [ a , b ]$,如果$\forall n \in \mathbb{ N }$,$\int_a^b f x^n \mathrm{ d } x = 0$,求证$f \equiv 0$.</p>
<p>也就是任意多项式$P$都有$\int_a^b fP \mathrm{ d } x = 0$.取$P$使得$| P - f | &lt; \epsilon$,于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| \int_a^b f^2 \mathrm{ d } x | & = | \int_a^b fP \mathrm{ d } x + \int_a^b f ( f - P ) \mathrm{ d } x | \\
& = | \int_a^b f ( f - P ) \mathrm{ d } x | \\
& \leq \epsilon \int_a^b | f | \mathrm{ d } x
\end{aligned}</script><p>所以$\int_a^b f^2 \mathrm{ d } x = 0$所以$f \equiv 0$.</p>
<h4><span id="傅里叶级数">傅里叶级数</span></h4><p>定义<strong>三角系</strong>为形如$\{ 1 , \cos ( nx ) , \sin ( nx ) \}$的集合,它们张成的线性空间中,也就是有限的线性组合$\sum_{ k = 0 }^n a_k \cos ( kx ) + b_k \sin ( kx )$称为$n$阶<strong>三角多项式</strong>.当$n \to \infty$的时候则称其为<strong>三角级数</strong>.容易见到$f ( x ) \equiv f ( x + 2 \pi )$.</p>
<p>下面我们来证明三角系两两正交,只需检查:</p>
<ol>
<li><p>当$m \ne n$的时候,$\int_{ - \pi }^{ \pi } \cos ( mx ) \cos ( nx ) \mathrm{ d } x$.</p>
</li>
<li><p>当$m \ne n$的时候,$\int_{ - \pi }^{ \pi } \sin ( mx ) \sin ( nx ) \mathrm{ d } x$.</p>
</li>
<li><p>$\forall n , m \in \mathbb{ Z }$,$\int_{ - \pi }^{ \pi } \sin ( nx ) \cos ( mx ) \mathrm{ d } x = 0$.</p>
</li>
<li><p>$\int_{ - \pi }^{ \pi } \cos^2 ( nx ) \mathrm{ d x } = \int_{ - \pi }^{ \pi } \sin^2 ( nx ) \mathrm{ d x } = \pi$.</p>
</li>
</ol>
<p>不妨设$\frac{ a_0 }{ 2 } + \sum_{ 1 }^\infty a_k \cos ( kx ) + b_k \sin ( kx ) \rightrightarrows f ( x )$,假如$f ( x )$的确一致收敛到某个函数,我们实际上可以用$f ( x )$去反推系数,两边乘一些东西再积分应该见到:</p>
<ol>
<li><p>$a_0 = \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f ( x ) \mathrm{ d } x$.</p>
</li>
<li><p>$a_k = \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f ( x ) \cos ( kx ) \mathrm{ d } x$.</p>
</li>
<li><p>$b_k = \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f ( x ) \sin ( kx ) \mathrm{ d } x$.</p>
</li>
</ol>
<p>应该是显然见到的.</p>
<p>当$f$在$[ - \pi , \pi ]$上绝对可积,也就是$\int_{ - \pi }^\pi | f | \mathrm{ d } x &lt; \infty$,那我们就可以按照上述方法拿到一个三角级数的系数,这个三角级数被称为$f ( x )$的<strong>傅里叶级数</strong>或者<strong>傅里叶展开</strong>.注意我们这里其实还并没有说这个三角级数的确收敛到$f ( x )$,而只能说我们可以如此由$f ( x )$构造出一个傅里叶级数.我们有时也将这样的函数记作$f ( x ) \in F [ - \pi , \pi ]$,不妨干脆将$f ( x )$依照$f ( x ) \equiv f ( x + 2 \pi )$的条件延拓$f ( x )$定义(或者干脆要求$f ( x )$是以$2 \pi$为周期的函数),应当见到以下结论:</p>
<ol>
<li><p>$\lim_{ n \to \infty } a_n = \lim_{ n \to \infty } b_n = 0$.</p>
</li>
<li><p>$a_n ( \alpha f + \beta g ) = \alpha a_n ( f ) + \beta a_n ( g )$.</p>
</li>
<li><p>$b_n ( \alpha f + \beta g ) = \alpha b_n ( f ) + \beta b_n ( g )$.</p>
</li>
<li><p>如果$f ( x )$是奇函数,则$a_n ( f ) \equiv 0$.</p>
</li>
<li><p>如果$f ( x )$是偶函数,则$b_n ( f ) \equiv 0$.</p>
</li>
<li><p>记$f_h ( x ) = f ( x + h )$,则$a_n ( f_h ) = a_n ( f ) \cos ( nh ) + b_n ( f ) \sin ( nh )$.</p>
</li>
<li><p>记$f_h ( x ) = f ( x + h )$,则$b_n ( f_h ) = b_n ( f ) \cos ( nh ) - a_n ( f ) \sin ( nh )$.</p>
</li>
<li><p>如果$f ( x ) \equiv f ( x + \pi )$,则$a_{ 2 n - 1 } ( f ) = b_{ 2 n - 1 } ( f )$.</p>
</li>
<li><p>对$\alpha \in ( 0 , 1 ]$,若$| f ( x ) - f ( y ) | \leq L | x - y |^\alpha , \forall x , y \in [ - \pi , \pi ]$,则$a_n = b_n = O ( \frac{ 1 }{ n^\alpha } )$.</p>
</li>
<li><p>若$f$可导,$f ‘$绝对可积,则$a_n = b_n = o ( \frac{ 1 }{ n } )$.</p>
</li>
<li><p>若$f$可导,$f ‘$绝对可积,则$a_n ( f ) = - \frac{ b_n ( f ‘ ) }{ n }$.</p>
</li>
<li><p>若$f$可导,$f ‘$绝对可积,则$b_n ( f ) = \frac{ a_n ( f ‘ ) }{ n }$.</p>
</li>
<li><p>若$f$可以导$m$次,而且$f^{ ( m ) }$绝对可积,则$a_n = b_n = o ( \frac{ 1 }{ n^m } )$.</p>
</li>
<li><p>若$f \in C ( \mathbb{ R } ) , f ( x + 2 \pi ) \equiv f ( x )$,则$\forall \epsilon &gt; 0$,则存在一列三角多项式一致逼近$f$.</p>
</li>
<li><p>若$f \in C ( \mathbb{ R } ) , f ( x + 2 \pi ) \equiv f ( x )$,若$\forall n \geq 0 , a_n \equiv b_n \equiv 0$,则$f \equiv 0$.</p>
</li>
</ol>
<p>(1)是由于黎曼引理,我们前面已经用若干种方法反复证过了.</p>
<p>(2)(3)是积分线性的显然结果,(4)(5)只需带入定义即可发现.</p>
<p>(6)(7)的话当然是因为和差角公式.(8)的话根据(6)和(7)由于$a_n ( f ) = a_n ( f_\pi ) = a_n ( f ) ( - 1 )^n$,这就搞定.</p>
<p>(9)的话,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f ( x ) \cos ( nx ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi - \frac{ \pi }{ n } }^{ \pi - \frac{ \pi }{ n } } f ( x + \frac{ \pi }{ n } ) \cos ( nt + \pi ) \mathrm{ d } x \\
& = - \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f ( x + \frac{ \pi }{ n } ) \cos ( nt ) \mathrm{ d } x \\
a_n & = \frac{ 1 }{ 2 \pi } \int_{ - \pi }^{ \pi } ( f ( x ) - f ( x + \frac{ \pi }{ n } ) ) \cos ( nx ) \mathrm{ d } x \\
| a_n | & \leq \frac{ 1 }{ 2 \pi } \int_{ - \pi }^{ \pi } L ( \frac{ \pi }{ n } )^\alpha \\
& = O ( 1 ) \frac{ 1 }{ n^\alpha }
\end{aligned}</script><p>这就搞定.</p>
<p>至于(10)的话,$a_n = b_n = O ( \frac{ 1 }{ n } )$当然只是(9)的推论.那怎么证明是$o ( \frac{ 1 }{ n } )$的呢?考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \frac{ 1 }{ \pi } \int_{ - \pi }^{ \pi } f \cos ( nx ) \mathrm{ d } x \\
& = \frac{ 1 }{ n \pi } \int_{ - \pi }^{ \pi } f \mathrm{ d } \sin ( nx ) \\
& = - \frac{ 1 }{ n \pi } \int_{ - \pi }^{ \pi } \sin ( nx ) f ' \mathrm{ d } x \\
& = o ( \frac{ 1 }{ n } )
\end{aligned}</script><p>上述过程也自然拿到了(11)和(12).</p>
<p>(13)的话也只需要由(11)和(12)拿到:</p>
<script type="math/tex; mode=display">
| a_n ( f ) | + | b_n ( f ) | \leq \frac{ | a_n ( f^{ ( m ) } ) | + | b_n ( f^{ ( m ) } ) | }{ n^m }</script><p>其实还有一个推论是如果$f$是$2 \pi$周期的解析函数,则$| a_n ( f ) | , | b_n ( f ) | \leq Me^{ - nc }$.而且甚至说这个条件是充要的,如果趋向于零的速度确实为此,则$f$也的确是解析函数.可惜的是这个结论需要用到复分析的结果,不得不在此略过.</p>
<p>(14)的话,乍一看像是Stone-Weierstrass定理的另一则应用,直接观察Stone-Weierstrass定理的证明发现的确可以照搬到三角多项式上(因为难点只在$f ( - \pi ) = f ( \pi )$,但原证明中分离的性质只用于贴合函数上的两个点),然而如果想要直接封装原定理拿过来的话的确难以处理$f ( x ) \equiv f ( x + 2 \pi )$的性质(其实可以从复平面绕过去).下面提供另一则证明:</p>
<p>先看当$f ( x )$是偶函数的时候,观察$x \in [ 0 , \pi ]$,取$y = \cos x$,见到$f ( \arccos y ) \in C [ - 1 , 1 ]$.此时存在一个多项式$P ( y ) = P ( \cos x )$一致逼近$f ( x )$,而$P ( \cos x )$当然是三角多项式.</p>
<p>考虑取$g ( x ) = f ( x ) + f ( - x )$,则如上知道$\forall \epsilon &gt; 0$,存在三角多项式$T_1 ( x )$使得$\forall x \in \mathbb{ R } , | g ( x ) - T_1 ( x ) | &lt; \frac{ \epsilon }{ 2 }$.</p>
<p>再取$\varphi ( x ) = ( f ( x ) - f ( - x ) ) \sin x$当然也是偶函数,存在三角多项式$T_2 ( x )$使得$\forall x \in \mathbb{ R } , | \varphi ( x ) - T_2 ( x ) | &lt; \frac{ \epsilon }{ 2 }$.</p>
<p>既然如此,考虑取$T_3 ( x ) = T_1 \sin^2 x + T_2 \sin x$,由上见到$| 2 f ( x ) \sin^2 x - T_3 ( x ) | &lt; \epsilon$,也就是说对于任何$f ( x )$都能找到如此一个$T_3 ( x )$满足条件.</p>
<p>既然如此,考虑对$f ( x - \frac{ \pi }{ 2 } )$做上述操作,也就是存在三角多项式$T_4 ( x )$满足:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| 2 f ( x - \frac{ \pi }{ 2 } ) \sin^2 x - T_4 ( x ) | < \epsilon \\
| 2 f ( x ) \cos^2 x - T_4 ( x + \frac{ \pi }{ 2 } ) | < \epsilon
\end{aligned}</script><p>既然如此,得到:$| 2 f ( x ) - T_3 ( x ) - T_4 ( x + \frac{ \pi }{ 2 } ) | &lt; 2 \epsilon$,这就搞定了.</p>
<p>对于(15),考虑找一列三角多项式一致逼近$f ( x )$,由于$f ( x )$的傅里叶级数总是$0$,所以对于三角多项式$T_n$来说一定有$\int_{ - \pi }^{ \pi } f ( x ) T_n ( x ) \mathrm{ d } x \equiv 0$,既然如此考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_{ - \pi }^{ \pi } f^2 \mathrm{ d } x & = \int_{ - \pi }^\pi f ( f - T_n ) \mathrm{ d } x \\
& \leq \int_{ - \pi }^\pi | f | \cdot | f - T_n | \mathrm{ d } x \\
& \leq \epsilon \int_{ - \pi }^\pi | f | \mathrm{ d } x & \to 0
\end{aligned}</script><p>因此$f \equiv 0$.这意味着连续函数的傅里叶展开是唯一的.</p>
<p>(15)的一则类似结果是,你可以从中看出$\{ 1 , \sin ( nx ) , \cos ( nx ) \}$三角系是缺一不可的,而不像多项式那样可以去掉很多.例如如果我们在其中去掉$\sin x$的话,那么$\sin x$本身就无法逼近,原因是反证法,如果能逼近,考虑一列三角多项式$\{ T_n \}$并且其中不含$\sin x$,然而,由于三角系中两两正交,因此$\forall T_n ,$都有$\int_{ - \pi }^{ \pi } T_n \sin x \mathrm{ d } x \equiv 0$,因此从(15)的证明过程就可以见到必然有$\sin x \equiv 0$,这当然就出事了.</p>
<h6><span id="example1">Example1</span></h6><p>设$x \in [ - \pi , \pi ]$,考虑一列$\{ b_n \}$单调下降趋近于$0$,那么根据DA判法当然有$S ( x ) = \sum_{ n = 1 }^\infty b_n \sin ( nx )$是逐点收敛的,假设收敛于$f ( x )$.如果$f ( x )$的确是$[ - \pi , \pi ]$上的绝对可积函数.求证:此时上述$S ( x )$的确是$f ( x )$的傅里叶级数.</p>
<p>容易见到$f ( x )$是奇函数,其傅里叶级数中的$a_n \equiv 0$.此时不妨只看$x \in [ 0 , \pi ]$上的结果.</p>
<p>难点当然在于$S ( x ) \to f$并不一定是一致逼近,但应该观察到的是:</p>
<script type="math/tex; mode=display">
| \sin ( mx ) \sum_{ k = 1 }^n \sin ( kx ) | \leq \left | \frac{ \sin ( mx ) }{ \sin \frac{ x }{ 2 } } \right | \leq \left | \frac{ mx }{ \frac{ x }{ \pi } } \right | = | m \pi |</script><p>所以这个一致有界,前面的$| b_n |$单调趋近于$0$,DA判法告诉我们$\sin ( mx ) S ( x )$一致收敛,那逐项积分就证完了$\int_{ - \pi }^{ \pi } g ( x ) \sin ( mx ) \mathrm{ d } x = \pi b_m$.</p>
<h6><span id="example2">Example2</span></h6><p>求$f ( x ) = \frac{ 1 - r^2 }{ 1 - 2 r \cos x + r^2 } , | r | &lt; 1$的傅里叶级数.</p>
<p>考虑在复数上做此操作,留神到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ 1 - z } & = \frac{ 1 - \bar{ z } }{ ( 1 - z ) ( 1 - \bar{ z } ) } \\
& = \frac{ 1 - \bar{ z } }{ 1 - 2 \Re z + | z |^2 } \\
& = \frac{ 1 - r \cos x + ir \sin x }{ 1 - 2 r \cos x + r^2 }
\end{aligned}</script><p>所以$2 \Re ( \frac{ 1 }{ 1 - z } ) - 1 = f ( x )$,然而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ 1 - z } & = \sum_{ n \geq 0 } z^n = \sum_{ n \geq 0 } r^n e^{ inx } \\
\Re ( \frac{ 1 }{ 1 - z } ) & = 1 + \sum_{ n \geq 1 } r^n \cos ( nx ) \\

\end{aligned}</script><p>所以$f ( x ) = 1 + \sum_{ n \geq 1 } 2 r^n \cos ( nx )$.</p>
<h5><span id="与原函数的收敛关系">与原函数的收敛关系</span></h5><p>做完以上操作后,我们来考虑这个傅里叶级数到底是否逼近于$f ( x )$本身,设$S_n ( x ) = \frac{ a_0 }{ 2 } + \sum_{ k = 1 }^n ( a_k \cos ( kx ) + b_k \sin ( kx ) )$.此时考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n ( x_0 ) & = \frac{ a_0 }{ 2 } + \sum_{ k = 1 }^n \int_{ - \pi }^\pi f ( x ) ( \cos kx \cdot \cos kx_0 + \sin kx \cdot \sin kx_0 ) \mathrm{ d } x \\
& = \frac{ 1 }{ 2 \pi } \int_{ - \pi }^\pi f ( x ) \mathrm{ d } x + \sum_{ k = 1 }^n \int_{ - \pi }^\pi f ( x ) \cos k ( x - x_0 ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( x ) \left ( \frac{ 1 }{ 2 } + \sum_{ k = 1 }^n \cos k ( x - x_0 ) \right ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( x ) \frac{ \sin ( n + \frac{ 1 }{ 2 } ) ( x - x_0 ) }{ 2 \sin \frac{ x - x_0 }{ 2 } } \mathrm{ d } x \\

\end{aligned}</script><p>不妨令迪利克雷核$D_n ( x ) = \frac{ \sin ( n + \frac{ 1 }{ 2 } ) x }{ 2 \sin \frac{ x }{ 2 } } , \varphi ( x_0 , x ) = \frac{ f ( x_0 + x ) + f ( x_0 - x ) }{ 2 }$,应当见到$\frac{ 1 }{ \pi } \int_{ - \pi }^\pi D_n ( x ) \mathrm{ d } x = 1$,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n ( x_0 ) & = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( x ) D_{ n } ( x - x_0 ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( t + x_0 ) D_{ n } ( t ) \mathrm{ d } t \\
& = \frac{ 1 }{ \pi } \int_0^\pi ( f ( x_0 + t ) + f ( x_0 - t ) ) D_n ( t ) \mathrm{ d } t \\
& = \frac{ 2 }{ \pi } \int_0^\pi \varphi ( x_0 , t ) D_n ( t ) \mathrm{ d } t
\end{aligned}</script><p>问题在于最后如何判断这个积分的收敛性,事实上可以找到若干个逼近的充分条件:</p>
<ol>
<li>分段可导时候的情况</li>
</ol>
<p>下面我们来证明:当$f$是Holder连续的时候,$\lim_{ n \to \infty } S_n ( x ) \to f ( x )$.</p>
<p>我们有如下<strong>黎曼局部化引理</strong>:对$\forall 0 &lt; \delta &lt; \pi$,都有$\lim_{ n \to \infty } \left ( S_n ( x_0 ) - \frac{ 2 }{ \pi } \int_0^\delta \varphi ( x_0 , t ) \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ t } \mathrm{ d } t \right ) = 0$.</p>
<p>如何证明此呢?考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ \pi }{ 2 } S_n ( x_0 ) & = \int_0^\delta \varphi ( x_0 , t ) D_n ( t ) \mathrm{ d } t + \int_\delta^\pi \varphi ( x_0 , t ) D_n ( t ) \mathrm{ d } t \\
& = \int_0^\delta \varphi ( x_0 , t ) \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ t } \mathrm{ d } t + \int_0^\delta \varphi ( x_0 , t ) \frac{ t - 2 \sin \frac{ t }{ 2 } }{ 2 t \sin \frac{ t }{ 2 } } \sin ( n + \frac{ 1 }{ 2 } ) t \mathrm{ d } t \\
& + \int_\delta^\pi \frac{ \varphi ( x_0 , t ) }{ 2 \sin \frac{ t }{ 2 } } \sin ( n + \frac{ 1 }{ 2 } ) t \mathrm{ d } t \\

\end{aligned}</script><p>留神到$\frac{ t - 2 \sin \frac{ t }{ 2 } }{ 2 t \sin \frac{ t }{ 2 } }$极限存在,因此其的确有界,对后面两项用黎曼引理就知道趋近于$0$.</p>
<p>接下来我们还有一个引理:当$\varphi \in R [ 0 , \delta ]$的时候,如果$\varphi ( 0 + )$存在,并且$\int_0^\delta \frac{ | \varphi ( t ) - \varphi ( 0 + ) | }{ t } &lt; \infty$,则$\lim_{ \lambda \to \infty } \int_0^\delta \varphi ( t ) \frac{ \sin \lambda t }{ t } \mathrm{ d } t = \frac{ \pi }{ 2 } \varphi ( 0 + )$.</p>
<p>于此证明,根据黎曼引理:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\lim_{ \lambda \to \infty } \int_0^\delta \frac{ \varphi ( t ) - \varphi ( 0 + ) }{ t } \sin \lambda t \mathrm{ d } t & = 0 \\
\lim_{ \lambda \to \infty } \int_0^\delta \frac{ \varphi ( t ) }{ t } \sin \lambda t \mathrm{ d } t & = \lim_{ \lambda \to \infty } \int_0^\delta \frac{ \varphi ( 0 + ) }{ t } \sin \lambda t \mathrm{ d } t \\
& = \varphi ( 0 + ) \lim_{ \lambda \to \infty } \int_0^{ \lambda \delta } \frac{ \sin t }{ t } \mathrm{ d } t \\
& = \frac{ \pi }{ 2 } \varphi ( 0 + )
\end{aligned}</script><p>既然如此,当$f$是霍尔德连续,也就是$\exists \alpha \in ( 0 , 1 ] , \exists C &gt; 0$,使得$| f ( x_0 + t ) - f ( x_0 ) | \leq C | t |^\alpha$,此时见到$| \varphi ( x_0 , t ) - \varphi ( x_0 , 0 + ) | = O ( | t |^\alpha )$,用上述引理知道此时$S_n ( x_0 ) \to f ( x_0 )$.</p>
<p>上述结论还可以得到一个更神秘的结论,我们上述引理只用到了在$x_0$附近的结果,那如果$f$在$x_0$附近不连续呢?</p>
<p>假设$f ( x_0 \pm 0 )$均存在,我们可以定义<strong>广义导数</strong>,定义右广义导数为$D_+ f ( x_0 ) = \lim_{ h \to 0 + } \frac{ f ( x_0 + h ) - f ( x_0 + 0 ) }{ h }$,同理定义左广义导数.</p>
<p>当$D_\pm f ( x_0 )$存在的时候,考虑此时$\frac{ | \varphi ( t ) - \varphi ( 0 + ) | }{ t }$没有瑕点,那上述结论当然也就满足.</p>
<p>如果我们定义分段可导为除了若干个断点处的左右广义导数不相同,其余所有点的左右广义导数都存在.那上述结论也就满足.</p>
<ol>
<li>分段单调时候的情况</li>
</ol>
<p>我们有<strong>Jordan引理</strong>:设$\varphi$在$[ 0 , \delta ]$上单调,则$\lim_{ \lambda \to \infty } \int_0^\delta \frac{ \varphi ( x ) }{ x } \sin ( \lambda x ) \mathrm{ d } x = \frac{ \pi }{ 2 } \varphi ( 0 + )$.</p>
<p>对Jordan引理的证明,不妨设$\varphi$单调递增,对$\forall \epsilon &gt; 0 , \exists 0 &lt; \delta ‘ &lt; \delta$,使得$\forall t \in ( 0 , \delta ‘ ) , 0 \leq \varphi ( t ) - \varphi ( 0 + ) &lt; \epsilon$.</p>
<p>不妨设$| \int_0^t \frac{ \sin x }{ x } | \leq M , \forall t &gt; 0$,考虑根据积分第二中值定理:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_0^{ \delta ' } ( \varphi ( t ) - \varphi ( 0 + ) ) \frac{ \sin ( \lambda t ) }{ t } \mathrm{ d } t | \\
= & | ( \varphi ( \delta ' ) - \varphi ( 0 + ) ) \int_\xi^{ \delta ' } \frac{ \sin ( \lambda t ) }{ t } \mathrm{ d } t | \\
\leq & 2 M \epsilon
\end{aligned}</script><p>而在$[ \delta ‘ , \delta ]$上可以直接用黎曼引理这就搞定了.</p>
<p>如果$\varphi$是有限个单调函数的和,上述结论当然也成立了.所以该结论对有界变差函数是成立的.</p>
<p>因此,当$f \in [ - \pi , \pi ]$上逐段单调的时候,$\varphi$逐段是两个单调函数的差,那此时当然也有$\lim_{ n \to \infty } S_n ( x ) = \frac{ f ( x + 0 ) + f ( x - 0 ) }{ 2 }$.</p>
<h6><span id="example1">Example1</span></h6><p>设$f ( x ) = \begin{cases}- 1 &amp; x \in ( - \pi , 0 ) \ 0 &amp; x = 0 \lor x = - \pi \lor x = \pi \ 1 &amp; x \in ( 0 , \pi )\end{cases}$.</p>
<p>见到这的确是一个奇函数,直接求它的傅里叶级数,见到是:</p>
<script type="math/tex; mode=display">
\frac{ 4 }{ \pi } \sum_{ n = 0 }^\infty \frac{ \sin ( 2 n + 1 ) x }{ 2 n + 1 } = \frac{ f ( x + 0 ) + f ( x - 0 ) }{ 2 } = f ( x )</script><p>我们竟然得到了一个一个神秘级数,很牛.</p>
<p>而且这个三角级数在$( 0 , \pi )$上处处收敛到$1$,这个性质在幂级数的时候是无法想象的,我们之前证明过了开区间上的非常值幂级数的零点集一定没有聚点.</p>
<h6><span id="example2">Example2</span></h6><p>设$f ( x ) = \begin{cases}\pi + x &amp; x \in [ - \pi , 0 ) \ \pi - x &amp; x \in [ 0 , \pi )\end{cases}$,也就是一个锯齿状的小函数,当然分段单调了.由于是一个偶函数,积分得到$a_n = \frac{ 2 }{ \pi } \int_0^\pi ( \pi - x ) \cos ( nx ) \mathrm{ d } x = \frac{ 2 }{ n^2 \pi } ( 1 - ( - 1 )^n )$.</p>
<p>这当然是个连续函数,那此时有:</p>
<script type="math/tex; mode=display">
f ( x ) = \frac{ \pi }{ 2 } + \frac{ 4 }{ \pi } ( \sum_{ k = 0 }^\infty \frac{ \cos ( 2 k + 1 ) x }{ ( 2 k + 1 )^2 } )</script><p>两边带入$x = 0$就知道$\sum_{ k = 0 }^\infty \frac{ 1 }{ ( 2 k + 1 )^2 } = \frac{ \pi^2 }{ 8 }$.</p>
<p>还没完,用大M判别法容易检验这个式子两边是绝对一致收敛的,那我们两边逐项积分得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^x f ( t ) \mathrm{ d } t & = \frac{ \pi }{ 2 } x + \frac{ 4 }{ \pi } \sum_{ k = 0 }^\infty \int_0^x \frac{ \cos ( 2 k + 1 ) t }{ ( 2 k + 1 )^2 } \mathrm{ d } t \\
& = \frac{ \pi }{ 2 } x + \frac{ 4 }{ \pi } \sum_{ k = 0 }^\infty \frac{ \sin ( 2 k + 1 ) t }{ ( 2 k + 1 )^3 } \\

\end{aligned}</script><p>把左边的$f$积出来,设其为$g ( x ) = \begin{cases}\pi x + \frac{ x^2 }{ 2 } &amp; x \in [ - \pi , 0 ) \ \pi x - \frac{ x^2 }{ 2 } &amp; x \in [ 0 , \pi )\end{cases}$.那它的傅里叶展开就等于右边的东西(因为一致收敛).带入$x = \frac{ \pi }{ 2 }$,可以得到$\frac{ \pi^3 }{ 32 } = \sum_{ k = 0 }^\infty \frac{ ( - 1 )^k }{ ( 2 k + 1 )^3 }$.</p>
<p>那接下来还可以两边再积分对吧!过程我也懒得写了,总之能推出$\sum_{ k = 0 }^\infty \frac{ 1 }{ ( 2 k + 1 )^4 } = \frac{ \pi^4 }{ 96 }$,可以得到$\sum_{ k = 1 }^\infty \frac{ 1 }{ k^4 } = \frac{ \pi^4 }{ 90 }$.</p>
<p>所以总之,我们可以用上面的策略得到所有的$\zeta ( 2 n )$.</p>
<h6><span id="example3">Example3</span></h6><p>考虑对$\cos ( ax )$在$[ - \pi , \pi ]$截取出来并延拓,然后对其作傅里叶展开,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\cos ( ax ) & = \frac{ \sin ( a \pi ) }{ a \pi } + \sum_{ n = 1 }^\infty \frac{ ( - 1 )^n 2 a }{ a^2 - n^2 } \frac{ \sin ( a \pi ) }{ \pi } \cos ( nx ) \\
\frac{ 1 }{ \sin ( a \pi ) } & = \frac{ 1 }{ a \pi } + \sum_{ n = 1 }^\infty \frac{ ( - 1 )^n 2 a \pi }{ ( a \pi )^2 - ( n \pi )^2 }
\end{aligned}</script><p>令$z = a \pi$,得到:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ \sin z } = \frac{ 1 }{ z } + \sum_{ n = 1 }^\infty ( - 1 )^n ( \frac{ 1 }{ z - n \pi } + \frac{ 1 }{ z + n \pi } )</script><h6><span id="example4">Example4</span></h6><p>假设$\int_{ - \infty }^{ + \infty } | f | \mathrm{ d } x &lt; \infty$,且存在$x_0 , \delta$,$f ( x_0 \pm 0 )$存在,使得以下二者其一成立:</p>
<ol>
<li><p>$f$在$( x_0 - \delta , x_0 + \delta )$上是有界变差的.</p>
</li>
<li><p>积分$\int_0^\delta \frac{ | f ( x_0 \pm t ) - f ( x_0 \pm 0 ) | }{ t } &lt; \infty$.</p>
</li>
</ol>
<p>则:</p>
<script type="math/tex; mode=display">
\lim_{ \alpha \to \infty } \frac{ 1 }{ \pi } \int_{ - \infty }^{ + \infty } f ( x_0 + t ) \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t = \frac{ 1 }{ 2 } ( f ( x_0 + 0 ) + f ( x_0 - 0 ) )</script><p>只需要证明:</p>
<script type="math/tex; mode=display">
\lim_{ \alpha \to \infty } \int_{ 0 }^\infty ( f ( x_0 + t ) - f ( x_0 + 0 ) ) \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t = 0</script><p>首先$[ 0 , + \infty )$上,对于$[ 0 , \delta ]$只需要正常做就行了.可是$\frac{ f ( x_0 + t ) - f ( x_0 + 0 ) }{ t }$在$( \delta , + \infty )$上未必可积,这就有点难绷.开动脑筋,想起来既然这里有一个$\mathbb{ R }$上的绝对可积,那当然得用一用我们的柯西准则,考虑将后面拆成$( \delta , M )$和$[ M , + \infty )$.如果我们能把后面的$[ M , + \infty )$搞定,那中间那一段用黎曼引理就搞定了.</p>
<p>后面怎么做呢,简单放缩:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_{ M }^\infty ( f ( x_0 + t ) - f ( x_0 + 0 ) ) \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t | \\
\leq & | \int_{ M }^\infty f ( x_0 + t ) \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t | + | \int_{ M }^\infty f ( x_0 + 0 ) \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t | \\
\leq & \int_{ M }^\infty | f ( x_0 + t ) | \mathrm{ d } t + | f ( x_0 + 0 ) \int_{ M }^\infty \frac{ \sin ( \alpha t ) }{ t } \mathrm{ d } t | \\
\to & 0
\end{aligned}</script><p>这就搞定了.</p>
<h5><span id="一致收敛到原函数的情形">一致收敛到原函数的情形</span></h5><p>那此时该函数肯定连续,然而连续函数未必总能一致逼近,Example1给出了一个反例.</p>
<p>那么应该加如何条件呢?先证明一个加强版的黎曼引理:</p>
<p>设$g ( x )$是$[ A , B ]$上的绝对可积函数,取$S_p = \sup_{ a , b \in [ A , B ] } | \int_a^b g ( t ) \sin pt \mathrm{ d } t | + \sup_{ a , b \in [ A , B ] } | \int_a^b g ( t ) \cos pt \mathrm{ d } t |$,我们要证明$\lim_{ p \to \infty } S_p = 0$.这个还并不显然,因为$a , b$是可以在$p$之后决定的.实际上这里就是为了拿到一个一致控制性,我们想让我们的黎曼引理是能一致控制住整个区间的,这样我们才能得到一致收敛的条件.</p>
<p>首先考虑$\forall \epsilon &gt; 0$,当$g ( x ) \in R [ a , b ]$的时候,可以先用连续函数逼近,再将连续函数变为多项式逼近.而当$g ( x )$有瑕点的时候,可以将瑕点逼掉.所以总能找到一个多项式$f ( x )$满足$\int_A^B | g ( x ) - f ( x ) | \mathrm{ d } x &lt; \frac{ \epsilon }{ 2 }$.然后考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_a^b f \sin ( pt ) \mathrm{ d } t & = \frac{ 1 }{ p } f \cos ( pt ) |_a^b + \frac{ 1 }{ p } \int_a^b \cos ( pt ) f ' \mathrm{ d } t \\
& \to 0
\end{aligned}</script><p>由此还可以再推出一个引理,$\lim_{ p \to \infty } \sup_{ A \leq x_0 \pm a , x_0 \pm b \leq B } | \int_a^b g ( x_0 \pm t ) \cos ( pt ) \mathrm{ d } t | = 0$.原因是换元后用和差角公式拆开就行.</p>
<p>进一步推广,考虑$\gamma ( t )$是$[ a , b ]$上的有界变差函数,我们证明:$\lim_{ p \to \infty } \sup_{ A \leq x_0 \pm a , x_0 \pm b \leq B } | \int_a^b g ( x_0 \pm t ) \gamma ( t ) \cos ( pt ) \mathrm{ d } t | = 0$.</p>
<p>不妨设$\gamma ( t )$单调递增,然后用积分第二中值定理就可以发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_a^b g ( x_0 \pm t ) \gamma ( t ) \sin ( pt ) \mathrm{ d } t \\
= & \gamma ( a ) \int_a^\xi g ( x_0 \pm t ) \sin ( pt ) \mathrm{ d } t + \gamma ( b ) \int_\xi^b g ( x_0 \pm t ) \sin ( pt ) \mathrm{ d } t \\
\to & 0
\end{aligned}</script><p>接下来设$\varphi ( t ) = f ( x + t ) + f ( x - t ) - 2 f ( x )$,假设$f$是$[ - \pi , \pi ]$上的绝对可积函数,而且$f$限制在子区间$[ a , b ]$上是连续的.我们有<strong>迪尼定理</strong>:若$\forall \epsilon &gt; 0 , \exists \delta &gt; 0 , \sup_{ x \in [ a , b ] } \int_0^\delta \frac{ | \varphi ( t ) | }{ t } \mathrm{ d } t &lt; \epsilon$,则其傅里叶级数$S_n ( x )$在区间$[ a , b ]$上一致逼近$f$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n ( x ) - f ( x ) & = \frac{ 1 }{ \pi } \int_0^\pi \varphi ( t ) \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ 2 \sin \frac{ t }{ 2 } } \mathrm{ d } t \\
& = \frac{ 1 }{ \pi } ( \int_0^\delta + \int_\delta^\pi ) \varphi ( t ) \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ 2 \sin \frac{ t }{ 2 } } \mathrm{ d } t \\

\end{aligned}</script><p>考虑前者:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^\delta & \leq \frac{ 1 }{ \pi } \int_0^\delta \frac{ | \varphi ( t ) | }{ t } \frac{ \frac{ t }{ 2 } }{ \sin \frac{ t }{ 2 } } \mathrm{ d } t \\
& \leq \frac{ 1 }{ 2 } \int_0^\delta \frac{ | \varphi ( t ) | }{ t } \mathrm{ d } t \\
& < \frac{ \epsilon }{ 2 }
\end{aligned}</script><p>至于后者,只需上述引理就搞定.</p>
<p>于是最后我们可以得到,如果$f$是Holder连续的时候,那对于任意的$[ a , b ]$,都一定有$S_n \rightrightarrows f ( x )$.</p>
<p>而如果当$f$是有界变差的时候,此时考虑$f$几乎处处可导,而在其可导的地方当然由上面的结果就一致收敛了,所以可以知道这个函数列几乎处处一致收敛到$f$.</p>
<p>然而容易检验如果一个连续函数列几乎处处一致收敛到一个连续函数,那当然它们就是一致收敛的关系.考虑反证,$\forall \epsilon &gt; 0$,设可导点集为$A$,则$\exists n , \sup_{ x \in A } ( f ( x ) - f_n ( x ) ) &lt; \epsilon$.</p>
<p>假设不一致收敛,此时$\exists x_0$使得$f ( x_0 ) - f_n ( x_0 ) &gt; 4 \epsilon$.然而由于$n$已经定死,所以现在$f$和$f_n$都是一致连续的,往旁边区间绕一下就行了.不管这个区间多小,由于$[ - \pi , \pi ] \setminus A$是零测的,所以总有与$A$的交.</p>
<p>从上面也可以看到,只要一个连续函数几乎处处可导,那它的傅里叶级数就可以一致逼近它.</p>
<h6><span id="example1">Example1</span></h6><p>设:</p>
<script type="math/tex; mode=display">
\begin{aligned}
Q_{ m , n } & & = \sum_{ k = 1 }^n \frac{ \sin ( m + n - k ) x }{ k } - \sum_{ k = 1 }^n \frac{ \sin ( m + n + k ) x }{ k } \\
& & = - 2 \cos ( m + n ) x \sum_{ v = 1 } \frac{ \sin ( vx ) }{ v }
\end{aligned}</script><p>容易检查这个函数是有界的,只需:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ v = 1 }^n \frac{ \sin vx }{ v } & & = \int_0^x \sum_{ v = 1 }^n \cos vt \mathrm{ d } t \\
& & = \int_0^x ( - \frac{ 1 }{ 2 } + \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ 2 \sin \frac{ t }{ 2 } } ) \\
& & = - \frac{ x }{ 2 } + \int_0^x ( \frac{ 1 }{ 2 \sin \frac{ t }{ 2 } } - \frac{ 1 }{ t } ) + \int_0^{ ( n + \frac{ 1 }{ 2 } ) x } \frac{ \sin t }{ t } \mathrm{ d } t
\end{aligned}</script><p>这样用黎曼引理立刻见到其有界,存在常数$C$使得$| \sum_{ v = 1 }^n \frac{ \sin vx }{ v } | \leq C$,那$| Q_{ n , m } | \leq 2 C$也有界.</p>
<p>定义$m_k = n_k = 2^{ k^3 }$,取函数$\varphi ( x ) = \sum_{ k = 1 }^\infty \frac{ 1 }{ k^2 } Q_{ m_k , n_k } ( x )$,既然$Q_{ m_k , n_k }$有界,根据大M判别法,这个东西当然一致收敛而且$2 \pi$周期连续.</p>
<p>既然如此,考察$\varphi ( x )$是奇函数,它的傅里叶展开的确就是上述形式(原因是连续函数有唯一傅里叶展开).</p>
<p>接下来考虑其波动考虑由于我们的$m_k = n_k = 2^{ k^3 }$,所以其实这里很稀疏的,留神到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_{ 2 n_k - 1 } ( x ) - S_{ n_k - 1 } ( x ) & = \frac{ 1 }{ k^2 } \left ( \sum_{ l = 1 }^{ n_k } \frac{ \sin ( 2 n_k - l ) x }{ l } \right )
\end{aligned}</script><p>接下来带入$x = \frac{ \pi }{ 4 n_k }$,见到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( S_{ 2 n_k - 1 } - S_{ n_k - 1 } ) ( \frac{ \pi }{ 4 n_k } ) & > \frac{ \sqrt{ 2 } }{ 2 } \frac{ 1 }{ k^2 } ( \sum_{ l = 1 }^{ n_k } \frac{ 1 }{ l } ) \\
& > \frac{ \sqrt{ 2 } }{ 2 } \frac{ 1 }{ k^2 } \ln n_k \\
& > \frac{ \sqrt{ 2 } \ln 2 }{ 2 } k \\
& \to \infty
\end{aligned}</script><p>因此见到不一致收敛,很厉害!</p>
<h5><span id="cesaro收敛">Cesaro收敛</span></h5><p>接下来我们引入<strong>Cesaro收敛</strong>的概念,回忆到Stolz定理给出若取定$\sigma_n = \frac{ a_1 + \cdots + a_n }{ n }$,回忆到如果$a_n \to a$,则$\sigma_n \to a$,然而反之未必成立.因此,$\sigma_n$如果收敛的话,这是一个比$a_n$收敛弱的条件.</p>
<p>在傅里叶级数这里也引入这个概念,我们不再研究$S_n ( x )$的收敛性,而考虑$\sigma_n ( x ) = \frac{ S_0 ( x ) + \cdots + S_n ( x ) }{ n + 1 }$的收敛性.考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sigma_n ( x ) & = \frac{ S_0 ( x ) + \cdots + S_n ( x ) }{ n + 1 } \\
& = \frac{ 1 }{ ( n + 1 ) \pi } \int_{ - \pi }^\pi f ( x + t ) \frac{ \sum_{ k = 0 }^n \sin ( k + \frac{ 1 }{ 2 } ) t }{ 2 \sin \frac{ t }{ 2 } } \mathrm{ d } t \\
& = \frac{ 1 }{ ( n + 1 ) \pi } \int_{ - \pi }^\pi f ( x + t ) \frac{ 1 - \cos ( n + 1 ) t }{ 2 \sin^2 \frac{ t }{ 2 } } \mathrm{ d } t \\
& = \frac{ 1 }{ ( n + 1 ) \pi } \int_{ - \pi }^\pi f ( x + t ) \frac{ \sin^2 ( \frac{ n + 1 }{ 2 } t ) }{ 2 \sin^2 \frac{ t }{ 2 } } \mathrm{ d } t \\

\end{aligned}</script><p>设费叶核$\phi_n ( t ) = \frac{ \sin^2 \frac{ n + 1 }{ 2 } t }{ 2 ( n + 1 ) \sin^2 \frac{ t }{ 2 } }$.容易见到$\phi_n ( t ) = \phi_n ( - t )$,$\phi ( 0 ) = \frac{ n + 1 }{ 2 }$,而且$\frac{ 1 }{ \pi } \int_{ - \pi }^\pi \phi_n ( t ) \mathrm{ d } t = 1$,原因是$\phi_n ( t )$原本是个三角多项式,因此这里的积分只和其常数项有关,而常数项为$\frac{ 1 }{ 2 }$.</p>
<p>现在我们说,当$f ( x ) \equiv f ( x + 2 \pi )$,$f$在$[ - \pi , \pi ]$上绝对可积,并且$f ( x_0 \pm 0 )$极限存在,则$\lim_{ n \to \infty } \sigma_n ( x_n ) = \frac{ f ( x_0 + 0 ) + f ( x_0 - 0 ) }{ 2 }$.进一步,如果$f \in C ( \mathbb{ R } )$,则$\sigma_n ( x ) \rightrightarrows f ( x )$.</p>
<p>考虑设$I_n = \sigma_n ( x ) - \frac{ f ( x + 0 ) + f ( x - 0 ) }{ 2 }$,有:</p>
<script type="math/tex; mode=display">
I_n = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \phi_n ( t ) ( f ( x + t ) + f ( x - t ) - f ( x + 0 ) - f ( x - 0 ) ) \mathrm{ d } t</script><p>此时考虑$f ( x \pm 0 )$存在意味着$\forall \epsilon &gt; 0 , \exists \delta &gt; 0$,使得当$0 &lt; t \leq \delta$的时候,总有$| f ( x \pm t ) - f ( x \pm 0 ) | &lt; \frac{ \epsilon }{ 2 \pi }$,于是我们上面的$I_n$就可以拆成$\int_0^\delta + \int_\delta^\pi$两部分.</p>
<p>对于前者:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ \pi } | \int_0^\delta | \leq \frac{ \epsilon }{ 2 \pi } \int_0^\pi \phi_n ( t ) \mathrm{ d } t < \frac{ \epsilon }{ 2 }</script><p>对于后者只要能控制$\max_{ [ \delta , \pi ] } \phi_n ( t )$就行,而这是显然的,因为当$t \geq \delta$的时候,分母就有下界了,让$n \to \infty$的时候当然趋近于$0$.所以$\lim_{ n \to \infty } I_n = 0$.</p>
<p>接下来的疑问是当$f$连续时为何一致收敛,这当然是因为$f$是一致连续的,那我上述唯一涉及$x$的地方,也就是当$f ( x \pm t ) \to f ( x )$的部分就可以被控制住,这就搞定了.</p>
<p>Cesaro收敛的另一个好处在于,当$f ( x + 0 )$和$f ( x - 0 )$存在的时候,由于如果逐点收敛一定就能导出Cesaro收敛,因此,如果傅里叶级数在某一点处收敛,则它必然也在这一点处Cesaro收敛且收敛于同一个$\frac{ f ( x + 0 ) + f ( x - 0 ) }{ 2 }$,换言之如果收敛则一定收敛于此.</p>
<h5><span id="平均收敛">平均收敛</span></h5><p>考虑如果一列函数$f_n$,如果$\int | f_n - f | \to 0$则我们称这列函数<strong>平均收敛</strong>到$f$.一个平均收敛的函数列可以处处点不收敛,一个逐点收敛的函数也可能并不平均收敛(因为积分不一定收敛).</p>
<p>考虑定义<strong>平方可积函数</strong>$f$为几乎处处连续而且只有有限个瑕点的$f$并且满足$\int_{ - \pi }^\pi f^2 \mathrm{ d } x &lt; \infty$.容易见到闭区间上的平方可积要强于绝对可积,原因正是柯西不等式:</p>
<script type="math/tex; mode=display">
\int_{ - \pi }^\pi | f | \mathrm{ d } x \leq \sqrt{ ( \int_{ - \pi }^\pi f^2 \mathrm{ d } x ) ( \int_{ - \pi }^\pi 1 \mathrm{ d } x ) }</script><p>从而看到如果$\int ( f_n - f )^2 \mathrm{ d } x \to 0$则当然有$\int | f_n - f | \mathrm{ d } x \to 0$,因此我们往往计算前者.</p>
<p>假设$f$是平方绝对可积的,考虑定义$\mathcal{ F }_n$为$n$阶三角多项式组成的集合,设$S_n$是$f$的傅里叶展开的前$n$项,我们有:</p>
<ol>
<li><p>$\int_{ - \pi }^\pi ( f - S_n )^2 \mathrm{ d } x = \min_{ T_n \in \mathcal{ F }_n } \int_{ - \pi }^\pi ( f - T_n )^2 \mathrm{ d } x$.</p>
</li>
<li><p><strong>Bessel不等式</strong>:$\frac{ a_0^2 }{ 2 } + \sum_{ n = 1 }^\infty ( a_n^2 + b_n^2 ) \leq \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f^2 \mathrm{ d } x$.</p>
</li>
<li><p><strong>Parseval等式</strong>:$\frac{ a_0^2 }{ 2 } + \sum_{ n = 1 }^\infty ( a_n^2 + b_n^2 ) = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f^2 \mathrm{ d } x$.</p>
</li>
<li><p><strong>广义Parseval等式</strong>:设$f , g$都平方可积,则$\frac{ 1 }{ \pi } \int_{ - \pi }^\pi fg \mathrm{ d } x = \frac{ a_0 ( f ) a_0 ( g ) }{ 2 } + \sum_{ n = 1 }^\infty ( a_n ( f ) a_n ( g ) + b_n ( f ) b_n ( g ) )$.</p>
</li>
</ol>
<p>先看(1)和(2),假设$T_n = \frac{ A_0 }{ 2 } + \sum_{ k = 1 }^n A_k \cos ( kx ) + B_k \sin ( kx )$,考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \int_{ - \pi }^\pi ( f - T_n )^2 \mathrm{ d } x \\
= & \int_{ - \pi }^\pi f^2 \mathrm{ d } x + \pi \left ( \frac{ A_0^2 }{ 2 } + \sum_{ k = 1 }^n ( A_k^2 + B_k^2 ) \right ) - 2 \pi ( A_0 \frac{ a_0 }{ 2 } + \sum_{ k = 1 }^n a_k A_k + b_k B_k ) \\
= & \int_{ - \pi }^\pi f^2 \mathrm{ d } x + \pi \left ( \frac{ ( A_0 - a_0 )^2 }{ 2 } + \sum_{ k = 1 }^n ( a_k - A_k )^2 + ( b_k - B_k )^2 \right ) - \pi \left ( \frac{ a_0^2 }{ 2 } + \sum_{ k = 1 }^n a_k^2 + b_k^2 \right ) \\
\geq & \int_{ - \pi }^\pi f^2 \mathrm{ d } x - \pi \left ( \frac{ a_0^2 }{ 2 } + \sum_{ k = 1 }^n a_k^2 + b_k^2 \right ) \\

\end{aligned}</script><p>等号成立当且仅当$A_k = a_k , B_k = b_k$,这样上述两者就都证毕.</p>
<p>再看(3),由(1)和(2),只需要证明对于平方可积函数总存在一列三角多项式$T_n$使得$\lim_{ n \to \infty } \int_{ - \pi }^\pi ( f - T_n )^2 \mathrm{ d } x = 0$即可.</p>
<p>当$f$是黎曼可积的时候这里较为平凡,只需要先用连续函数$g$逼近$f$,再用三角多项式逼近$g$即可.最终因为有$( T - f )^2 \leq 2 ( T - g )^2 + 2 ( f - g )^2$就行.顺便一提这个不等式还可以证明平方可积的函数的和差也一定是平方可积.</p>
<p>接下来要把瑕点给处理掉,由于平方可积,所以瑕点那里的积分会足够小,直接把那一段抹平成$0$就行.抹平了后的函数可以被逼近,而抹平带来的影响又很小,这就搞定了.</p>
<p>再看(4),对$( f + g )$和$( f - g )$分别做Parseval等式,然后用它们一作差就能证明此结论.</p>
<p>关于Bessel不等式和Parseval等式,一个更好的理解是它体现了正交基上的操作,Bessel不等式说对于一组正交基我们总有$\Vert u \Vert^2 \leq \sum_k ( u | e_k )^2$成立.</p>
<h6><span id="example1">Example1</span></h6><p>求证:函数$f , g$在$[ - \pi , \pi ]$上黎曼可积,则它们的傅里叶级数相同的充分必要条件是$\int_{ - \pi }^\pi | f - g | \mathrm{ d } x = 0$.</p>
<p>先证明充分性,比较显然:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \int_{ - \pi }^\pi ( f - g ) \sin ( nx ) \mathrm{ d } x | \\
\leq & \int_{ - \pi }^\pi | f - g | \mathrm{ d } x
\end{aligned}</script><p>再证必要性,也很显然,考虑如果傅里叶级数相同,则Parseval等式必有$\int f^2 \mathrm{ d } x = \int g^2 \mathrm{ d } x = \int fg \mathrm{ d } x$,这说明$\int ( f - g )^2 \mathrm{ d } x = 0$,立刻推出$\int | f - g | \mathrm{ d } x = 0$.</p>
<h6><span id="example2">Example2</span></h6><p>求证:当$b_n$单调递减趋近于$0$的时候,如果$\sum \frac{ b_n }{ n } &lt; \infty$,则$f ( x ) = \sum b_n \sin ( nx )$在$[ - \pi , \pi ]$上绝对可积.</p>
<p>不妨设$x \in [ - \pi , \pi ]$,首先考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = n + 1 }^{ n + m } \sin ( kx ) | \\
= & | \frac{ \cos ( n + m + \frac{ 1 }{ 2 } ) - \cos ( n + \frac{ 1 }{ 2 } ) }{ 2 \sin \frac{ x }{ 2 } } | \\
\leq & \frac{ 1 }{ | \sin \frac{ x }{ 2 } | }
\end{aligned}</script><p>此时考虑设$S_m = \sum_{ k = n + 1 }^{ m } \sin ( kx )$,取$x \in [ \frac{ \pi }{ n + 1 } , \frac{ \pi }{ n } ]$,用Abel变换立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ k = n + 1 }^{ n + m } b_k \sin ( kx ) | \\
= & | \sum_{ k = n + 1 }^{ n + m } b_k ( S_{ k } - S_{ k - 1 } ) | \\
= & | \sum_{ k = n + 1 }^{ n + m - 1 } ( b_{ k } - b_{ k + 1 } ) S_{ k } - b_{ n + 1 } S_{ n } + b_{ n + m } S_{ n + m } | \\
= & | \sum_{ k = n + 1 }^{ n + m - 1 } ( b_{ k } - b_{ k + 1 } ) S_{ k } + b_{ n + m } S_{ n + m } | \\
\leq & \frac{ b_n }{ | \sin \frac{ x }{ 2 } | } \\
\leq & \frac{ \pi }{ x } b_{ n + 1 } \\
\leq & ( n + 1 ) b_n
\end{aligned}</script><p>这里已经和$m$没有关系了,既然如此考虑取$B_n = \sum_{ k = 1 }^n b_k$,自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\int_0^\pi | f | \mathrm{ d x } & = \sum_{ n = 1 }^\infty \int_{ \frac{ \pi }{ n + 1 } }^{ \frac{ \pi }{ n } } | f | \mathrm{ d } x \\
& \leq \sum_{ n = 1 }^\infty \int_{ \frac{ \pi }{ n + 1 } }^{ \frac{ \pi }{ n } } ( B_n + ( n + 1 ) b_n ) \mathrm{ d } x \\
& = \sum_{ n = 1 }^\infty \frac{ \pi }{ n ( n + 1 ) } ( B_n + ( n + 1 ) b_n ) \\

\end{aligned}</script><p>此时只需检验$\sum \frac{ B_n }{ n ( n + 1 ) }$收敛就行了对吧.这个比较平凡:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ n = 1 }^\infty \frac{ B_n }{ n ( n + 1 ) } & = \sum_{ n = 1 }^\infty \frac{ 1 }{ n ( n + 1 ) } \sum_{ k = 1 } b_k \\
& = \sum_{ k = 1 }^\infty b_k \sum_{ n = k }^\infty \frac{ 1 }{ n ( n + 1 ) } \\
& = \sum_{ k = 1 }^\infty \frac{ b_k }{ k } \\
& < \infty
\end{aligned}</script><p>这就搞定了.</p>
<h5><span id="逐项积分">逐项积分</span></h5><p>设$f$绝对可积,其傅里叶级数为$\frac{ a_0 }{ 2 } + \sum a_n \cos ( nx ) + b_n \sin ( nx )$,考虑取$F ( x ) = \int_0^x ( f ( t ) - \frac{ a_0 }{ 2 } ) \mathrm{ d } t$,容易检查$F ( x )$是有界变差的,原因是$\sum | F ( x_i ) - F ( x_{ i - 1 } ) | = \sum | \int_{ x_{ i - 1 } }^{ x_i } f ( t ) \mathrm{ d } t | \leq \int | f |$.</p>
<p>既然如此,它就会被它的傅里叶级数一致逼近,不妨记作$F ( x ) = \frac{ A_0 }{ 2 } + \sum_{ n = 1 }^\infty A_n \cos ( nx ) + B_n \sin ( nx )$.</p>
<p>接下来考虑把这些系数都求出来,先令$x = 0$求出$\frac{ A_0 }{ 2 } + \sum_{ n = 1 }^\infty A_n = 0$,当$n \geq 1$的时候,留神到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A_n & = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi F ( x ) \cos ( nx ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } F ( x ) \frac{ \sin ( nx ) }{ n } |_{ - \pi }^\pi - \frac{ 1 }{ n \pi } \int_{ - \pi }^\pi f ( x ) \sin ( nx ) \mathrm{ d } x \\
& = - \frac{ b_n }{ n }
\end{aligned}</script><p>注意这里用的分部积分是广义分部积分,我们曾经搞过.</p>
<p>同理$B_n = \frac{ a_n }{ n }$,补一个$x$的傅里叶级数进去,于是我们见到:</p>
<script type="math/tex; mode=display">
\int_0^x f ( t ) \mathrm{ d } t = \frac{ a_0 }{ 2 } x + \sum_{ n = 1 }^\infty a_n \int_0^x \cos ( nt ) \mathrm{ d } t + b_n \int_0^x \sin ( nt ) \mathrm{ d } t</script><p>也就是一个函数和傅里叶级数逐项积分后总相等.</p>
<h5><span id="逐项微分">逐项微分</span></h5><p>设$f$可导而且是$2 \pi$周期的,并且$\int_{ - \pi }^\pi | f ‘ | \mathrm{ d } x &lt; \infty$,那由逐项积分那里的结论,自然有$a_0 ( f ‘ ) = 0 , a_n ( f ‘ ) = nb_n ( f ) , b_n ( f ‘ ) = - na_n ( f )$,也就是当:$f = \frac{ a_0 }{ 2 } + \sum a_n \cos ( nx ) + b_n \sin ( nx )$,则$f ‘ \sim \sum - na_n \sin ( nx ) + nb_n \cos ( nx )$.</p>
<h5><span id="收敛速度的估计">收敛速度的估计</span></h5><p>最后来分析一下它的收敛能力,不妨假设$f$是$2 \pi$周期逐段可导函数,并且$\int_{ - \pi }^{ \pi } ( f ‘ )^2 \mathrm{ d } x &lt; \infty$,则$\max | f ( x ) - S_n ( x ) | = o ( \frac{ 1 }{ \sqrt{ n } } )$,原因是由Parseval等式,有:</p>
<script type="math/tex; mode=display">
\frac{ 1 }{ \pi } \int_{ - \pi }^\pi ( f ' )^2 \mathrm{ d } x = \frac{ a_0 ( f ' )^2 }{ 2 } + \sum_{ n = 1 }^\infty ( a_n ( f ' )^2 + b_n ( f ' )^2 )</script><p>也就是后面这个级数收敛对吧,那柯西准则给出:</p>
<script type="math/tex; mode=display">
\sum_{ k = n + 1 }^\infty ( a_k ( f ' )^2 + b_k ( f ' )^2 ) = o ( 1 )</script><p>现在来看误差项:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| f ( x ) - S_n ( x ) | & \leq | \sum_{ k = n + 1 }^\infty a_k ( f ) \cos ( kx ) + b_k ( f ) \sin ( kx ) | \\
& \leq \sum_{ k = n + 1 }^\infty | a_k ( f ) | + | b_k ( f ) | \\
& = \sum_{ k = n + 1 }^\infty \frac{ | a_k ( f ' ) | + | b_k ( f ' ) | }{ k } \\
& \leq \sqrt{ \sum_{ k = n + 1 }^\infty | a_k ( f ' )^2 | + | b_k ( f ' )^2 | } \sqrt{ \sum_{ k = n + 1 }^\infty \frac{ 1 }{ k^2 } } \\
& = o ( 1 ) \frac{ 1 }{ \sqrt{ n } }
\end{aligned}</script><h5><span id="复数形式">复数形式</span></h5><p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & \sim \frac{ a_0 }{ 2 } + \sum a_n \cos ( nx ) + b_n \sin ( nx ) \\
& = \frac{ a_0 }{ 2 } + \sum a_n \frac{ e^{ inx } + e^{ - inx } }{ 2 } + \sum b_n \frac{ e^{ inx } - e^{ - inx } }{ 2 i } \\
& = \sum_{ n = - \infty }^\infty c_n e^{ inx }
\end{aligned}</script><p>此时有$c_n = \frac{ 1 }{ 2 \pi } \int_{ - \pi }^\pi f ( x ) e^{ - inx } \mathrm{ d } x$.</p>
<h5><span id="三角级数的唯一性问题">三角级数的唯一性问题</span></h5><p>接下来来解决点看上去很平凡的问题,如果:</p>
<script type="math/tex; mode=display">
\frac{ a_0 }{ 2 } + \sum_{ n = 1 }^\infty a_n \cos ( nx ) + b_n \sin ( nx ) = \frac{ \tilde{ a_0 } }{ 2 } + \sum_{ n = 1 }^\infty \tilde{ a_n } \cos ( nx ) + \tilde{ b_n } \sin ( nx )</script><p>而且左右两端都收敛到某个函数.能否导出$a_n = \tilde{ a_n } , b_n = \tilde{ b_n }$.注意这里并不能两遍乘个$\cos ( nx )$然后积分,因为未必可积.</p>
<p>我们下面可以证明,如果上面这种相等除了至多可数个点以外都成立,那就是同一个三角级数.当然只需要证明当:</p>
<script type="math/tex; mode=display">
\frac{ a_0 }{ 2 } + \sum_{ n = 1 }^\infty a_n \cos ( nx ) + b_n \sin ( nx ) = 0</script><p>至多除了一个可数集合$E = \{ x_1 , x_2 , \cdots \}$以外成立的时候有$a_n = b_n = 0$即可.</p>
<p>先来证明一个引理:此时$\lim_{ n \to \infty } a_n = \lim_{ n \to \infty } b_n = 0$.这还并不显然,因为这个三角级数并不一定是傅里叶级数.</p>
<p>首先级数收敛,通项趋近于$0$,首先设$\rho_n = \sqrt{ a_n^2 + b_n^2 }$,则$a_n \cos ( nx ) + b_n \sin ( nx ) = \rho_n \sin ( nx + \varphi_n )$.现在只需要证明$\lim_{ n \to \infty } \rho_n = 0$.</p>
<p>反证,如果没有上述结论,则总存在一个无穷子列$\{ \rho_{ n_k } \}_k$大于某一个正常数$c$,设其指标集合为$F = \{ n_1 &lt; n_2 &lt; \cdots \}$.</p>
<p>现在考虑$[ 0 , 2 \pi ]$上,找一个区间$I_1 = [ l_1 , r_1 ]$使得其不含有$x_1$,由于$F$通项肯定趋近无穷大,总能找到一个$m_1 \in F$,使得$| [ m_1 l_1 , m_1 r_1 ] | = m_1 | I_1 | &gt; 2 \pi$.既然它的区间长度足够大,那其中总有一个子区间$J_1 \subseteq I_1$,使得$\sin ( m_1 x + \varphi_{ m_1 } ) &gt; \frac{ 1 }{ 2 }$在$J_1$上成立.那我当然可以再找一个子区间$I_2 \subseteq J_1$使得$I_2$中不含有$x_2$,重复以上操作,这就是一个闭区间套.最后套出来了一个点$w \notin E$,此时$\sin ( m_k w + \varphi_{ m_k } ) &gt; \frac{ 1 }{ 2 }$,自然有$\varphi_{ m_k } \sin ( m_k w + \varphi_{ m_k } ) &gt; \frac{ c }{ 2 }$,这立刻导出矛盾.</p>
<p>再来一个引理:假设$F ( x ) \in C ( a , b )$,可数集合$E \subseteq ( a , b )$.定义其<strong>二阶差分</strong>为$\Delta_h^2 F ( x ) = F ( x + 2 h ) + F ( x - 2 h ) - 2 F ( x )$.已知其<strong>广义二阶导数</strong>$\delta^2 F = \varlimsup_{ h \to + 0 } \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \geq 0 , \forall x \notin E$,而$\varlimsup_{ h \to + 0 } \frac{ \Delta_h^2 F ( x ) }{ h } \geq 0 , \forall x \in E$.则结论是$F ( x )$是一个下凸函数.</p>
<p>这个结论的自然之处在于如果$F ‘ ‘ ( x )$存在,那$F ( x + 2 h ) = F ( x ) + F ‘ ( x ) 2 h + \frac{ F ‘ ‘ ( x ) }{ 2 } ( 2 h )^2 + o ( h^2 )$并且$F ( x - 2 h ) = F ( x ) - F ‘ ( x ) 2 h + \frac{ F ‘ ‘ ( x ) }{ 2 } ( 2 h )^2 + o ( h^2 )$,所以上面那个$\delta^2 F = F ‘ ‘ ( x )$,那如果它非负当然是下凸函数.</p>
<p>那如果$F ‘ ‘ ( x )$不存在呢?反证,假设$F$不凸,则一定存在一个子区间$( \alpha , \beta ) \subseteq ( a , b )$,使得在这个区间上,$F ( x )$函数在$( \alpha , \beta )$这条弦之上(因为连续性,至少有三个点是违背三弦定理的,作一条弦后,函数有一些部分在上面有一些部分在下面,取某个恒在上面的子区间即可).</p>
<p>总之,我们找到了一个子区间$( \alpha , \beta )$使得:</p>
<script type="math/tex; mode=display">
F ( x ) - \left ( \frac{ F ( \beta ) - F ( \alpha ) }{ \beta - \alpha } ( x - \alpha ) + F ( \alpha ) \right ) > 0</script><p>接下来要推矛盾,分成两种情况:</p>
<p>第一种情况是$\delta^2 F &gt; 0$的情形,考虑辅助函数$G_\mu ( x ) = F ( x ) - ( \mu ( x - a ) + F ( \alpha ) )$,其中$\mu = \frac{ F ( \beta ) - F ( \alpha ) }{ \beta - \alpha } + \epsilon$,也就是比原本那条弦的斜率稍微大了一点点,那只要$\epsilon$落在某个足够小的区间内,$G_\mu ( x )$仍然有大于零的部分.直接取$G_\mu ( x_0 ( \mu ) ) = \max_{ [ \alpha , \beta ] } G_\mu$,此时观察到$G_\mu$和$F$只差一个一次函数,它们作二阶差分后就相等了,然而,由于$G_\mu ( x_0 ( \mu ) )$取的是最大值,当$h$取足够小的时候,它的二阶差分一定小于等于$0$,因此能导出$x_0 ( \mu ) \in E$,并且同理能导出$\varlimsup_{ h \to + 0 } \frac{ \Delta_h^2 F ( x_0 ( \mu ) ) }{ h } = 0$.从而导出:</p>
<script type="math/tex; mode=display">
\varlimsup_{ h \to + 0 } \frac{ G_\mu ( x_0 ( \mu ) - 2 h ) - G_\mu ( x_0 ( \mu ) ) }{ h } = \varlimsup_{ h \to + 0 } \frac{ G_\mu ( x_0 ( \mu ) + 2 h ) - G_\mu ( x_0 ( \mu ) ) }{ h } = 0</script><p>欸,你怎么变一阶差分了,那我的一次函数不就有用了么,必定有:</p>
<script type="math/tex; mode=display">
\varlimsup_{ h \to + 0 } \frac{ F ( x_0 ( \mu ) - 2 h ) - F ( x_0 ( \mu ) ) }{ h } = 2 \mu</script><p>所以$\mu \to x_0 ( \mu )$为单射,这与$x_0 ( \mu ) \in E$矛盾.</p>
<p>那么等于$0$的情况呼之欲出了对吧,此时任意的$n$都可以做到$F ( x ) + \frac{ x^2 }{ n }$是凸的,随便搞个反证法就可以知道$F ( x )$必定是凸的.</p>
<p>最后来设$F ( x ) = \frac{ a_0 }{ 4 } x^2 - \sum_{ n = 1 }^\infty \frac{ a_n \cos ( nx ) + b_n \sin ( nx ) }{ n^2 }$,由于$a_n \to 0 , b_n \to 0$,所以这玩意用大M判别法知道绝对一致收敛,那就是一个连续函数.</p>
<p>此时计算:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\Delta_h^2 F ( x ) & = \frac{ a_0 }{ 4 } ( ( x + 2 h )^2 + ( x - 2 h )^2 - 2 x^2 ) \\
& - \sum_{ n = 1 }^\infty \frac{ 1 }{ n^2 } ( a_n ( \cos ( n ( x + 2 h ) ) + \cos ( n ( x - 2 h ) ) - 2 \cos ( nx ) ) \\
& + b_n ( \sin ( n ( x + 2 h ) ) + \sin ( n ( x - 2 h ) ) - 2 \sin ( nx ) ) ) \\

\end{aligned}</script><p>而此时对后面的部分用和差化积,留神到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \cos ( n ( x + 2 h ) ) + \cos ( n ( x - 2 h ) ) - 2 \cos ( nx ) \\
= & 2 \cos ( nx ) \cos ( 2 nh ) - 2 \cos ( nx ) \\
= & 2 \cos ( nx ) ( \cos ( 2 nh ) - 1 ) \\
= & - 4 \cos ( nx ) \sin^2 ( nh )
\end{aligned}</script><p>于是:</p>
<script type="math/tex; mode=display">
\frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } = \frac{ a_0 }{ 2 } + \sum_{ n = 1 }^\infty ( a_n \cos ( nx ) + b_n \sin ( nx ) ) ( \frac{ \sin ( nh ) }{ nh } )^2</script><p>乍一看已经要完事了对吧!很可惜并没有,因为这个$n \to \infty$了,我们还需要证明下面这个引理:当$\sum_{ n = 1 }^\infty a_n = s$收敛的时候,那么$\lim_{ h \to 0 + } \sum_{ n = 1 }^\infty a_n ( \frac{ \sin ( nh ) }{ nh } )^2 = s$.</p>
<p>最难过的是这里的$a_n$不定号,我们可能第一反应是前部分可以让$n \to \infty$而后半部分可以直接抛掉,可在不定号的时候这一切都难以实现了.对于不定号项的求和,我们也许唯一的武器只有Abel变换.设$a_0 = 0 , b_n ( h ) = ( \frac{ \sin ( nh ) }{ nh } )^2 , b_0 ( h ) = 1 , S_n = \sum_{ k = 1 }^n a_k$.立刻得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ n = 0 }^\infty a_n b_n ( h ) & = \sum_{ n = 1 }^\infty ( S_n - S_{ n - 1 } ) b_n ( h ) \\
& = \sum_{ n = 0 }^\infty S_n ( b_n ( h ) - b_{ n + 1 } ( h ) )
\end{aligned}</script><p>既然$S_n$收敛,不妨设$| S_n | &lt; M$,下面来估计:</p>
<script type="math/tex; mode=display">
\begin{aligned}
| b_{ n + 1 } ( h ) - b_{ n } ( h ) | & = | \int_{ nh }^{ ( n + 1 ) h } ( \frac{ \sin^2 t }{ t^2 } ) ' \mathrm{ d } t | \\
& \leq \int_{ nh }^{ ( n + 1 ) h } | \frac{ 2 \sin t ( \cos t - \frac{ \sin t }{ t } ) }{ t^2 } | \mathrm{ d } t \\
\sum | b_{ n + 1 } ( h ) - b_{ n } ( h ) | & \leq \int_{ 0 }^{ + \infty } | \frac{ 2 \sin t ( \cos t - \frac{ \sin t }{ t } ) }{ t^2 } | \mathrm{ d } t \\

\end{aligned}</script><p>盯着这个积分,发现其在$0$附近极限存在(泰勒展开就能看到),而在无穷处其实就是$O ( \frac{ 1 }{ t^2 } )$,所以这个积分存在,当然有$\sum | b_{ n + 1 } ( h ) - b_{ n } ( h ) | \leq + \infty$,其实上面的过程就是在证明这个函数是有界变差的对吧!准备工作业已就绪,不妨设$\varphi_n = b_n ( h ) - b_{ n + 1 } ( h )$,请看:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& | \sum_{ n = 0 }^\infty a_n b_n ( h ) - s | \\
= & | \sum_{ n = 0 }^\infty ( s_n \varphi_n ( h ) - s \varphi_n ( h ) ) | \\
\leq & \sum_{ n = 0 }^N | S_n - s | \cdot | \varphi_n ( h ) | + \sum_{ n = N + 1 }^\infty | S_n - s | \cdot | \varphi_n ( h ) |
\end{aligned}</script><p>只要取定足够大的$N$就可以使得$| S_n - s | \to 0$,而在此时只要让$h \to 0$就可以让前半部分定死的$\varphi_n ( h ) \to 0$,于是就搞定了.</p>
<p>从而我们可以看到上述引理的确成立了,进一步地两个上极限都等于$0$,所以$F ( x )$的确是下凸函数,然而正是因为等于$0$,所以$- F ( x )$也是下凸函数,所以$F ( x )$既是上凸,又是下凸,那它必然是一个一次函数.那$a_0 = 0$就是必然的了.既然$a_0 = 0$,$F ( x )$就是一个$2 \pi$周期函数,所以它必然是常值函数.然而一个三角级数一致收敛到一个常值函数,这个三角级数本身必然是常值函数,所以$a_n = b_n = 0$,这就搞定了.</p>
<h5><span id="傅里叶级数的最佳逼近性">傅里叶级数的最佳逼近性</span></h5><p>下面我们想证明:傅里叶级数是最佳逼近,如果一个三角级数处处收敛到了一个黎曼可积函数,则这个三角级数就是这个函数的傅里叶级数.(事实上这个结论在绝对可积时也是对的,甚至可以有有限个点不收敛到它)</p>
<p>不妨设$f \in R [ - \pi , \pi ]$,有界$m \leq f \leq M$.三角级数$\frac{ a_0 }{ 2 } + \sum a_n \cos ( nx ) + b_n \sin ( nx )$逐点逼近于它本身.我们上面引入的也就是$\delta^2 F ( x_0 ) = f ( x_0 )$.</p>
<p>来引入一个引理:如果$\forall x_0 \in ( a , b ) , \delta^2 F = \lim_{ h \to + 0 } \frac{ \Delta_h^2 F }{ 4 h^2 } \in [ m , M ]$,则不加极限的情况,$\forall x_0 \in ( a + h , b - h ) , h &gt; 0 , \frac{ \Delta_h^2 F }{ 4 h^2 } \in [ m , M ]$.</p>
<p>我想这应该是平凡的,方向呼之欲出:使用介值定理.不过这里是二次函数,那我们就取定$F ( x_0 ) , F ( x_0 \pm 2 h )$三个点,过这三个点做一个二次函数.事实上这个二次函数就是$\varphi ( x ) = F ( x_0 ) + ( x - x_0 ) \frac{ F ( x_0 + 2 h ) - F ( x_0 - 2 h ) }{ 4 h } + \frac{ ( x - x_0 )^2 }{ 2 } \frac{ \Delta_h^2 F ( x_0 ) }{ 4 h^2 }$.取$g ( x ) = F ( x ) - \varphi ( x )$,则$g ( x )$会在$x_0 , x_0 \pm 2 h$取值为$0$,并且其在$( x_0 - 2 h , x_0 + 2 h )$上肯定有一个最大值$x_1$和一个最小值$x_2$,在前者的广义二阶导数$\leq 0$而后者$\geq 0$,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\delta^2 F ( x_1 ) - \frac{ \Delta_h^2 F ( x_0 ) }{ 4 h^2 } & \leq 0 \leq \delta^2 F ( x_2 ) - \frac{ \Delta_h^2 F ( x_0 ) }{ 4 h^2 } \\
m & \leq \frac{ \Delta_h^2 F ( x_0 ) }{ 4 h^2 } \leq M
\end{aligned}</script><p>现在我们就知道如何做了,回忆到:</p>
<script type="math/tex; mode=display">
\frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } = \frac{ a_0 }{ 2 } + \sum_{ n = 1 }^\infty ( a_n \cos ( nx ) + b_n \sin ( nx ) ) ( \frac{ \sin ( nh ) }{ nh } )^2</script><p>当我不取$h \to 0$的时候这个两边可是一致收敛的.那右边肯定是前边的傅里叶级数,立刻有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n ( \frac{ \sin ( nh ) }{ nh } )^2 & = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \cos ( nx ) \mathrm{ d } x \\
b_n ( \frac{ \sin ( nh ) }{ nh } )^2 & = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \sin ( nx ) \mathrm{ d } x \\

\end{aligned}</script><p>那我们自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \lim_{ h \to + 0 } a_n ( \frac{ \sin ( nh ) }{ nh } )^2 \\
& = \lim_{ h \to + 0 } \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \cos ( nx ) \mathrm{ d } x \\

\end{aligned}</script><p>然而此时$\frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \in [ m , M ]$,后面积分那个东西有界.欸,取$h = \frac{ 1 }{ n } \to 0$可以拿到一个一致有界的函数列,这不是我们控制收敛定理么,交换顺序!</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n & = \lim_{ h \to + 0 } \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \cos ( nx ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi \lim_{ h \to + 0 } \frac{ \Delta_h^2 F ( x ) }{ 4 h^2 } \cos ( nx ) \mathrm{ d } x \\
& = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( x ) \cos ( nx ) \mathrm{ d } x \\

\end{aligned}</script><p>这就证毕了.</p>
<h5><span id="傅里叶级数不逐点收敛到自身的连续周期函数">傅里叶级数不逐点收敛到自身的连续周期函数</span></h5><p>定义$C ( T )$为$2 \pi$周期连续函数组成的线性空间.此时定义$\Vert f - g \Vert = \sup | f - g |$,其实也就是Banach空间对吧.有了范数定义距离,有了距离就可以有开闭集的概念.Baire纲定理告诉我们此时可数个开稠集的交集仍然是稠密集(不过未必是开集).</p>
<p>现在考虑$f ( x )$的傅里叶级数,取$S_n ( f , x ) = \frac{ a_0 }{ 2 } + \sum_{ k = 1 }^n a_k \cos ( kx ) + b_k \sin ( kx )$,迪利克雷核的结论告诉我们$S_n ( f , x ) = \frac{ 1 }{ \pi } \int_{ - \pi }^\pi f ( t ) D_n ( x - t ) \mathrm{ d } t$,其中$D_n ( w ) = \frac{ \sin ( n + \frac{ 1 }{ 2 } ) w }{ 2 \sin \frac{ w }{ 2 } }$.</p>
<p>接下来定义$\varphi_f ( x ) = \sup_{ n \geq 1 } | S_n ( f , x ) |$,取$E_m ( x ) = \{ f \in C ( T ) | \varphi_f ( x ) &gt; m \}$.下面我们来证明:$E_m ( x )$是$C ( T )$的开稠子集.</p>
<p>是开集应该是自然的结论,因为当$n , x$定死的时候,$S_n ( f , x )$从定义看是连续地依赖于$f$.如果$f \in E_m ( x )$,则$\exists n , | S_n ( f , x ) | &gt; m$,那它周围当然有一个小邻域,使得其中的$g$都满足$| S_n ( g , x ) | &gt; m$了,所以这肯定是开集.</p>
<p>接下来得证明它是稠集,定义$g_n ( t ) = \begin{cases}1 &amp; D_n ( t ) \geq 1 \ - 1 &amp; D_n ( t ) \leq - 1 \ D_n ( t ) &amp; \text{ otherwise }\end{cases}$.此时发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \pi } \int_{ - \pi }^\pi g_n ( t ) D_n ( t ) \mathrm{ d } t \\
= & O ( 1 ) + \frac{ 1 }{ \pi } \int_{ - \pi }^\pi | D_n ( t ) | \mathrm{ d } t \\

\end{aligned}</script><p>原因是$| D_n ( t ) | \geq 1$的部分二者相等,而不同的部分在有限区间上积分不会太大.</p>
<p>然而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \frac{ 1 }{ \pi } \int_{ - \pi }^\pi | D_n ( t ) | \mathrm{ d } t \\
= & \frac{ 2 }{ \pi } \int_0^\pi | D_n ( t ) | \mathrm{ d } t \\
= & \frac{ 1 }{ \pi } \int_0^\pi | \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ 2 \sin \frac{ t }{ 2 } } | \mathrm{ d } t \\
> & \frac{ 1 }{ \pi } \int_0^\pi | \frac{ \sin ( n + \frac{ 1 }{ 2 } ) t }{ t } | \mathrm{ d } t \\
> & \frac{ 1 }{ \pi } \int_0^{ ( n + \frac{ 1 }{ 2 } ) \pi } \frac{ | \sin t | }{ t } \mathrm{ d } t \\
> & \frac{ 1 }{ \pi } \sum_{ k = 2 }^n \int_{ ( k - 1 ) \pi }^{ k \pi } \frac{ | \sin t | }{ t } \mathrm{ d } t \\
= & \sum_{ k = 2 }^n O ( 1 ) \frac{ 1 }{ k } \\
= & O ( \ln n )
\end{aligned}</script><p>接下来考虑取$h_n = \frac{ g_n }{ \sqrt{ ln n } } \to 0$,则$S_n ( h_n , x ) = O ( \sqrt{ \ln n } )$.此时设$U_{ \epsilon } ( f ) = \{ g \in C ( T ) | \Vert f - g \Vert &lt; \epsilon \}$,回忆到三角多项式可以一致逼近任何连续周期函数,所以存在三角多项式(有限项)$T \in U_{ \frac{ \epsilon }{ 2 } } ( f )$.</p>
<p>取$r_n ( x ) = T + h_n$,由于$h_n \to 0$,所以当$n$足够大的时候$r_n ( x ) = g + h_n \in U_\epsilon ( f )$.此时$S_n ( r_n , x ) = S_n ( T , x ) + S_n ( h_n , x )$,但是$T$是有限项三角多项式,所以$S_n ( r_n , x ) = O ( 1 ) + O ( \sqrt{ \ln n } ) \to \infty$.这就搞定了,那此时$r_n \in E_m ( x )$而且在$f$的邻域里.所以这个集合是稠密的.</p>
<p>接下来取$E_x = \bigcap_{ m = 1 }^\infty E_m ( x )$,容易发现$E_x$中的所有函数在$x$这一点的傅里叶级数竟然都无界,我可以干脆取$E = \bigcap_{ x \in \mathbb{ Q } } E_x$,则这里面存在一个函数,这个函数的傅里叶级数在任意有理点处发散.</p>
<p>其实还可以更牛,取$F_m ( f ) = \{ x \in \mathbb{ R } | \varphi_f ( x ) &gt; m \}$,这显然是个开集.取$F_f = \bigcap_{ n = 1 }^\infty F_n$,这就是可数个开集的交.而且从上面的论证可以发现$\mathbb{ Q } \subseteq F_f$,可是这里的$\mathbb{ Q }$是稠密的,所以$F_f$必然也是稠密的,那它就是可数个开稠集的交,有结论说可数个开稠集的交一定是不可数集合.</p>
<p>然而,还有结论说一个周期连续函数的傅里叶级数其实几乎处处收敛于本身.</p>
<h6><span id="example1">Example1</span></h6><p>设$f ( x )$是$2 \pi$周期连续函数,设$M_n = \max_{ x \in [ - \pi , \pi ] } | S_n ( x ) |$,求证:$\lim_{ n \to \infty } \frac{ M_n }{ \ln n } = 0$.</p>
<p>不妨设$M_f = \max f$,考虑$| S_n ( x ) | \leq | S_n ( x ) - f | + M_f$,而后者是个死数,除以$\ln n$后当然趋近于$0$.</p>
<p>现在只需要看前者,然而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
S_n ( x ) - f & = \frac{ 1 }{ \pi } \int_{ 0 }^\pi ( f ( x + t ) + f ( x - t ) - 2 f ( x ) ) D_n ( t ) \mathrm{ d } t \\
& = \frac{ 1 }{ \pi } \int_{ 0 }^\delta ( f ( x + t ) + f ( x - t ) - 2 f ( x ) ) D_n ( t ) \mathrm{ d } t
\end{aligned}</script><p>而回忆到$\int_0^\pi | D_n ( t ) | = O ( \ln n )$,由一致连续性前半部分显然可以决定一个$\delta$是前者$&lt; \epsilon$,这就搞定了.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%B9%B3%E9%82%91%E4%B8%80%E4%B8%AD%E9%9B%86%E8%AE%AD%E4%BD%9C%E4%B8%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%B9%B3%E9%82%91%E4%B8%80%E4%B8%AD%E9%9B%86%E8%AE%AD%E4%BD%9C%E4%B8%9A/" class="post-title-link" itemprop="url">平邑一中集训作业</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-30 14:59:17" itemprop="dateModified" datetime="2025-07-30T14:59:17+08:00">2025-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI/" itemprop="url" rel="index"><span itemprop="name">OI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%B9%B3%E9%82%91%E4%B8%80%E4%B8%AD%E9%9B%86%E8%AE%AD%E4%BD%9C%E4%B8%9A/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%B9%B3%E9%82%91%E4%B8%80%E4%B8%AD%E9%9B%86%E8%AE%AD%E4%BD%9C%E4%B8%9A/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          Here's something encrypted, password is required to continue reading.
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%B9%B3%E9%82%91%E4%B8%80%E4%B8%AD%E9%9B%86%E8%AE%AD%E4%BD%9C%E4%B8%9A/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%AD%97%E7%AC%A6%E4%B8%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="post-title-link" itemprop="url">字符串</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-30 14:42:58" itemprop="dateModified" datetime="2025-07-30T14:42:58+08:00">2025-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI/" itemprop="url" rel="index"><span itemprop="name">OI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%AD%97%E7%AC%A6%E4%B8%B2/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%AD%97%E7%AC%A6%E4%B8%B2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          Here's something encrypted, password is required to continue reading.
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%AD%97%E7%AC%A6%E4%B8%B2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B8%8E%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B8%8E%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">多项式与生成函数</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-02 14:50:28" itemprop="dateModified" datetime="2025-12-02T14:50:28+08:00">2025-12-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">具体数学</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B8%8E%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B8%8E%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h2><span id="高数基础补档">高数基础补档</span></h2><h3><span id="复数相关">复数相关</span></h3><p>棣莫弗定理:$( cos \theta + i \sin \theta )^n = \cos ( n \theta ) + i \sin ( n \theta )$.</p>
<p>欧拉公式:$e^{ i \pi } = - 1$.</p>
<p>也就是$e^{ 2 i \pi } = 1$,同时又有$e^{ i \theta } = cos \theta + i · sin \theta$,证明直接使用泰勒展开.</p>
<p>单位根:对于$x^n = 1$,我们会有$n$个根,设第$k$个根为$\omega_n^k$.那么我们有:$\omega_n^k = e^{ 2 \pi \frac{ k }{ n } i } = cos ( 2 \pi \frac{ k }{ n } ) + i · sin ( 2 \pi \frac{ k }{ n } )$.</p>
<p>单位根有以下性质:</p>
<ol>
<li><p>折半引理:$\omega_{ 2 n }^{ 2 k } = \omega_n^k \\$,由我们上面推导的通项公式即可证明.</p>
</li>
<li><p>消去引理:$\omega_n^{ k + \frac{ n }{ 2 } } = - \omega_n^k \\$,同样使用通项，运用三角恒等变换可证明.</p>
</li>
</ol>
<h4><span id="分圆多项式">分圆多项式</span></h4><p>上复平面,设$S_k = ( \cos \frac{ 2 k \pi }{ n } , \sin \frac{ 2 k \pi }{ n } )$,也就是$z_k = \cos \frac{ 2 k \pi }{ n } + i \sin \frac{ 2 k \pi }{ n }$是方程$z^n - 1 = 0$的复根.我们把这个方程写开:</p>
<script type="math/tex; mode=display">
z^n - 1 = ( z - 1 ) ( z^{ n - 1 } + z^{ n - 2 } + \cdots + 1 ) = 0</script><p>不难发现$z = 1$是平凡解.</p>
<p>我们不妨定义$f ( x ) = \prod_{ k = 1 }^n ( 1 + X^k ) = \sum_{ k \geq 0 } a_k X^k$,事实上我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{ 1 }{ n } \sum_{ j = 1 }^n f ( \omega_n^j ) & = \frac{ 1 }{ n } \sum_{ j = 1 }^n \sum_{ k \geq 0 } a_k \omega^{ kj }_n \\
& = \frac{ 1 }{ n } \sum_{ k \geq 0 } a_k \sum_{ j = 1 }^n \omega_{ n }^{ kj } \\
& = \sum_{ j \geq 0 } a_{ jn } + \frac{ 1 }{ n } \sum_{ k \geq 0 , n \nmid k } a_k \frac{ 1 - \omega^{ nj }_n }{ 1 - \omega^{ k }_n } \omega_{ n }^j \\
& = \sum_{ j \geq 0 } a_{ jn }
\end{aligned}</script><p>事实上,我们令$d = \frac{ n }{ \gcd ( j , n ) }$,容易发现$f ( \omega_n^j ) = ( \prod_{ k = 1 }^d ( 1 + \omega_n^{ kj } ) )^{ \frac{ n }{ d } }$,又容易发现$n | jd$.</p>
<p>接下来观察$X^d - 1 = \prod_{ k = 1 }^d ( X - \omega_{ n }^{ kj } )$,带入$X = - 1$得到$f ( \omega_n^j ) = \begin{cases}2^{ \frac{ n }{ d } } &amp; d \in \text{ odd } \ 0 &amp; d \in \text{ even }\end{cases}$.</p>
<p>接下来考虑拿到$\sum_{ j } a_{ jn }$,只需求$\frac{ 1 }{ n } \sum_{ j = 1 }^n f ( \omega_n^j ) = \frac{ 1 }{ n } \sum_{ d \in \text{ odd } , \gcd ( j , n ) = \frac{ n }{ d } } 2^{ \frac{ n }{ d } } = \frac{ 1 }{ n } \sum_{ d \in \text{ odd } } \varphi ( d ) 2^{ \frac{ n }{ d } }$.</p>
<h5><span id="example尺规做正n边形问题">Example(尺规做正n边形问题)</span></h5><p><del>碰瓷高斯问题.</del></p>
<p>一步一步来.根据尺规作图理论:尺规作图只可以实现$+ , - , \times , \div , \sqrt[2]{  }$五种操作.而对于正$n$边形,显然只要我们能将$\cos \frac{ 2 \pi }{ n }$用只含上述五种操作和若干整数表示出来,那就一定可行.</p>
<h6><span id="正五边形问题">正五边形问题</span></h6><p>观察正五边形在复平面上的图像,注意到有两对点互为共轭复数,我们令:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sigma_1 & = z_1 + z_4 \\
\sigma_2 & = z_2 + z_3
\end{aligned}</script><p>不难验证:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sigma_1 + \sigma_2 & = - 1 \\
\sigma_1 \sigma_2 & = - 1
\end{aligned}</script><p>可以求出复合条件的解,将$z$带入又有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sigma_1 & = 2 \cos \frac{ 2 \pi }{ 5 } \\
\sigma_2 & = 2 \cos \frac{ 4 \pi }{ 5 }
\end{aligned}</script><p>于是我们显然可以求得.</p>
<h6><span id="正七边形">正七边形</span></h6><p>类似正五边形,最后会导出三次方程:根中含有三次根号,因此不行.</p>
<h6><span id="正n边形">正n边形</span></h6><p><del>要解决正17边形,只需要解决正n边形,然后令n=17即可</del>.</p>
<p><del>你问我咋想到的下面的证明?问高斯去.</del></p>
<p>下面其实用到了ntt知识,但我懒得扔下面了.</p>
<p>先假设$n \in \mathrm{ prime }$,我们用$p$代替$n$.</p>
<p>我们有$z_1 = \cos \frac{ 2 \pi }{ p } + i \sin \frac{ 2 \pi }{ p }$,由于其它的$z$都可以表示成它的幂,因此我们记$\varepsilon = z_1$.</p>
<p>我们现在想要这么分组:</p>
<script type="math/tex; mode=display">
\sigma_{ k + 1 } = \sum_{ 1 \leq l \leq p - 1 , f ( l , k ) = 1 } \varepsilon^l</script><h3><span id="泰勒展开">泰勒展开</span></h3><p>即$f ( x ) = g ( x ) = f ( x_0 ) + \sum_{ k \geq 1 } \frac{ f^{ ( k ) } ( x_0 ) }{ k ! } ( x - x_0 )^k \\$.$x_0 = 0$的时候是麦克劳林级数.</p>
<p>麦克劳林展开是生成函数的基础,我们所谓的生成函数的封闭形式其实就是麦克劳林展开的逆运算(可能也不能完全等价,但笔者能力不够,暂且这么理解).</p>
<h2><span id="离散傅里叶变换">离散傅里叶变换</span></h2><p>考虑如何将一个交换群以一个函数(未必是同态)映射到复数,则这个东西天然对$\mathbb{C}$形成线性空间且维度为$|G|$.</p>
<p>结构定理首先给出$G\cong \mathbb{Z}_{n_1}\times \cdots\times \mathbb{Z}_{n_k}$,考虑映射$X_a(x)$,其固定一个$a:(a_1,\cdots,a_k)$,而将一个$x:(x_1,\cdots,x_k)$映射到$\omega_{n_1}^{a_1x_1}\cdots \omega_{n_k}^{a_kx_k}$.</p>
<p>现在考虑这个映射本身所组成的交换群$\{X_a\}$,容易发现以下性质:</p>
<ol>
<li>$X_aX_b=X_{a+b}$.</li>
<li>$X_a(x+y)=X_a(x)X_a(y)$.</li>
<li>$\bar X_a=X_{-a}$.</li>
<li>$X_{a}(b)=X_{b}(a)$.</li>
<li>$\sum_x X_a(x)=\begin{cases}|G|&amp;a=0\\0&amp;\text{otherwise}\end{cases}$</li>
</ol>
<p>考虑在上面的复内积$\langle X_a,X_b\rangle=\sum_x X_a(x)\bar {X_b}(x)=\sum_x X_{a-b}(x)$.这显然是一组正交基.从而任何一个$f:G\to \mathbb{C}$都可以写作$\sum \hat f(b)X_b$的形式,而且$\hat f(b)=\frac{1}{n}\langle f,X_b\rangle$,容易见到这里$\hat f(b)\in \mathbb{C}$,从而其实$\hat f$也是一个$G\to \mathbb{C}$的函数.那如果拿它来做内积会怎么样呢?请看:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_b \hat f(b)\bar{X}_a(b)&=\sum_b\sum_x \frac{1}{n}f(x)X_{-b}(x)X_{-a}(b)\\
&=\sum_b\sum_x \frac{1}{n}f(x)X_{-b}(x)X_{-b}(a)\\
&=\sum_b\sum_x \frac{1}{n}f(x)X_{-b}(a+x)\\
&=\sum_x \frac{1}{n}f(x)\sum_bX_{-(a+x)}(b)\\
&=f(-a)
\end{aligned}</script><p>于是我们见到下面两个过程:</p>
<ol>
<li>$\langle f,X_a\rangle=n \hat f(a)$.</li>
<li>$\langle\hat f,X_{-a}\rangle=f(a)$.</li>
</ol>
<p>接下来定义卷积$(f*g)(x)=\sum_{y}f(y)g(x-y)$.</p>
<p>还是应该再思考一下两者的地位,见到:</p>
<ol>
<li>$n\Vert \hat f\Vert^2=\Vert f\Vert^2$.</li>
<li>$\widehat{cf}=c\hat f$.</li>
<li>$\widehat{f+g}=\hat f+\hat g$</li>
<li>$\widehat{fg}=\hat f*\hat g$.</li>
<li>$\widehat{f*g}=n\sdot \hat f\sdot \hat g$.</li>
</ol>
<p>考虑(1),显然$\Vert f\Vert^2=n\sum_x (\hat f(x))^2$.</p>
<p>(2)(3)显然.</p>
<p>对于(4):</p>
<script type="math/tex; mode=display">
\widehat{fg}(x)=\frac{1}{n}\langle fg,X_x\rangle</script><p>对于(5):</p>
<script type="math/tex; mode=display">
\begin{aligned}
\widehat{f*g}(x)&=\frac{1}{n}\langle f*g,X_x\rangle\\
&=\frac{1}{n}\sum_{a}(f*g)(a)X_{-x}(a)\\
&=\frac{1}{n}\sum_{a}X_{-x}(a)\sum_{b}f(b)g(a-b)\\
&=\frac{1}{n}\sum_{a}\sum_{b}f(a)g(b)X_{-x}(a+b)\\
&=\frac{1}{n}\sum_{a}\sum_{b}f(a)g(b)X_{-x}(a)X_{-x}(b)\\
&=\frac{1}{n}n\hat f(x)n\hat g(x)\\
&=n \hat f(x)\hat g(x)
\end{aligned}</script><h2><span id="多项式">多项式</span></h2><h3><span id="多项式基础">多项式基础</span></h3><h4><span id="点值表示法和系数表示法">点值表示法和系数表示法</span></h4><p>代数基本定理:一个$n - 1$次方程在复数域上有且只有$n - 1$个根.</p>
<p>定理:一个$n - 1$次多项式在$n$个不同点的取值唯一确定了该多项式.</p>
<p>证明:考虑反证法,假设命题不成立,则存在两个$n - 1$次多项式$A ( x )$和$B ( x )$且有$\forall i \in [ 0 , n - 1 ] , A ( x_i ) = B ( x_i ) \\$.</p>
<p>令$C ( x ) = A ( x ) - B ( x )$,那么$C ( x )$至多是一个$n - 1$次多项式且$\forall i \in [ 0 , n - 1 ] , C ( x_i ) = 0 \\$,也就是$C ( x )$有$n$个根,与代数基本定理不符合.</p>
<p>由上面的内容,多项式有点值表示法和系数表示法两种:</p>
<p>系数表示法:$A ( x ) = \sum_{ i = 0 }^{ n - 1 } a_i x^i \\$.</p>
<p>点值表示法:$y_i = \sum_{ j = 0 }^{ n - 1 } a_j x_i^j \\$.</p>
<p>已知多项式点值表示法求系数表示法的过程被称为插值.</p>
<h4><span id="拉格朗日插值">拉格朗日插值</span></h4><p>构造多项式$\sum_{ i = 0 }^{ n - 1 } y_i ( \prod_{ j = 0 \land j \ne i }^{ n - 1 } \frac{ x - x_j }{ x_i - x_j } ) \\$.显然当$x = x_i$时,该多项式的答案为$y_i$.</p>
<p>另外,如果$x_i = i$,不难发现这个式子可以写成:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ i = 1 }^{ n } y_i ( \prod_{ j = 1 \land j \ne i }^{ n } \frac{ x - x_j }{ x_i - x_j } ) \\
\\
= & \sum_{ i = 1 }^n y_i ( \prod_{ j = 1 \land j \ne i }^n \cfrac{ x - j }{ i - j } ) \\
= & \sum_{ i = 1 }^n y_i ( - 1 )^{ n - i } ( \cfrac{ 1 }{ ( i - 1 ) ! ( n - i ) ! } \prod_{ j = 1 , j \ne i }^{ n } ( x - j ) )
\end{aligned}</script><h3><span id="多项式运算">多项式运算</span></h3><p>考虑两个多项式相乘,如果我们已知他们的点值表示法,显然可以直接相乘.</p>
<p>这为我们提供了一种思路:先将系数表示法转化为点值表示法,进行相乘之后再转化回系数表示法.</p>
<p>这引出以FFT为代表的多项式乘法,并拓展到了多种多项式运算.</p>
<h4><span id="多项式乘法">多项式乘法</span></h4><h5><span id="快速傅里叶变换fft">快速傅里叶变换(FFT)</span></h5><h6><span id="dft">DFT</span></h6><p>将$n$次单位根(默认$n$是二的整次幂,如果少了的话补零,设$n = 2^w$)分别带入$A ( x )$得到点值向量$A ( \omega_n^k ) \\$.</p>
<p>如果朴素带入,复杂度显然不可接受.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A ( x ) & = \sum_{ i = 0 }^{ n - 1 } a_i x^i \\
& = \sum_{ i = 2 k , k \in \mathbb{ N } }^{ n - 2 } a_i x^i + \sum_{ i = 2 k + 1 , k \in \mathbb{ N } }^{ n - 1 } a_i x^i \\
& = \sum_{ i = 2 k , k \in \mathbb{ N } }^{ n - 2 } a_i x^{ 2 k } + x \sum_{ i = 2 k + 1 , k \in \mathbb{ N } }^{ n - 1 } a_i x^{ 2 k } \\

\end{aligned}</script><p>令</p>
<p>A_2(x)=\sum_{i=2k+1,k\in\mathbb{N}}^{n-1}a_ix^{k}\\$, 那 么$A(x)=A_1(x^2)+xA_2(x^2)\\</p>
<p>接下来分类讨论:</p>
<p>$\forall 0 \leq k \leq \frac{ n }{ 2 } - 1 , k \in \mathbb{ N } \\$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A ( \omega_n^k ) & = A_1 ( \omega_n^{ 2 k } ) + \omega_n^k A_2 ( \omega_n^{ 2 k } ) \\

\end{aligned}</script><p>根据折半引理:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A ( \omega_n^k ) & = A_1 ( \omega_{ \frac{ n }{ 2 } }^k ) + \omega_n^k A_2 ( \omega^k_{ \frac{ n }{ 2 } } ) \\

\end{aligned}</script><p>这样我们处理完了前半部分.</p>
<p>$\forall \frac{ n }{ 2 } \leq k + \frac{ n }{ 2 } \leq n - 1 , k \in \mathbb{ N } \\$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A ( \omega_n^{ k + \frac{ n }{ 2 } } ) & = A_1 ( \omega_n^{ 2 k + n } ) + \omega_n^{ k + \frac{ n }{ 2 } } A_2 ( \omega_n^{ 2 k + n } ) \\

\end{aligned}</script><p>根据消去引理:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A ( \omega_n^{ k + \frac{ n }{ 2 } } ) & = A_1 ( \omega_{ \frac{ n }{ 2 } }^k ) - \omega_n^k A_2 ( \omega_{ \frac{ n }{ 2 } }^k ) \\

\end{aligned}</script><p>综上,我们可以递归处理$A_1$和$A_2$,然后合并得到$A$的答案,可以分治.</p>
<h6><span id="idft">IDFT</span></h6><p>设$A ( \omega_n^k ) = d_k \\$,构造多项式$F ( x ) = \sum_{ i = 0 }^{ n - 1 } d_i x^i \\$.</p>
<p>我们求出$F ( x )$的点值表示,设$c_k = F ( \omega_n^{ - k } ) \\$,也即:</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_k & = \sum_{ i = 0 }^{ n - 1 } d_i ( \omega_n^{ - k } )^i \\
& = \sum_{ i = 0 }^{ n - 1 } ( \sum_{ j = 0 }^{ n - 1 } a_j ( \omega_n^i )^j ) ( \omega_n^{ - k } )^i \\
& = \sum_{ j = 0 }^{ n - 1 } a_j \sum_{ i = 0 }^{ n - 1 } ( \omega_n^i )^{ j - k } \\

\end{aligned}</script><p>当$j = k$时,显然$\sum_{ i = 0 }^{ n - 1 } ( \omega_n^i )^{ j - k } = n \\$.</p>
<p>否则根据等比数列求和公式,$\sum_{ i = 0 }^{ n - 1 } ( \omega_n^i )^{ j - k } = \frac{ \omega^0_n [ ( \omega_n^{ j - k } )^n - 1 ] }{ \omega_n^{ j - k } - 1 } = 0 \\$.</p>
<p>所以$\sum_{ i = 0 }^{ n - 1 } ( \omega_n^i )^{ j - k } = n [ j = k ] \\$.</p>
<p>那么我们有</p>
<p>a_k=\frac{c_k}{n}\\</p>
<h6><span id="写法">写法</span></h6><p>递归写法显然.</p>
<p>递归过程中,第$k$层相当于在根据数在第$k$位的二进制数是$1$还是$0$来分类.那显然可以求出最后一层的数组,然后向上合并.</p>
<p>(没找到fft的代码,懒得写了,直接用的ntt的,注意快速幂要处理幂为负数的情况).</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init_rev</span><span class="params">(<span class="type">int</span> limit,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">rev[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;limit;++i)&#123;</span><br><span class="line">rev[i]=(rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(k<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> limit,ll *a,ll t)</span></span>&#123;<span class="comment">//DFT:t=1;IDFT:t=-1</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;limit;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(i&lt;rev[i])std::<span class="built_in">swap</span>(a[i],a[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;limit;mid=mid&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="type">int</span> n=mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line">ll wn=<span class="built_in">mpow</span>(gn,t*(mod<span class="number">-1</span>)/n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;limit;i+=n)&#123;</span><br><span class="line">ll w=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;mid;++k,w=w*wn%mod)&#123;</span><br><span class="line">ll wakn=w*a[i+k+mid]%mod;</span><br><span class="line">ll ak=a[i+k];</span><br><span class="line">a[i+k]=ak+wakn;<span class="built_in">Mod</span>(a[i+k]);</span><br><span class="line">a[i+k+mid]=ak-wakn+mod;<span class="built_in">Mod</span>(a[i+k+mid]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t==<span class="number">-1</span>)&#123;</span><br><span class="line">ll inv=<span class="built_in">mpow</span>(limit,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;limit;++i)&#123;</span><br><span class="line">a[i]=a[i]*inv%mod;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5><span id="快速数论变换ntt">快速数论变换(NTT)</span></h5><p>由于FFT中的单位根会产生精度误差,因此在膜$998244353$意义下,通常会选择NTT来进行多项式乘法.</p>
<p>NTT与FFT的运算过程基本相同,证明过程基本相同,唯一不同的是将单位根改为了原根.</p>
<p>根据上面FFT的证明过程,我们知道,设原根为$g$,$g_n = g^{ \frac{ p - 1 }{ n } } \\$,只需要证明原根满足以下条件,就可以进行变换:</p>
<ol>
<li><p>$g_n^n = g_n^0 = 1$且$\forall 0 \leq i &lt; j &lt; n , g_n^i \ne g_n^j$,证明由原根的性质.</p>
</li>
<li><p>折半引理:$g_{ 2 n }^{ 2 k } = g_{ n }^k$,证明显然.</p>
</li>
<li><p>消去引理:$g_{ n }^{ k + \frac{ n }{ 2 } } = - g^k_n \\$.由于$g^{ \frac{ p - 1 }{ 2 } } = - 1$,该结论显然成立.</p>
</li>
</ol>
<p>由上我们证明了,我们完全可以使用$g_n$代替$\omega_n$进行变换.</p>
<p>另外,注意到$998244352 = 2^{ 23 } \times 7 \times 17 \\$,而$2^{ 23 } \approx 8 \times 10^6 \\$.因而,当$n \leq 8 \times 10^6$的时候,$g_n$可以直接求出.这也是为什么大部分NTT题目都使用$998244353$作为模数的原因.</p>
<h5><span id="范德蒙德矩阵理解">范德蒙德矩阵理解</span></h5><p>范德蒙德矩阵形如:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
1 & \alpha_1 & \cdots & \alpha_1^{ n - 1 } \\
1 & \alpha_2 & \cdots & \alpha_2^{ n - 1 } \\
\vdots & \vdots & \ddots & \vdots \\
1 & \alpha_m & \cdots & \alpha_m^{ n - 1 }
\end{bmatrix} \in \mathbb{ R }^{ m \times n }</script><p>如果取单位根,我们有:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
1 & 1 & \cdots & 1 \\
1 & \omega_n^1 & \cdots & \omega_2^{ n - 1 } \\
\vdots & \vdots & \ddots & \vdots \\
1 & \omega_n^{ n - 1 } & \cdots & \omega_n^{ ( n - 1 )^2 }
\end{bmatrix} \in \mathbb{ R }^{ n \times n }</script><p>这就是我们在做FFT(一个线性变换)的时候的变换矩阵.所以我们有:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
1 & 1 & \cdots & 1 \\
1 & \omega_n^1 & \cdots & \omega_2^{ n - 1 } \\
\vdots & \vdots & \ddots & \vdots \\
1 & \omega_n^{ n - 1 } & \cdots & \omega_n^{ ( n - 1 )^2 }
\end{bmatrix}^{ - 1 } = \frac{ 1 }{ n } \begin{bmatrix}
1 & 1 & \cdots & 1 \\
1 & \omega_n^{ - 1 } & \cdots & \omega_2^{ - ( n - 1 ) } \\
\vdots & \vdots & \ddots & \vdots \\
1 & \omega_n^{ - ( n - 1 ) } & \cdots & \omega_n^{ - ( n - 1 )^2 }
\end{bmatrix}</script><h4><span id="分治fft">分治FFT</span></h4><p>给定$g ( x )$和$f ( 0 )$,求$f ( x ) = \sum_{ y = 1 }^x f ( x - y ) g ( y )$,答案对$998244353$取膜.</p>
<p>考虑分治,假如我们已经知道了$f ( x ) , x \in [ 1 , \frac{ n }{ 2 } ]$.那我们可以计算出这段部分对$f ( y ) ， y \in [ \frac{ n }{ 2 } + 1 , n ]$的贡献.</p>
<p>这显然是一个卷积的形式,我们直接计算$f$和$g$的乘积并贡献上去.</p>
<h4><span id="多项式求逆">多项式求逆</span></h4><p>对于多项式$P ( x )$,找到$Q ( x )$使得$Q ( x ) P ( x ) \equiv 1 \pmod{ x^{ n } } \\$.显然$Q ( x )$是唯一的.</p>
<p>首先不妨设$n = 2^k \\$.</p>
<p>如果我们已知$P ( x ) Q_{ k - 1 } ( x ) \equiv 1 \pmod{ x^{ 2^{ k - 1 } } } \\$,同时肯定有$P ( x ) Q_{ k } ( x ) \equiv 1 \pmod{ x^{ 2^{ k - 1 } } } \\$,相减得到$Q_k ( x ) - Q_{ k - 1 } ( x ) \equiv 0 \pmod{ x^{ 2^{ k - 1 } } } \\$.</p>
<p>两边平方:</p>
<script type="math/tex; mode=display">
\begin{aligned}
Q_k^2 ( x ) + Q^2_{ k - 1 } ( x ) - 2 Q_k ( x ) Q_{ k - 1 } ( x ) & \equiv 0 \pmod{ x^{ 2^k } } \\

\end{aligned}</script><p>两边乘一下$P ( x )$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
Q_k ( x ) - 2 Q_{ k - 1 } ( x ) + P ( x ) Q_{ k - 1 }^2 ( x ) & \equiv 0 \pmod{ x^n } \\
Q_k ( x ) & \equiv 2 Q_{ k - 1 } ( x ) - P ( x ) Q_{ k - 1 }^2 ( x ) \pmod{ x^n } \\

\end{aligned}</script><p>根据主定理，这么做复杂度是$O ( n \log_2 n )$的.</p>
<p>同时,多项式求逆可以解决上面提到的分治FFT.我们注意到分治FFT的条件等价于:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F ( x ) & \equiv F ( x ) G ( x ) + f_0 \pmod{ x^{ n + 1 } } \\
F ( x ) & = \frac{ f ( 0 ) }{ 1 - G ( x ) } \pmod{ x^{ n + 1 } }
\end{aligned}</script><p>于是可以直接做多项式求逆.</p>
<h4><span id="多项式除法">多项式除法</span></h4><p>对于$n$次多项式$F ( x )$和$m$次多项式$G ( x )$,找到$Q ( x ) , R ( x )$使得$F ( x ) = G ( x ) Q ( x ) + R ( x ) \\$.</p>
<p>考虑对于$n$次多项式$F ( x )$,令$F_R ( x ) = x^n F ( \cfrac{ 1 }{ x } )$,如果设$f_i$为其$x^i$项前的系数,不难发现$f_R ( i ) = f ( n - i )$.</p>
<p>那么我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F ( x ) & = G ( x ) Q ( x ) + R ( x ) \\
F ( \cfrac{ 1 }{ x } ) & = G ( \cfrac{ 1 }{ x } ) Q ( \cfrac{ 1 }{ x } ) + R ( \cfrac{ 1 }{ x } ) \\
x^n F ( \cfrac{ 1 }{ x } ) & = x^m G ( \cfrac{ 1 }{ x } ) x^{ n - m } Q ( \cfrac{ 1 }{ x } ) + x^{ n - m + 1 } x^{ m - 1 } R ( \cfrac{ 1 }{ x } ) \\
F_R ( x ) & = G_R ( x ) Q_R ( x ) + x^{ n - m + 1 } R_R ( x ) \\
F_R ( x ) & \equiv G_R ( x ) Q_R ( x ) \pmod{ x^{ n - m + 1 } } \\
Q_R ( x ) & \equiv F_R ( x ) G_R^{ - 1 } ( x ) \pmod{ x^{ n - m + 1 } }
\end{aligned}</script><p>于是只要做一遍多项式求逆即可求得$Q ( x )$,再做一遍相减既可以得到$R ( x )$.</p>
<h4><span id="多项式ln">多项式ln</span></h4><p>给出$n - 1$次多项式$A ( x )$,求一个多项式$B ( x )$,满足$B ( x ) \equiv \ln A ( x )$.</p>
<p>我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
B ( x ) & \equiv \ln A ( x ) \pmod{ x^n } \\
B ' ( x ) & \equiv \cfrac{ A ' ( x ) }{ A ( x ) } \pmod{ nx^{ n - 1 } } \\
B ( x ) & \equiv \int \cfrac{ A ' ( x ) }{ A ( x ) } dx \pmod{ x^n } \\

\end{aligned}</script><p>另外,考虑中间求导的过程中,其实模数也要相应发生变化,但是由于模数是从更高次变低,而最后积分的时候又要变回来,所以可以直接忽略变化.</p>
<p>定理:在模意义下当且仅当$[ x^0 ] f ( x ) = 1$的时候,$f ( x )$有对数多项式.</p>
<p>我们对最后再做一步:</p>
<script type="math/tex; mode=display">
\begin{aligned}
B ( x ) & \equiv \int_0^x \cfrac{ A ' ( t ) }{ A ( t ) } dt + B ( 0 ) \pmod{ x^n } \\

\end{aligned}</script><p>首先$B ( 0 ) = \ln A ( 0 ) = \ln a_0$,如果$a_0 \in \mathbb{ Q } \land a_0 \ne 1$,则$B ( 0 ) \notin \mathbb{ Q }$,因此不能放到模意义下,自然不存在对数多项式.</p>
<p>若$[ x^0 ] f ( x ) = 1$的时候,$B ( 0 ) = 0$,因此可以直接求出答案.</p>
<h4><span id="牛顿迭代">牛顿迭代</span></h4><p>给定多项式$G ( x )$,求一个多项式$F ( x )$满足$G ( F ( x ) ) \equiv 0 \pmod{ x^n }$.</p>
<p>首先$n = 1$的时候,也就是求$G ( F ( x ) ) \equiv 0 \pmod{ x }$.这个要根据具体题目具体分析求出.</p>
<p>假设我们已经求出了在$\bmod x^{ \lceil \frac{ n }{ 2 } \rceil }$意义下的答案$F_0 ( x )$,我们考虑在$F_0 ( x )$处做泰勒展开:</p>
<script type="math/tex; mode=display">
\begin{aligned}
G ( F ( x ) ) & = \sum_{ k = 0 }^{ + \infty } \frac{ G^{ ( k ) } ( F_0 ( x ) ) }{ k ! } ( F ( x ) - F_0 ( x ) )^k \equiv 0 \pmod{ x^n } \\

\end{aligned}</script><p>考虑$F ( x ) - F_0 ( x )$,由于$F_0 ( x ) \equiv F ( x ) \pmod{ x^{ \lceil \frac{ n }{ 2 } \rceil } }$,因此,因此$( F ( x ) - F_0 ( x ) )^2 \equiv 0 \pmod{ x^n }$.</p>
<p>于是我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ k = 0 }^{ + \infty } \frac{ G^{ ( k ) } ( F_0 ( x ) ) }{ k ! } ( F ( x ) - F_0 ( x ) )^k & \equiv 0 \pmod{ x^n } \\
G ( F_0 ( x ) ) + G ' ( F_0 ( x ) ) ( F ( x ) - F_0 ( x ) ) & \equiv 0 \pmod{ x^n } \\
F ( x ) & \equiv F_0 ( x ) - \frac{ G ( F_0 ( x ) ) }{ G ' ( F_0 ( x ) ) } \pmod{ x^n }
\end{aligned}</script><p>牛顿迭代可以用来证明多项式求逆的式子同样正确.</p>
<h4><span id="多项式开方">多项式开方</span></h4><p>给定$h ( x )$,设$g ( f ( x ) ) = f^2 ( x ) - h ( x )$,求零点.</p>
<p>根据牛顿迭代,有:</p>
<script type="math/tex; mode=display">
f ( x ) \equiv f_0 ( x ) - \frac{ f^2 ( x ) - h ( x ) }{ 2 f_0 ( x ) } \equiv \frac{ f^2 ( x ) + h ( x ) }{ 2 f_0 ( x ) } \pmod{ x^n }</script><p>还没完,用牛顿迭代前一定要求$g ( a ) \equiv 0 \pmod{ x^n }$的解,也就是$[ x^0 ] h ( x )$的开根,用二次剩余算.</p>
<h4><span id="多项式exp">多项式exp</span></h4><p>给定$h ( x )$,设$g ( f ( x ) ) = \ln f ( x ) - h ( x )$,求零点.</p>
<p>根据牛顿迭代,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( x ) & \equiv f_0 ( x ) - \frac{ \ln f_0 ( x ) - h ( x ) }{ \frac{ 1 }{ f_0 ( x ) } } \pmod{ x^n } \\
& \equiv f_0 ( x ) ( 1 - \ln f_0 ( x ) + h ( x ) ) \pmod{ x^n }
\end{aligned}</script><p>还没完,还需要求$g ( a ) \equiv 0 \pmod{ x^n }$的解,注意到存在$\exp$当且仅当$[ x^0 ] g ( x ) \equiv 0$,此时$f ( x ) \equiv 1 \pmod{ x }$.</p>
<h4><span id="多项式快速幂">多项式快速幂</span></h4><p>求$\ln$后求$\exp$即可,唯一的问题是为什么指数可以对$p$取膜.</p>
<p>我们有一个结论:</p>
<script type="math/tex; mode=display">
f ( x^p ) \equiv f ( x )^p \pmod{ p }</script><p>这个结论很简单,注意到$( a + b )^p \equiv a^p + b^p \pmod{ p }$即可.</p>
<p>而又由于$n &lt; p$,因此$f ( x )^p \equiv f ( 0 ) \pmod{ p }$,通常取$f ( 0 ) = 1$,于是就可以直接对$p$取膜.</p>
<h4><span id="多项式运算全家桶重载运算符版">多项式运算全家桶(重载运算符版)</span></h4><p>我们必须指出的一点是,虽然重载运算符很好看,但是大部分情况下还是需要指针传参.例如在这里,由于做$\exp$的时候的直接数组传参,会导致$\exp$的复杂度退化到$O ( n \log^2 n )$.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> qwq 300007</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> gn=<span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> rev[qwq];</span><br><span class="line">ll inv[qwq];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">poly</span>&#123;</span><br><span class="line">ll x[qwq];</span><br><span class="line"><span class="type">int</span> limit,k;</span><br><span class="line">&#125;a;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Mod</span><span class="params">(ll &amp;x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&gt;=mod)x-=mod;</span><br><span class="line"><span class="keyword">if</span>(x&lt;<span class="number">0</span>)x+=mod;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mpow</span><span class="params">(ll x,ll k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(k&lt;<span class="number">0</span>)k+=mod<span class="number">-1</span>;</span><br><span class="line">ll ans=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(;k;k=k&gt;&gt;<span class="number">1</span>,x=x*x%mod)&#123;</span><br><span class="line"><span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans=ans*x%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">get_inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&gt;qwq<span class="number">-7</span>)<span class="keyword">return</span> <span class="built_in">mpow</span>(x,mod<span class="number">-2</span>);</span><br><span class="line"><span class="keyword">if</span>(inv[x])<span class="keyword">return</span> inv[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> inv[x]=<span class="built_in">mpow</span>(x,mod<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init_rev</span><span class="params">(<span class="type">int</span> limit,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;limit;++i)&#123;</span><br><span class="line">rev[i]=(rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(k<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ntt</span><span class="params">(poly *a,<span class="type">int</span> t)</span></span>&#123;</span><br><span class="line"><span class="built_in">init_rev</span>((a-&gt;limit),(a-&gt;k));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(a-&gt;limit);++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(rev[i]&gt;i)std::<span class="built_in">swap</span>(a-&gt;x[i],a-&gt;x[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;(a-&gt;limit);mid=mid&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="type">int</span> n=mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line">ll wn=<span class="built_in">mpow</span>(gn,t*(mod<span class="number">-1</span>)/n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(a-&gt;limit);i+=n)&#123;</span><br><span class="line">ll w=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;mid;++k,w=w*wn%mod)&#123;</span><br><span class="line">ll wakn=w*(a-&gt;x[i+k+mid])%mod;</span><br><span class="line">ll ak=(a-&gt;x[i+k]);</span><br><span class="line">a-&gt;x[i+k]=ak+wakn;<span class="built_in">Mod</span>(a-&gt;x[i+k]);</span><br><span class="line">a-&gt;x[i+k+mid]=ak-wakn;<span class="built_in">Mod</span>(a-&gt;x[i+k+mid]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t==<span class="number">-1</span>)&#123;</span><br><span class="line">ll inv=<span class="built_in">get_inv</span>(a-&gt;limit);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a-&gt;limit;++i)&#123;</span><br><span class="line">a-&gt;x[i]=(a-&gt;x[i])*inv%mod;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> %(poly x,<span class="type">int</span> k)&#123;<span class="comment">//对x^&#123;2^k&#125;取膜</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=(<span class="number">1</span>&lt;&lt;k);i&lt;x.limit;++i)x.x[i]=<span class="number">0</span>;</span><br><span class="line">x.k=k;</span><br><span class="line">x.limit=<span class="number">1</span>&lt;&lt;k;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> +(poly x,poly y)&#123;</span><br><span class="line">x.limit=std::<span class="built_in">max</span>(x.limit,y.limit);</span><br><span class="line">x.k=std::<span class="built_in">max</span>(x.k,y.k);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.limit;++i)&#123;</span><br><span class="line">x.x[i]+=y.x[i];<span class="built_in">Mod</span>(x.x[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> -(poly x,poly y)&#123;</span><br><span class="line">x.limit=std::<span class="built_in">max</span>(x.limit,y.limit);</span><br><span class="line">x.k=std::<span class="built_in">max</span>(x.k,y.k);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.limit;++i)&#123;</span><br><span class="line">x.x[i]-=y.x[i];<span class="built_in">Mod</span>(x.x[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span>*(ll x,poly y)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;y.limit;++i)&#123;</span><br><span class="line">y.x[i]=x*y.x[i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> *(poly x,poly y)&#123;</span><br><span class="line">x.limit=std::<span class="built_in">max</span>(x.limit,y.limit)&lt;&lt;<span class="number">1</span>;</span><br><span class="line">x.k=std::<span class="built_in">max</span>(x.k,y.k)+<span class="number">1</span>;</span><br><span class="line">y.limit=x.limit;y.k=x.k;</span><br><span class="line"><span class="built_in">ntt</span>(&amp;x,<span class="number">1</span>);<span class="built_in">ntt</span>(&amp;y,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.limit;++i)&#123;</span><br><span class="line">x.x[i]=x.x[i]*y.x[i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">ntt</span>(&amp;x,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line">poly q_inv,tmp_inv;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">invpoly</span><span class="params">(poly x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(x.limit&lt;&lt;<span class="number">1</span>);++i)&#123;</span><br><span class="line">q_inv.x[i]=tmp_inv.x[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">q_inv.x[<span class="number">0</span>]=<span class="built_in">mpow</span>(x.x[<span class="number">0</span>],<span class="number">-1</span>);q_inv.limit=<span class="number">1</span>,q_inv.k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">2</span>,k=<span class="number">1</span>;lim&lt;=x.limit;lim=lim&lt;&lt;<span class="number">1</span>,++k)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;++i)&#123;</span><br><span class="line">tmp_inv.x[i]=x.x[i];</span><br><span class="line">&#125;</span><br><span class="line">tmp_inv.limit=q_inv.limit=lim;</span><br><span class="line">tmp_inv.k=q_inv.k=k;</span><br><span class="line">q_inv=<span class="number">2ll</span>*q_inv-q_inv*q_inv%k*tmp_inv%k;</span><br><span class="line">&#125;</span><br><span class="line">q_inv.limit=x.limit;q_inv.k=x.k;</span><br><span class="line"><span class="keyword">return</span> q_inv;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> /(poly x,poly y)&#123;</span><br><span class="line"><span class="type">int</span> lim=x.limit,k=x.k;</span><br><span class="line">x=x*<span class="built_in">invpoly</span>(y);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=lim;i&lt;x.limit;++i)&#123;</span><br><span class="line">x.x[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">x.limit=lim,x.k=k;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Dpoly</span><span class="params">(poly x)</span></span>&#123;<span class="comment">//求导</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;x.limit;++i)&#123;</span><br><span class="line">x.x[i<span class="number">-1</span>]=x.x[i]*i%mod;</span><br><span class="line">x.x[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Spoly</span><span class="params">(poly x)</span></span>&#123;<span class="comment">//积分</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x.limit<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)&#123;</span><br><span class="line">x.x[i+<span class="number">1</span>]=x.x[i]*<span class="built_in">get_inv</span>(i+<span class="number">1</span>)%mod;</span><br><span class="line">x.x[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">lnpoly</span><span class="params">(poly x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x.x[<span class="number">0</span>]!=<span class="number">1</span>);<span class="comment">//无解</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Spoly</span>(<span class="built_in">Dpoly</span>(x)/x);</span><br><span class="line">&#125;</span><br><span class="line">poly q_exp,tmp_exp;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">exppoly</span><span class="params">(poly x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x.x[<span class="number">0</span>]!=<span class="number">0</span>);<span class="comment">//无解</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(x.limit&lt;&lt;<span class="number">1</span>);++i)&#123;</span><br><span class="line">q_exp.x[i]=tmp_exp.x[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">q_exp.x[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">2</span>,k=<span class="number">1</span>;lim&lt;=x.limit;lim=lim&lt;&lt;<span class="number">1</span>,++k)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;++i)tmp_exp.x[i]=x.x[i];</span><br><span class="line">tmp_exp.limit=q_exp.limit=lim;</span><br><span class="line">tmp_exp.k=q_exp.k=k;</span><br><span class="line">q_exp=(q_exp+q_exp*(tmp_exp-<span class="built_in">lnpoly</span>(q_exp)))%k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> q_exp;</span><br><span class="line">&#125;</span><br><span class="line">poly q_sqrt,tmp_sqrt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">sqrtpoly</span><span class="params">(poly x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x.x[<span class="number">0</span>]!=<span class="number">1</span>);<span class="comment">//如果不是1要做二次剩余</span></span><br><span class="line">q_sqrt.x[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">2</span>,k=<span class="number">1</span>;lim&lt;=x.limit;lim=lim&lt;&lt;<span class="number">1</span>,++k)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;++i)tmp_sqrt.x[i]=x.x[i];</span><br><span class="line">tmp_sqrt.limit=q_sqrt.limit=lim;</span><br><span class="line">tmp_sqrt.k=q_sqrt.k=k;</span><br><span class="line">q_sqrt=(q_sqrt*q_sqrt%k+tmp_sqrt)/(<span class="number">2ll</span>*q_sqrt)%k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> q_sqrt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">powpoly</span><span class="params">(poly x,ll k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x.x[<span class="number">0</span>]!=<span class="number">1</span>);<span class="comment">//无解</span></span><br><span class="line">x=k*<span class="built_in">lnpoly</span>(x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">exppoly</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="集合幂级数">集合幂级数</span></h3><p>集合幂级数形如$\sum_{ i = 0 }^{ 2^n - 1 } a_i x^i$,其中二进制数$i$表示$\{ 1 , 2 , . . . , n \}$的一个子集,用$| i |$表示该子集大小,等价于对二进制使用的popcount函数.</p>
<p>下述级数如无特别说明均为集合幂级数.</p>
<h4><span id="与或卷积">与/或卷积</span></h4><p>高维前缀和:$c_i = \sum_{ j \subseteq i } a_j \\$.</p>
<p>高维后缀和:$c_i = \sum_{ j \supseteq i } a_j \\$.</p>
<p>上述过程又称快速莫比乌斯变换(FMT).</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(<span class="number">1</span>&lt;&lt;n);j++)</span><br><span class="line"><span class="keyword">if</span>(j&amp;(<span class="number">1</span>&lt;&lt;i)) a[j]+=a[j^(<span class="number">1</span>&lt;&lt;i)];<span class="comment">//高维前缀和</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(<span class="number">1</span>&lt;&lt;n);j++)</span><br><span class="line"><span class="keyword">if</span>(j&amp;(<span class="number">1</span>&lt;&lt;i)) a[j^(<span class="number">1</span>&lt;&lt;i)]+=a[j];<span class="comment">//高维后缀和</span></span><br></pre></td></tr></table></figure>
<p>或卷积:$c_i = \sum_{ j } \sum_{ k } [ j \lor k = i ] a_j b_k \\$.</p>
<p>与卷积:$c_i = \sum_{ j } \sum_{ k } [ j \land k = i ] a_j b_k \\$.</p>
<p>二者求法类似,考虑如何求$a$和$b$的或卷积:</p>
<p>引理:</p>
<p>若$j , k \subseteq i$,则$j \lor k \subseteq i$,逆命题同样成立.</p>
<p>若$j , k \supseteq i$,则$j \land k \supseteq i$,逆命题同样成立.</p>
<p>设$a , b , c$的高维前缀和分别为$A , B , C$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A_i B_i & = ( \sum_{ j \subseteq i } a_j ) ( \sum_{ k \subseteq i } b_k ) \\
& = \sum_{ j , k \subseteq i } a_i b_k \\
& = \sum_{ k \lor j \subseteq i } a_i b_k \\
& = C_i \\

\end{aligned}</script><p>现在考虑已知$C$求$c$,本质上是一个反演.注意到$\sum_{ r \subseteq p } ( - 1 )^{ | r | } = \sum_{ k = 0 }^{ | p | } C_{ | p | }^k ( - 1 )^k = [ p = 0 ] \\$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
c ( p ) & = \sum_{ q \subseteq p } [ p - q = 0 ] c ( q ) \\
& = \sum_{ q \subseteq p } \sum_{ r \subseteq ( p - q ) } ( - 1 )^{ | r | } c ( q ) \\
& = \sum_{ r \subseteq p } ( - 1 )^{ | r | } \sum_{ q \subseteq ( p - r ) } c ( q ) \\
& = \sum_{ r \subseteq p } ( - 1 )^{ r } C ( p - r ) \\
& = \sum_{ r \subseteq p } ( - 1 )^{ | p | - | r | } C ( r ) \\

\end{aligned}</script><p>于是有$c ( S ) = \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } C ( T ) \\$(实际上就是个差分的过程).</p>
<p>因而做两遍高维前缀和再反推回去即可,复杂度$O ( 2^n n )$.</p>
<p>与卷积即改为高维后缀和.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT_and</span><span class="params">(ll *a,ll t,<span class="type">int</span> limit)</span></span>&#123;<span class="comment">//FWT:t=1;IFWT:t=-1</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;limit;mid=mid&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="type">int</span> n=mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;limit;j+=n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;mid;++k)&#123;</span><br><span class="line">a[j+k]+=t*a[j+k+mid]%mod;</span><br><span class="line"><span class="built_in">Mod</span>(a[j+k]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT_or</span><span class="params">(ll *a,ll t,<span class="type">int</span> limit)</span></span>&#123;<span class="comment">//FWT:t=1;IFWT:t=-1</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;limit;mid=mid&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="type">int</span> n=mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;limit;j+=n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;mid;++k)&#123;</span><br><span class="line">a[j+k+mid]+=t*a[j+k]%mod;</span><br><span class="line"><span class="built_in">Mod</span>(a[j+k+mid]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="异或卷积">异或卷积</span></h4><p>异或卷积:$c_i = \sum_j \sum_k [ j \oplus k = i ] a_j b_k \\$.</p>
<p>引理:$( i \oplus j ) \land k = ( i \land k ) \oplus ( j \land k )$.</p>
<p>证明的话考虑如果$k = 0$,二者显然相等;当$k = 1$的时候,左右都等价于$( i \oplus j )$.</p>
<p>快速沃尔什变换(FWT):</p>
<p>定义集合幂级数$FWT ( a )$,满足$FWT ( a )_i = \sum_{ j = 0 }^{ 2^n - 1 } ( - 1 )^{ | i \land j | } a_j \\$.</p>
<p>那么有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( c )_i & = \sum_{ j = 0 }^{ 2^n - 1 } ( - 1 )^{ | i \land j | } c_j \\
& = \sum_{ j = 0 }^{ 2^n - 1 } ( - 1 )^{ | i \land j | } \sum_{ k = 0 }^{ 2^n - 1 } \sum_{ l = 0 }^{ 2^n - 1 } [ k \oplus l = j ] a_k b_l \\
& = \sum_{ k = 0 }^{ 2^n - 1 } \sum_{ l = 0 }^{ 2^n - 1 } ( - 1 )^{ | ( k \oplus l ) \land i | } a_k b_l \\
& = \sum_{ k = 0 }^{ 2^n - 1 } \sum_{ l = 0 }^{ 2^n - 1 } ( - 1 )^{ | k \land i | } a_k ( - 1 )^{ | l \land i | } b_l \\
& = FWT ( a )_i FWT ( b )_i \\

\end{aligned}</script><p>时间复杂度$O ( 2^n n )$.</p>
<p>逆运算的话考虑实现过程,反向就行.不过可以把过程中乘上的$\frac{ 1 }{ 2 }$都提出来乘到最后.</p>
<p>FMT可以看作是FWT在解决与/或卷积时的特例.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">FWT_xor</span><span class="params">(ll *a,ll t,<span class="type">int</span> limit)</span></span>&#123;<span class="comment">//FWT:t=1;IFWT:t=-1</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;limit;mid=mid&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="type">int</span> n=mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;limit;j+=n)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;mid;++k)&#123;</span><br><span class="line">ll x=a[j+k],y=a[j+k+mid];</span><br><span class="line">a[j+k]=x+y;<span class="built_in">Mod</span>(a[j+k]);</span><br><span class="line">a[j+k+mid]=x-y;<span class="built_in">Mod</span>(a[j+k+mid]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t==<span class="number">-1</span>)&#123;</span><br><span class="line">ll inv=<span class="built_in">mpow</span>(limit,mod<span class="number">-2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;limit;++i)a[i]=a[i]*inv%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="快速沃尔什变换">快速沃尔什变换</span></h4><h5><span id="线性代数角度">线性代数角度</span></h5><p>我们来重定义一下所谓的FWT.</p>
<p>首先类比FFT,我们希望存在一个线性变换$FWT$,使得</p>
<ol>
<li><p>若$c_i = \sum_{ j \oplus k } a_j b_k$,则$FWT ( c ) = FWT ( a ) FWT ( b )$.</p>
</li>
<li><p>这个线性变换是可逆的.</p>
</li>
<li><p>做这个线性变换和其逆变换的复杂度都可以接受.</p>
</li>
</ol>
<p>我们设$FWT ( A )_i = \sum_{ j } w ( i , j ) A_j$,我们想要做的就是构造一组满足上述条件的$w$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( C )_i & = FWT ( A )_i FWT ( B )_i \\
\sum_{ j } w ( i , j ) C_j & = \sum_{ j , k } w ( i , j ) w ( i , k ) A_j B_k
\end{aligned}</script><p>再考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
C & = A * B \\
C_i & = \sum_{ k \oplus l = i } A_k B_l \\
\sum_{ j } w ( i , j ) C_j & = \sum_j w ( i , j ) \sum_{ k \oplus l = j } A_k B_l \\
\sum_{ j , k } w ( i , j ) w ( i , k ) A_j B_k & = \sum_j w ( i , j ) \sum_{ k \oplus l = j } A_k B_l \\
\sum_{ j , k } w ( i , j ) w ( i , k ) A_j B_k & = \sum_{ j , k } A_j B_k w ( i , j \oplus k )
\end{aligned}</script><p>比较两边系数,有$w ( i , j ) w ( i , k ) = w ( i , j \oplus k )$.只要满足这个条件,我们就能构造出一组满足条件(1)的线性变换.如果这个线性变换对应的矩阵可逆,那么就满足了条件(2).</p>
<p>而由于$\oplus$是集合的运算,我们可以对二进制分开考虑.换句话说,如果$a = \sum_{ i = 0 } a_i 2^i , b = \sum_{ i = 0 } b_i 2^i$,那么$w ( a , b ) = \prod_{ i = 0 } w ( a_i , b_i )$一定是满足条件的.</p>
<p>这样我们就可以只求一个$2 \times 2$的线性变换矩阵就好.我们接下来将对三种常见的基础位运算($\lor , \land , xor ( \oplus )$)分别讨论这个矩阵.我们先来解决第三个问题:如何快速求出$FWT ( a )$呢?</p>
<p>考虑和FFT一样折半,令$i_0$为$i$的最高位是否是$1$,$i ‘$为$i$去掉最高位后的二进制数字,令$n = 2^m$我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( A )_i & = \sum_{ j = 0 }^{ 2^m - 1 } w ( i , j ) A_j \\
& = \sum_{ j = 0 }^{ 2^{ m - 1 } - 1 } w ( i , j ) A_j + \sum_{ j = 2^{ m - 1 } }^{ 2^m - 1 } w ( i , j ) A_j \\
& = w ( i_0 , 0 ) \sum_{ j = 0 }^{ 2^{ m - 1 } - 1 } w ( i ' , j ' ) A_j + w ( i_0 , 1 ) \sum_{ j = 2^{ m - 1 } }^{ 2^m - 1 } w ( i ' , j ' ) A_j
\end{aligned}</script><p>这样就实现了规模减半,复杂度$O ( mn )$.</p>
<p>下面我们设FWT的变换矩阵为$\begin{bmatrix}w ( 0 , 0 ) &amp; w ( 0 , 1 ) \ w ( 1 , 0 ) &amp; w ( 1 , 1 )\end{bmatrix}$.顺便一提,不难发现,最后对整体做的矩阵是这个矩阵的克罗内多积.</p>
<h6><span id="或卷积">或卷积</span></h6><p>取矩阵$\begin{bmatrix}1 &amp; 0 \ 1 &amp; 1\end{bmatrix}$.其逆矩阵为$\begin{bmatrix}1 &amp; 0 \ - 1 &amp; 1\end{bmatrix}$.</p>
<h6><span id="与卷积">与卷积</span></h6><p>取矩阵$\begin{bmatrix}1 &amp; 1 \ 0 &amp; 1\end{bmatrix}$.其逆矩阵为$\begin{bmatrix}1 &amp; - 1 \ 0 &amp; 1\end{bmatrix}$.</p>
<h6><span id="异或卷积">异或卷积</span></h6><p>取矩阵$\begin{bmatrix}1 &amp; 1 \ 1 &amp; - 1\end{bmatrix}$.其逆矩阵为$\begin{bmatrix}\frac{ 1 }{ 2 } &amp; \frac{ 1 }{ 2 } \ \frac{ 1 }{ 2 } &amp; - \frac{ 1 }{ 2 }\end{bmatrix}$.</p>
<h5><span id="生成函数角度">生成函数角度</span></h5><p>我们再从生成函数角度理解一下FWT.</p>
<p>我们重新定义幂乘法:$x^S x^T = x^{ S \oplus T }$,显然幂乘法该满足的性质它都满足.</p>
<p>观察FWT的式子:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( A )_S & = \sum_{ T = 0 }^{ 2^n - 1 } ( - 1 )^{ | S \land T | } a_T \\
IFWT ( A )_S & = \frac{ 1 }{ 2^n } FWT ( A )_S
\end{aligned}</script><p>这等价于:</p>
<script type="math/tex; mode=display">
\begin{aligned}
[ x^S ] FWT ( A ) & = \sum_{ T = 0 }^{ 2^n - 1 } ( - 1 )^{ | S \land T | } a_T \\
[ x^S ] IFWT ( A ) & = [ x^S ] \frac{ 1 }{ 2^n } FWT ( A )
\end{aligned}</script><h4><span id="子集卷积">子集卷积</span></h4><p>子集卷积:$c_i = \sum_{ j } \sum_{ k } [ j \land k = \emptyset , j \lor k = i ] a_j b_k \\$.</p>
<p>意识到该卷积与或卷积的差别在于:或卷积会多累加一些$[ j \land k \ne \emptyset ]$的答案,而$[ j \land k = \phi , j \lor k = i ] = [ | j | + | k | = | i | , j \lor k = i ] \\$.</p>
<p>因而可以将原集合按照元素个数分组做FMT,然后再$n^2$次结合,并做IFMT,最终将结果累计,复杂度$O ( 2^n n^2 )$.</p>
<h4><span id="集合占位幂级数">集合占位幂级数</span></h4><p>其实就是设$g_{ i , j } = z^i f_j$,然后做卷积(类似子集卷积).</p>
<h4><span id="example">Example</span></h4><h5><span id="example1agc034f-rng-and-xor">Example1([AGC034F] RNG and XOR)</span></h5><p>设$f_i ( n )$表示操作$n$次后第一次变成$i$的概率,$g_i ( n )$表示操作$n$次后变成$i$的概率.$F , G$分别是其生成函数.</p>
<p>注意到$G_i = F_i G_0 , F_i = \frac{ G_i }{ G_0 }$,而$F_i ‘ ( 1 )$就是期望.接下来的问题在于如何求$G$.</p>
<p>接下来涉及到的东西就很本质了,我们一开始先把$a_i \rightarrow \frac{ a_i }{ \sum a }$,然后做$A = FWT ( a )$,注意这里$A_0 = \sum a = 1$,FWT自身有很好的性质:$a = \frac{ 1 }{ 2^N } FWT ( A )$.我们做$n$次操作后得到的概率数组也就是$\frac{ 1 }{ 2^N } FWT ( A^n )$.展开FWT的式子,自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g_i ( n ) & = \sum_{ j = 0 }^{ 2^N - 1 } ( - 1 )^{ | i \land j | } A_j^n x^n \\
G_i & = \sum_{ j = 0 }^{ 2^N - 1 } ( - 1 )^{ | i \land j | } \frac{ 1 }{ 1 - A_j x } \\
F_i & = \frac{ G_i }{ G_0 } \\
F_i ' & = \frac{ G_i ' G_0 - G_0 ' G_i }{ G_0^2 } \\
& = \frac{ ( \sum_{ j = 0 }^{ 2^N - 1 } ( - 1 )^{ | i \land j | } \frac{ A_j }{ ( 1 - A_j x )^2 } ) ( \sum_{ j = 0 }^{ 2^N - 1 } \frac{ 1 }{ 1 - A_j x } ) - ( \sum_{ j = 0 }^{ 2^N - 1 } \frac{ A_j }{ ( 1 - A_j x )^2 } ) ( \sum_{ j = 0 }^{ 2^N - 1 } ( - 1 )^{ | i \land j | } \frac{ 1 }{ 1 - A_j x } ) }{ ( \sum_{ j = 0 }^{ 2^N - 1 } \frac{ 1 }{ 1 - A_j x } )^2 }
\end{aligned}</script><p><del>(我草这个式子太顶级了)</del></p>
<p>但是我们冷静一下,这个题与普通生成函数不同的地方在于,我们要求$F ‘_i ( 1 )$,因此我们直接把$x = 1$带入算一算就好.不过由于$A_0 = 1$,我们必须要解决分母为$0$的情况,解决的方法是分母乘上$( 1 - x )$,这样就消掉了$j = 0$的项,同时分子由于是减法可以抵消一下.</p>
<p>然后大概做做吧,感觉太顶级了.</p>
<h5><span id="example2qoj5089环覆盖">Example2([QOJ5089]环覆盖)</span></h5><p>合法显然当且仅当每个点度数为偶数,考虑直接拿一个二进制数将每个点度数奇偶性压起来,如果选中一条边$u \leftrightarrow v$就异或上$( 2^u + 2^v )$.最后要求这个二进制数是$0$.我们用一个二元组$( a , F )$表示在集合幂级数上异或上$a$,在多项式上乘上$F$.显然一条边是$( 0 , 1 ) + ( 2^u + 2^v , x )$.注意到这是可以定义乘法运算和标量乘法运算的,也就能做FWT,而且在做FWT的时候要么乘上$1 + x$要么乘上$1 - x$,做完FWT得到的每一个$FWT_i$一定形如$( 1 + x )^k ( 1 - x )^{ m - k }$,做IFWT的时候直接求$\frac{ 1 }{ 2^N } \sum ( 1 + x )^k ( 1 - x )^{ m - k }$即可.</p>
<p>仔细想想这个过程:有一句名言是只要看到生成函数就一定存在分配律,这里也是一样的,由于存在一种选择:选不选这条边,因此这里也就有了两种情况:$( 0 , 1 )$和$( 2^u + 2^v , x )$,分开两种情况就实现了FWT.</p>
<p>问题在于对于每个$i$求$k$,也就是对于每个$i$求有多少条边满足$| i \land ( 2^u + 2^v ) | = 1$,也就是求有多少条边一段链接在了$i$的内部,另一端连接在了外部,这个补集转化一下,做高维前缀和.</p>
<h5><span id="example3cf1034e-little-c-loves-3-iii">Example3(CF1034E Little C Loves 3 III)</span></h5><p>仍然是子集卷积,转化为$c_i = \sum_{ j } \sum_{ k } [ | j | + | k | = | i | , j \lor k = i ] a_j b_k \\$.然后我们将$a_j$乘上$4^j$,将$b_k$乘上$4^k$,最后把$c_i$除去$4^i$对$4$取膜就行.</p>
<p>还有个用到FWT的本质的矩阵做法,大概是手推矩阵然后再手推求逆.</p>
<h5><span id="example4cf1336e2-chiori-and-doll-picking">Example4(CF1336E2 Chiori and Doll Picking)</span></h5><p>先考虑easy version.首先求出线性基,如果线性基的大小$k$比较小,我们可以直接$2^k$枚举一下.而如果线性基较大,我们先消成最简线性基,然后主元位置有多少个$1$取决于选了多少个元素,其他位置共有$m - k$个,可以直接状压进状态.这样复杂度就是$O ( \min \{ 2^k , m^2 2^{ m - k } \} )$.</p>
<p>那么我们怎么优化呢?首先$k$较大的时候有点难做,我们看看能不能优化到$2^{ m - k }$.</p>
<p>考虑设$f_i^c = [ | i | = c ]$,将线性基能做出的线性空间设为$A$,$A_S = 1$当且仅当线性基能异或出$S$(最后再把那些废元素贡献到答案里).那么$popcount = c$的答案就是$IFWT ( FWT ( F ) FWT ( A ) )_0$.考虑$IFWT_0 = \frac{ 1 }{ 2^m } \sum_{ i = 0 }^{ 2^m - 1 } FWT ( F )_i FWT ( A )_i$,问题在于这个东西好像也不好做.</p>
<p>然后接下来开始一波顶级操作(下面的操作全部基于行向量+行操作):</p>
<p>引理1:$FWT ( A )$要么是$2^k$,要么是$0$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
A * A = A \times 2^k</script><p>这句是为啥呢?因为对于右边的每一个数字$x$和左边的一个数字$y$,如果它们都在线性基中,一定存在一个数字$z$满足$y \oplus z = x$,不然就是$0$.</p>
<p>于是我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( A )_i \cdot FWT ( A )_i & = FWT ( A )_i \times 2^k \\
FWT ( A )_i & = 0 \lor 2^k
\end{aligned}</script><p>引理2:$FWT ( A )_i = 2^k \Leftrightarrow \forall x , A_x \ne 0 , | i \land x | \equiv 0 \pmod{ 2 }$.</p>
<p>直接展开上面的式子,用$\sum_{ S \subseteq T } ( - 1 )^{ | S | } = [ T = \emptyset ]$.</p>
<p>引理3:$FWT ( A )$中值为$2^k$的位置构成一个线性基.</p>
<p>只需要证明封闭性就好,注意到如果$i$满足条件,$j$满足条件,一开始做FWT时我们已经注意到:$( i \oplus j ) \land x = ( i \land x ) \oplus ( j \land x )$.于是这个引理也显然成立.</p>
<p>引理4:$FWT ( A )$中值为$2^k$的位置构成的线性基的大小是$m - k$.</p>
<p>设这些位置构成的空间是$B$,$B_S = 1$当且仅当$S$在这个空间中.我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
FWT ( A ) & = B \times 2^k \\
A & = IFWT ( B ) \times 2^k
\end{aligned}</script><p>注意到$a_0 = 1$,也就是$\frac{ 2^k }{ 2^m } \sum b = 1 , \sum b = 2^{ m - k }$,这就证明了引理.</p>
<p>引理5:将$A$的线性基对应的矩阵从前往后消成最简,$B$的线性基对应的矩阵从后往前消成最简,上$A$下$B$拼成一个$m \times m$的矩阵,那么这个矩阵关于主对角线对称.</p>
<p>首先根据$rank ( A ) + rank ( B ) = k + m - k = m$可以知道主对角线一定全是$1$,然后我们任取$A$中的一个基$x$和$B$中的一个基$y$,应该有$| x \land y | \equiv 0 \pmod{ 2 }$.不难发现此时必定对称(画个图,不对称的话考虑主元对他俩的贡献就不是偶数了).</p>
<p>通过这个引理可以由$A$得知$B$长什么样.</p>
<p>引理6:$FWT ( F^c )_i$只和$| i |$有关.</p>
<p>因为$F^c_i$只和$| i |$有关,这里考虑一下对称性就可以.因此设$w_{ d }^c = FWT ( F^c )_i , | i | = d$.</p>
<p>然后注意到$w_d^c = \sum_{ i = 0 }^{ 2^m - 1 } ( - 1 )^{ | i \land ( 2^d - 1 ) | } [ | i | = c ]$.组合意义展开一下:</p>
<script type="math/tex; mode=display">
w_d^c = \sum_{ j = 0 }^{ d } ( - 1 )^{ j } \binom{ d }{ j } \binom{ m - d }{ c - j }</script><p>接下来怎么做呢?令$g_d = \sum_{ i = 0 }^{ 2^m - 1 } [ A_i = 1 ] [ | i | = d ]$,这里可以$O ( 2^{ m - k } )$,然后乘起来就行了.</p>
<p>太顶级了吧.</p>
<h5><span id="example5cf-1326f2">Example5(CF 1326F2)</span></h5><p>首先发现”如果没有边那么是$0$”这个限制太强了,如果我们能改为”如果是$0$,那么可有边可无边”的话,整个序列就会被$1$的段分成若干两两无关的链.显然这是一步或卷积,这样我们就只需要求后者.如果设$g_{ len , S }$表示长度为$len$,一段长度为$len - 1$的连续的$1$对应的集合是$S$的方案数,不难发现我们最后只需要做一个类似子集卷积的东西就行(前面的每个段会自动在后面放个$0$).</p>
<p>但是还没完,题目让我们求每一个,我们不难发现我们这样划分之后答案只取决于链的长度的可重集合,而本质不同的集合的数量很少,直接枚举就行.</p>
<h5><span id="example6qoj5019">Example6(qoj5019)</span></h5><p>首先可以类似数位dp设计一个$dp_{ i , S }$表示目前dp到了第$i$位,然后前面的$limit$是$S$.接下来分类讨论当前的最大值限制是$1$还是$0$.</p>
<p>这个题知道题解其实没什么难的,但是这个题告诉了我们:FWT作为一种线性变换,它是可以和其它线性变换一起做的,也就是说你是可以将其中的若干位做FWT,剩下若干位做其它的东西的.</p>
<h2><span id="生成函数">生成函数</span></h2><h3><span id="普通生成函数ogf">普通生成函数(OGF)</span></h3><h4><span id="概念">概念</span></h4><p>我们定义一个幂级数形如$A ( z ) = \sum_{ k \geq 0 } a_k z^k$,并使$[ z^n ] A ( z ) = a_n$.则称$A ( z )$是$\langle a_0 , a_1 , . . . \rangle$的生成函数.</p>
<h4><span id="运算">运算</span></h4><ol>
<li><p>$\alpha A ( z ) + \beta B ( z ) = \sum_{ n \geq 0 } ( \alpha f_n + \beta g_n ) z^n$.</p>
</li>
<li><p>$z^m A ( z ) = \sum_{ n \geq 0 } g_{ n } z^{ n + m } = \sum_{ n \geq m } g_{ n - m } z^n$.</p>
</li>
<li><p>$A ( cz ) = \sum_{ n \geq 0 } c^n f_n z^n$.</p>
</li>
<li><p>$A ‘ ( z ) = \sum_{ n \geq 1 } ig_i z^{ i - 1 }$.</p>
</li>
<li><p>$\int A ( z ) dz = \sum_{ n \geq 0 } \cfrac{ 1 }{ n + 1 } g_n z^{ n + 1 }$.</p>
</li>
<li><p>$A ( z ) B ( z ) = \sum_{ n \geq 0 } ( \sum_{ k = 0 }^n f_k g_{ n - k } ) z^n$.</p>
</li>
<li><p>$\cfrac{ 1 }{ 1 - z } A ( z ) = \sum_{ n \geq 0 } ( \sum_{ k = 0 }^n g_k ) z^n$.</p>
</li>
</ol>
<h4><span id="常见序列生成函数">常见序列生成函数</span></h4><ol>
<li>$\cfrac{ 1 }{ 1 - z } = \sum_{ k \geq 0 } z^k \\$,$\cfrac{ 1 }{ 1 - cz } = \sum_{ k \geq 0 } c^k z^k \\$.</li>
</ol>
<p>证明显然.</p>
<ol>
<li>$( 1 + z )^r = \sum_{ k \geq 0 } \binom{ r }{ k } z^k \\$,$( 1 - z )^r = \sum_{ k \geq 0 } ( - 1 )^k \binom{ r }{ k } z^k \\$.</li>
</ol>
<p>证明根据二项式定理.</p>
<ol>
<li>$\cfrac{ 1 }{ 1 - z^m } = \sum_{ n \geq 0 } [ n | m ] z^n \\$.</li>
</ol>
<p>证明显然.</p>
<ol>
<li>$\cfrac{ 1 }{ ( 1 - z )^{ n + 1 } } = \sum_{ k \geq 0 } \binom{ n + k }{ n } z^k , n \in \mathbb{ N } \\$,$\cfrac{ z^n }{ ( 1 - z )^{ n + 1 } } = \sum_{ k \geq 0 } \binom{ k }{ n } z^k , n \in \mathbb{ N } \\$</li>
</ol>
<p>直接使用二项式定理展开$( 1 - z )^{ - n - 1 }$,可以得到:</p>
<script type="math/tex; mode=display">
( 1 - z )^{ - n - 1 } = \sum_{ k \geq 0 } ( - 1 )^k \binom{ - n - 1 }{ k } z^k</script><p>反转上指标并使用对称恒等式得到上式.此外上式还有两个特殊形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\cfrac{ 1 }{ ( 1 - z )^2 } & = \sum_{ n \geq 0 } ( n + 1 ) z^n \\
\cfrac{ z }{ ( 1 - z )^2 } & = \sum_{ n \geq 0 } nz^n
\end{aligned}</script><p>根据$( 1 )$求导即可得到此式.</p>
<ol>
<li><p>$e^z = \sum_{ k \geq 0 } \cfrac{ z^k }{ k ! } \\$.</p>
</li>
<li><p>$\ln ( \cfrac{ 1 }{ 1 - z } ) = \sum_{ n \geq 1 } \cfrac{ 1 }{ n } z^n$.</p>
</li>
<li><p>$\ln ( 1 + z ) = \sum_{ k \geq 0 } ( - 1 )^k \cfrac{ z^{ k + 1 } }{ k + 1 } \\$.</p>
</li>
</ol>
<p>可以使用积分或泰勒展开证明.</p>
<ol>
<li>$\frac{ 1 - \sqrt{ 1 - 4 x } }{ 2 x } = \sum_{ k \geq 0 } \frac{ \binom{ 2 k }{ k } }{ k + 1 } x^k$.</li>
</ol>
<p>也即卡特兰数$C_k$的生成函数,证明考虑:</p>
<script type="math/tex; mode=display">
xC^2 + 1 = C</script><p>然后得到两个根,带入$x = 0$舍掉一个.</p>
<h3><span id="指数生成函数egf">指数生成函数(EGF)</span></h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53079223">https://zhuanlan.zhihu.com/p/53079223</a></p>
<p>序列$\{ a \}$的指数生成函数定义为形式幂级数$\hat F ( x ) = \sum a_n \frac{ x^n }{ n ! }$.注意$[ x^n ] \hat F ( x ) = a_n$.</p>
<h4><span id="基本运算">基本运算</span></h4><p>我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\hat F ( x ) \hat G ( x ) & = \sum_{ j \geq 0 } a_j \frac{ x^j }{ j ! } \sum_{ k \geq 0 } b_k \frac{ x^k }{ k ! } \\
& = \sum_{ k \geq 0 } x^k \sum_{ j = 0 }^k a_j b_{ k - j } \frac{ k ! }{ j ! ( k - j ) ! } \frac{ 1 }{ k ! } \\
& = \sum_{ k \geq 0 } \frac{ x^k }{ k ! } \sum_{ j = 0 }^k a_j b_{ k - j } \binom{ k }{ j }
\end{aligned}</script><p>即$\langle \sum_{ i = 0 }^n \binom{ n }{ i } a_i b_{ n - i } \rangle$的EFG.</p>
<p>注意到有一个特例是$x \hat F ( x )$就是$\langle \binom{ n }{ n - 1 } a_i \rangle$的EGF.</p>
<h4><span id="封闭式">封闭式</span></h4><ol>
<li>$e^x = \sum_{ k \geq 0 } \frac{ x^k }{ k ! }$</li>
</ol>
<p>直接泰勒展开就可以得到</p>
<ol>
<li>$e^{ px } = \sum_{ k \geq 0 } p^k \frac{ x^k }{ k ! }$</li>
</ol>
<p>换元后可以得到.一个经典特例是$e^{ - x } = \sum_{ k \geq 0 } ( - 1 )^k \frac{ x^k }{ k ! }$.</p>
<ol>
<li>$\frac{ e^x + e^{ - x } }{ 2 } = \sum_{ k \geq 0 } [ 2 | k ] \frac{ x^k }{ k ! }$.</li>
</ol>
<p>显然.</p>
<ol>
<li>$( 1 + x )^n = \sum_{ k \geq 0 } n^{ \underline{ k } } \frac{ x^k }{ k ! }$.</li>
</ol>
<p>做二项式定理就显然了.</p>
<ol>
<li><p>$\ln ( 1 + x ) = \sum_{ k \geq 1 } ( - 1 )^{ k - 1 } ( k - 1 ) ! \frac{ x^k }{ k ! }$.</p>
</li>
<li><p>$\ln ( 1 - x ) = \sum_{ k \geq 1 } ( k - 1 ) ! \frac{ x^k }{ k ! }$.</p>
</li>
</ol>
<p>都可以通过泰勒展开证明.</p>
<h4><span id="exp的组合意义">EXP的组合意义</span></h4><p>我们设$F_k ( n )$为$n$个有标号元素划分成$k$个非空无序集合的情况,$f_i$为$i$个元素组成一个集合的时候,其上特定组合结构的数量(就是一个一个只和$| S |$有关的定义在集合上的函数),有:</p>
<script type="math/tex; mode=display">
F_k ( n ) = \frac{ n ! }{ k ! } \sum_{ \sum_{ i = 1 }^k a_i = n } \prod_{ j = 1 }^k \frac{ f_{ a_j } }{ a_j ! }</script><p>设$\hat{ F } ( x ) = \sum_{ n \geq 0 } f_n \frac{ x^n }{ n ! }$,再设:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\hat G_k ( x ) & = \sum_{ n \geq 0 } F_k ( n ) \frac{ x^n }{ n ! } \\
& = \sum_{ n \geq 0 } x^n \frac{ 1 }{ k ! } \sum_{ \sum_{ i = 1 }^k a_i = n } \prod_{ j = 1 }^k \frac{ f_{ a_j } }{ a_j ! } \\
& = \sum_{ n \geq 0 } \frac{ 1 }{ k ! } \sum_{ \sum_{ i = 1 }^k a_i = n } \prod_{ j = 1 }^k \frac{ f_{ a_j } x^{ a_j } }{ a_j ! } \\
& = \frac{ 1 }{ k ! } \hat F^k ( x )
\end{aligned}</script><script type="math/tex; mode=display">
\sum_{ k \geq 0 } \hat G_k ( x ) = \exp \hat F ( x )</script><p>或者直接递推:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F_k ( x ) & = \sum_{ i = 1 }^{ n - k + 1 } \binom{ n }{ i } F_{ k - 1 } ( n - i ) f_i \frac{ 1 }{ k } \\

\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
\hat G_k ( x ) & = \sum_{ n \geq 0 } \frac{ x^n }{ n ! } F_k ( n ) \\
& = \sum_{ n \geq 0 } \frac{ x^n }{ n ! } \sum_{ i = 1 }^{ n - k + 1 } \binom{ n }{ i } F_{ k - 1 } ( n - i ) f_i \frac{ 1 }{ k } \\
& = \frac{ 1 }{ k } \sum_{ n \geq 0 } \frac{ x^n }{ n ! } \sum_{ i = 1 }^{ n - k + 1 } \binom{ n }{ i } F_{ k - 1 } ( n - i ) f_i \\
& = \frac{ 1 }{ k } \hat G_{ k - 1 } ( x ) \hat F ( x ) \\
& = \frac{ 1 }{ k ! } \hat F^k ( x )
\end{aligned}</script><p>简而言之,$[ x^n ] \hat F ( x )$是将$n$个有标号的元素放到同一个无序集合的方案数,而$[ x^n ] \exp \hat F ( x )$是将$n$个有标号的元素分成若干个无编号的非空无序集合的方案数.</p>
<h4><span id="example">Example</span></h4><h5><span id="example1poj3734">Example1(POJ3734)</span></h5><p>对于红黄色砖块,其选取方案为$\{ 1 , 0 , 1 , 0 , \cdots \}$,对应的EGF是$\frac{ e^x + e^{ - x } }{ 2 }$.</p>
<p>对于蓝绿色砖块,选取方案是$e^x$.</p>
<p>乘起来有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\hat F ( x ) & = ( \frac{ e^x + e^{ - x } }{ 2 } )^2 e^{ 2 x } \\
& = \frac{ ( e^{ 2 x } + 2 + e^{ - 2 x } ) e^{ 2 x } }{ 4 } \\
& = \frac{ e^{ 4 x } + 2 e^{ 2 x } + 1 }{ 4 } \\
& = \frac{ 1 }{ 4 } + \sum_{ k \geq 0 } \frac{ 4^i + 2^{ i + 1 } }{ 4 } \frac{ x^i }{ i ! }
\end{aligned}</script><p>于是有$[ x^n ] \hat F ( x ) = 4^{ n - 1 } + 2^{ n - 1 }$.</p>
<h5><span id="example2圆排列">Example2(圆排列)</span></h5><p>长度为$n$的排列数的指数生成函数是$\hat P ( x ) = \sum_{ n \geq 0 } \frac{ n ! x^n }{ n ! } = \frac{ 1 }{ 1 - x }$.</p>
<p>长度为$n$的圆排列的指数生成函数是$\hat Q ( x ) = \sum_{ n \geq 0 } \frac{ ( n - 1 ) ! x^n }{ n ! } = \frac{ x^n }{ n } = - \ln ( 1 - x ) = \ln \frac{ 1 }{ 1 - x }$.</p>
<p>于是有$\exp \hat Q ( x ) = \hat P ( x )$.</p>
<p>这个怎么理解呢?考虑一个排列可以分成若干个置换环,而一个集合能形成的置换环数量显然就是圆排列.</p>
<h5><span id="example3错排数">Example3(错排数)</span></h5><p>从置换环的角度考虑,错排是指置换环中不存在自环的排列,也就是说不存在长度为$1$的置换环,其EGF显然是$\sum_{ n \geq 2 } \frac{ x^n }{ n } = - \ln ( 1 - x ) - x$,错排数的EGF对其取$\exp$即可.</p>
<h5><span id="example4点带编号无向连通图计数">Example4(点带编号无向连通图计数)</span></h5><p>考虑如果$n$个点带编号的无向连通图的EGF是$\hat F ( x )$,那么$n$个点带标号无向图的EGF就是$\exp \hat F ( x )$,后者直接计数,前者对后者做一次$\ln$就好.</p>
<h5><span id="example5不动点计数">Example5(不动点计数)</span></h5><p>求有多少个映射$f : \{ 1 , 2 , \cdots , n \} \mapsto \{ 1 , 2 , \cdots , n \}$满足$f \circ f \circ \cdots \circ f$(共$k$个$f$)$= f \circ f \circ \cdots \circ f$(共$k - 1$个$f$).</p>
<p>考虑将$i \rightarrow f_i$,这等价于对深度不超过$k$的基环树(环的长度为$1$)计数,等价于对深度不超过$k$的有根树计数.注意到删去根节点后等价于对深度不超过$k - 1$的有根树计数,因此$\hat F_k ( x ) = x \exp \hat F_{ k - 1 } ( x )$.</p>
<h5><span id="example6cf891elust">Example6([CF891E]Lust)</span></h5><p>假设$k$次操作后$a_i$减少了$b_i$,实际上要求的就是$\prod_{ i = 1 }^n a_i - \prod_{ i = 1 }^n ( a_i - b_i )$.</p>
<p>考虑对所有情况下的$\prod_{ i = 1 }^n ( a_i - b_i )$求和,注意到$k$次操作,使得$i$出现$b_i$次的方案数是$\frac{ k ! }{ \prod_{ i = 1 }^n b_i ! }$.直接设$a_j$的EGF是</p>
<script type="math/tex; mode=display">
\begin{aligned}
\hat F_{ j } ( x ) & = \sum_{ i \geq 0 } ( a_j - i ) \frac{ x^i }{ i ! } \\
& = \sum_{ i \geq 0 } a_j \frac{ x^i }{ i ! } - \sum_{ i \geq 1 } \frac{ x^i }{ ( i - 1 ) ! } \\
& = a_j e^x - xe^x = ( a_j - x ) e^x
\end{aligned}</script><p>答案就是$[ x^k ] \prod_{ j = 1 }^n \hat F_j ( x )$.</p>
<h5><span id="example7">Example7</span></h5><h3><span id="狄利克雷生成函数dgf">狄利克雷生成函数(DGF)</span></h3><p>对于序列$f_n$,定义其DGF为$\tilde{ F } ( x ) = \sum_{ i \geq 1 } \frac{ f_i }{ i^x }$.注意到若$f$是积性函数,那么$\tilde{ F } ( x ) = \prod_{ p \in \mathrm{ prime } } \sum_{ i \geq 0 } \frac{ f_{ p^i } }{ p^{ ix } } \\$.</p>
<h4><span id="基本运算">基本运算</span></h4><p>对于两个序列$f , g$,其DGF之积对应的是两者的狄利克雷卷积序列的DGF:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\tilde{ F } ( x ) \tilde{ G } ( x ) & = \sum_{ i } \sum_{ j } \frac{ f ( i ) g ( j ) }{ ( ij )^x } \\
& = \sum_{ i } \frac{ 1 }{ i^x } \sum_{ d | i } f ( d ) g ( \frac{ i }{ d } )
\end{aligned}</script><h4><span id="封闭式">封闭式</span></h4><ol>
<li>$\epsilon ( x ) = [ x = 1 ]$.</li>
</ol>
<p>显然为$\tilde{ E } ( x ) = 1$.</p>
<ol>
<li>$I ( x ) = 1$.</li>
</ol>
<p>其封闭式是黎曼函数$\zeta ( x )$,事实上,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\zeta ( x ) & = \prod_{ i \geq 1 } \frac{ 1 }{ i^x } \\
& = \prod_{ p \in \mathrm{ prime } } \sum_{ i \geq 0 } \frac{ 1 }{ p^{ ix } } \\
& = \prod_{ p \in \mathrm{ prime } } \frac{ 1 }{ 1 - p^{ - x } }
\end{aligned}</script><ol>
<li>$\mu ( n )$.</li>
</ol>
<p>其DGF为$\tilde{ M } ( x ) = \prod_{ p \in \mathrm{ prime } } ( 1 - p^{ - x } )$.注意到$\zeta ( x ) \tilde{ M } ( x ) = 1 , \tilde{ M } ( x ) = \frac{ 1 }{ \zeta ( x ) }$.</p>
<ol>
<li>$id ( n ) = n$.</li>
</ol>
<p>有$\tilde{ ID } ( n ) = \prod_{ i \geq 1 } \frac{ i }{ i^x } = \prod_{ i \geq 1 } \frac{ 1 }{ i^{ x - 1 } } = \zeta ( x - 1 )$.</p>
<ol>
<li>$I_k ( n ) = n^k$.</li>
</ol>
<script type="math/tex; mode=display">
\tilde{ I_k } ( x ) = \prod_{ i \geq 1 } \frac{ 1 }{ i^{ x - k } } = \zeta ( x - k )</script><ol>
<li>$\varphi ( n )$.</li>
</ol>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\tilde{ \Phi } ( x ) & = \prod_{ p \in \mathrm{ prime } } ( 1 + \frac{ p - 1 }{ p^x } + \frac{ p ( p - 1 ) }{ p^{ 2 x } } + \cdots ) \\
& = \prod_{ p \in \mathrm{ prime } } \frac{ 1 - p^{ - x } }{ 1 - p^{ 1 - x } } \\
& = \tilde{ \Phi } ( x ) = \frac{ \zeta ( x - 1 ) }{ \zeta ( x ) }
\end{aligned}</script><p>也注意到$\tilde{ \Phi } ( x ) I ( x ) = \zeta ( x - 1 ) = \tilde{ ID } ( x )$.</p>
<ol>
<li>$\sigma_k ( n ) = \sum_{ d | n } d^k$.</li>
</ol>
<p>注意到$\sigma_k ( n ) = I_k ( n ) * I_0 ( n )$,也就是说$\tilde{ S } ( x ) = \zeta ( x - k ) \zeta ( x )$.</p>
<ol>
<li>$u ( n ) = | \mu ( n ) |$.</li>
</ol>
<p>$\tilde{ u } ( n ) = \frac{ \zeta ( n ) }{ \zeta ( 2 n ) }$.</p>
<h4><span id="example">Example</span></h4><h5><span id="example1luogup3768">Example1(luoguP3768)</span></h5><p>考虑对于$f ( n ) = n^2 \varphi ( n )$构造积性函数$g ( n ) , h ( n )$使得$f * g = h$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\tilde{ F } ( x ) & = \prod_{ p \in \mathrm{ prime } } ( 1 + \sum_{ k \geq 1 } \frac{ p^{ 3 k - 1 } ( p - 1 ) }{ p^{ kx } } ) \\
& = \prod_{ p \in \mathrm{ prime } } \frac{ 1 - p^{ 2 - x } }{ 1 - p^{ 3 - x } } = \frac{ \zeta ( x - 3 ) }{ \zeta ( x - 2 ) }
\end{aligned}</script><p>也就是$f * I_2 = I_3$.</p>
<h3><span id="阶乘的扩展定义">阶乘的扩展定义</span></h3><p>对于复数的阶乘,我们通常定义:</p>
<script type="math/tex; mode=display">
\cfrac{ 1 }{ z ! } = \lim_{ n \rightarrow + \infin } \binom{ n + z }{ z } n^{ - z }</script><p>同时我们定义$\Gamma ( z + 1 ) = z !$,有:$( - z ) ! \Gamma ( z ) = \cfrac{ \pi }{ \sin ( \pi z ) }$.</p>
<p>这样我们还可以定义广义阶乘幂:</p>
<script type="math/tex; mode=display">
\begin{aligned}
z^{ \underline{ w } } & = \cfrac{ z ! }{ ( z - w ) ! } \\
z^{ \overline{ w } } & = \cfrac{ \Gamma ( z + w ) }{ \Gamma ( z ) }
\end{aligned}</script><p>通过以上我们还可以有二项式系数的定义:</p>
<script type="math/tex; mode=display">
\binom{ z }{ w } = \lim_{ \zeta \rightarrow z , \omega \rightarrow w } \cfrac{ \zeta ! }{ \omega ! ( \zeta - \omega ) ! }</script><h3><span id="超几何级数">超几何级数</span></h3><h4><span id="超几何函数">超几何函数</span></h4><p>我们定义超几何函数$F ( a_1 , . . . , a_m ; b_1 , . . . b_n ; z ) = F \left ( \begin{array}{ r | } a_1 , . . . , a_m \ b_1 , . . . , b_n\end{array} z \right ) = \sum_{ k \geq 0 } \cfrac{ z^k \prod_{ i = 1 }^m a_i^{ \overline{ k } } }{ k ! \prod_{ i = 1 }^n b_i^{ \overline{ k } } }$.</p>
<p>许多生成函数都可以写成超几何函数的形式.</p>
<p>值得一提的是,如果我们直接定义类似$\cfrac{ 0 }{ 0 } = 1$之类的式子,可以发现当$z = 0$时任意超几何函数总是$= 1$.</p>
<p>值得一提的是,我们通常直接忽略超几何函数中的任何特殊情况,例如分母为$0$或者哪里出现了正无穷.如同生成函数中我们不关心式子带入一个数后是否收敛而只关心是否两边存在一种对应的转化.如果你想去探究超几何函数中的各种情况,那请去翻那本巨大的、黑糊糊的、作者默认你精通高等数学的、你在第五章看到的恒等式作者在第七章才给出证明的《具体数学》,而不是看我这个弱智写的笔记.笔者看这一段的时候已经被作者的”严谨”态度整疯了.该证明的一拖再拖不该证明的可以一句话带过的逼逼逼逼.仿佛这本书就是写给那些已经会了所有东西只是来使自己已经学会的东西更加体系化的以及拿来查阅各种恒等式的工具书.</p>
<h4><span id="特殊的超几何函数">特殊的超几何函数</span></h4><h5><span id="合流超几何函数">合流超几何函数</span></h5><p>我们通常把形如$M ( a ; b ; z ) = F \left ( \begin{array}{ r | } a \ b\end{array} z \right ) = \sum_{ k \geq 0 } \cfrac{ z^k a^{ \overline{ k } } }{ b^{ \overline{ k } } k ! }$的函数称为合流超几何函数.</p>
<p>不难发现我们有:</p>
<script type="math/tex; mode=display">
F \left ( \begin{array}
{ r | } 1 \\
1
\end{array} z \right ) = e^z</script><p>也即常见生成函数中的$( 6 )$.</p>
<h5><span id="高斯超几何函数">高斯超几何函数</span></h5><p>我们把形如$F \left ( \begin{array}{ r | } a , b \ c\end{array} z \right ) = \sum_{ k \geq 0 } \cfrac{ z^k a^{ \overline{ k } } b^{ \overline{ k } } }{ c^{ \overline{ k } } k ! }$的函数称为高斯超几何函数.</p>
<p>下面是几种常见的高斯超几何函数形式:</p>
<ol>
<li>$F \left ( \begin{array}{ r | } 1 , 1 \ 1\end{array} z \right ) = \cfrac{ 1 }{ 1 - z }$.</li>
</ol>
<p>即常见生成函数$( 1 )$.</p>
<ol>
<li>$F \left ( \begin{array}{ r | } - a , 1 \ 1\end{array} - z \right ) = ( 1 + z )^a$.</li>
</ol>
<p>即常见生成函数$( 2 )$.</p>
<ol>
<li>$F \left ( \begin{array}{ r | } a , 1 \ 1\end{array} z \right ) = \cfrac{ 1 }{ ( 1 - z )^a }$.</li>
</ol>
<p>即常见生成函数$( 4 )$.</p>
<ol>
<li>$F \left ( \begin{array}{ r | } 1 , 1 \ 2\end{array} - z \right ) = \cfrac{ \ln ( 1 + z ) }{ z }$.</li>
</ol>
<p>即常见生成函数$( 7 )$.</p>
<h4><span id="超几何级数的应用">超几何级数的应用</span></h4><p>我们先考虑改写超几何级数的形式:</p>
<p>$F \left ( \begin{array}{ r | } a_1 , . . . , a_m \ b_1 , . . . , b_n\end{array} z \right ) = \sum_{ k \geq 0 } t_k , t_k = \cfrac{ z^k \prod_{ i = 1 }^m a_i^{ \overline{ k } } }{ k ! \prod_{ i = 1 }^n b_i^{ \overline{ k } } }$.</p>
<p>不难发现$t_0 = 1$,而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\cfrac{ t_{ k + 1 } }{ t_k } & = \cfrac{ z^{ k + 1 } }{ z^k } \cfrac{ k ! }{ ( k + 1 ) ! } \cfrac{ \prod_{ i = 1 }^m a_i^{ \overline{ k + 1 } } }{ \prod_{ i = 1 }^m a_i^{ \overline{ k } } } \cfrac{ \prod_{ i = 1 }^n b_i^{ \overline{ k } } }{ \prod_{ i = 1 }^n b_i^{ \overline{ k + 1 } } } \\
& = \cfrac{ \prod_{ i = 1 }^m ( k + a_i ) }{ \prod_{ i = 1 }^n ( k + b_i ) } \cfrac{ z }{ k + 1 }
\end{aligned}</script><p>换句话说,$\cfrac{ t_{ k + 1 } }{ t_k }$是关于$k$的一个有理函数.而根据代数基本定理,任意$k$的有理函数在$\mathbb{ C }$内都可以分解为以上的形式(如果缺少$k + 1$项则需要上下同时乘以$k + 1$以补上).</p>
<p>换句话说,对于一个无穷级数$\sum_{ k \geq 0 } t_k$,我们先将$\cfrac{ t_{ k + 1 } }{ t_k }$表示回超几何函数,设为$F$.</p>
<p>那么有:$\sum_{ k \geq 0 } t_k = t_0 F$.</p>
<p>好,接下来请把脑子扔了,不要纠结某一个公式按理来说只能作用于正整数而在这里直接将它套在了复数域上.你只需要知道数学家非常厉害通过扩展一些东西的定义(大部分是阶乘和$\Gamma$函数的定义)来使这些公式全部成立.But who cares,只要我们能用就行了.我又不是数竞人,这些麻烦的要死我直观上根本无法接受的定义交给数竞老哥证明得了.反正信竞更多依赖离散数学,大不了我们直接默认所有的数都是自然数.</p>
<h5><span id="example">Example</span></h5><p>求证:$\sum_{ k \leq n } \binom{ r + k }{ k } = \binom{ r + n + 1 }{ n } \Leftrightarrow F \left ( \begin{array}{ r | } 1 , - n \ - n - r\end{array} 1 \right ) = \cfrac{ r + n + 1 }{ r + 1 } , n \in \mathbb{ N } \\$.</p>
<p>首先考虑:</p>
<script type="math/tex; mode=display">
\sum_{ k \leq n } \binom{ r + k }{ k } = \sum_{ k \geq 0 } \binom{ r + n - k }{ n - k }</script><p>有了这个无穷级数,我们可以直接将二项式系数用阶乘形式展开,于是得到:</p>
<script type="math/tex; mode=display">
\binom{ r + n }{ n } F \left ( \begin{array}
{ r | } 1 , - n \\
- n - r
\end{array} 1 \right ) = \binom{ r + n + 1 }{ n }</script><p>两边同时除以$\binom{ r + n }{ n }$得到上式.</p>
<h5><span id="二项式系数与超几何函数">二项式系数与超几何函数</span></h5><p>通过范德蒙德卷积,不难验证:</p>
<script type="math/tex; mode=display">
F \left ( \begin{array}
{ r | } a , b \\
c
\end{array} 1 \right ) = \cfrac{ \Gamma ( c - a - b ) \Gamma ( c ) }{ \Gamma ( c - a ) \Gamma ( c - b ) } , - b \in \mathbb{ N }</script><p>这个公式的一个特例是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F \left ( \begin{array}
{ r | } a , - n \\
c
\end{array} 1 \right ) & = \cfrac{ ( c - a )^{ \overline{ n } } }{ c^{ \overline{ n } } } = \cfrac{ ( a - c )^{ \underline{ n } } }{ ( - c )^{ \underline{ n } } } , n \in \mathbb{ N } \\
\sum_{ k \geq 0 } \cfrac{ a^{ \overline{ k } } ( - n )^{ \overline{ k } } }{ c^{ \overline{ k } } k ! } & = \cfrac{ ( c - a )^{ \overline{ n } } }{ c^{ \overline{ n } } } = \cfrac{ ( a - c )^{ \underline{ n } } }{ ( - c )^{ \underline{ n } } } , n \in \mathbb{ N } \\

\end{aligned}</script><p>这个公式几乎囊括了所有的基本二项式求和公式:上指标求和,平行求和,范德蒙德卷积……几乎只要是我们推出的由两个及以下项的乘积求和的二项式系数相关的式子都可以使用这个式子.</p>
<p>那么如果我们要三项相乘或更多,我们有Saalschütz恒等式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
F \left ( \begin{array}
{ r | } a , b , - n \\
c , a + b - n - c + 1
\end{array} 1 \right ) & = \cfrac{ ( c - a )^{ \overline{ n } } ( c - b )^{ \overline{ n } } }{ c^{ \overline{ n } } ( c - a - b )^{ \overline{ n } } } = \cfrac{ ( a - c )^{ \underline{ n } } ( b - c )^{ \underline{ n } } }{ ( - c )^{ \underline{ n } } ( a + b - c )^{ \overline{ n } } } , n \in \mathbb{ N } \\

\end{aligned}</script><p>事实上,《具体数学》上给出了大量的超几何级数的应用以及各种技巧,但是笔者的智商已经理解不了接下来的内容了.考虑到大部分时候上述两个超几何级数恒等式已经足够解决绝大部分问题,如果考到更加困难的求和技巧,笔者相信别人也不会做,于是笔者决定摆烂.</p>
<h3><span id="求微分方程">求微分方程</span></h3><h4><span id="example1luogu4931">Example1(luogu4931)</span></h4><p>二项式反演:</p>
<script type="math/tex; mode=display">
\begin{aligned}
ans_k & = \sum_{ i = k }^n ( - 1 )^{ i - k } \binom{ i }{ k } \binom{ n }{ i } \binom{ n }{ i } i ! ( 2 n - 2 i ) ! 2^i \\
& = \sum_{ i = k }^n ( - 1 )^{ i - k } \frac{ 1 }{ k ! ( i - k ) ! } \frac{ n ! }{ ( n - i ) ! } \frac{ n ! }{ ( n - i ) ! } ( 2 n - 2 i ) ! 2^i \\
& = ( n ! )^2 \frac{ 2^k }{ k ! } \sum_{ i = k }^n ( - 1 )^{ i - k } \frac{ 1 }{ ( i - k ) ! } \binom{ 2 n - 2 i }{ n - i } 2^{ i - k } \\
& = ( n ! )^2 \frac{ 2^k }{ k ! } \sum_{ i = 0 }^{ n } \frac{ ( - 2 )^{ i } }{ i ! } \binom{ 2 n - 2 i }{ n - i }
\end{aligned}</script><p>注意到后者只与$n - k$有关,不妨设其为$f_{ n } = \sum_{ i = 0 }^{ n } \frac{ ( - 2 )^{ i } }{ i ! } \binom{ 2 n - 2 i }{ n - i }$,预处理一下就可以做到$O ( n^2 + nT )$.</p>
<p>加强版咋做?我们继续看看式子:</p>
<script type="math/tex; mode=display">
\begin{aligned}
ans & = ( n ! )^2 \frac{ 2^k }{ k ! } f_{ n - k } \\
f_{ n } & = \sum_{ i = 0 }^{ n } \frac{ ( - 2 )^{ i } }{ i ! } \binom{ 2 n - 2 i }{ n - i }
\end{aligned}</script><p>注意到$f$是一个卷积的形式,设其生成函数为$F_n$,$g_n = \frac{ ( - 2 )^n }{ n ! } , h_n = \binom{ 2 n }{ n }$,我们自然有$F = GH$.</p>
<p>考虑$G$和$H$的生成函数形式,先看$G$,显然用泰勒展开:</p>
<script type="math/tex; mode=display">
G = \sum_{ n \geq 0 } \frac{ ( - 2 x )^n }{ n ! } = e^{ - 2 x }</script><p>再看$H$,是卡特兰数的生成函数,有:</p>
<script type="math/tex; mode=display">
H = \frac{ 1 }{ \sqrt{ 1 - 4 x } }</script><p>这下简单了,答案是:</p>
<script type="math/tex; mode=display">
( n ! )^2 \frac{ 2^k }{ k ! } [ x^{ n - k } ] \frac{ e^{ - 2 x } }{ \sqrt{ 1 - 4 x } }</script><p>现在看$F$,平方一下有:</p>
<script type="math/tex; mode=display">
( 1 - 4 x ) F^2 = e^{ - 4 x }</script><p>两边求导:</p>
<script type="math/tex; mode=display">
\begin{aligned}
- 4 F^2 + ( 1 - 4 x ) 2 F \times F ' & = - 4 e^{ - 4 x } \\
- 4 F^2 + ( 1 - 4 x ) 2 F \times F ' & = - 4 ( 1 - 4 x ) F^2 \\
( 2 - 8 x ) F ' & = 16 xF \\

\end{aligned}</script><p>得到了一个线性递推形式,更进一步地:</p>
<script type="math/tex; mode=display">
\begin{aligned}
2 ( i + 1 ) f_{ i + 1 } - 8 if_i & = 16 f_{ i - 1 } \\
if_i & = 4 ( i - 1 ) f_{ i - 1 } + 8 f_{ i - 2 }
\end{aligned}</script><p>技术总结一下:其实就是你想要得到一个递推式,然后注意到这玩意要写成微分方程的形式,所以开始往那边凑.</p>
<h3><span id="生成函数的应用">生成函数的应用</span></h3><h4><span id="求解递归关系">求解递归关系</span></h4><p>我们假设已经有了$R ( z ) = \sum_{ k \geq 0 } g_k z^k$,并且$R ( z ) = \cfrac{ P ( z ) }{ Q ( z ) }$,其中$P ( z )$和$Q ( z )$都是多项式,我们想要找到一种方式求解$[ z^n ] R ( z )$.</p>
<p>考虑有理函数$S ( z ) = \sum_{ k = 1 }^m \cfrac{ a_k }{ 1 - \rho_k z } \\$,不难发现$[ z^n ] S ( z ) = \sum_{ k = 1 }^m a_k \rho_k^n \\$.</p>
<p>那么可以证明,只要$Q ( z ) = 0$无重根并且无零根,那么就存在一组系数满足$S ( z ) = R ( z )$.</p>
<p>我们这么定义”反射”运算,若$Q ( z ) = \sum_{ k = 0 }^m q_k z^k \\$,则其反射多项式为$Q^R ( z ) = \sum_{ k = 0 }^m q_k z^{ m - k } \\$.</p>
<p>若$Q ( z ) = q_0 \prod_{ k = 1 }^m ( 1 - \rho_k z )$,则显然有$Q^R ( z ) = q_0 \prod_{ k = 1 }^m ( z - \rho_k ) \\$.</p>
<p>那么显然这里求出来的这组数$\rho$就是$S ( z )$中的那组$\rho$.</p>
<p>而我们有$a_k = \cfrac{ - \rho_k P ( \cfrac{ 1 }{ \rho_k } ) }{ Q ‘ ( \rho_k ) }$.</p>
<h4><span id="example1">Example1</span></h4><p>已知$n ! = \sum_{ k } \binom{ n }{ k } g_{ n - k } , n \in \mathbb{ N } \\$,求$g_n$.</p>
<p>首先两边同时除以$n !$并将组合数用阶乘形式展开,我们有:</p>
<script type="math/tex; mode=display">
1 = \sum_{ k } \cfrac{ g_{ n - k } }{ k ! ( n - k ) ! } .</script><p>如果我们令$D ( z ) = \sum_{ k \geq 0 } \cfrac{ g_{ k } }{ k ! } z^k$,则有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\cfrac{ 1 }{ 1 - z } & = e^z D ( z ) \\
D ( z ) & = \cfrac{ 1 }{ 1 - z } e^{ - z } \\
D ( z ) & = ( \sum_{ k \geq 0 } z^k ) ( \sum_{ k \geq 0 } ( - 1 )^k \cfrac{ z^k }{ k ! } ) \\
[ z^n ] D ( z ) & = \sum_{ k = 0 }^n \cfrac{ ( - 1 )^k }{ k ! }
\end{aligned}</script><p>于是$g_n = n ! \sum_{ k = 0 }^n \cfrac{ ( - 1 )^k }{ k ! } \\$.</p>
<h4><span id="example2qoj5169-夹娃娃">Example2([QOJ5169] 夹娃娃)</span></h4><p>首先设$F_i ( x )$为第$i$家的生成函数,这个是显然可以快速预处理出来的.令$M = 520$.</p>
<p>问题在于每次询问的时候求出答案呢?</p>
<p>这里有一个套路:我们在一开始就暴力做点值,最后拿拉格朗日插值求答案.中间大概把能预处理的都预处理一下.最后的问题在于:</p>
<p>第一,预处理点值的时候,一共有$n$个多项式,最高次数是$M$,因此一共要插入$nM$个值,又要处理每个后缀,复杂度来到$O ( n^2 M^3 )$.这个问题是好解决的.我们只需要在带入点值的时候做一个后缀继承一类的东西,复杂度就可以来到$O ( n^2 M^2 )$.</p>
<p>第二,询问的时候需要找到所有对应的点值并暴力乘起来,复杂度来到$O ( n^2 Mq )$.但$n$如此小,我们可以用指数级别的复杂度来优化,我们考虑预处理一下$2^n$的答案,复杂度来到$O ( nM 2^n q )$.但是这个更不太行.那怎么办呢?我们把这个指数级别的东西分块一下.预处理复杂度来到$O ( \frac{ n }{ B } B 2^B MnM )$,单次询问复杂度来到$O ( \frac{ n }{ B } Mnq )$.但这个预处理复杂度好像还是有点艰难.不过注意到如果做一个剪枝优化:如果总共的喜欢的店的个数乘以$k$要大于$m$,就直接输出$0$.预处理的时候块内部也做一个剪枝,然后发现就能过了(牛逼).</p>
<p>第三,拉格朗日插值的时候需要$O ( ( nM )^2 q )$的复杂度,不过由于点值可以自己控制,这个复杂度可以轻松降到$O ( nMq )$.</p>
<h4><span id="example3十二省联考-2019-皮配">Example3([十二省联考 2019] 皮配)</span></h4><p>首先注意到题目等价于规定一个阵营和一个排序的人数上下界.</p>
<p>我们可以将这四位导师分别记为$xy , y , x , 1$,这样最后判断幂在一个区间内的$x$和$y$前面的系数就行.</p>
<p>注意到如果没有学校有偏好,将生成函数卷起来后得到的答案就是$\prod ( x^{ s_i } y^{ s_i } + x^{ s_i } ) + \prod ( y^{ s_i } + 1 ) = ( \prod ( x^{ s_i } + 1 ) ) ( \prod ( y^{ s_i } + 1 ) )$.也就是$x$和$y$是互相独立的,我们可以分开算.</p>
<p>对于那些有偏好的学校,我们暴力算就行.复杂度不会高于$O ( mk^2 s )$.最后两部分合并一下.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%9B%BE%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%9B%BE%E8%AE%BA/" class="post-title-link" itemprop="url">图论</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-16 13:55:05" itemprop="dateModified" datetime="2025-12-16T13:55:05+08:00">2025-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI/" itemprop="url" rel="index"><span itemprop="name">OI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%9B%BE%E8%AE%BA/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%9B%BE%E8%AE%BA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h3><span id="约定">约定</span></h3><p>$K_n$为$n$个点的完全图</p>
<h3><span id="树的性质">树的性质</span></h3><h5><span id="example1hdu6035colorful-tree">Example1([HDU6035]Colorful Tree)</span></h5><p>考虑每种颜色的贡献,一种颜色的贡献显然是删去所有这个颜色的边后,剩下的联通块之间的路径.</p>
<h5><span id="example22022qbxt国庆day1tree">Example2([2022qbxt国庆Day1]tree)</span></h5><p>首先考虑分开处理每个点,在做每个点的时候假设它的所有子节点全部已经满足条件了,最终我们再通过计算组合数的方式计算即可.</p>
<p>那么最后,我们需要对于每个点进行处理,假设我们已知这个子树的集合是$S$,那么我们需要用容斥计算如果当前子树集合是$S$的子集的情况,不难发现容斥式子:</p>
<script type="math/tex; mode=display">
ans = \sum_{ k = \max \{ f_v | x \rightarrow v \} }^{ f_x } ( - 1 )^{ f_x - k } k \binom{ f_x }{ k } \sum_{ x \rightarrow v } \binom{ k }{ f_v }</script><p>其实也就是个二项式反演的形式.</p>
<p>这题还需要一些技巧优化,我们首先发现由于$f_v$有可能有重复的,我们可以提前把重复的$f_v$压缩到一起再用快速幂求,于是后面的部分最多不过$\sqrt{ n }$级别.而前面是一个类似于树上启发式合并的东西,于是复杂度$O ( n \sqrt{ n } \log n )$.</p>
<h5><span id="example3cf1628e-groceries-in-meteor-town">Example3(CF1628E Groceries in Meteor Town)</span></h5><p>因为要求路径最大值,所以先建Kruskal重构树.然后问题转化为求一个点和一群白点的LCA是谁.</p>
<p>树上多点LCA有个经典性质:也就相当于其中$dfn$序最大的和最小的两个点的LCA.</p>
<p>至于区间覆盖可以用线段树.</p>
<h5><span id="example4loj3692">Example4(loj3692)</span></h5><p>注意到$D$很小.</p>
<p>我们考虑处理邻域乘,设$f_{ x , i }$表示$x$的$i$级儿子需要乘上的答案.每次修改时,先将$f_{ x , D }$和$f_{ x , D - 1 }$乘上$W$,然后令$x = fa_x$,$D = D - 2$,继续此操作直到$D$为$0$.</p>
<p>然后询问的时候直接暴力跳$D$层父亲找答案,不难发现这样做是对的.</p>
<p>同样的思路可以脱离点分治处理很多邻域问题.</p>
<h4><span id="树的直径">树的直径</span></h4><ol>
<li><p>定义:树中最长的一条简单路径.</p>
</li>
<li><p>树的直径可能有多个.</p>
</li>
<li><p>直径的两个端点一定是两个叶子节点.</p>
</li>
<li><p>如果树有多条直径,树的不同的直径的中点/中边一定是相同的.</p>
</li>
<li><p>到一个点距离最远的点一定是直径的一个端点.</p>
</li>
<li><p>对于两棵树,如果第一棵树直径两端点为$( u , v )$,第二棵树直径两端点为$( x , y )$,用一条边将两棵树连接,那么新树的直径一定是$u , v , x , y$中的两个点.</p>
</li>
</ol>
<p>上述的证明大都是考虑反证法:如果不成立,则一定存在一条更长的直径.</p>
<h5><span id="example1sdoi2013直径">Example1([SDOI2013]直径)</span></h5><p>有一个做法是:考虑找到直径的中点/中边,找到它到两边的最远距离的点,显然两边的点分别的以中点/中边的两个端点为根的LCA中间的部分就是一定会被包含的边.</p>
<h4><span id="树的重心">树的重心</span></h4><ol>
<li><p>定义:树的重心是删去后所有剩余子树大小最大值最小的点.</p>
</li>
<li><p>树的重心是删去后所有剩余子树大小全部小于等于$\lfloor \cfrac{ n }{ 2 } \rfloor$的点.</p>
</li>
<li><p>树的重心只有可能有一个或两个.</p>
</li>
<li><p>如果树有两个重心,那么这两个重心相邻.</p>
</li>
<li><p>树的重心是所有点到其距离之和最小的点.</p>
</li>
<li><p>把一个树添加或删除一个叶子,那么它的重心最多只移动一条边的距离.</p>
</li>
<li><p>把两个树通过一条边相连得到一个新的树,那么新的树的重心在连接原来两个树的重心的路径上.</p>
</li>
</ol>
<p>(2)的证明如下:</p>
<p>如果重心是$u$,且删去$u$后剩余最大子树大小大于$\lfloor \cfrac{ n }{ 2 } \rfloor$,设这棵子树中与$u$相邻的点为$v$,则我们删去$v$后,最大子树大小一定会减少,不满足假设,所以(2)得证.</p>
<p>另外,如果一个点删去后所有剩余子树大小全部小于等于$\lfloor \cfrac{ n }{ 2 } \rfloor$,那它也一定是重心.因为不存在除了重心以外的满足条件的点:考虑调整法,与重心相邻的点一定都不满足条件,因为它们的子树大小全都小于等于$\lfloor \cfrac{ n }{ 2 } \rfloor$,移动后最大子树一定不小于$n - \lfloor \cfrac{ n }{ 2 } \rfloor$.</p>
<p>(3)(4)的证明如下:</p>
<p>首先证明:如果有两个点都是重心,那它们一定相邻.</p>
<p>考虑如果二者不相邻,那删去它们后剩下的最大子树大小一定相等,设这两个点分别为$x , y$,那删去$x$后,剩下的最大子树一定包含了$y$,而这个子树的大小一定小于等于$\lfloor \cfrac{ n }{ 2 } \rfloor$.那删去$y$后,剩下的最大子树大小必定大于$\lfloor \cfrac{ n }{ 2 } \rfloor$,一定不合法.</p>
<p>而树上不可能有超过两个点两两相邻,于是最多只有两个重心,且它们一定相邻.</p>
<p>(5)的证明如下:</p>
<p>考虑如果$u$是树的重心,我们看能不能将$u$调整到另一个点使得所有点到其距离之和更小.</p>
<p>由于调整是一步一步做的,显然只需要判断所有和$u$相邻的点是否符合条件即可.设这个点为$x$,那我们把$u$改为$x$,会使答案减小$siz_x$,增加$n - siz_x$,由于$siz_x \leq \lfloor \cfrac{ n }{ 2 } \rfloor$,所以这么做一定不优.</p>
<p>(6)的证明如下:</p>
<p>首先,如果加入一个叶子节点后,各个子树大小仍然都$&lt; \lfloor \cfrac{ n }{ 2 } \rfloor$,那显然不必调整.</p>
<p>不然,显然是往叶子节点移动一格或者加入一个相邻的重心.</p>
<p>(7)的证明如下:</p>
<p>不妨设两棵树大小分别为$siz_a \leq siz_b$,然后令相连的两个点是这两棵树的根.</p>
<p>对于$b$中的重心,肯定是会往根跳,并且不可能跳出$b$原本的树.</p>
<h5><span id="example1csp-s2019树的重心">Example1([CSP-S2019]树的重心)</span></h5><p>首先取重心$rt$为根,如果有两个就随便取一个.</p>
<p>接下来我们考虑对于每个点$x$,它在什么情况下会成为重心.首先,删掉的边不可能在$x$的子树内,不然一定不可能取到$x$的.然后,我们假设删掉的子树大小为$S$,$x$的子树内最大的一个子树大小为$g_x$,那么根据重心的性质有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
2 ( n - S - siz_x ) & \leq n - S \\
2 g_x & \leq n - S \\

\end{aligned}</script><p>整理得到:</p>
<script type="math/tex; mode=display">
2 g_x \leq n - S \leq 2 siz_x</script><p>考虑这个怎么计算:如果没有删边必须在$x$子树外的限制,那显然可以直接遍历一遍存下$n - S$,然后统一使用值域树状数组做.而我们接下来考虑删去$x$子树内的贡献,类似colorful tree的做法,每次dfs到一个点,记录下来当前树状数组的答案,然后dfs子树,回溯时拿新答案减去旧答案就是子树内的答案.</p>
<p>接下来我们需要考虑$x = rt$怎么做.</p>
<p>考虑$x$的子树中最大的那个和次大的那个,如果我们删去的节点不在最大的子树中,那只需要保证最大的子树大小满足条件;不然,只需保证次大的子树大小满足条件,也是好维护的.</p>
<h4><span id="树的结构的维护">树的结构的维护</span></h4><h5><span id="example1">Example1</span></h5><p>给定一棵树,树上点有点权$val$.现在有一个值$sum$,初始为$0$.从$1$号点出发,每第一次到一个点$u$,就会使$sum + = val_u$.求在时刻保证$sum \geq 0$的前提下,$sum$最终的最大值.</p>
<p>首先注意到为了保证$sum \geq 0$这个性质,一个节点应该有两个值:$lim$表示能走到这个点所需要的最小的$sum$,$val$表示到了这个点后能获得的价值.显然如果$val \leq 0$则无意义.</p>
<p>如果我们能一开始处理出根的所有儿子的$lim$和$val$,我们就可以使用先走$lim$小的点,并不断累计$sum$的方式做.</p>
<p>所以考虑不断向上合并信息.不难发现此时一个点要处理出多对$( lim , val )$.考虑用一个左偏树维护这个东西.</p>
<p>但是,我们还需要保证不能跳着选点.也就是说我们要保证选中一个点,这个点的父亲必须选,怎么办呢?</p>
<p>一个方式是,我们把排序方法从只看$lim$变成先判是否存在祖先后代关系,再判断$lim$.</p>
<p>另一个方式是,我们每次直接把当前子树根节点扔到堆顶.但是需要满足堆的性质.不难发现如果这个点$val &lt; 0$,我们可以将它与下面的$lim$最的节点合并直到这个点$val \geq 0$.而如果这个点的$lim$太大,我们同样可以合并.注意到这样我们采取了一种很聪明的方式维护了树的形态.</p>
<h4><span id="dfs树的性质">dfs树的性质</span></h4><h5><span id="example1cf1361ejames-and-the-chase">Example1([CF1361E]James and the Chase)</span></h5><p>如何判断一个点是否是好的呢?首先,如果要求是任意路径,那一个点是好的当且仅当它是一个叶向有根树的根.</p>
<p>现在要求是简单路径,那也就是说如果走了重复点是可以忽略的,这也就是说这个叶向有根树可以有反走边,而显然不能有横插边.不难发现这是充要条件.</p>
<p>另一个问题是:如何快速判断一个点是否满足上述条件呢?首先我们求出以一个好的点为根的dfs树(随机选取一定数量的点,如果一个都不是好点直接输出$- 1$),然后我们发现:一个点$u$是好的必要条件是它的子树内只有一条反走边,证明显然.假设$u$通过这条反走边走到了点$v$,那么$u$是好的点当且仅当$v$也是好的点.</p>
<p>这是为啥呢?首先,因为我们是以一个好点为根跑的dfs树,所以$u$走到子树内的点必定只有一种方式.那子树外的点呢?走到$v$后,显然就要从它走到其它点,而它到$u$的子树内显然只有一种方案,那如果$v$到其它点也只有一种方案,那么根据$u \rightarrow v$这条路径,$u$显然也是好点.</p>
<h5><span id="example2loj-6276">Example2(Loj 6276)</span></h5><p>找到所有颜色相同的点对$( x , y )$,经过它们的路径都不合法,显然经过它们的路径可以用dfs序刻画成矩阵,最后要求矩阵面积并.</p>
<h3><span id="圆方树的性质">圆方树的性质</span></h3><ol>
<li><p>对于任意的非空无向图$G$,一定存在一个$G$的点双连通分量$B$,使得$B$中只有不超过$1$个节点是$G$的割点.其中,若$B$中没有$G$的割点,则有$B = G$.</p>
</li>
<li><p>若一个点双连通分量不为$K_2$,则该点双连通分量中至少有一个简单环.</p>
</li>
<li><p>在仙人掌上的每个点双连通分量要么是$K_2$,要么是一个简单环.</p>
</li>
<li><p>对于一个不是$K_2$的点双连通分量中的任意一个点$u$,一定存在一个简单环$C$使得$u$在$C$上.</p>
</li>
<li><p>对于一个不是$K_2$的点双连通分量中的任意两个点$u , v$,一定存在一个简单环$C$使得$u , v$在$C$上.</p>
</li>
<li><p>对于一个不是$K_2$的点双,任给一点$x$和一边$e$,一定存在经过$x , e$的简单环.</p>
</li>
<li><p>对于一个不是$K_2$的点双,任给两点$s , t$和一边$e$,一定存在一条$s - e - t$的简单路径.</p>
</li>
</ol>
<p>(6)的证明非常变魔术,你考虑把$e : u \leftrightarrow v$这条边给改成$u \leftrightarrow w \leftrightarrow v$,然后$w$和$x$在一个简单环上,意味着$u , w , v , x$在一个简单环上.</p>
<p>(7)考虑(6)就行,先找到$s$和$e$所在的简单环,然后从这个环上连到$t$.</p>
<h3><span id="任意图的性质">任意图的性质</span></h3><ol>
<li>若一张无向连通图$G$中存在$3$个不同的一度点$x , y , z$,则一定存在一个点$u \notin \{ x , y , z \}$使得存在$3$条两两没有公共边的简单路径满足其中一个端点均为$u$ 且另一个端点分别为$x , y , z$.(证明考虑求生成树后讨论LCA)</li>
</ol>
<h3><span id="dsu-on-tree">dsu on tree</span></h3><h5><span id="exampleqoj5020">Example(QOJ5020)</span></h5><p>我们考虑树链剖分,这样将问题转化为三部分:</p>
<ol>
<li><p>对于某个点而言,到它距离$\leq d$的点数量.这个问题可以使用点分治解决.</p>
</li>
<li><p>对于某条重链的上半部分而言,它连接的所有轻子树中,到它距离$\leq d$的点数量.这个问题直接dsu on tree.</p>
</li>
<li><p>对于某个点而言,在它子树内到它距离$\leq d$的点数量.这个问题也可以直接dsu on tree.</p>
</li>
</ol>
<p>为什么转化为三个部分就能求解呢?我们考虑一条链$u \rightarrow w \rightarrow v$,其中$w$是这条链上深度最浅的点.那么首先我们统计在$w$子树外的,这一个部分可以由(1)和(3)做差求出来.然后我们要求的就是在$w$子树内,到这条链的距离$\leq d$的点的数量.这个怎么求呢?我们考虑差分,求一下$1 \rightarrow u$和$1 \rightarrow w$的答案然后做差.这样我们对这条到根的路径重链剖分,只需要处理重链的上半部分以及两条重链的连接处.不难发现两条重链的连接处会被多算一次,拿(3)减一下就好.以及这条路径所叉出去的重儿子也需要用(3).</p>
<p>现在的问题在于怎么求(2)和(3),先考虑(2),我们对于每一条重链从顶端走到低端不断地加入轻儿子,然后维护BIT就行.(3)是类似的,只不过是需要从底端走到顶端.</p>
<p>注意如果把重儿子和轻儿子分开处理,那么可能会在一些奇怪的地方算重,解决方法是特判$w$处的答案,然后拆成两条互相之间完全没有影响的链,当然这也有可能会发生跳重链的时候轻儿子算重的情况,同样需要判断一下.</p>
<h3><span id="最小生成树">最小生成树</span></h3><h5><span id="example1cf1550f-jumping-around">Example1(CF1550F Jumping Around)</span></h5><p>首先考虑离线.注意到每次肯定跳到一个自己能跳到的点,而这个点应该是所需灵活度最小的点.</p>
<p>考虑boruvka算法,建立最小生成树并判断.</p>
<h3><span id="kruskal重构树">Kruskal重构树</span></h3><p>最小生成树时,每一次加边的时候把那个边变成虚点,两个点连到这条边上.任意两个点的LCA就是它们路径上的最小边权.</p>
<h3><span id="最短路">最短路</span></h3><h5><span id="example1cf1753d-the-beach">Example1(CF1753D The Beach)</span></h5><p>首先,自然的想法是把格子图黑白染色.</p>
<p>然后,我们注意到一个床是不可能被移动两次及以上的.因为如果是横着动两次,那不动自然就有一对空位置了;如果是转两次,考虑转的目的一定是为了空出某个位置或某两个位置(不可能为了空出三个位置,显然这么做很闲),一次操作足矣;如果是动一次转一次也是一样的,要么转的很闲要么原本就存在这么一对空位置.</p>
<p>我们再进行一步转化,考虑把动床改为动格子.换句话说,每个格子可以通过一定的代价移动到和它相邻的床的与它不相邻的那个位置上.注意到移动格子的过程只会把黑格子移动到黑格子,白格子移动到白格子.</p>
<p>于是建立超级源点跑两边最短路,枚举最后床放在哪里即可.不过这里有一点是一个床有没有可能被黑白最短路同时跑了一遍,是有可能的,但这么跑一定不优秀,不可能是最小答案.</p>
<h5><span id="example2cf843ddynamic-shortest-path">Example2([CF843D]Dynamic Shortest Path)</span></h5><p>注意到$O ( nq )$能过.而且每次修改只是对于若干条边$+ 1$,自然想到每次修改完后跑01bfs.</p>
<p>但是怎么跑呢?注意到维护每个点最短路的增量,并且在路径的增量上跑01bfs,自然可求.</p>
<h5><span id="example3-同余最短路luogup2371墨墨的等式">Example3 同余最短路([luoguP2371]墨墨的等式)</span></h5><p>因为$a_i$无序,假设$a_1$最小,那么所有的数字都可以按$\mod a_1$的结果分成$a_1$类.我们按照余数设置$a_1$个点,编号为$0$至$a_1 - 1$.</p>
<p>设$dis_i$为所有能组成的数中且$\mod a_1$余数为$i$的最小数.那么,所有能表示出来的$\bmod a_1$余数为$i$的数都可以写作$dis_i + k \times a_1 , k \in \mathbb{ N }$的形式,求得$dis_i$后可以很轻易算出.</p>
<p>那么怎么求$dis_i$呢?我们考虑:对于任意一个数$k$,它可以怎么得到.注意到如果$k - a_j$(其中$i \ne j$)可行,那么$k$一定可行.自然有:$dis_i = \min \{ dis_j + a_k | 0 \leq j &lt; a_i , k \ne i \}$.</p>
<p>这显然是一个最短路问题.</p>
<h3><span id="差分约束">差分约束</span></h3><h5><span id="example1agc056c-01-balanced">Example1([AGC056C] 01 Balanced)</span></h5><p>将$1$看成$- 1$,$0$看成$+ 1$,不难发现字典序最小也就是让前缀和序列字典序最小,并且有$sum_{ r_i } = sum_{ l_i - 1 }$以及$- 1 \leq sum_{ i } - sum_{ i - 1 } \leq 1$,然后做$01$bfs跑最短路,显然最短路可以保证每个$sum$都尽可能小.</p>
<p>然后另一个问题在于这玩意为啥不会让$sum_i = sum_{ i - 1 }$,这个建图后观察一下就知道不会发生这种情况.</p>
<h3><span id="2-sat">2-SAT</span></h3><h5><span id="example1cf1697f">Example1(CF1697F)</span></h5><p>对每个点建立$k$对点表示$a_i \geq x$和$a_i &lt; x$,就能做了.</p>
<h5><span id="example22021集训队互测-序列">Example2(2021集训队互测 序列)</span></h5><p>注意到如果$a_i &lt; x$,那么$a_j \geq x \land a_k \geq x$,这样就可以刻画所有的条件.</p>
<p>而且一定可以刻画所有的条件.</p>
<h3><span id="对偶图">对偶图</span></h3><h5><span id="example1csp-s-2021-交通规划">Example1([CSP-S 2021] 交通规划)</span></h5><p>先考虑如果附加点的颜色全都相同,那肯定输出$0$即可.</p>
<p>考虑附加点的数量为$2$的时候,那显然最优情况需要将整个图分成各自联通的两部分,一部分染成黑色,一部分染成白色.可以发现这就是一个对偶图.</p>
<p>而如果附加点的数量很多怎么做呢?稍微思考一下</p>
<h3><span id="广义串并联图三度化">广义串并联图/三度化</span></h3><h4><span id="定义">定义</span></h4><p>定义:不存在$4$个点使得任意两点之间存在一条简单路径,且这六条路径不在$4$个点之外的地方相交.</p>
<h4><span id="删一度点">删一度点</span></h4><p>经典问题引入:树上带权最大独立集.</p>
<p>首先dp是可以实现的,我们考虑是否存在贪心算法.</p>
<p>首先,如果不带权,我们显然可以每次选取一度点或零度点,并删去所有相连的点.这样做显然是最优的.</p>
<p>但怎么做带权的方法呢?我们注意到可以先删掉所有负点权的点,然后可以加入剩下的所有零度点.</p>
<p>那么对于一度点呢?对于一个一度点$u$和它的相邻点$v$,我们不能盲目选$u$的原因是可能选取$v$会更优秀.考虑做一个带悔贪心,我们先把$u$选上,然后把$v$的权值设为$val_v - val_u$,相当于我们仍然可以选$v$,但是要花费$val_u$的代价把$u$删去.</p>
<p>我们把类似这样的操作称为<strong>删一度点</strong>.</p>
<h4><span id="缩二度点">缩二度点</span></h4><p>问题引入:给定一个仙人掌,每个点可以染色为$0$或$1$,$u$节点染成$0$会有$b_u$的贡献,不然有$w_u$的贡献.若一条边$e$相邻的两点颜色相同则有$s_e$的贡献,不然有$d_e$的贡献,求最大答案.</p>
<p>首先如果有一度点和零度点,我们仍然可以使用删一度点的操作.</p>
<p>如果没有,考虑仙人掌上的一个点双一定是一个简单环.而且一定存在一个点双$B$满足$B$只包含一个割点.</p>
<p>那么对于这个点双上的一个非割点$x$以及和它相邻的两个点$u$和$v$,我们考虑$x$的染色有可能改变$u$和$v$的答案,那么怎么办呢?</p>
<p>冷静思考一下,我们想办法把$x$给删掉.简单来说,我们把$u$和$v$之间连一条边权为$[ w_{ 0 , 0 } , w_{ 0 , 1 } , w_{ 1 , 0 } , w_{ 1 , 1 } ]$的边,分别表示$u$和$v$的染色为以上四种情况时这条边(也就是原本的$x$)的最大贡献是什么,这显然可以通过讨论$x$的取值而求得.这样初始边权实际上就是$[ s , d , d , s ]$,于是我们就可以删掉一个二度点并连起来与它相邻的两个点,我们把类似这样的操作称为<strong>缩二度点</strong>.</p>
<h4><span id="叠合重边">叠合重边</span></h4><p>注意到使用缩二度点的时候,会把一个三元环缩成两个点及链接它们的两条重边,但是我们可以直接把重边合起来,我们把类似这样的操作称为<strong>叠合重边</strong>.</p>
<h4><span id="正确性证明">正确性证明</span></h4><p>接下来我们证明:任何广义串并联图都可以通过以上三种操作缩为一个点.</p>
<h5><span id="引理1">引理1</span></h5><p>对于一个无向图$G$,若进行若干次删一度点操作,缩$2$度点操作以及叠合重边操作后得到的图不是广义串并联图,那么$G$也不是广义串并联图.</p>
<p>考虑用逆操作还原原图.删一度点的逆操作是加入一个点,叠合重边的逆操作是将一条边变成两条边,这两个操作显然不会使一个不是广义串并联图的图变成广义串并联图.接下来考虑缩二度点的逆操作:删掉一条边$( u , v )$并加入一个点$w$和两条边$( u , w )$和$( w , v )$.</p>
<p>由于这个图不是广义串并联图,所以一定存在一组反例点$\{ a , b , c , d \}$.如果我们删掉的边不在作为反例的六条边上,那显然不影响;如果在,由于新加入的两条边仍然可以作为路径,所以也不影响.</p>
<p>于是引理得证.</p>
<h5><span id="引理2">引理2</span></h5><p>任意一张所有点的度数都大于等于$3$的简单无向连通图,一定不是广义串并联图.</p>
<p>这个引理的严格证明有些麻烦.我们冷静一下,一个四个点的完全图满足以上条件且不是广义串并联图.而其他的图感性理解一下应该可以通过缩路径的方式变成一个四个点的完全图.</p>
<p>结合引理1,我们得知任意一个操作后不能变成单个节点的图的无向连通图不是广义串并联图.</p>
<h5><span id="引理3">引理3</span></h5><p>任意一个满足$m \leq n + k$的图,通过删一度点,缩二度点,叠合重边操作后,$m$和$n$都会到达一个$O ( k )$的量级.</p>
<p>考虑缩完点后,所有点的度数$\geq 3$,于是有$2 m \geq 3 n$,而在操作过程中,$m - n$的值显然是不增的,于是有$m - n \leq k$,解一下方程得到$n \leq 2 k , m \leq 3 k$.</p>
<h4><span id="example122zr提高十连测day6摆件">Example1(22zr提高十连测day6摆件)</span></h4><p>首先考虑颜色之间没啥区别,所以对于一棵树来说,朴素的dp是可以的.</p>
<p>简单来说,设$dp_i$表示第$i$棵子树的答案.合并的时候考虑设$f_v = \cfrac{ 1 }{ k } dp_v sam_e + \cfrac{ k - 1 }{ k } dp_v dif_e$,自然有$dp_u = \prod_{ u \rightarrow v } f_v \\$.</p>
<p>接下来考虑先随便找一棵生成树,然后暴力枚举多余的反走边的深度较低的叶子节点的颜色,再进行dp即可.</p>
<p>另外也可以缩点后做,不过对于这题没啥区别.</p>
<h4><span id="example2joi-open-2022-放学路">Example2([JOI Open 2022] 放学路)</span></h4><p>广义串并联图的一个很重要的思想是:我们通过一些手段改变这个图的形态为一个好做的形态,但是答案又和原图相同.</p>
<p>在这个思想的指导下,我们考虑这个题能否进行三度化.不过注意起点和终点简单特判一下,别把他们给删了.这样我们最后如果得到了一个只有起点和终点的图,那就一定是no.</p>
<p>然后如果没有只得到起点和终点呢?对最短路图建DAG,考虑如果$S$和$T$在一个点双中,我们找到两个点$u , v$,使得$u \rightarrow v$,并且$u$的出度至少是$2$,$v$的入度至少是$2$,显然只要找到就做完了.现在的问题就在于为啥这条边一定存在.这个考虑找一个入度至少为$2$的点$v$,找到它的入点$u$,如果$u$的出度不是$2$,那么$u$也是一个入度至少为$2$的点.这样往前推一定至少能推到一个点(因为不可能$S$贡献了俩入度).</p>
<p>如何保证$S , T$在一个点双中呢?其实只需要添加一条边$( S , T , dis_{ S \rightarrow T } )$就行了.显然加了后不会对答案产生影响.然后不在$S , T$这个边双内的点也没有用了.</p>
<h3><span id="点分治">点分治</span></h3><h5><span id="example1cfgym101002k">Example1(CFgym101002K)</span></h5><p>点分治,假设当前分治重心是$g$,将每个数缩成一个二元组$( w_i , d_i )$,所求就是$w_i w_j + d_i + d_j$最小,直接排序做斜率优化.</p>
<h4><span id="点分树的性质">点分树的性质</span></h4><ol>
<li><p>点分树的高度是$O ( \log n )$级别.</p>
</li>
<li><p>两个点在原树上的路径一定经过其在点分树上的LCA.</p>
</li>
</ol>
<h5><span id="example1codechef-btree">Example1(codechef [BTREE])</span></h5><p>这题用到了一个经典套路:一个树形连通图的点数减去边数为$1$,把虚树建出来,能到达一个点的守卫必然是一个树形连通图(虚树中原本没有守卫的点可以加个不同覆盖范围的守卫).于是我们只需要求出每个守卫能覆盖多少点以及两个守卫之间的那条路径能覆盖多少个点,前者用点分树轻松维护,后者的话找一下这条边上的某个满足条件的点就行.</p>
<h5><span id="example2">Example2</span></h5><p>给定一棵树,现在在上面选定$m$对不同的点,要求每对点的距离之和最大.</p>
<p>考虑如果确定了$2 m$个点,我们如何匹配他们.对每条边算贡献,假设这条边两侧分别有$a , b$个点,那么这条边最大的贡献就是$\min \{ a , b \}$.不难发现这个上界可以取到,只需要取这$2 m$个点的带权重心,由于不存在绝对众数,所以直接两两匹配.枚举带权重心是啥,这样复杂度$O ( n^2 )$.</p>
<p>那么怎么优化呢?我们注意到如果以一个点$x$作为根,而它有一个儿子$y$,$y$的子树中选了少于$m$个点,那么我们以$y$为根一定是不优秀的,不然一开始就不可能只选少于$m$个点,再考虑带权重心这个东西,上点分树.</p>
<p>具体来说,我们建立点分树,然后从点分树的根开始枚举带权重心,如果当前没有一棵子树选了$m$个点,就停止,不然往选了$m$个点的那棵子树走(如果有两个的话选第$m$大更大的那个),这样就只会选取$O ( \log n )$个带权重心.</p>
<h3><span id="边分治">边分治</span></h3><p>需要建立虚点转二叉树.</p>
<h4><span id="边分树的性质">边分树的性质</span></h4><ol>
<li><p>非叶子节点代表边,叶子节点代表点.</p>
</li>
<li><p>边分树的高度是$O ( \log n )$级别.</p>
</li>
<li><p>边分树上每棵子树中的叶子节点一定联通.</p>
</li>
<li><p>是一棵完全二叉树.</p>
</li>
<li><p>两个点在原树上的路径一定经过其在边分树上的LCA所代表的边.</p>
</li>
</ol>
<h3><span id="二分图">二分图</span></h3><h4><span id="定理">定理</span></h4><h5><span id="最大流-最小割定理">最大流-最小割定理</span></h5><h5><span id="hall定理">Hall定理</span></h5><p>对于二分图$\langle V_1 , V_2 , E \rangle , | V_1 | \leq | V_2 |$,那么该图存在完备匹配的充要条件是$\forall Q \subseteq V_1 , | Q | \leq | N ( Q ) |$,其中$N ( Q )$指的是所有与$Q$中点有边相连的点的集合.</p>
<p>必要性很显然,接下来说明充分性.设$T$为最小点覆盖,也就是最大匹配的数量,再设$M$为最大匹配,此时自然有:</p>
<script type="math/tex; mode=display">
| M | = | T | = | T_1 | + | T_2 | \geq | T_1 | + | N ( V_1 / T_1 ) | \geq | T_1 | + | V_1 / T_1 | = | V_1 |</script><p>显然$| M | \leq | V_1 |$,于是$| M | = | V_1 |$.</p>
<p>另外,Hall定理有一个推论:正则二分图一定存在完美匹配.什么叫正则二分图,就是所有的点的度数(不为$0$)都相等的图.</p>
<p>$2^d$-正则二分图求完美匹配的话,可以不断求欧拉回路并给边定向,每次把一个方向的边全都删掉,这样就转化成了$2^{ d - 1 }$-正则二分图,不断递归到$d = 0$.</p>
<h5><span id="vizing定理">Vizing定理</span></h5><p>设$f ( G )$表示将$G$边染色,使得有公共点的边的颜色不同,最少需要的颜色数量.</p>
<p>设$\delta ( G )$表示$G$中的点的最大度数.</p>
<p>对于一般图,我们有:$\delta ( G ) \leq f ( G ) \leq \delta ( G ) + 1$,对于二分图有$\delta ( G ) = f ( G )$.</p>
<p>考虑这个的证明:我们每次将一对点$( x , y )$染色,考虑设它们当前没染色的最小的颜色是$l_x , l_y ( l_x \leq l_y )$,如果相等就直接选,不然类似增广路更新.</p>
<h4><span id="二分图最大权匹配">二分图最大权匹配</span></h4><p>假定二分图两边两两有边(不是的话可以补上$- \infty$的边),这样就一定存在完美匹配.</p>
<p>我们给每个点一个顶标权值$v$,对于任意一条边$e : a \leftrightarrow b$,它的权值是$w_e$,我们要求$v$满足$v_a + v_b \geq w_e$.</p>
<p>如果我们规定了一组顶标后,取出所有满足$v_a + v_b = w_e$的边后的图(称作相等子图)存在完美匹配,那这组完美匹配就一定是最大权匹配.</p>
<p>这是为啥呢?考虑此时的最大权其实也就是$\sum v$,而由于$v_a + v_b \geq w_e$,因此最大权匹配一定不会超过$\sum v$.这就是一个可达的上界.</p>
<p>那么我们该怎么得到一个相等子图呢?考虑先构造一组合法的顶标,让左部端点取边的最大值,右部端点取$0$,然后开始增广.</p>
<p>从左侧任意一个非匹配点出发,在相等子图上走增广路并增广.如果增广失败,我们将访问过的左部端点全部减去$d$,右部端点全部加上$d$,注意到此时匹配边一定不会变化,因为匹配边要么两个端点都没被访问过,要么都被访问过.而左端点被访问过,右端点没被访问过的边有可能加入相等子图,我们考虑取所有这种边的需要的差值的最小值并进行更新.但是直接这么做的复杂度有点高.</p>
<p>使用bfs优化,可以发现只会扩大$O ( n^2 )$次子图,每次复杂度$O ( n )$,增广的复杂度类似,于是总复杂度$O ( n^3 )$.</p>
<h4><span id="example">Example</span></h4><h5><span id="example1-xvii-open-cup-named-after-ev-pankratiev-grand-prix-of-japanopenstrain-contest-1489-bpoint-pairs">Example1([ XVII Open Cup named after E.V. Pankratiev. Grand Prix of Japan(openstrain contest 1489) B]Point Pairs)</span></h5><p>看到这种要求横坐标或纵坐标相同的题,有一个自然的想法是建立二分图,对于点$( x , y )$,将二分图左边的$x$和右边的$y$连一条边.那么配对等价于要每次找两条相邻的边删掉.那么如何删掉呢?</p>
<p>首先发现的是,二分图不同的连通块可以分开处理,我们接下来只讨论一个连通块的情况.如果这个连通块有奇数条边,显然一定不行.而又可以发现,如果这个连通块有一个点度数仅为$1$,那这条边如何删是确定的,我们可以把它和另一条边删掉,不难发现怎么删最后得到的新图仍然联通.而如果不存在度数为$1$的点呢?由于这是一个二分图,不存在奇环,所以我们可以找一个简单环删掉,之后显然也是一个连通块.我们到这里就可以发现问题了.运用数学归纳不难证明:只要一个连通块的边数是偶数就一定合法.</p>
<p>然后我们可以使用可撤销的分治解决这个问题.</p>
<h3><span id="网络流常见模型">网络流常见模型</span></h3><h4><span id="最大流">最大流</span></h4><h4><span id="最小费用最大流">最小费用最大流</span></h4><h4><span id="最小割">最小割</span></h4><p>最大流$=$最小割,证明显然.</p>
<p>最小割求方案。这个是简单的，我们删去所有流量$0$的边后从$S$开始bfs，找到所有$S$能到达的点，显然这些点（注意如果这个点一开始就不能到达$T$，那它是废物，不用管它，下面只讨论它能到达$T$的情况）组成一个SCC（为啥呢？首先$S$能到达它们，其次由于是最小割，因此这个点一定到达不了$T$，而原本是可以到达$T$的，假设这个点是$x$，那么一定是原本存在一条$S \rightarrow x \rightarrow T$的路径被割掉了，也就是现在一定存在一条$x \rightarrow S$的路径）。最小割包含的边一定是这个集合和其它集合交界处的边。这是为啥呢？首先这些边一定组成了原图的一个割，其次，我们发现割不可能存在$S$所在SCC中，而割掉完全不连接$S$的边可以发现不如割其中一个点在$S$所在SCC的边。</p>
<h5><span id="example1luogup4313-文理分科">Example1(luoguP4313 文理分科)</span></h5><p>先把所有的满意值全部吃下,然后考虑放弃哪些.</p>
<p>对于每个人$u$,将$S$向他连一条流量为$art$的边,它向$T$连一条为$science$的边,表示它自己要么放弃文科,要么放弃理科.</p>
<p>然后再对每个点建立一个虚点$u ‘$,$S$向$u ‘$连一条为$sameart$的边,$u ‘$向相邻的实点连$\infty$的边,表示要么放弃$sameart$,要么那些点全都放弃理科.$samescience$是同理的.</p>
<p>从这也可以看出来,大部分最小割的题目其实就是将冲突的选项放到一条路径中,然后考虑放弃哪些,将这个限制用最小割表示出来.</p>
<h5><span id="example2hnoi2013切糕">Example2([HNOI2013]切糕)</span></h5><p>也是显然的最小割,唯一难处理的地方在于相差$\leq D$.</p>
<p>这个怎么做呢?建图后先每一竖轴都变成了一条链,我们在链之间加一些$\infty$的边,使得如果断开的两个点之差大于$D$,那就可以通过这条边破坏最小割结构.</p>
<p>这题同样告诉我们:对于最小割题目中的限制条件,几乎都是需要考虑破坏最小割结构的(也有可能是用费用流限制).</p>
<h5><span id="example3uoj704">Example3(uoj704)</span></h5><p>二分图最小割计数.</p>
<p>先求出最小割,然后显然每个匹配的三条边一定会选择一条割掉.</p>
<p>不妨设$a_i = 0 / 1 / 2$表示第$i$对匹配割掉了哪一条边.</p>
<p>考虑每个非匹配边$( u , v )$对点权的限制:</p>
<ol>
<li><p>$u$在最大匹配$i$中,$v$不在.则$a_i = 0$.</p>
</li>
<li><p>$v$在最大匹配$i$中,$u$不在,则$a_i = 2$.</p>
</li>
<li><p>$u$在最大匹配$i$中,$v$在最大匹配$j$中,则$a_i = 0$或$a_j = 2$.</p>
</li>
</ol>
<p>前两种是好处理的,考虑第三种:显然所有都选$2$或所有都选$0$是一种方案,更进一步地,我们将$i \rightarrow j$,那么在一个强连通分量中的点一定都是$2$或都是$0$.这样可以缩点,缩点后发现DAG上的每一条路径的染色都形如$0 , 0 , 0 , \cdots , 0 , ( 1 ) , 2 , \cdots , 2 , 2 , 2$.</p>
<p>不妨折半搜索,按照拓扑排序,确定前一半哪些是$0$,剩下是$1 / 2$,那他们的后继必然全都是$2$,这样后面的是$2$的集合一定是这个后继集合的超集,高维后缀和.</p>
<p>接下来只需要判断哪些位置可以选$1$.相当于前驱全都是$0$并且后继全都是$2$.</p>
<h4><span id="二分图匹配">二分图匹配</span></h4><h4><span id="二分图最小点覆盖">二分图最小点覆盖</span></h4><p>二分图最小点覆盖$=$二分图最小割.</p>
<p>问题在于如何求解方案.</p>
<p>我们从左侧的非匹配点开始dfs,走还有残留流量的路径.并将路径上所有的点全都打上标记.那么左侧所有的未标记点和右侧所有的标记点就是一组合法的方案.</p>
<p>这是为啥呢?首先我们注意到,左侧的非匹配点一定会被标记,右侧的非匹配点一定不会被标记.</p>
<p>为啥右侧的非匹配点一定不会被标记呢?因为如果被标记了,从左侧非匹配点到右侧非匹配点这条路径的起始边和终边就都是非匹配边,显然是一条增广路.</p>
<p>然后我们又注意到:对于一组匹配点,要么两者都被标记,要么两者都不被标记,因为一旦走到了右侧点,下一步必然走向左侧点.而如果走到了左侧点,也必然是从右侧点走过来的.</p>
<p>接下来我们讨论一下:</p>
<p>对于非匹配边,由于其必然连了一个左侧非匹配点,所以它的右边必然被选择了.</p>
<p>对于匹配边,不难发现它会被某个匹配点覆盖掉.</p>
<p>于是得证.</p>
<p>当然,上面的证明略显啰嗦.事实上我们这么考虑:</p>
<p>首先,我们按照套路,求出$S$所有能到达的点.根据二分图的性质,这个点的集合必然不包括$T$.</p>
<p>然后我们取所有不在这个点集的左侧点和所有在这个点集的右侧点,这样所有的点被分为了四个部分,边也自然被分为了四个部分,讨论一下就知道这四个部分中有一个部分是不存在边的.于是得证.</p>
<h4><span id="二分图最大独立集">二分图最大独立集</span></h4><p>二分图最大独立集$= n -$二分图最小点覆盖.</p>
<h5><span id="example1cf1404e">Example1(CF1404E)</span></h5><p>在两个可选矩形的边界处建立一个点,如果它被选了,那么说明这个矩形和上面那个矩形被一起覆盖了.然后注意到每有一个点被选,自然就多覆盖了一个矩形,显然一个矩形不可能又跟纵向的一起被覆盖又跟横向的一起被覆盖,在他俩之间连边跑最大独立集即可.</p>
<p>感觉还是类似于最小路径覆盖,将这种两个一起被覆盖就减少答案的东西转换成一整条流.</p>
<h4><span id="最大权闭合子图">最大权闭合子图</span></h4><p>原图的边流量设为$+ \infty$,然后对于每个点$x$,如果$val_x &gt; 0$,那么$ans + = val_x$,然后将$S \rightarrow x$,流量为$val_x$;不然,$x \rightarrow T$,流量为$- val_x$,然后求出最小割$w$,答案即为$ans - w$.</p>
<h5><span id="example1luogup4177">Example1(luoguP4177)</span></h5><p>只需要把中间的$\infty$边改为租用的代价即可.</p>
<h4><span id="最小路径覆盖覆盖点">最小路径覆盖(覆盖点)</span></h4><p>将每个点$x$拆为两个点$A_x$,$B_x$,将$S$向所有$A$连边,$B$向$T$连边,如果图中存在一条路径$x \rightarrow y$,则连边$A_x \rightarrow B_y$,流量均为$1$,然后求出最大流$w$,答案即为$n - w$.</p>
<p>还有一个版本是可以重复走点,做一遍传递闭包就行.因为可重复相当于原图上的可跳点,这个版本又叫最小链覆盖.</p>
<h5><span id="example1网络流24题魔术球问题">Example1([网络流24题]魔术球问题)</span></h5><p>枚举球数,不断在残联网络上加边并在新图跑最小路径覆盖即可.</p>
<h4><span id="最长反链">最长反链</span></h4><p>反链是一个点的集合,满足这个集合中的点两两不可达.</p>
<p>最长反链$=$可重复走点的最小点覆盖(最小链覆盖).</p>
<p>为啥呢?因为发现做完传递闭包后等价于新图的最大独立集.当然图是有性质的,观察一下可重复走点的最小点覆盖就可以发现等价于传递闭包后在二分图上求最大独立集.</p>
<h5><span id="example1cf1630fmaking-it-bipartite">Example1([CF1630F]Making It Bipartite)</span></h5><p>首先显然的一点是,对于任意一个数字$x$,这个序列中不能同时出现$px$和$pqx$,其中$p , q$都是大于等于二的正整数.这是显然的.如果我们把图改为有向图,由$x \rightarrow px$,那么整个图就只会有两种点:只有出边的点和只有入边的点.</p>
<p>那么我们该怎么办呢?如果是只能出现$x$就不能出现$px$,那这就是一个经典的最长反链问题.但多了一层,我们可以考虑类似分层图的思想:建立和原图完全一样的图$G ‘$,并且将$G$中的$x$向$G ‘$中的$x ‘$连有向边,然后跑最长反链.不难发现这样做是正确的.</p>
<h4><span id="平面图最小割">平面图最小割</span></h4><p>平面图最小割$=$对偶图最短路.</p>
<h4><span id="最小费用任意流">最小费用任意流</span></h4><p>一般费用流,但是当当前增广路代价为正的就停止增广.</p>
<p>和最小费用最大流不一样,这玩意是可以增量的.</p>
<p>只需要考虑所有新的从源到汇的增广路以及增加过程出现的负环即可.</p>
<h5><span id="example1luogup4694-pa2013raper">Example1(luoguP4694 [PA2013]Raper)</span></h5><p>费用流模型很好建立,问题在于这个东西好像跑费用流有点慢.</p>
<p>那咋办呢?我们考虑到费用流是有凸性的.所以搭配一下wqs二分.</p>
<p>然后分一下三种情况讨论:</p>
<ol>
<li><p>直接$S \rightarrow T$的负增广路,相当于选取最小的$b$和当前的$a$搭配.</p>
</li>
<li><p>有一条$S \rightarrow a \rightarrow b \rightarrow a \rightarrow S$的负环,相当于以当前的$a$代替前面的某个较大的$a$.</p>
</li>
<li><p>有一条$S \rightarrow a \rightarrow b \rightarrow T \rightarrow b \rightarrow a \rightarrow S$的负环,注意到这个环必然没意义,因为不可能存在一条$T \rightarrow S$的负路径(不然反路径就是正的,而最小费用任意流不可能流正路径),所以这种情况不如直接选$S \rightarrow T$的路径.</p>
</li>
</ol>
<p>讨论完拿堆模拟一下就行.</p>
<p>这引出了著名的模拟费用流算法.</p>
<h4><span id="负费用最小流">负费用最小流</span></h4><p>一般费用流,但是当增广当前增广路时费用变成正的就停止增广.</p>
<p>注意如果两条增广路代价相同选流量大的那条.</p>
<h4><span id="有负环的费用流">有负环的费用流</span></h4><p>首先注意到:如果初始图没有负环,那无论后面怎么流都不可能出来负环.因为这意味着要么是一开始流了个正环,要么是一开始有负路径不走走正路径,都不太可能.</p>
<p>对于所有的负边$u \rightarrow v$,我们建立两个新点$S ‘$和$T ‘$,我们先将这条负边反向权值取相反数并让答案加上$f \times v$,之后令$u \rightarrow T ‘ , S ‘ \rightarrow v$,跑$S ‘ \rightarrow T ‘$的费用流,这个时候再在残联网络上跑$s \rightarrow t$的费用流就是答案.</p>
<p>为啥会这样呢?</p>
<p>首先先证明正确性,这个东西相当于一开始跑了一下$T ‘ \rightarrow u \rightarrow v \rightarrow S ‘$的图.然后我们在跑$S ‘ \rightarrow T ‘$的时候一定是可以把上面的那个东西所从$T ‘ \rightarrow S ‘$的所有流量全都退回去,因为这是一个可以构造的上界.也就相当于我们跑了一个环流.而在费用流里跑环流显然是不会影响答案的.</p>
<p>好,那么为啥这么做就不会出现负环了呢?因为你不可能在跑$S ‘ \rightarrow T ‘$的时候跑个正环出来,自然不可能出现负环.</p>
<p>另外有一点是,一个点可能向$S ‘$或$T ‘$连很多边,其实是可以拼掉的,因为这些边全都是零权边,而构造完后的图是非负权边.</p>
<h4><span id="模拟费用流">模拟费用流</span></h4><p>对于特殊的图,模拟EK费用流的增广过程并进行操作.</p>
<p>对着例题记吧.</p>
<h5><span id="example1luogup4694-pa2013raper">Example1(luoguP4694 [PA2013]Raper)</span></h5><h4><span id="散题">散题</span></h4><h5><span id="example1cqoi2014危桥">Example1([CQOI2014]危桥)</span></h5><p>有一个朴素的想法是:我们直接按题意建图,然后$S \rightarrow a_1 , b_1$,$T \rightarrow a_2 , b_2$,跑最大流然后检查是否满流.</p>
<p>问题在于,这样有可能会出现$a_1 \rightarrow b_2$的流量,我们怎么避免这种情况呢?</p>
<p>做法是,我们交换$b_1 , b_2$并重复上面的过程,如果还是满流,我们声明一定合法.</p>
<p>为什么呢?我们注意到此时网络上的流量分为四种:$a_1 \rightarrow a_2$,$a_1 \rightarrow b_2$,$b_1 \rightarrow a_2$,$b_1 \rightarrow b_2$.不难发现$a_1 \rightarrow b_2$和$b_1 \rightarrow a_2$的流量是相等的.</p>
<p>在第二次跑网络流时,我们不妨直接将$a_1 \rightarrow a_2$和$b_2 \rightarrow b_1$的流量加入答案并将这两条路径反向.此时,如果$a_1$还是要走到$b_1$,你发现第一轮的时候已经找到了一条$b_1 \rightarrow a_2$的路径,我们一定可以走这条来构造出只有$a_1 \rightarrow a_2$的路径,另一边同理.</p>
<h3><span id="图的计数问题">图的计数问题</span></h3><h4><span id="prufer序列">Prufer序列</span></h4><p>我们可以将一颗有编号$n$个点($n \geq 2$)的无根树与一个长度为$n - 2$的Prufer序列建立双射.换句话说,一颗有编号$n$个节点的无根树总共有$n^{ n - 2 }$种(Cayley公式).</p>
<p>首先证明一个树可以对应到一个序列:每次选择一个度数为$1$的编号最小的点,把它连向的点加到序列中并把这个点删去,直到最后只剩下两个节点,这样我们就把一棵树对应到一个序列.不难发现每个点出现的次数是其度数$- 1$.</p>
<p>然后证明一个序列可以还原成一棵树:</p>
<p>我们可以通过序列得知每个点的度数,每次找到度数中最小的那个点并把它与序列中的第一个元素连边并删去序列中的第一个元素,不断这么做显然可以还原树.</p>
<h5><span id="example">Example</span></h5><p>一个$n$个点的图有$k$个连通块,现在加入$k - 1$条边使得图连通,求方案数.</p>
<p>令$s_i$为第$i$个连通块的点数,$d_i$为第$i$个连通块所新连上的边数,如果我们令$\binom{ n }{ c_1 , c_2 , . . . , c_m } = \cfrac{ n ! }{ c_1 ! c_2 ! . . . c_m ! } , \sum_{ i = 1 }^m c_i = n \\$,也即将$n$个位置拆分成$m$个集合,第$i$个集合有$c_i$个位置的方案数.</p>
<p>那我们所需要做的也就是枚举每个连通块所新连出的边数$d_i$,于是答案即$\sum_d [ \sum d_i = 2 k - 2 ] \binom{ k - 2 }{ d_1 - 1 , d_2 - 1 , . . . , d_k - 1 } \prod_{ i = 1 }^k s_i^{ d_i } \\$.</p>
<p>注意到我们有多项式定理:$( x_1 + x_2 + . . . + x_m )^n = \sum_{ c } [ \sum c_i = n ] \binom{ n }{ c_1 , c_2 , . . . , c_m } \prod_{ i = 1 }^m x_i^{ c_i } \\$.</p>
<p>于是原式$= n^{ k - 2 } \prod_{ i = 1 }^k s_i$.</p>
<h4><span id="prufer序列的矩阵树定理理解">Prufer序列的矩阵树定理理解</span></h4><p>事实上,Prufer序列其实是可以拿矩阵树定理代替的(但是更麻烦一点).</p>
<p>我们先考虑证明Cayley公式:构造矩阵:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
- n + 1 & 1 & \cdots & 1 \\
1 & - n + 1 & \cdots & 1 \\
\vdots & \vdots & \ddots & \vdots \\
1 & 1 & \cdots & - n + 1
\end{bmatrix}</script><p>其主余子式为:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
- n + 1 & 1 & \cdots & 1 \\
1 & - n + 1 & \cdots & 1 \\
\vdots & \vdots & \ddots & \vdots \\
1 & 1 & \cdots & - n + 1
\end{bmatrix}</script><p>将所有行全部加到第一行:</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
- 1 & - 1 & \cdots & - 1 \\
1 & - n + 1 & \cdots & 1 \\
\vdots & \vdots & \ddots & \vdots \\
1 & 1 & \cdots & - n + 1
\end{bmatrix}</script><p>全部加下来,然后就成了上三角矩阵,将对角线乘起来就是$n^{ n - 2 }$.</p>
<p>连通块的结论是类似的.</p>
<h4><span id="lgv引理">LGV引理</span></h4><p>设$G$是一个有限的带权有向无环图,有点集$V$的一个大小为$n$的子集$A = \{ a_1 , a_2 , . . . , a_n \}$作为起点集合,一个大小为$n$的子集$B = \{ b_1 , b_2 , . . . , b_n \}$作为终点集合.</p>
<p>记边$i$的权值为$w_i$.对于有向路径$p$,记路径上所有边的边权的乘积为$W ( p )$.记$e ( u , v ) = \sum_{ p : u \rightarrow v } W ( p )$,即从$u$到$v$的所有路径的边权乘积之和.</p>
<p>记$P : A \rightarrow B = ( p_1 , p_2 , . . . , p_n )$,$p_i$表示从$a_i$到$b_{ \sigma ( i ) }$的一条路径,其中$\sigma$是一个排列,记$sign ( \sigma )$为$- 1$以这个排列的逆序对数量为幂的值.又记$\sigma ( P )$为$P$所对应终点的排列.若满足$\forall 1 \leq i , j \leq n , i \ne j$,$p_i$与$p_j$没有公共点,则记作$P^u$,否则记作$P^c$,若不作区分记作$P$.记$W_{ all } ( P ) = \prod_{ i = 1 }^n W ( p_i ) \\$,也就是所有路径的乘积.</p>
<p>设矩阵$M$满足$M_{ i , j } = e ( a_i , b_j )$,那么有:</p>
<script type="math/tex; mode=display">
\det M = \sum_{ P^u : A \rightarrow B } sign ( \sigma ( P^u ) ) W_{ all } ( P^u )</script><p>证明:</p>
<p>根据行列式的定义,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\det M & = \sum_{ \sigma } sign ( \sigma ) \prod_{ i = 1 }^n e ( a_i , b_{ \sigma ( i ) } ) \\
& = \sum_{ \sigma } sign ( \sigma ) \prod_{ i = 1 }^n \sum_{ p_i : a_i \rightarrow b_{ \sigma ( i ) } } w ( p_i ) \\

\end{aligned}</script><p>考虑后面那部分,$\prod_{ i = 1 }^n \sum_{ p_i : a_i \rightarrow b_{ \sigma ( i ) } } w ( p_i ) \\$形如一个卷积的形式,所以这个式子等价于所有对应排列为$\sigma$的$P$的$w ( P )$,所以有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\det M & = \sum_{ \sigma } sign ( \sigma ) ( \sum_{ P : \{ a_1 , . . . , a_n \} \rightarrow \{ b_{ \sigma ( 1 ) } , . . . , b_{ \sigma ( n ) } \} } w ( P ) ) \\
& = \sum_{ P : A \rightarrow B } sign ( \sigma ( P ) ) w ( P ) \\
& = \sum_{ P^u : A \rightarrow B } sign ( \sigma ( P^u ) ) w ( P^u ) + \sum_{ P^c : A \rightarrow B } sign ( \sigma ( P^c ) ) w ( P^c )
\end{aligned}</script><p>接下来只需证明$\sum_{ P^c : A \rightarrow B } sign ( \sigma ( P^c ) ) w ( P^c ) = 0 \\$即可.</p>
<p>设所有$P^c$组成的集合为$E$,考虑构造一个映射$f : E \rightarrow E$满足如下条件:</p>
<ol>
<li><p>$f ( P^c ) \ne P^c$.</p>
</li>
<li><p>$f ( f ( P^c ) ) = P^c$.</p>
</li>
<li><p>$w ( f ( P^c ) ) = w ( P^c )$.</p>
</li>
<li><p>$sign ( f ( P^c ) ) = - sign ( P^c )$.</p>
</li>
</ol>
<p>上面的结论即得证.</p>
<p>我们不妨考虑$P^c$中的第一对相交的路径$p_i$和$p_j$,并交换它们的终点.显然满足上述条件,于是结论得证.</p>
<h5><span id="example">Example</span></h5><p>现在有$n$个点,第$i$个点位于$( a_i , 1 )$,需要走到$( b_i , n )$.一个在$( x , y )$的点可以走向$( x + 1 , y )$或$( x , y + 1 )$.求路径不相交的方案数.</p>
<p>路径不相交,则终点排列只有可能是$\{ 1 , 2 , . . . , n \}$,直接使用LGV引理即可.</p>
<h4><span id="矩阵树定理">矩阵树定理</span></h4><h5><span id="无向图情况">无向图情况</span></h5><p>定义无向图的度数矩阵$D ( G )$为:$D ( G )_{ i , j } = \begin{cases}0 &amp; i \ne j \ \deg_{ i } &amp; i = j\end{cases}$.</p>
<p>令$w ( i , j )$为$i$与$j$之间直接相连的无向边个数,定义无向图的邻接矩阵$A ( G )_{ i , j } = \begin{cases}0 &amp; i = j \ w ( i , j ) &amp; i \ne j\end{cases}$</p>
<p>定义无向图的基尔霍夫矩阵(又称拉普拉斯矩阵)$L ( G ) = D ( G ) - A ( G )$.</p>
<p>记$t ( G )$为图$G$的生成树个数,那么有:$t ( G )$等于基尔霍夫矩阵任意一个主余子式.</p>
<p>引理:无向图的基尔霍夫矩阵的任意一个代数余子式都相等.</p>
<p>证明:考虑删去第$i$行,设剩下的矩阵为$A = [ \vec{ r }_1 , \vec{ r }_2 , . . . , \vec{ r }_n ]$,根据基尔霍夫矩阵的性质,不难发现$\sum{ \vec{ r }_i } = \vec{ 0 }$.$\forall 1 \leq j &lt; k \leq n$,如果我们删去第$j$列,考虑将除了第$k$列的其它列全部加到第$k$列,于是得到矩阵$[ \vec{ r }_1 , . . . , \vec{ r }_{ j - 1 } , \vec{ r }_{ j + 1 } , . . . , \vec{ r }_{ k - 1 } , - \vec{ r }_j , \vec{ r }_{ k + 1 } , . . . , \vec{ r }_n ]$.我们接下来一路将第$k$列交换到第$j + 1$列之前并取反,我们就得到了删去第$k$列的矩阵,于是有$M_{ i , j } = ( - 1 )^{ 1 + ( k - 1 ) - ( j + 1 ) + 1 } M_{ i , k }$,也就是$C_{ i , j } = C_{ i , k }$,同理可证明$C_{ j , i } = C_{ k , i }$.</p>
<p>接下来,用$T$表示生成树的边的集合,设$w ( T ) = \prod_{ e \in T } w ( e )$,我们只需证明$C_{ 1 , 1 } = \sum w ( T )$.</p>
<p>定义$\zeta ( e , u ) = v , e = \{ u , v \}$,考虑构造一个$n \times m$的矩阵$A$满足$A_{ i , j } = \begin{cases}1 &amp; i \in e_j \land i &lt; \zeta ( e_j , i ) \ - 1 &amp; i \in e_j \land i &gt; \zeta ( e_j , i ) \ 0 &amp; other\end{cases} \\$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
AA^T ( i , j ) & = \sum_{ k = 1 }^m A ( i , k ) A^T ( k , j ) \\
& = \sum_{ k = 1 }^m A ( i , k ) A ( j , k ) \\

\end{aligned}</script><p>当$i = j$时,不难发现$AA^T ( i , j ) = \sum_{ k = 1 }^m [ i \in e_k ] = \deg_i$.不然,注意到显然为$- \sum_{ k = 1 }^m [ i \in e_k ] [ j \in e_k ]$.也就是说,$AA^T = L$.</p>
<p>定义$A$删去第一行后得到的矩阵为$B$,则$BB^T = M_{ 1 , 1 }$.此时我们带入Cauchy-Binet公式,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
M_{ 1 , 1 } & = \sum_{ | S | = n - 1 , S \subseteq \{ 1 , 2 , . . . , m \} } \det ( B [ S ] B^T [ S ] ) \\
& = \sum_{ | S | = n - 1 , S \subseteq \{ 1 , 2 , . . . , m \} } \det ( B [ S ] )^2
\end{aligned}</script><p>接下来我们需要证明:如果$S$集合构成了一棵生成树,那么$\det B [ S ] = \pm 1$.反之,$\det B [ S ] = 0$.</p>
<p>如果集合没有构成一个生成树,则至少存在一个简单环.如果有某个点是孤立点那么答案肯定是$0$,因此只需考虑每个点都与边连通的情况即可.</p>
<p>考虑这种情况下,如果有两条边$( u_1 , u_2 )$和$( u_2 , u_3 )$被选上了,那么我们可以通过列变换将它们改为$( u_1 , u_2 )$和$( u_1 , u_3 )$.这样不断进行下去,如果存在环,一定会出现重边选择的情况,这个时候行列式的值为$0$.如果不存在环,那么我们可以通过这个操作得到一个菊花图.所以行列式为$\pm 1$.</p>
<p>所以定理得证.</p>
<h6><span id="example省选联考-2020-a-卷作业题">Example([省选联考 2020 A 卷]作业题)</span></h6><p>给定一个图,设第$i$条边的权值为$w_i$,求所有生成树的$\gcd ( w_1 , . . . , w_{ n - 1 } ) \sum_{ i = 1 }^{ n - 1 } w_i$之和.</p>
<p>首先前面的$\gcd$可以使用$\varphi * I = id$来处理.于是剩下的问题在于我们如何将一个生成树的边的和代替乘积作为贡献来求和.</p>
<p>不妨进行扩域,令$j^2 = 0 , j \ne 0$,这样我们可以类比复数来将每个数写作$a + bj$的模式.考虑将每条边的边权改为$w_i j + 1$并定义新域的四则运算,取最后得到的数$a + bj$的$b$作为答案即可.</p>
<p>另外,注意到这样做复杂度$wn^3$,很难通过.考虑每次只当边数大于等于$n - 1$的时候再跑行列式.不妨设$\sigma ( n )$为$n$的因数个数,考虑如果因数很分散,那肯定复杂度很低,不然,我们有复杂度$O ( n^3 \cfrac{ \sum_{ i = 1 }^m \sigma ( w_i ) }{ n - 1 } )$,可以通过.</p>
<h6><span id="example北京省选集训2019生成树计数">Example([北京省选集训2019]生成树计数)</span></h6><p>给定一个图,设第$i$条边的权值为$w_i$,求所有生成树的$( \sum_{ i = 1 }^{ n - 1 } w_i )^k$之和.</p>
<p>考虑将第$e$条边边权改为$\sum_{ i = 0 }^k \cfrac{ w_e^i x^i }{ i ! }$.根据多项式定理,显然最后取$[ x^k ]$并乘以$k !$即可.</p>
<h5><span id="有向图情况">有向图情况</span></h5><p>定义有向图的出度矩阵$D^{ out } ( G ) = \begin{cases}0 &amp; i \ne j \ \deg^{ out }_i &amp; i = j\end{cases}$,类似地可以定义入度矩阵$D^{ in } ( G )$.</p>
<p>令$cnte ( i , j )$为从$i$直接连向$j$的有向边个数,定义有向图的邻接矩阵$A ( G )_{ i , j } = \begin{cases}0 &amp; i = j \ cnte ( i , j ) &amp; i \ne j\end{cases}$</p>
<p>定义有向图的出度基尔霍夫矩阵$L^{ out } ( G ) = D^{ out } ( G ) - A ( G )$,同理可以定义其入度基尔霍夫矩阵$L^{ in } ( G )$.</p>
<p>记$t^{ root } ( r , G )$为图$G$以$r$为根的根向生成树($r$为根时,所有边都从儿子指向父亲)个数,同理可以定义叶向生成树个数$t^{ leaf } ( r , G )$.</p>
<p>设$M^{ out }_{ r , r }$为$L^{ out }$的主余子式,有$t^{ root } ( r , G ) = M^{ out }_{ r , r }$.叶向同理.</p>
<p>下面只简单提到根向生成树的证明,叶向同理.</p>
<p>类似于无向图,我们考虑构造$n \times m$矩阵$A$和$( n - 1 ) \times m$矩阵$B$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
A_{ i , j } & = \begin{cases}
1 & e_j ' s \ head \ is \ i \\
- 1 & e_j ' s \ tail \ is \ i \\
0 & other
\end{cases} \\
B_{ i , j } & = \begin{cases}
1 & e_j ' s \ head \ is \ i \\
0 & other
\end{cases}
\end{aligned}</script><p>剩下的部分与无向图类似.</p>
<h4><span id="best定理">BEST定理</span></h4><p>设$ec ( G )$为有向图$G$的欧拉回路个数,若其存在欧拉回路,则:</p>
<script type="math/tex; mode=display">
ec ( G ) = t^{ root } ( G , x ) \prod_{ i = 1 }^n ( \deg_i - 1 ) !</script><p>其中$\deg_i = \deg^{ in }_i = \deg_i^{ out }$.</p>
<p>考虑如果勒令以$x$为起点,我们保留除了$x$以外每个点的最后经过的出边,最后一定会形成一棵根向树.而其他点可以随便选(由于我们勒令了每个点存在一个出边,所以不可能走到死胡同),这样的答案是$t^{ root } ( G , x ) \deg_x \prod_{ i = 1 }^n ( \deg_i - 1 ) !$.</p>
<p>但是如果没有规定起点,考虑循环重构,在我们选择不同的边当作初始边时,只需循环一下总体的顺序,就可以得到以另一条边为初始边的另一个图,所以答案要比规定起点的答案多除一个$\deg_x$.</p>
<h4><span id="格路计数问题">格路计数问题</span></h4><h5><span id="定义">定义</span></h5><ol>
<li><p>在平面直角坐标系中,横坐标和纵坐标都是整数的点称为格点,平面格路是指从一个格点到另一格点只走格点的路,格路的长度是指其所走的路的步数.</p>
</li>
<li><p>对于一条从$( 0 , 0 )$到$( n , m )$的格路,若其只使用了上步$U = ( 0 , 1 )$,右步$L = ( 1 , 0 )$,则我们称其为$( n , m )$自由路.</p>
</li>
<li><p>记$\mathcal{ F } ( n , m )$为$( n , m )$自由路的集合,$F ( n , m ) = # \mathcal{ F } ( n , m )$为$( n , m )$自由路数量,即$\mathcal{ F } ( n , m )$的元素个数,显然$F ( n , m ) = \binom{ n + m }{ n } \\$.</p>
</li>
<li><p>对于一条从$( 0 , 0 )$到$( n , m )$的自由路,若其始终不经过对角线$y = \cfrac{ m }{ n } x$下方,则我们称之为$( n , m ) - Dyck$路.</p>
</li>
<li><p>记$\mathcal{ D } ( n , m )$为$( n , m )$自由路的集合,$D ( n , m ) = # \mathcal{ D } ( n , m )$为$( n , m )$自由路数量,即$\mathcal{ D } ( n , m )$的元素个数.</p>
</li>
<li><p>对于从$( 0 , 0 )$到$( n , m )$的$2$条格路$P , Q$,其中$P = u_1 u_2 . . . u_{ n + m } , Q = v_1 v_2 . . . v_{ n + m } ( u_i , v_i \in{ L , U } , i = 1 , 2 , . . . , n + m )$.若 $\exists i , u_{ i + 1 } . . . u_{ n + m } u_1 . . . u_i = v_1 v_2 . . . v_{ n + m }$,则我们称格路$P , Q$等价.将$P$的等价格路全集记为$[ P ]$.</p>
</li>
<li><p>对于任意格路$P$,记$P_k = u_{ k + 1 } . . . u_{ n + m } u_1 . . . u_k$,则$[ P ] = \{ P_k | k = 1 , 2 , 3 , · · · , n + m \}$.定义$P$的周期为使得$P = P_k$的最小数$k$，用$period ( P )$表示,则显然有$# [ P ] = period ( P )$.</p>
</li>
</ol>
<h5><span id="定理">定理</span></h5><h4><span id="散模型">散模型</span></h4><h5><span id="多叉堆计数">多叉堆计数</span></h5><p>有一棵树,要求给每个点一个$[ 1 , n ]$的权值且不同的点权值不同,满足父亲的权值小于儿子的权值,求方案数.</p>
<p>不妨设以$u$为根节点的子树方案数为$f_u$,$u$的儿子是$v_1 , . . . , v_k$,注意到$f_u = \binom{ siz_u - 1 }{ siz_{ v_1 } , siz_{ v_2 } , . . . , siz_{ v_k } } \prod f_{ v_i } = ( siz_u - 1 ) ! \prod_{ u \rightarrow v } \frac{ f_{ v } }{ siz_v ! } \\$.</p>
<p>那么考虑根的答案$f_1$,考虑不断将$f_1$中含有的其它$f_u$向下展开,自然的,除了$1$号点外,每个点对答案都贡献了一个$\frac{ 1 }{ siz }$,而根的贡献是$( n - 1 ) !$.</p>
<p>也就是说,$ans = ( n - 1 ) ! \prod_{ u = 2 }^n \frac{ 1 }{ siz_u } = n ! \prod_{ u = 1 }^n \frac{ 1 }{ siz_u } \\$.</p>
<h6><span id="example1agc060c-large-heap">Example1([AGC060C] Large Heap)</span></h6><p>如果没有限制,就是一个简单的多叉堆计数.</p>
<p>而有了限制怎么做呢?我们考虑把$u$到$1$的路径和$v$到$1$的路径归并起来,会得到一条长链.我们只要确定了长链上的元素,通过组合数以及二叉堆计数,自然可以算出不在长链上的元素的答案.而对于长链上的元素,我们可以直接设计一个$O ( n^2 )$的dp即可.</p>
<h6><span id="example2heoi2013sao">Example2([HEOI2013]SAO)</span></h6><p>显然给出的是一张树形图,然后每条边有一个限制表示这条边所连接的两个点哪个更大.现在给每个点一个$[ 1 , n ]$的权值且不同的点权值不同求方案数.</p>
<p>我们随便找一个点然后当成有根树做,然后如果只有父亲小于儿子的边就是简单的多叉堆计数.不然,我们可以做一个简单容斥.这样问题就又转化回多叉堆计数,容斥部分写一个树形dp就好.</p>
<p>补一下,这个树形dp没有那么简单.首先你注意到多叉堆计数是跟子树大小有关系的,所以你不能简单地设计$f_{ i , j }$表示$i$子树内选中了$j$条边的代价,你必须加一维来处理子树大小,也就是设$f_{ u , siz , cnt }$表示$u$所在连通块大小为$siz$,子树中总共选择了$cnt$条边的代价.</p>
<p>但是注意到这题的容斥系数是$( - 1 )^k$,其中$k$是选择的儿子小于父亲的数量,然后其它的要求儿子大于父亲的边随便选.你发现你选中了一条边,无非是对答案乘以一个$- 1$,这是没有必要记录的.因此直接以$f_{ u , siz }$的状态转移就行.</p>
<p>这个故事告诉我们别什么容斥都最后算,你能在做的过程中把$- 1$乘上去就别惦记最后统一求和了.</p>
<h5><span id="三元环计数">三元环计数</span></h5><p>我们对原图建立一个新的有向图,在新图中,如果$u \rightarrow v$,则在原图中$\deg u &lt; \deg v$或$\deg u = \deg v \land u &lt; v$.根据自然根号,每个点的出度不会超过$O ( \sqrt{ n } )$.</p>
<p>接下来枚举原图的一条边$u \leftrightarrow v$,只要在新的图中找到$w$满足$u \rightarrow v , u \rightarrow w , v \rightarrow w$即可.打tag做一做,复杂度$O ( n \sqrt{ n } )$.</p>
<h5><span id="四元环计数">四元环计数</span></h5><p>仍然类似三元环计数那样建立新图.</p>
<p>考虑原图中的两条边$u \leftrightarrow v$和$u \leftrightarrow v ‘$,我们考虑对四元环中度数最大的那个点$w$计数,对于这个$w$统计一个tag表示形如$u \leftrightarrow v \rightarrow w$的数量,每次改变$u$的时候清空一下全图tag.</p>
<h5><span id="有标号dag计数">有标号DAG计数</span></h5><p>即:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_n & = \sum_{ k = 1 }^n \binom{ n }{ k } ( - 1 )^{ k - 1 } 2^{ k ( n - k ) } f_{ n - k } \\

\end{aligned}</script><p>证明见反演与容斥-子集反演-Example2.</p>
<h6><span id="example1qoj5749">Example1(qoj5749)</span></h6><p>注意到一个环内部不能有任何边,那么其实也就是有标号DAG计数,只不过要乘上一个斯特林数.不妨设$g_{ n , m }$为$n$个点$m$条边的答案,再设$G_n$为其生成函数.事实上,我们自然有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
G_n & = \sum_{ k = 1 } \binom{ n }{ k } \sum_{ j = 1 }^k{ k \brack j } ( - 1 )^{ j - 1 } ( 1 + z )^{ k ( n - k ) } G_{ n - k } \\
& = \sum_{ k = 1 } \binom{ n }{ k } ( 1 + z )^{ k ( n - k ) } G_{ n - k } \sum_{ j = 1 }^k{ k \brack j } ( - 1 )^{ j - 1 } \\

\end{aligned}</script><p>逆用斯特林公式,如果$n \geq 1$:</p>
<script type="math/tex; mode=display">
\sum_{ i }{ n \brack i } ( - 1 )^{ i - 1 } = ( - 1 ) \times ( - 1 )^{ \overline{ n } } = [ n = 1 ]</script><p>注意到$G_1 = 1$,于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
G_n & = n ( 1 + z )^{ n - 1 } G_{ n - 1 } \\
& = n ! ( 1 + z )^{ \frac{ n ( n - 1 ) }{ 2 } } \\
[ z^m ] G_n & = n ! \binom{ \frac{ n ( n - 1 ) }{ 2 } }{ m }
\end{aligned}</script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8F%8D%E6%BC%94%E4%B8%8E%E5%AE%B9%E6%96%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8F%8D%E6%BC%94%E4%B8%8E%E5%AE%B9%E6%96%A5/" class="post-title-link" itemprop="url">反演与容斥</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-08-04 00:40:55" itemprop="dateModified" datetime="2025-08-04T00:40:55+08:00">2025-08-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%85%B7%E4%BD%93%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">具体数学</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8F%8D%E6%BC%94%E4%B8%8E%E5%AE%B9%E6%96%A5/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8F%8D%E6%BC%94%E4%B8%8E%E5%AE%B9%E6%96%A5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h2><span id="反演">反演</span></h2><p>假设有两个函数$f$和$g$满足:$f ( n ) = \sum_{ k } a_{ n , k } g ( k )$,已知f求g的过程称为反演.</p>
<p>一般情况下,求反演只能高斯消元,但是有一些形式的反演有巧妙解法.</p>
<h3><span id="子集反演">子集反演</span></h3><p>一般形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( S ) & = \sum_{ T \subseteq S } g ( T ) \Leftrightarrow g ( S ) = \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } f ( T ) \\
f ( S ) & = \sum_{ S \subseteq T \subseteq U } g ( T ) \Leftrightarrow g ( S ) = \sum_{ S \subseteq T \subseteq U } ( - 1 )^{ | T | - | S | } f ( T )
\end{aligned}</script><p>证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( S ) & = \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } f ( T ) \\
& = ( - 1 )^{ | S | } \sum_{ T \subseteq S } ( - 1 )^{ | T | } \sum_{ P \subseteq T } g ( P ) \\
& = ( - 1 )^{ | S | } \sum_{ P \subseteq S } g ( P ) \sum_{ T \subseteq S / P } ( - 1 )^{ | T | + | P | } \\
& = ( - 1 )^{ | S | } \sum_{ P \subseteq S } g ( P ) ( - 1 )^{ | P | } \sum_{ T \subseteq S / P } ( - 1 )^{ | T | } \\
& = ( - 1 )^{ | S | } \sum_{ P \subseteq S } g ( P ) [ S = P ] ( - 1 )^{ | P | } \\
& = g ( S )
\end{aligned}</script><p>不难发现,这个子集反演也就相当于在做高维前后缀和.</p>
<h5><span id="example12019zrpzt七连day1d">Example1(2019zrpzt七连day1D)</span></h5><p>根据子集反演,设$cnt_S$为集合为$S$的数量,然后设$f_S = \sum_{ S ‘ \subseteq S } cnt_{ S ‘ }$,有:$ans = \sum_{ S } 2^{ f_S } ( - 1 )^{ n - | S | }$.</p>
<p>做一遍高维前缀和就好,复杂度$O ( n 2^n )$,应该也可以用分治FMT无脑做到$O ( n^2 2^n )$.</p>
<h5><span id="example2有标号dag计数">Example2(有标号DAG计数)</span></h5><p>设$f_{ i , j }$表示$i$个点,其中有$j$个点的入度数为$0$的方案数.(等一下,为撒子想到要记度数为$0$的点咧?因为你要一层一层转移,而在DAG中一层一层的就是零度点.而且说到底,你注意到有编号这个事实其实是很烦的,因为考虑如果一个一个点放上去,就有可能出现放的地方是等价的.而这么一层一层是绝对不会出现等价点的问题的.再说的仔细一点,如果我们把位置空着,然后选出一些放上来,是会出现等价点的问题的.但如果我们先选出来,然后再把边连上就不会.于是我们必须要枚举一些点然后再连到上面去)</p>
<p>这样我们每次枚举删去这$j$个点后,还剩下$k$个零度点.于是自然有:</p>
<script type="math/tex; mode=display">
f_{ i , j } = \binom{ i }{ j } \sum_{ k = 1 }^{ i - j } ( 2^j - 1 )^k 2^{ j ( i - j - k ) } f_{ i - j , k }</script><p>等一下咧,这复杂度$O ( n^3 )$了,这咋办啊?</p>
<p>好像转移优化不太了,因为$k$很难省去(在指数上).但我们注意到我们定义的时候说:$0$度点的数量恰好为$k$,这个条件好像太强了<del>果然OI就是发现限制太强了就弱一点,发现太弱了就强一点</del>,所以我们想办法把它放弱一点.</p>
<p>一个经典的方法是:我们把定义改为至少$k$个零度点.但是这样转移好像还是不太行:零度点的情况太多了.那我们不妨考虑容斥,因为推导容斥的过程中,永远不害怕情况太多:我们直接考虑所有情况的集合.<del>当然能不能推到最后是另一回事</del>.</p>
<p>我们设$f ( n , S )$表示$n$个点,其中只有$S$中的点的入度为$0$;类似定义$g ( n , S )$表示$n$个点,至少$S$中的点的入度为$0$.显然我们所求也就是$g ( n , \emptyset )$,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n , S ) & = 2^{ | S | ( n - | S | ) } g ( n - | S | , \emptyset ) \\
g ( n , S ) & = \sum_{ S \subseteq T } f ( n , T )
\end{aligned}</script><p>对第二个式子用子集反演,有:</p>
<script type="math/tex; mode=display">
f ( n , S ) = \sum_{ S \subseteq T } ( - 1 )^{ | T | - | S | } g ( n , T )</script><p>接下来使用反复带入大法:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n , \emptyset ) & = \sum_{ \emptyset \ne T } f ( n , T ) \\
& = \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } g ( n , S ) \\
& = \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } 2^{ | S | ( n - | S | ) } g ( n - | S | , \emptyset ) \\
& = \sum_{ m = 1 }^n \sum_{ | T | = m } \sum_{ T \subseteq S } ( - 1 )^{ | S | - | T | } 2^{ | S | ( n - | S | ) } g ( n - | S | , \emptyset ) \\
& = \sum_{ m = 1 }^n \binom{ n }{ m } \sum_{ k = m }^n \binom{ n - m }{ k - m } ( - 1 )^{ k - m } 2^{ k ( n - k ) } g ( n - k , \emptyset ) \\

\end{aligned}</script><p>可以发现:我们在推式子的过程中,将和集合本身有关的性质转化为了只和集合大小有关的式子,于是就简化了大量运算.</p>
<p>接下来我们继续化简:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ m = 1 }^n \binom{ n }{ m } \sum_{ k = m }^n \binom{ n - m }{ k - m } ( - 1 )^{ k - m } 2^{ k ( n - k ) } g ( n - k , \emptyset ) \\
= & \sum_{ k = 1 }^n \sum_{ m = 1 }^k \binom{ n }{ m } \binom{ n - m }{ k - m } ( - 1 )^{ k - m } 2^{ k ( n - k ) } g ( n - k , \emptyset ) \\
= & \sum_{ k = 1 }^n \binom{ n }{ k } 2^{ k ( n - k ) } g ( n - k , \emptyset ) \sum_{ m = 1 }^k \binom{ k }{ m } ( - 1 )^{ k - m } \\
= & \sum_{ k = 1 }^n \binom{ n }{ k } 2^{ k ( n - k ) } g ( n - k , \emptyset ) ( ( 1 - 1 )^k - ( - 1 )^k ) \\
= & \sum_{ k = 1 }^n \binom{ n }{ k } 2^{ k ( n - k ) } g ( n - k , \emptyset ) ( - 1 )^{ k - 1 } \\

\end{aligned}</script><p>注意到复杂度已经降到$O ( n^2 )$了.</p>
<p>上面是从集合的角度一步步分析得到的.但如果你直接从容斥的角度考虑,忽略掉那个$( - 1 )^{ k - 1 }$,把它当成一个可以数学归纳出来的容斥系数,那么这个式子会得到一个很简单的理解方式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_n & = \sum_{ k = 1 }^n \binom{ n }{ k } ( - 1 )^{ k - 1 } 2^{ k ( n - k ) } f_{ n - k } \\

\end{aligned}</script><p>也就是直接设,然后钦定其有至少$j$个,然后配容斥系数.</p>
<h3><span id="二项式反演">二项式反演</span></h3><p>一般形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \sum_{ k = 0 }^n C_n^k g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = 0 }^n ( - 1 )^{ n - k } C_n^k f ( k ) \\
f ( n ) & = \sum_{ k = 0 }^n ( - 1 )^k \binom{ n }{ k } g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = 0 }^n ( - 1 )^k \binom{ n }{ k } f ( k ) \\
f ( n ) & = \sum_{ k = n }^N C_k^n g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = n }^N ( - 1 )^{ k - n } C_k^n f ( k ) \\
f ( n ) & = \sum_{ k = n }^N ( - 1 )^k \binom{ k }{ n } g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = n }^N ( - 1 )^k \binom{ k }{ n } f ( k ) \\

\end{aligned}</script><p>显然以$( - 1 )^n g ( n )$代替$g ( n )$即可从第一个式子推导第二个式子,下面证明第一个式子:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ k = 0 }^n ( - 1 )^{ n - k } C_n^k f ( k ) \\
& = \sum_{ m = 0 }^n \sum_{ k = 0 }^{ n - m } ( - 1 )^k C_{ n - m }^k C_n^m g ( m ) \\
& = \sum_{ k = 0 }^n ( - 1 )^k C_n^k \sum_{ m = 0 }^{ n - k } C_{ n - k }^m g ( m ) \\
& = \sum_{ k = 0 }^n ( - 1 )^k C_n^k f ( n - k ) \\
& = \sum_{ k = 0 }^n ( - 1 )^{ n - k } C_n^k f ( k ) \\

\end{aligned}</script><h5><span id="example1错排问题">Example1(错排问题)</span></h5><p>$n$个有编号的人站成一排,求他们都没有站到自己编号对应位置的方案数.</p>
<p>设$f ( n )$为$n$个人随便站的方案数,$g ( n )$为$n$个人都站错的方案数.</p>
<p>如果知道$g$的表达式,我们可以通过枚举有多少人站错位置来得到$f$,即:$f ( n ) = \sum_{ k = 0 }^n C_n^k g ( k )$.</p>
<p>显然就是一个二项式反演,$g ( n ) = \sum_{ k = 0 }^n ( - 1 )^{ n - k } C_n^k f ( k ) = \sum_{ k = 0 }^n ( - 1 )^{ n - k } C_n^k k !$.</p>
<p>值得一提的是,我们再观察一下最后得到的错排公式并进行一定的化简,可以得到:$g ( n ) = n ! \sum_{ 0 \leq k \leq n } \cfrac{ ( - 1 )^k }{ k ! } \\$.</p>
<p>不难发现$n !$的后面形如$e^{ - 1 }$的泰勒展开,我们考虑直接将泰勒展开的公式带入,可以得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \cfrac{ n ! }{ e } - n ! \sum_{ k > n } \cfrac{ ( - 1 )^k }{ k ! } \\
& = \cfrac{ n ! }{ e } - \cfrac{ ( - 1 )^{ n + 1 } }{ n + 1 } \sum_{ 0 \leq k } ( - 1 )^k \cfrac{ ( n + 1 ) ! }{ ( k + n + 1 ) ! }
\end{aligned}</script><p>用一些我不会的方法分析误差,会发现后面的项所能带来的误差很小,于是有$g ( n ) = \lfloor \cfrac{ n ! }{ e } + \cfrac{ 1 }{ 2 } \rfloor + [ n = 0 ]$.</p>
<p>另外,观察$g$关于$f$的表达式,不难求出$g$的递推式:$g ( n ) = ng ( n - 1 ) + ( - 1 )^n$.</p>
<p>下面证明$g_n = ( n - 1 ) ( g_{ n - 1 } + g_{ n - 2 } )$,事实上,右边等于:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& ( n - 1 ) ( g_{ n - 1 } + g_{ n - 2 } ) \\
= & ( - 1 )^{ n - 1 } ( n - 1 ) + ( n - 1 ) \sum_{ k = 0 }^{ n - 2 } ( ( n - 1 ) ! \frac{ ( - 1 )^k }{ k ! } + ( n - 2 ) ! \frac{ ( - 1 )^k }{ k ! } ) \\
= & n ! \sum_{ k = 0 }^{ n - 2 } \frac{ ( - 1 )^k }{ k ! } - ( n - 1 ) ( - 1 )^n \\

\end{aligned}</script><h5><span id="example2cf1750g">Example2(CF1750G)</span></h5><p>如果没有字典序限制就是经典的二项式反演:考虑能被分为$k$段,说明有$n - k$个位置和前一个位置是大一的关系.我们钦定这些位置即可.</p>
<p>而有字典序限制也很经典,枚举LCP,枚举下一个位置,这个时候值域被分为若干个区间,假设剩了$x$个数字,$y$个区间,那么钦定$j$对的方案是$\binom{ x - y }{ j } ( x - j ) !$.然后要乘上前面已经有了的,也就是乘上形如$( 1 + z )^k$.这样复杂度$O ( n^4 )$.</p>
<p>这种问题通常LCP后的下一个位置都可以规避,这里你发现不同的取值只会让后面的$x , y , k$有$O ( 1 )$种不同的取值,因此不用枚举.这样就是$O ( n^3 )$.但是那个多项式乘法也可以规避,考虑最后的答案形如$\sum ( 1 + z )^k P_k ( x )$,我们考虑写成$P_{ n - 1 } ( z ) + = ( 1 + z ) P_n ( z )$,然后不断这么做,就只需要$O ( n^2 )$.</p>
<h5><span id="example3cf1228e">Example3(CF1228E)</span></h5><p>不妨设至多有$i$行$j$列最小值为$1$的答案是$f_{ i , j }$,恰好有$i$行$j$列最小值为$1$的答案是$g_{ i , j }$,注意到:</p>
<script type="math/tex; mode=display">
f_{ n , m } = \sum_{ i = 0 }^n \binom{ n }{ i } \sum_{ j = 0 }^m \binom{ m }{ j } g_{ i , j }</script><p>令$h_{ n , m } = \sum_{ j = 0 }^m \binom{ m }{ j } g_{ n , j } \\$,则$f_{ n , m } = \sum_{ i = 0 }^n \binom{ n }{ i } h_{ i , m } \\$,而$f_{ n , m } = k^{ nm } ( k - 1 )^{ NM - nm }$.做两次二项式反演得到$g$.</p>
<p>写到这里发现一个问题(其实是我发现问题后把上面原本写错的给改了),为啥$f_{ n , m } \ne \binom{ N }{ n } \binom{ M }{ m } k^{ nm } ( k - 1 )^{ NM - nm }$呢?我们写成子集反演形式看看:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ S , T } & = \sum_{ s \subseteq S } \sum_{ t \subseteq T } g_{ s , t } \\
f_{ S , T } & = \sum_{ s \subseteq S } h_{ s , T } \\
h_{ S , T } & = \sum_{ t \subseteq T } g_{ S , t } \\

\end{aligned}</script><p>做子集反演:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ S , T } & = k^{ | S | \times | T | } ( k - 1 )^{ NM - | S | | T | } \\
h_{ s , T } & = \sum_{ S \subseteq s } ( - 1 )^{ | s | - | S | } f_{ S , T } \\
g_{ s , t } & = \sum_{ T \subseteq t } ( - 1 )^{ | t | - | T | } h_{ s , T }
\end{aligned}</script><p>把集合改成集合大小就可以发现问题所在:</p>
<p>换句话说,$g_{ n , m }$本身就包含了所有$| S | = n , | T | = m$的情况的和,并且在组合数$\binom{ m }{ j }$那里就找到了唯一确定的$f_{ s , t }$,因此$f_{ n , m }$是唯一确定的.这意味着这里$f$的$n , m$并非集合之和,而是已经确定的集合的大小.</p>
<p>啥?这和我平常接触的二项式反演不一样啊?不说别的,第四题(BZOJ2839)的式子是这样的:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_i & = 2^{ 2^{ n - i } } \binom{ n }{ i } \\
f_k & = \sum_{ i = k }^n \binom{ i }{ k } g_i \\
g_k & = \sum_{ i = k }^n ( - 1 )^{ i - k } \binom{ i }{ k } f_i
\end{aligned}</script><p>冷静一下,二项式反演的公式肯定没错,那也就一定是下面这几句出现了问题:</p>
<script type="math/tex; mode=display">
f_{ n , m } = \sum_{ i = 0 }^n \binom{ n }{ i } \sum_{ j = 0 }^m \binom{ m }{ j } g_{ i , j }</script><p>这个问题其实非常显然,我们的$g_{ i , j }$定义为所有$| S | = i , | T | = j$的答案之和.$f$也是这么定义的,那这个式子就是错的,应该写成:</p>
<script type="math/tex; mode=display">
f_{ n , m } = \sum_{ i = 0 }^n \binom{ N - i }{ n - i } \sum_{ j = 0 }^m \binom{ M - j }{ m - j } g_{ i , j }</script><p>这样才是在不确定的那些行列中选择组合数,而不是在确定的那些行列中选.</p>
<p>但这样又有一个问题,就是这个题的特殊性,这个题要求$g_{ N , M }$,那此时$g$怎么定义不应该是一样的吗?</p>
<p>当然不一样,二项式反演讲究统一性,所有的定义必须遵循一个统一的原则,不然如果什么样子的函数都能反演,那一般的反演就不是一个需要解方程才能完成的东西了.</p>
<p>回到第四题,再看一遍这个式子:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_k & = \sum_{ i = k }^n \binom{ i }{ k } g_i \\

\end{aligned}</script><p>这个定义式就非常良性,$g$是已知的集合,$f$是未知的集合.我们乘上组合数就可以得到对于$f$来说已知的集合.因此这个就非常正确.</p>
<p>回到这个题上,为什么我们最后把$f$的定义改成$f_{ n , m } = k^{ nm } ( k - 1 )^{ NM - nm }$就对了呢?</p>
<p>再看看这个式子:</p>
<script type="math/tex; mode=display">
f_{ n , m } = \sum_{ i = 0 }^n \binom{ n }{ i } \sum_{ j = 0 }^m \binom{ m }{ j } g_{ i , j }</script><p>这个式子的右边在干这样一件事:那就是在已知$n$行$m$列的集合的前提下,从中选出$i$行$j$列并求$g$.那么你从哪知道的$n$行$m$列呢?你得组合数啊!</p>
<p>所以,实际上的$f$是这样的:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ n , m } & = \binom{ N }{ n } \binom{ M }{ m } \sum_{ i = 0 }^n \binom{ n }{ i } \sum_{ j = 0 }^m \binom{ m }{ j } g_{ i , j } \\
f_{ n , m } & = \binom{ N }{ n } \binom{ M }{ m } k^{ nm } ( k - 1 )^{ NM - nm }
\end{aligned}</script><p>好麻烦啊,能不能避免这种需要进一步思考集合意义的问题呢?</p>
<p>考虑二项式反演的第二个形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \sum_{ k = n }^N C_n^k g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = n }^N ( - 1 )^{ k - n } C_n^k f ( k ) \\

\end{aligned}</script><p>不难发现这个式子无论怎么写,前后都一定是从已知集合中选东西.绝对不会出现上面的问题.</p>
<p>因此,我们重新写一下这个题的相关式子,考虑直接正难则反,设$f ‘_{ i , j }$为至少有$i$行$j$列不满足条件的方案数,自然有$f ‘_{ i , j } = f_{ N - i , M - j }$.你发现此时一定有:</p>
<script type="math/tex; mode=display">
f '_{ n , m } = \sum_{ i = n }^N \binom{ i }{ n } \sum_{ j = m }^M \binom{ j }{ m } g '_{ i , j }</script><p>最后答案就是$g ‘_{ 0 , 0 }$.</p>
<h3><span id="斯特林反演">斯特林反演</span></h3><p>一般形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \sum_{ k = 0 }^n \left \{ \begin{array}
{ c } n \\
k
\end{array} \right \} g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] ( - 1 )^{ n - k } f ( k ) \\
f ( n ) & = \sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] g ( k ) \Leftrightarrow g ( n ) = \sum_{ k = 0 }^n \left \{ \begin{array}
{ c } n \\
k
\end{array} \right \} ( - 1 )^{ n - k } f ( k ) \\
f ( m ) & = \sum_{ n = m }^M ( - 1 )^{ m - n } \left [ \begin{array}
{ c } n \\
m
\end{array} \right ] g ( n ) \Leftrightarrow g ( m ) = \sum_{ k = 0 }^M \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} f ( k ) \\
f ( m ) & = \sum_{ n = m }^M ( - 1 )^{ m - n } \left \{ \begin{array}
{ c } n \\
m
\end{array} \right \} g ( n ) \Leftrightarrow g ( m ) = \sum_{ k = 0 }^M \left [ \begin{array}
{ c } k \\
m
\end{array} \right ] f ( k ) \\

\end{aligned}</script><p>考虑第一类斯特林数和第二类斯特林数的对称性,只需证明第一个和第三个式子即可.</p>
<p>反转公式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} ( - 1 )^{ n - k } & = \sum_{ k = 0 }^n \left \{ \begin{array}
{ c } n \\
k
\end{array} \right \} \left [ \begin{array}
{ c } k \\
m
\end{array} \right ] ( - 1 )^{ n - k } = [ m = n ] \\

\end{aligned}</script><p>第一个式子的证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ m = 0 }^n [ m = n ] g ( m ) \\
& = \sum_{ m = 0 }^n \sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} ( - 1 )^{ n - k } g ( m ) \\
& = \sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] ( - 1 )^{ n - k } \sum_{ m = 0 }^k \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} g ( m ) = \sum_{ k = 0 }^n \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] ( - 1 )^{ n - k } f ( k ) \\

\end{aligned}</script><p>第三个式子的证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( m ) & = \sum_{ n = m }^M [ n = m ] g ( n ) \\
& = \sum_{ n = m }^M \sum_{ k = 0 }^M \left [ \begin{array}
{ c } n \\
k
\end{array} \right ] \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} ( - 1 )^{ n - k } g ( n ) \\
& = \sum_{ k = 0 }^M \left \{ \begin{array}
{ c } k \\
m
\end{array} \right \} f ( k ) \\

\end{aligned}</script><h3><span id="莫比乌斯反演">莫比乌斯反演</span></h3><p>一般形式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \sum_{ d | n } g ( d ) \Leftrightarrow g ( n ) = \sum_{ d | n } \mu ( \frac{ n }{ d } ) f ( d ) \\
f ( n ) & = \sum_{ n | d } g ( d ) \Leftrightarrow g ( n ) = \sum_{ n | d } \mu ( \frac{ d }{ n } ) f ( d ) \\
f ( x ) & = \sum_{ 1 \leq d } g ( d ) \Leftrightarrow g ( x ) = \sum_{ 1 \leq d } f ( \cfrac{ x }{ d } ) \mu ( d )
\end{aligned}</script><p>第一个式子的证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ m | n } [ \frac{ n }{ m } = 1 ] g ( m ) \\
& = \sum_{ m | n } \sum_{ d | \frac{ n }{ m } } \mu ( d ) g ( m ) \\

\end{aligned}</script><p>注意到$[ d | \frac{ n }{ m } ] = [ md | n ] = [ m | \frac{ n }{ d } ] \\$.</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ d | n } \mu ( d ) \sum_{ m | \frac{ n }{ d } } g ( m ) \\
& = \sum_{ d | n } \mu ( d ) f ( \frac{ n }{ d } ) \\
& = \sum_{ d | n } \mu ( \frac{ n }{ d } ) f ( d ) \\

\end{aligned}</script><p>第二个式子的证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ n | d } [ \frac{ d }{ n } = 1 ] g ( d ) \\
& = \sum_{ n | d } \sum_{ c | \frac{ d }{ n } } \mu ( c ) g ( d ) \\
& = \sum_{ c | d } \sum_{ nc | d } \mu ( c ) g ( d ) \\
& = \sum_{ c } \mu ( c ) f ( nc ) \\
& = \sum_{ n | d } \mu ( \frac{ d }{ n } ) f ( d ) \\

\end{aligned}</script><p>第三个式子的证明:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ 1 \leq d } g ( \cfrac{ x }{ d } ) \mu ( d ) & = \sum_{ d \geq 1 } \mu ( d ) \sum_{ k \geq 1 } f ( \cfrac{ x }{ kd } ) \\
& = \sum_{ m \geq 1 } f ( \cfrac{ x }{ m } ) \sum_{ d , k \geq 1 } [ m = dk ] \mu ( d ) \\
& = \sum_{ m \geq 1 } f ( \cfrac{ x }{ m } ) \sum_{ d | m } \mu ( d ) \\
& = f ( x )
\end{aligned}</script><h4><span id="example1">Example1</span></h4><p>求长度为$n$且仅包含小写英文字母且循环节长度恰为$n$的字符串个数.</p>
<p>不妨设$f ( n )$表示长度为$n$的字符串个数,$g ( n )$表示长度为$n$且循环节长度恰为$n$的字符串个数.</p>
<p>有$f ( n ) = \sum_{ d | n } g ( d )$,根据莫比乌斯反演,$g ( n ) = \sum_{ d | n } \mu ( \cfrac{ n }{ d } ) f ( d )$.</p>
<h4><span id="example2">Example2</span></h4><p>求$\sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m gcd ( i , j ) \\$.</p>
<p>我们通过这个题来讲一下推导技巧.</p>
<h5><span id="增加枚举量">增加枚举量</span></h5><script type="math/tex; mode=display">
\begin{aligned}
\sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m gcd ( i , j ) & = \sum_{ i = 1 }^n \sum_{ j = 1 }^m id [ gcd ( i , j ) ] \\
& = \sum_{ i = 1 }^n \sum_{ j = 1 }^m \sum_{ d | gcd ( i , j ) } \varphi ( d ) \\

\end{aligned}</script><h5><span id="交换枚举顺序">交换枚举顺序</span></h5><script type="math/tex; mode=display">
\begin{aligned}
\sum_{ i = 1 }^n \sum_{ j = 1 }^m \sum_{ d | gcd ( i , j ) } \varphi ( d ) & = \sum_{ d = 1 }^{ \min ( n , m ) } \sum^{ \lfloor \frac{ n }{ d } \rfloor }_{ i = 1 } \sum^{ \lfloor \frac{ m }{ d } \rfloor }_{ j = 1 } \varphi ( d ) \\

\end{aligned}</script><h5><span id="分离无关变量">分离无关变量</span></h5><script type="math/tex; mode=display">
\begin{aligned}
\sum_{ d = 1 }^{ \min ( n , m ) } \sum^{ \lfloor \frac{ n }{ d } \rfloor }_{ i = 1 } \sum^{ \lfloor \frac{ m }{ d } \rfloor }_{ j = 1 } \varphi ( d ) & = \sum^{ \min ( n , m ) }_{ d = 1 } \varphi ( d ) \times \lfloor \cfrac{ n }{ d } \rfloor \times \lfloor \cfrac{ m }{ d } \rfloor \\

\end{aligned}</script><p>考虑使用数论分块,只需处理出$\varphi ( d )$的前缀和即可在$O ( \sqrt{ n } + \sqrt{ m } )$的复杂度解决此问题.</p>
<h4><span id="example3">Example3</span></h4><p>求$\sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m [ gcd ( i , j ) = 1 ] \\$.</p>
<p>和上一道题几乎没区别,唯一不同的是需要处理的函数从$id$变为了$\epsilon$.</p>
<h4><span id="example4">Example4</span></h4><p>求$\sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m [ gcd ( i , j ) \in \mathrm{ prime } ] \\$.</p>
<p>考虑增加枚举量,则:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m [ gcd ( i , j ) & \in \mathrm{ prime } ] = \sum_{ i = 1 }^{ n } \sum_{ j = 1 }^m \sum_{ p \in \mathrm{ prime } } [ gcd ( i , j ) = p ] \\
& = \sum_{ p \in \mathrm{ prime } } \sum^{ \lfloor \frac{ n }{ d } \rfloor }_{ i = 1 } \sum^{ \lfloor \frac{ m }{ d } \rfloor }_{ j = 1 } [ gcd ( pi , pj ) = p ] \\
& = \sum_{ p \in \mathrm{ prime } } \sum^{ \lfloor \frac{ n }{ p } \rfloor }_{ i = 1 } \sum^{ \lfloor \frac{ m }{ p } \rfloor }_{ j = 1 } [ gcd ( i , j ) = 1 ] \\
& = \sum_{ p \in \mathrm{ prime } } \sum_{ d = 1 }^{ \min ( \lfloor \frac{ m }{ p } \rfloor , \lfloor \frac{ n }{ p } \rfloor ) } \mu ( d ) \lfloor \cfrac{ n }{ pd } \rfloor \lfloor \cfrac{ m }{ pd } \rfloor \\

\end{aligned}</script><p>于是转化为上一道题,但复杂度仍不可接受.</p>
<h5><span id="换元">换元</span></h5><p>考虑设$x = pd$,则变为$\sum_{ x = 1 }^{ \min ( n , m ) } \sum_{ p \in \mathrm{ prime } \land p | x } \mu ( \frac{ x }{ p } ) \lfloor \frac{ n }{ x } \rfloor \lfloor \frac{ m }{ x } \rfloor \\$.</p>
<h4><span id="example5ur-5怎样跑得更快">Example5([UR #5]怎样跑得更快)</span></h4><p>首先先考虑去掉$lcm$使得式子中只有$i , j , \gcd ( i , j )$.</p>
<p>显然可以构造函数$f ( x ) = x^{ c - d } , g ( x ) = x^d , h ( x ) = x^d \\$,然后将题目转化为$\sum_{ j = 1 }^n f ( gcd ( i , j ) ) g ( i ) h ( j ) x_j \equiv b_i ( \mod p ) \\$.</p>
<p>$\gcd ( i , j )$很难处理,于是考虑用莫比乌斯反演消掉.</p>
<p>可以求出$f_r ( n )$使得$f ( n ) = \sum_{ d | n } f_r ( d ) \\$,也即$f_r ( n ) = \sum_{ d | n } \mu ( \cfrac{ n }{ d } ) f ( d )$.</p>
<p>则原式即:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ j = 1 }^n \sum_{ d } [ d | i ] [ d | j ] f_r ( d ) g ( i ) h ( j ) x_j & \equiv b_i ( \mod p ) \\
\sum_{ d | i } f_r ( d ) \sum_{ j = 1 }^n [ d | j ] h ( j ) x_j & \equiv \frac{ b_i }{ g ( i ) } ( \mod p ) \\

\end{aligned}</script><p>令$z_d = \sum_{ j = 1 }^n [ d | j ] h ( j ) x_j \\$,有$\sum_{ d | i } f_r ( d ) z_d \equiv \frac{ b_i }{ g ( i ) } ( \mod p ) \\$.</p>
<p>这个也是一个莫比乌斯反演的形式,我们可以求出左边,进而求出$z_d$.</p>
<p>而$z_d = \sum_{ j = 1 }^n [ d | j ] h ( j ) x_j = \sum_{ d | j }^n h ( j ) x_j$,可以再次使用莫比乌斯反演求出$h ( j ) x_j$,进而求$x_j$.</p>
<p>无解条件显然是$g_i = 0 \land x_i \ne 0$.</p>
<p>简而言之,这个题的步骤就是:</p>
<ol>
<li><p>通过增加枚举量消掉$lcm$以及$\gcd$这些难以处理的项.</p>
</li>
<li><p>将$i$与$j$尽量分到式子两边.</p>
</li>
<li><p>先通过莫比乌斯反演求出一些值,再通过这些值反推.</p>
</li>
</ol>
<h4><span id="example6cf1566hxor-quiz">Example6([CF1566H]Xor-quiz)</span></h4><p>首先注意到一个重要的事实:我们只需要询问所有$\mu ( x ) \ne 0$的$x$,就可以得到全部信息,而这些$x$的数量是完全足够我们全部询问一遍的.</p>
<p>注意到一个事实是,异或是模意义下的按位加减法,这意味着我们可以对异或做莫比乌斯反演.事实上,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \bigoplus_{ i \in A } i [ \gcd ( i , n ) = 1 ] \\
& = \bigoplus_{ i \in A }^c i \sum_{ d | i , d | n } \mu ( d ) \\

\end{aligned}</script><p>注意到$\sum_{ d | i } \mu ( d ) = \bigoplus_{ d | i } | \mu ( d ) |$,于是:</p>
<script type="math/tex; mode=display">
f ( n ) = \bigoplus_{ d | n } | \mu ( d ) | \bigoplus_{ d | i , i \in A } i</script><p>接下来只要我们形式上写作$n$,我们就默认$\mu ( n ) \ne 0$,又令$g ( n ) = \bigoplus_{ n | i , i \in A } i$,此时自然有$f ( n ) = \bigoplus_{ d | n } g ( d ) \\$.这是一个经典的莫反形式,我们再反演回去就可以得到$g ( n ) = \bigoplus_{ d | n } \mu ( \frac{ n }{ d } ) f ( d ) = \bigoplus_{ d | n } f ( d )$,也就是说我们可以求得所有的$g ( n )$,也就是这个集合中所有是$n$的倍数的异或值.</p>
<p>注意一个事实:如果我们设$w ( m ) = \prod_{ p \in \mathrm{ prime } , p | m } p$,那么我们就可以按照$w$的不同将所有数划分为若干个集合,每个集合在每次查询的时候要么都不被异或要么都被异或.这也告诉我们:我们只能求出每个集合中被选进$A$的这些数的异或值,而不能分开得知它们.接下来考虑如何知道这个,不妨设$S ( n ) = \{ x | w ( x ) = n \}$,又设$h ( n ) = \bigoplus_{ i \in A , i \in S ( n ) } i$.考虑用$g ( n )$表示$h ( n )$,我们有:</p>
<script type="math/tex; mode=display">
g ( n ) = \bigoplus_{ n | d } | \mu ( \frac{ d }{ n } ) | h ( d )</script><p>反演,有$h ( n ) = \bigoplus_{ n | d } g ( d ) \\$.于是我们可以求得所有的$h ( n )$了.</p>
<p>现在的问题在于:对于数$n , \mu ( n ) \ne 0$,我们要在$S ( n )$中选出若干个数,使得它们的异或和为$h ( n )$,并且选出的数字总共有$| A |$个.</p>
<p>然后是根据数据随机,拿每个集合的线性基随机一下自由元,然后对着构造.多随机几次,最后做背包.</p>
<h3><span id="多重子集反演">多重子集反演</span></h3><p>设$S$为可重集合.</p>
<p>一般形式:定义$\mu ( S )$,若$S$包含重复元素则为$0$,否则为$( - 1 )^{ | S | }$.</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( S ) & = \sum_{ T \subseteq S } g ( T ) \Leftrightarrow g ( S ) = \sum_{ T \subseteq S } \mu ( S - T ) f ( T ) \\

\end{aligned}</script><p>证明:</p>
<p>根据莫比乌斯反演,这个是显然的.</p>
<h3><span id="单位根反演离散傅里叶变换">单位根反演(离散傅里叶变换)</span></h3><p>一般形式($\omega_n = e^{ \frac{ 2 \pi i }{ n } }$):</p>
<script type="math/tex; mode=display">
f_m = \sum_{ k = 0 }^{ n - 1 } \omega_n^{ mk } g_k \Leftrightarrow g_m = \frac{ 1 }{ n } \sum_{ k = 0 }^{ n - 1 } \omega_n^{ - mk } f_k</script><p>可以发现这个式子其实就是FFT时所做的DFT与IDFT.</p>
<h3><span id="一般情况">一般情况</span></h3><p>考虑莫比乌斯反演的过程,我们实际上使用的是$[ m | n ] \sum_{ d | \frac{ n }{ m } } \mu ( d ) = [ n = m ] \\$.</p>
<p>令$c = md$,左边$= \sum_{ c | n } [ m | c ] \mu ( \frac{ c }{ m } ) = \sum ( [ c | n ] ) ( [ m | c ] \mu ( \frac{ c }{ m } ) ) \\$.</p>
<p>令$A_{ c , n } = [ c | n ]$,$B_{ m , c } = [ m | c ] \mu ( \frac{ c }{ m } ) \\$,那我们有$BA = I$.</p>
<p>刚才的过程相当于:</p>
<script type="math/tex; mode=display">
\begin{aligned}
Ax & = b \\
x & = Ix \\
x & = ( BA ) x \\
x & = B ( Ax ) \\
x & = Bb \\

\end{aligned}</script><p>无论是二项式反演还是莫比乌斯反演,他们都满足$f ( n )$所依赖的$g ( k )$有$k \leq n \\$.</p>
<p>根据上面的情况,我们发现$A$是一个下三角矩阵,$B$是$A^{ - 1 }$.</p>
<p>现在来推导满足$k \leq n$的一般情况反演:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f ( n ) & = \sum_{ k = 1 }^n a_{ n , k } g ( k ) \\

\end{aligned}</script><p>不妨设算子$\mu ( n , m )$,满足$\sum_{ k = 1 }^n a_{ n , k } \mu ( k , m ) = \sum_{ k = 1 }^n \mu ( n , k ) a_{ k , m } = [ n = m ] \\$.</p>
<p>即$AB = BA = I \\$.</p>
<script type="math/tex; mode=display">
\begin{aligned}
g ( n ) & = \sum_{ m = 1 }^n [ n = m ] g ( m ) \\
& = \sum_{ m = 1 }^n \sum_{ k = 1 }^n \mu ( n , k ) a_{ k , m } g ( m ) \\
& = \sum_{ k = 1 }^n \mu ( n , k ) f ( k ) \\

\end{aligned}</script><p>由上我们发现,反演解决了一些在下标上的二元运算卷积:</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_r & = \sum_{ p , q } [ f ( p , q ) = r ] a_p b_q \\

\end{aligned}</script><p>而我们需要把$f$分成两个独立的部分,通常正变换一下,处理一下,逆变换回来.</p>
<h2><span id="容斥">容斥</span></h2><h4><span id="一般形式">一般形式</span></h4><p>即:将求并集中元素个数转化成了求交集中元素个数.</p>
<p>我们有:$\mid \bigcup_{ i = 1 }^n S_i \mid = \sum_{ T \subseteq \{ 1 , . . . , n \},T\ne \emptyset } ( - 1 )^{ | T - 1 | } \mid \bigcap_{ p \in T } S_p \mid$.</p>
<p>证明:我们考虑对于每个元素,看它对最终答案的贡献.假设它所属$m$个集合$S_1 , . . . , S_m$,而除了这些集合以外的集合,</p>
<script type="math/tex; mode=display">
\begin{aligned}
cnt & = \sum_{ i = 1 }^m ( - 1 )^{ i - 1 } \binom{ m }{ i } \\
& = \binom{ m }{ 0 } - \sum_{ i = 0 }^m ( - 1 )^i \binom{ m }{ i } \\
& = 1 - [ m = 0 ]
\end{aligned}</script><p>显然,当这个元素被包含的时候,贡献为$1$,反之贡献为$0$.</p>
<p>如果我们定义一类在集合上的函数$F ( S ) = \sum_{ p \in S } F ( p )$,那么自然也有:</p>
<script type="math/tex; mode=display">
F ( \bigcup_{ i = 1 }^n S_i ) = \sum_{ T \subseteq \{ 1 , . . . , n \} } ( - 1 )^{ | T | - 1 } F ( \bigcap_{ p \in T } S_p )</script><p>另外,我们上面的做法是:当交集好求时求并集.我们还可以使用一步补集转化:</p>
<script type="math/tex; mode=display">
\mid \bigcap_{ i = 1 }^n S_i \mid = | U | - \mid \bigcup_{ i = 1 }^n \overline{ S_i } \mid</script><p>这样我们同样可以在并集好求的时候求交集.</p>
<p>会发现容斥和二项式反演是很像的.但是不一样的是,容斥是从集合的角度考虑,更注重单个元素的贡献;二项式反演是从函数的角度考虑,更关注函数之间的转化.</p>
<h5><span id="example1不定方程非负整数解计数">Example1(不定方程非负整数解计数)</span></h5><p>考虑不定方程$\sum_{ i = 1 }^n x_i = m$,和$n$个限制条件$x_i \leq b_i$,其中$m$和$b_i$都是非负整数,求该方程的非负整数解的数目.</p>
<p>首先,我们需要找出全集$U$,以及刻画$U$中元素的$P_i$(条件):</p>
<ol>
<li><p>$U$是满足$\sum_{ i = 1 }^n x_i = m$的所有非负整数解;</p>
</li>
<li><p>对于每个变量$i$,都对应一个$P_i = [ x_i \leq b_i ]$.</p>
</li>
</ol>
<p>设所有满足$P_i$的解构成集合$S_i$,那么我们需要求解的值就是$\mid \bigcap_{ i = 1 }^n S_i \mid$.而$\mid U \mid$显然是$\binom{ m + n - 1 }{ n - 1 }$.我们有:$\mid \bigcap_{ i = 1 }^n S_i \mid = | U | - \mid \bigcup_{ i = 1 }^n \overline{ S_i } \mid$.考虑对$\mid \bigcup_{ i = 1 }^n \overline{ S_i } \mid$使用容斥原理,注意到$\overline{ S_i }$的意义是满足$x_{ i } \geq b_{ i } + 1$的解的数目.换句话说也就是部分变量有下界限制,那直接左右两边同时减去下界即可.于是枚举子集即可实现.</p>
<p>欸,等一下,咋想到的补集转化,又是咋想到要用容斥的捏?</p>
<p>我们冷静一下,首先补集转化和容斥都是一个思想:正难则反.我们要求满足条件的个数,就先想一下能不能求不满足条件的个数,然后拿总的个数减去.然后注意到不满足条件的意义是:有至少一个不满足,这样就很可以容斥了.</p>
<h5><span id="example2错排问题">Example2(错排问题)</span></h5><p>我们考虑从容斥的角度再次认识一下错排.</p>
<p>首先,我们需要找出全集$U$,以及刻画$U$中元素的$P_i$(条件):</p>
<ol>
<li><p>$U$是长度为$n$的所有排列;</p>
</li>
<li><p>对于每个变量$i$,都对应一个$P_i = [ p_i \ne i ]$.</p>
</li>
</ol>
<p>注意到所求仍然是$\mid \bigcap_{ i = 1 }^n S_i \mid$.于是我们仍然试图$| \bigcap_{ k = 1 }^m \overline{ S_{ a_k } } |$.考虑其意义,也即:有$m$个位置被确定了,而其它位置没有限制,于是$| \bigcap_{ k = 1 }^m \overline{ S_{ a_k } } | = \binom{ n }{ m } ( n - m ) !$.根据容斥,自然有:$d_n = n ! - \sum_{ m = 1 }^n ( - 1 )^{ m - 1 } \binom{ n }{ m } ( n - m ) ! = n ! \sum_{ m = 0 }^n \cfrac{ ( - 1 )^m }{ m ! }$.</p>
<h5><span id="example3bzoj3622已经没有什么好害怕的了">Example3(bzoj3622已经没有什么好害怕的了)</span></h5><p>首先可以用dp+双指针得到$f_i$表示勒令$i$对满足条件的方案数.把$k$的定义改为恰好$k$对满足条件的显然是同强度的.</p>
<p>我们接下来仍然考虑容斥,首先,我们需要找出全集$U$,以及刻画$U$中元素的$P_i$(条件).</p>
<p>等一下,这个好像不好刻画?</p>
<p>我们先回归一下容斥的本质:考虑每个元素的贡献.注意到恰好$a$对的方案会被钦定$b$对的方案计算$\binom{ b }{ a }$次.我们再考虑一种方式理解容斥:我们一步一步把正确的答案消出来:简单来说,我第一步让所有恰好为$k$的方案贡献为$1$,其它的可能也有贡献,但我们忽略他们.第二步让所有恰好为$k + 1$的方案贡献为$0$,第三步以此类推.于是这个题,我们考虑也这么做:这样第一步令$ans = f_k$,第二步除去其中被多算的$k + 1$,这一步令$ans - = \binom{ k + 1 }{ k } f_{ k + 1 }$.这个时候,我们再考虑$k + 2$的贡献:它将在$f_k$时贡献$\binom{ k + 2 }{ k }$次,在$f_{ k + 1 }$时贡献$- \binom{ k + 2 }{ k + 1 } \binom{ k + 1 }{ k } = - \binom{ k + 2 }{ k } \binom{ 2 }{ 1 }$次,那它现在的贡献还有:$- \binom{ k + 2 }{ k }$次.以此类推,可以得到$ans = \sum_{ i = k }^n f_i ( - 1 )^{ i - k } \binom{ i }{ k }$.</p>
<p>等一下,这也太麻烦了,就不能从集合的角度分析嘛?</p>
<p>冷静一下,如果我们要做容斥,我们必须考虑每个元素<strong>单独</strong>的贡献,但是在这个题中,每个元素并没有单独的贡献,而是整个集合需要满足性质才能贡献.也就是说,我们无法分析每个$P_i$.而考虑集合就需要将集合分类,从而使用二项式反演.</p>
<p>换句话说,这个定义在集合上的函数并不满足可加性.</p>
<p>换句话说,我们要用容斥,就一定要刻画$P_i$,因为只有这个时候,我们才能通过分析满不满足$P_i$的解集的交并来实现.</p>
<p>再换句话说,大部分的所谓的容斥其实都和集合<strong>没啥关系</strong>,我们做容斥就是需要逐个考虑贡献,把它们贡献全都杀成$1 / 0$就行.</p>
<h5><span id="example4haoi2008硬币购物">Example4(HAOI2008硬币购物)</span></h5><p>如果直接对于每次询问暴力做,复杂度显然是$O ( 4 ns )$,无法接受.于是考虑预处理来降低单词询问复杂度.</p>
<p>注意到硬币数量很少,并且每个硬币的贡献可以独立计算.我们完全可以刻画$P_i = [ use_i \leq d_i ]$,从而可以用容斥做.复杂度$O ( 4 s + n 2^4 )$.</p>
<h5><span id="example5">Example5</span></h5><p>Alice和Bob在玩游戏,他们有一个$n$个点的无向完全图,设所有的边组成了集合$E$,他们想取遍$E$的所有非空子集,对某个集合$S$有一个估价$f ( S )$:考虑$n$个点与$S$中的边组成的图,我们用$m$种颜色对所有点染色,其中同一个连通块的点必须染成一种颜色,那么$f ( S )$等于这个图的染色方案数.同时,Alice喜欢奇数,所以当$| S |$为奇数时,Alice的分值加上$f ( S )$,否则Alice的分值减去$f ( S )$,求最后的分值.$( n , m \leq 10^6 )$.</p>
<p>一开始抄题的时候没有写染色而是直接写”设$k$为连通块个数,则$f ( S ) = m^k$.”然后发现做不了,因为$| S |$相同的$f ( S )$不尽相同,而且可能情况还蛮多的.冷静一下,注意到连通块这个性质太强了:如果我们把它放到指数上,那应该会做得很痛苦.所以我们考虑每有一个连通块就乘上一个$m$,这个看上去就简单一些.</p>
<p>但是这样好像还是不太好做,毕竟现在我们面对的还是一个难以转化为计数问题的图论问题,只是把问题的单位元素从图变成了连通块.那我们能不能再进一步:把单位元素换成单点呢?</p>
<p>考虑由于连通块要染一种颜色,那$x \leftrightarrow y \Rightarrow col_x = col_y$.注意到这是一个单位元素更小的限制条件!并且我们发现我们将与$- 1$有关的单位元素(从一开始就是点)和与$f$有关的单位元素统一起来了.这也提示我们做计数的时候,尤其是做容斥的计数的时候,最好先将单位元统一,这样后面才可能更容易做.</p>
<p>接下来就可以写式子了,令$F ( C )$表示在$C$情况下的染色方案,$T_{ ( i , j ) }$表示满足边$( i , j )$限制的解集:</p>
<script type="math/tex; mode=display">
ans = \sum_{ \emptyset \ne S \subseteq E } ( - 1 )^{ | S | - 1 } F ( \bigcap_{ ( i , j ) \in S } T_{ ( i , j ) } )</script><p>冷静一下!这个东西和容斥长得那叫一个一模一样啊.我们看看能不能逆向分析出$ans$的意义:显然是$F ( \bigcup_{ i = 1 }^{ m } P_i )$.也就是完全图中至少有两个点颜色相同的染色数.根据补集转化,我们只需求出两两点不相同的染色数即可.所以最后的答案就是$m^n - m^{ \underline{ n } }$.</p>
<h5><span id="example6">Example6</span></h5><p>求$\varphi ( n )$.</p>
<p>考虑这么一个事实:假设$n = \prod p_i^{ q_i }$,注意到令$P_i = [ \gcd ( i , n ) = 1 ]$,我们所求也就是$\mid \bigcap_{ i = 1 }^n S_i \mid$.于是可以用上面的方法做.另外,这里的做法引出莫比乌斯反演.</p>
<h5><span id="example7agc058d">Example7(AGC058D)</span></h5><p>直接容斥好像不太可做,我们把容斥中的条件改为有多少个极长的形如$ABCABCAB . . .$这样的串.</p>
<p>乍一看这个极长的条件好像巨难满足,但实际上我们冷静一下,我们只需要满足这个串长度大于等于$3$并且开头不能往前延申就可以了,后面其实是没啥必要管的.</p>
<p>拿组合数算一算.</p>
<h5><span id="example8agc035f">Example8(AGC035F)</span></h5><p>显然问题只在于重复计算的问题.我们先将所有状态做一个双射:对于一个网格,唯一可能被重复计算的只可能是一个拐角的$1$,我们让这种情况下的行尽可能长.</p>
<p>然后捏?注意到这样的话一个拐角的角一定是行了,是列就一定不合法,我们考虑把不合法的列杀了.</p>
<p>于是做一下容斥,答案是$\sum_{ i = 0 }^{ \min ( n , m ) } ( - 1 )^i \binom{ n }{ i } \binom{ m }{ i } i ! ( m + 1 )^{ n - i } ( n + 1 )^{ m - i }$.</p>
<h5><span id="example9">Example9</span></h5><p>给定若干个限制条件$( x , y )$,表示$a_x = y$和$a_y = x$必须满足至少一个,求排列方案数.</p>
<p>首先$i \rightarrow p_i$把排列转化成图,这样上面的限制条件也就是有一些无向的链和环,最后定向.一开始以为随便做做,思考一下注意到如果有长度为$2$的链,它自己成环的话是不用$\times 2$的.</p>
<p>这咋办.一个办法是:我们考虑容斥,先随便放进去,最后再钦定若干个自己成环.诶等一下为啥这个容斥是对的?因为系数是$\times 2$,所以一个有$1$个单独成环的状态会被随便放的情况恰好多算一次.类似可以做容斥.</p>
<p>当然,也可以考虑先把其它的合并,最后做长度为$2$的链,但是!一开始一定要钦定有序,最后再用组合数统一算答案.因为一开始带着顺序做很难做.</p>
<h5><span id="example10agc036f-square-constraints">Example10([AGC036F] Square Constraints)</span></h5><p>由题意得:$n^2 - i^2 \leq P_i^2 \leq ( 2 n )^2 - i^2$.</p>
<p>当一个东西有上界又有下界的时候可以想到容斥.问题转化为只有上界.假设最后所有的上界为$l_i$,那么只有上界的答案应该是什么呢?将$l$从小到大排序,答案就是$\prod_{ i = 0 }^{ 2 n - 1 } ( l_i - i )$.(注意到必须满足$l_{ 2 n - 1 } = 2 n - 1$.)</p>
<p>但是这个东西和容斥怎么结合起来呢?我们将限制放到二维平面上,注意到上下界的限制其实是两个$\frac{ 1 }{ 4 }$的圆弧.而通过圆弧的性质不难看出:最终的$l$分为三部分:在下半部分圆弧上的,在上半部分圆弧后面的,在上半部分圆弧前面的.而如果想知道$l$按照顺序排序,我们只需要对前两部分做归并,然后将最后一部分直接放到后面即可.于是我们考虑按照$l$的大小为顺序进行一个类似归并的东西,每次判断当前下半部分圆弧是否要往上加点即可.这样我们可以处理前两部分对答案的贡献,但问题在于第三部分对答案的贡献怎么做,我们需要找到第三部分上的点在排序后的位置.我们预先枚举容斥集合的大小即可,这样就可以快速算出这个东西,于是复杂度$O ( n^3 )$.</p>
<h5><span id="example1123省选第一轮集训day4c带劲的旅行">Example11([23省选第一轮集训day4]C带劲的旅行)</span></h5><p>(下面将$n$和$m$反着写)</p>
<p>设$p = \frac{ 2 k }{ n } , q = n - p$.</p>
<p>首先注意到期望$= P [ len \geq 1 ] + P [ len \geq 2 ] + \cdots$.</p>
<p>考虑如何计算$P [ len \geq x ]$,如果我们设$a_i$表示以$i$作为开头的极长的带劲的长度大于等于$x$的序列的集合,那么最后无非是要求所有$a$的并.考虑用容斥做到求所有$a$的交.不过要注意讨论一下是不是第一个点.</p>
<h5><span id="example12">Example12</span></h5><p>给定$n , k$和$n$个点各自的颜色,对有编号无根树计数,要求相同颜色组成的连通块大小不超过$k$.$n \leq 300$.</p>
<p>著名结论:$n$个点$m$个连通块任意连边成树的方案数是$n^{ m - 2 } \prod s$,其中$s$是每个连通块的大小.但是,如果我们强行对每种颜色分成若干连通块,我们要防止它们之间有边.这就是我一开始没做出来的原因:要容斥的根本不是树的大小不能超过$k$,由于树的形态多变,这个是不能维护的!正确的做法是找到若干个相同颜色的大小小于等于$k$的连通块,要求它们两两无边.甚至根本就不是它们可以连边但是大小不能超过$k$,我们要容斥的东西一定要好算,简单.</p>
<p>然后就做完了,每次暴力合并若干个颜色相同的块,容斥系数$( - 1 )^{ 块 数 - 1 }$.</p>
<p>容斥是一个层层递进的东西,我们每一步都是基于上一步的限制:它本身就是一个求解集的东西.</p>
<h4><span id="min-max容斥">Min-Max容斥</span></h4><p>对于:</p>
<script type="math/tex; mode=display">
\mid \bigcup_{ i = 1 }^n S_i \mid = \sum_{ T \subseteq \{ 1 , . . . , n \} } ( - 1 )^{ | T - 1 | } \mid \bigcap_{ p \in T } S_p \mid</script><p>考虑一个特例:$S_i = \{ 1 , 2 , \cdots , a_i \}$,那么上面的式子导出min-max容斥(我们设$S = \{ a_1 , a_2 , \cdots , a_n \}$)(第二个式子可以把前缀改成后缀):</p>
<script type="math/tex; mode=display">
\begin{aligned}
\max ( S ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - 1 } \min ( T ) \\
\min ( S ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - 1 } \max ( T )
\end{aligned}</script><p>由于是集合,这个式子在期望意义下同样成立:</p>
<script type="math/tex; mode=display">
\begin{aligned}
E ( \max \{ S \} ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - 1 } E ( \min \{ S \} ) \\
E ( \min \{ S \} ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - 1 } E ( \max \{ S \} )
\end{aligned}</script><p>进一步,这个式子可不止能求min-max的转化,它可以求出集合中第k大的数字:</p>
<script type="math/tex; mode=display">
\begin{aligned}
kth \max \{ S \} & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - k } \binom{ | T | - 1 }{ k - 1 } \min \{ T \} \\
kth \min \{ S \} & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - k } \binom{ | T | - 1 }{ k - 1 } \max \{ T \} \\
E ( kth \max \{ S \} ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - k } \binom{ | T | - 1 }{ k - 1 } E ( \min \{ T \} ) \\
E ( kth \min \{ S \} ) & = \sum_{ T \subseteq S , T \ne \emptyset } ( - 1 )^{ | T | - k } \binom{ | T | - 1 }{ k - 1 } E ( \max \{ T \} )
\end{aligned}</script><p>原理是消掉前$k - 1$大的数字,让他们的贡献为$0$,剩下的配一下容斥系数.</p>
<h5><span id="example123省选10连测-day6a">Example1([23省选10连测 day6]A)</span></h5><p>不妨设$tim_i$为$[ i , i + 1 ]$第一次被覆盖的时间,答案就是:</p>
<script type="math/tex; mode=display">
E ( \max_{ i = 1 }^{ n - 1 } \{ tim_i \} ) = \sum_{ T \subseteq \{ 1 , 2 , \cdots , n - 1 \} , T \ne \emptyset } ( - 1 )^{ | T | - 1 } E ( \min_{ j \in T } \{ tim_j \} )</script><p>设$f ( S )$为有多少个区间能覆盖至少一个$[ i , i + 1 ] , i \in S$,考虑$E = p_{ [ t \geq 0 ] } + p_{ [ t \geq 1 ] } + p_{ [ t \geq 2 ] } + \cdots$,于是$E ( \min_{ j \in S } \{ tim_j \} ) = \frac{ m }{ f ( S ) }$.</p>
<p>于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
ans & = \sum_{ T \subseteq \{ 1 , 2 , \cdots , n - 1 \} , T \ne \emptyset } ( - 1 )^{ | T | - 1 } f ( T ) \\
& = \sum_{ k = 0 }^m \frac{ m }{ k } \sum_{ T \subseteq \{ 1 , 2 , \cdots , n - 1 \} , T \ne \emptyset , f ( T ) = k } ( - 1 )^{ | T | - 1 }
\end{aligned}</script><p>注意到$f ( S )$可能不那么好求,我们求$g ( S ) = m - f ( S )$,也就是不包含任何一个$[ i , i + 1 ] , i \in S$的区间个数,我们有:</p>
<script type="math/tex; mode=display">
ans = \sum_{ k = 0 }^m \frac{ m }{ m - k } \sum_{ T \subseteq \{ 1 , 2 , \cdots , n - 1 \} , T \ne \emptyset , g ( T ) = k } ( - 1 )^{ | T | - 1 }</script><p>这里已经不难写出$O ( n^3 )$的dp了.</p>
<p>那么怎么优化呢?设$dp_{ i , j }$表示只考虑$[ 1 , i ]$时($[ i - 1 , i ]$必选),$\sum_{ g ( T ) = j } ( - 1 )^{ | T | - 1 }$的答案,不难发现每次加入一个区间$[ l , r ]$就会让$dp_{ i , j } , i &lt; = l$对$dp_{ r , j + 1 }$的贡献乘一个$1$.</p>
<p>如何处理这个事情?我们用类似多项式的东西,前者相当于平移多项式系数,后者相当于标量乘法,然后拿线段树维护和,复杂度$O ( nm \log n )$.</p>
<h4><span id="反射容斥">反射容斥</span></h4><p>一般形式:给定二维平面上两个点$S$和$T$,其中$T$在$S$的右方,给定两条线$y = a$和$y = b$,每次可以向右上或者右下走一步,求不碰线的从$S$到$T$的方案数.</p>
<p>我们不妨设$A$表示一定碰了一次上界的方案数,$B$表示一定碰了一次下界的方案数,$AB$表示一定碰了一次上界后碰了一次下界的方案数……</p>
<p>最后的答案就是随便走$- A - B + AB + BA - ABA - BAB . . .$.</p>
<p>考虑设步数为$n$,那显然长度最多为$\cfrac{ n }{ a - b }$.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8D%9A%E5%BC%88%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8D%9A%E5%BC%88%E8%AE%BA/" class="post-title-link" itemprop="url">博弈论</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI/" itemprop="url" rel="index"><span itemprop="name">OI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8D%9A%E5%BC%88%E8%AE%BA/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8D%9A%E5%BC%88%E8%AE%BA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h3><span id="bash游戏">Bash游戏</span></h3><p>$A$和$B$,有$n$颗石子,每次可以取$x$颗,其中$1 \leq x \leq m \\$,求$A$是否能赢.</p>
<p>考虑直接令石子数量为状态,有$SG ( x ) = mex \{ SG ( y ) | \max \{ 0 , x - m \} \leq y \leq x - 1 \} \\$,注意到$SG ( x ) = 0$当且仅当$x \equiv 0 ( \mod m + 1 )$.</p>
<p>我们使用数学归纳证明:</p>
<p>当$0 \leq x \leq m$时,显然成立.</p>
<p>而对于$x$,如果$x \equiv 0 ( \mod m + 1 ) \\$,那么集合$S = \{ y \in \mathbb{ Z } | \max \{ 0 , x - m \} \leq y \leq x - 1 \}$中一定$\nexists y$满足$y \equiv 0 ( \mod m + 1 ) \\$.</p>
<p>也就是$\nexists y$满足$SG ( y ) = 0$,那么$SG ( n ) = 0$.反之,一定存在.</p>
<h3><span id="nim游戏">Nim游戏</span></h3><p>$A$和$B$,有$n$堆石子,第$i$堆石子有$x_i$个石子.每次可以任选一堆取走若干个石子,最后不能取的人输.求先手是否必胜.</p>
<p>注意到如果$x$均等于$0$一定先手必败.考虑令$w = x_1 \oplus x_2 \oplus . . . \oplus x_n$($w$即为全游戏的$SG$值),那么先手必败当且仅当$w = 0 \\$.</p>
<p>证明:</p>
<p>只需证明当$w \ne 0$时一定存在一种方法使得$w = 0 \\$.</p>
<p>考虑$w$的最高位为第$k$位,那么一定存在一个$x_i$的第$k$位为$1$.将它改为$0$,然后这个$x_i$的后面几位可以随意更改.</p>
<h4><span id="example1nimk游戏">Example1(Nimk游戏)</span></h4><p>$A$和$B$,有$n$堆石子,第$i$堆石子有$x_i$个石子.每次可以任选不超过$k$堆取走若干个石子,最后不能取的人输.</p>
<p>将$x_i$写成二进制,如果每一位的$1$的个数均是$k + 1$的倍数,那么先手一定必败.道理是差不多的.</p>
<h4><span id="example2multi-nim游戏">Example2(Multi-Nim游戏)</span></h4><p>Nim游戏,但是玩家每回合可以将任意一堆石子数量大于等于$2$的石子堆分成任意两堆不为空的石子堆.没法操作的人输.</p>
<p>本质仍然是SG游戏,我们正常做就行.</p>
<p>$SG ( x ) = mex \{ \{ SG ( v ) | x \rightarrow v \} , \{ SG ( x - i ) \oplus SG ( i ) | 1 \leq i &lt; x \} \} \\$.</p>
<p>找一下规律可以发现:</p>
<script type="math/tex; mode=display">
\begin{aligned}
SG ( x ) & = \begin{cases}
x - 1 & x \equiv 0 ( \mod 4 ) \\
x & x \equiv 1 或 2 ( \mod 4 ) \\
x + 1 & x \equiv 3 ( \mod 4 ) \\

\end{cases} \\

\end{aligned}</script><p>不妨设当$x \leq 4 k$时结论成立.</p>
<p>当$x = 4 k + 1$时,前半部分一定是取遍了$[ 1 , 4 k ]$.</p>
<p>但是一定不存在$a$和$b$满足$a + b = 4 k + 1$并且$SG ( a ) \oplus SG ( b ) = 4 k + 1$.讨论一下$a$和$b$在$\mod 4$意义下的值就会发现不可能.</p>
<p>其他的是同理的.</p>
<h3><span id="sg游戏">SG游戏</span></h3><p>$n$个DAG,每个DAG只有一个起始点,起始点上有一枚棋子.$A$和$B$每次可以选一个图,将上面的棋子沿DAG移动一条边,不能移动的人输.</p>
<p>直接使用$SG ( u ) = mex \{ SG ( v ) | u \rightarrow v \}$.</p>
<p>那么先手必败当且仅当所有DAG初始节点的SG异或起来是$0$.</p>
<p>首先如果$SG ( u ) = x$,那么$\forall 0 \leq y &lt; x$,$\exists v$使得$u \rightarrow v$且$SG ( v ) = y$.可以发现这就如同Nim游戏了.</p>
<p>但是与Nim游戏不同的是,可能$\exists y &gt; x$,但是仍然可以转移到.</p>
<p>但在这种情况下,我可以继续转移到一个$u ‘$使得$SG ( u ‘ ) = x$,因此异或值不变.</p>
<h4><span id="example1anti-sg游戏">Example1(Anti-SG游戏)</span></h4><p>SG游戏,但是不能取的人赢.</p>
<p>SJ定理:</p>
<p>先手必胜当且仅当下面两个条件满足一个:</p>
<ol>
<li><p>游戏的SG函数不为$0$且游戏中某个单一游戏的SG函数大于$1$.</p>
</li>
<li><p>游戏的SG函数为$0$且游戏中没有单一游戏的SG函数大于$1$.</p>
</li>
</ol>
<p>如果没有单一游戏的SG函数大于$1$,那么显然游戏的SG函数为$0$就赢了,否则就输了.</p>
<p>而如果SG函数为$0$且存在某个单一游戏的SG函数大于$1$,一定是输的.</p>
<p>因为这个情况下,后手先按照正常$SG$游戏压着先手,最后一定会剩两堆一样大于$1$的,无论你怎么选,对手都可以压着你.如果你把一堆全选了,此时对手就可以把另一堆剩下一个,这样就必输;如果你把这一堆选的只剩下一个,对手就可以把它那一堆全选了,这样就也是必输的.</p>
<h4><span id="example2every-sg">Example2(Every-SG)</span></h4><p>SG游戏,但是每次每个能移动的游戏都必须移动,不能移动任何游戏的人输.</p>
<p>对于每个子游戏,如果先手必胜,先手一定会尽可能多争取时间.</p>
<p>反之,先手一定会尽可能早结束游戏.</p>
<p>在$DAG$上dp的时候除了$SG$我们再加一维表示时间耗费,就可以dp了.</p>
<h4><span id="example25every-sg">Example2.5(Every-SG)</span></h4><p>n个游戏,每个游戏两堆石子,每次可以从大的那堆中取小的那堆石子大小的整数倍的石子.</p>
<p>直接套用Every-SG的做法就行.</p>
<h4><span id="example3nim-on-tree">Example3(Nim on tree)</span></h4><p>一棵有根树两个人,每次可以挑一棵真子树删掉,不能操作者输.</p>
<p>结论:$SG ( u ) = \bigoplus_{ u \rightarrow v } ( SG ( v ) + 1 )$.</p>
<p>考虑归纳假设.如果$u$只有$v$一个儿子.那么要么将$v$子树全删,要么删一部分,有:</p>
<script type="math/tex; mode=display">
SG ( u ) = mex ( x | x = 0 \lor 0 \leq x - 1 < SG ( v ) ) = SG ( v ) + 1</script><p>而如果有多个儿子,则每个儿子都相当于是一个SG子游戏,异或起来即可.</p>
<p>另一种理解方式:考虑只有一个儿子的情况,那么相当于这个儿子的所有状态都向终止节点连了一条边,终止节点的$SG$为$0$,而显然$SG$图中的其它节点的$SG$均要$+ 1$.</p>
<h4><span id="example4">Example4</span></h4><p>$n$个有根仙人掌,保证所有的环与树的结构只有一个公共点(环只有一条连到环外的边).</p>
<p>两个人分别操作删边,与根不连通的边都被删掉.</p>
<p>结论:奇环$SG = 1$,偶环$SG = 0$.</p>
<p>这么考虑:边数为$k$的链的$SG$为$k$.</p>
<p>而拆开奇环后,你得到的两条链奇偶性一定相同,因而不可能得到$1$.偶环同理,不可能得到$0$.</p>
<h4><span id="example5">Example5</span></h4><p>无向图,每次删掉一条边以及与根节点不连通的部分,无法操作者输.</p>
<p>考虑Example2.</p>
<p>Fusion定理:将偶环替换成一个新点,奇环替换成一个新点连出去一条边,做边双.对于一个边双,$SG$值只和他边的奇偶性有关.证明大概和上面一样.</p>
<h3><span id="斐波那契博弈">斐波那契博弈</span></h3><p>一个数$N$,两个人轮流令他减去一个数,第一次不能减完,每次减的不能超过上一次的两倍.</p>
<p>不能操作者输.</p>
<p>结论为:当且仅当$N$是斐波那契数时,先手必败.</p>
<p>考虑归纳证明:</p>
<p>先证明当$N$是斐波那契数时必败,不妨假设$N = N_0 + N_1$,</p>
<p>考虑将$N$看成两堆,因为如果第一次取走了大于$N_1$颗石子,由于$N_0 \leq N_1 \\$,则后手第二步可以全取走,必败.</p>
<p>并且一开始先手一定要在$N_0$堆取石子,原因是如果取了大于$N_0$颗石子,由于$N = N_0 + N_1 \leq 3 N_0 \\$.这样下一步后手就可以全取完.</p>
<p>那么现在先手应该开始取$N_0$这一堆,如果在这一堆取的过程中,先手一直取得不超过$N_0$剩下的数,那么根据归纳假设,后手一定可以取走$N_0$堆的最后一个石子,此时局面变成了只剩$N_1$颗石子.只要此时先手不能一次取走$N_1$颗石子,先手就必败.而后手最后一步拿走石子最多会拿走$\frac{ 2 }{ 3 } N_0$的石子,但是,$\frac{ 4 }{ 3 } N_0 &lt; N_1$,因此一定不可能.</p>
<p>否则,仍然是先手取走了$N_0$全部石子,又当了先手取$N_1$的石子.仍然是必败的.</p>
<p>齐肯多夫定理:任意一个正整数都可以被表示成若干不连续的斐波那契数之和.</p>
<p>设$N = \sum_{ i = 1 }^k f_{ p_i }$,其中$p_1 &lt; p_2 &lt; p_3 &lt; . . . &lt; p_k \\$,先手取走$f_{ p_1 } \\$.由于$2 f_{ p_1 } &lt; f_{ p_2 }$,因此后手接下来无论如何不可能取得大于等于$f_{ p_2 } \\$,问题转化为一堆大小为$f_{ p_2 }$的石子,此时先手必败.因此原问题的先手必胜.</p>
<h3><span id="二分图博弈">二分图博弈</span></h3><p>给出一张二分图和起点$S$,$A$和$B$轮流操作,每次操作只能选与上一个被选的点相邻的点,且不能选已经选过的点.</p>
<p>考虑二分图的所有最大匹配,如果在所有的最大匹配的方案中都包含了起点$S$,那么先手必胜,否则先手必败.</p>
<p>证明:</p>
<p>如果所有匹配都包含$S$,那么$A$只需要每次走到一个和$S$匹配的点即可.$B$无论如何不可能走到一个不在最大匹配中的点,不然,我们将路径全部取反,就得到了一个最大匹配不变但不包含$S$的点,与假设不符.</p>
<p>而如果存在一个匹配不包含$S$,如果$A$仍然第一步走到一个和$S$匹配的点那么$B$一定能想办法走到一个不在当前$A$选择的最大匹配中的点而在一个不包含$S$的最大匹配中的点,于是$B$必胜.</p>
<h4><span id="example12022qbxt国庆day5c">Example1([2022qbxt国庆Day5]C)</span></h4><p>显然,一个人敢抢金条当且仅当没有人敢抢他的金条.假设$dp_{ S , x } = 0 / 1$表示目前集合$S$中的所有人都已经离场了,而目前金条在$x$手中,金条会不会被抢.显然,如果$\exists y$满足$dp_{ S \cup \{ x \} , y } = 0$,也就是金条在$y$手里不会被抢,那$x$手中的金条必定会被抢.</p>
<p>将这个抢的过程看作二分图博弈中走到相邻的点的过程,于是这个问题等价于二分图博弈.也就是说,如果二分图博弈先手必胜,那么第一个拿到金条的人一定会被抢.</p>
<p>因此,我们需要找到所有与$S$匹配的可能出现在最大匹配中的边,对应编号最小的那个点,金条最后一定在他手里.(第一步这么走后,一定能构造出)</p>
<p>这个怎么构造呢,我们考虑先跑一遍dinic求最大匹配,然后做一遍tarjan缩点,然后如果$S$和$x$并未匹配,那么我们判断二者是否在一个强连通分量中,如果在,那他们可以被匹配.</p>
<p>至于判断$S$是否一定在其中,只需要先删去$S$,跑dinic,再在残联网络上加上$S$,判断是否有新的增广路.</p>
<h3><span id="树上博弈">树上博弈</span></h3><h4><span id="example1zr23省选10连-day1-clashmas">Example1(zr[23省选10连 day1] Clashmas)</span></h4><p>注意到删点对树形态的影响,考虑重心</p>
<ol>
<li>$n$为奇数,重心为后手点.</li>
</ol>
<p>注意到此时后手一定可以通过一些方式维持重心不变,因此后手必胜.</p>
<ol>
<li>$n$为奇数,重心为先手点.</li>
</ol>
<p>我们不妨设先手是A,后手是B.</p>
<p>考虑一个事实:对于这样一棵树,我们删着删着一定会出现一个时刻使得此时$n$为偶数,有两个重心(比如最后只剩下两个点的时刻),根据(4)和(5)的讨论,此时胜负已分.而且不难注意到此时A变为了实际上的后手.</p>
<p>根据(5),如果B掌控了任意一个重心,那A就输了.因此A必定要使当前局面的两个中心均为A的点.考虑原重心的所有儿子,它们有的是A点,有的是B点.由于树的重心的性质,树的重心的移动一定是一点一点挪的,也就是说第一次出现上面的局面的时候,两个重心必有一个是原重心,另一个是原重心的儿子,接下来A和B就要对于另一个重心能取到哪个儿子做争夺.我们不妨设A的点的集合为$S_A$,B的点的集合为$S_B$.以原重心为根建树,设其所有儿子组成的集合为$S_C$,不难发现A能胜利(也就是让两个重心全都属于他)当且仅当$\sum_{ u \in S_A \cap S_C } siz_u \geq \sum_{ u \in S_B \cap S_C } siz_u$.</p>
<p>原因很简单:A和B必然每次都会去杀属于对方的子树中$siz$最大的那棵.由于A有着先手优势,因此只要满足上面的条件,A总能获胜.</p>
<ol>
<li>$n$为偶数,唯一重心,重心为后手点.</li>
</ol>
<p>类似(2)的讨论,最后一定有某个时刻使得此时$n$为偶数,有两个重心(比如最后只剩下两个点的时刻),此时A仍然是先手,根据(5),只要他掌控一个重心就可以获胜.</p>
<p>类似地,不难发现胜利条件等价于(2).</p>
<ol>
<li>$n$为偶数,两个重心,重心均为后手点.</li>
</ol>
<p>注意到此时整棵树分为两个大小相等的部分,因此后手一定可以维持这个场面不动,后手必胜.</p>
<ol>
<li>$n$为偶数,至少有一个重心是先手点.</li>
</ol>
<p>注意到此时先手一定存在一种方式开局,使得重心仍为这个先手点,这样就转化为第一种情况,先手必胜.</p>
<h3><span id="散题">散题</span></h3><h5><span id="problem1csp-s2020贪吃蛇">Problem1([CSP-S2020]贪吃蛇)</span></h5><p>首先注意到,如果一个蛇吃完后还不是最小的蛇,那它一定会吃.因为被吃的蛇是单调不降的,而吃蛇的蛇是单调不增的,因此下一个蛇如果要吃,那一定会比它还小,所以至少会先被吃掉,而那条蛇会被吃掉,它就一定不会选,所以无论如何这条蛇都不会被吃掉.</p>
<p>我们考虑如果吃完后变成了最小的蛇后会怎么样,我们设$f_i$为还剩$i$条蛇的时候能不能吃,那$f_i = 1$的话,要么$i = 2$,要么吃完后不是最小的,要么$f_{ i - 1 } = 0$.</p>
<p>递归做就好了.另外这题需要复杂度$O ( n )$,需要用几个队列/双端队列维护.</p>
<h5><span id="problem2agc023dgo-home">Problem2([AGC023D]Go Home)</span></h5><p>首先,最后一个人要么是最左边的,要么是最右边的.而显然这两边中人数较少的一个将会是最后一个到家的,那么这个人的目标就是帮助另一边的人尽可能快到家,于是会帮着它投票.以此类推不断递归下去.</p>
<h5><span id="problem3牛客38727e">Problem3(牛客38727E)</span></h5><p>首先考虑如果有人作为第$n - p + 1$个人复读了,那接下来复读一定不会被惩罚,于是没复读的都会复读,这样这个人就必死.于是最多只会复读$n - p$个人.</p>
<p>继续思考,如果有人作为第$n - 2 p + 1$个人复读了会怎么样,后面的人也都不会被惩罚了,于是也会继续复读.</p>
<p>以此类推,会发现最后只会有$n \mod p$个人复读,并且一定是前$n \mod p$在一轮内复读完.</p>
<h5><span id="problem4arc155d">Problem4(arc155D)</span></h5><p>考虑直接转移,但是有可能出现在原地转的情况,注意到这种情况我们只需要记录$f_{ i , j }$表示当前的$G$是$i$,$G$的倍数还剩下$j$个,然后做转移,再进一步发现我们只关心$j$的奇偶性.于是记$f_{ i , 0 / 1 }$即可.</p>
<p>这题给我最大的启示是,我们不能假定让双方共同遵守一个”君子协定”,博弈论最重要的就是博弈,不能说我们最后再选倍数之类的,他的转移路线会变化的.</p>
<h5><span id="problem5">Problem5</span></h5><p>给一个“日”字型图,七条边,每条边有一堆石子.每次可以选任意多条不构成环的边,然后将这些边上的石子堆取走任意多个石子.求先手必胜策略,以及如果每条边的石子数量在$[ l_i , r_i ]$,那么有多少种先手必胜的情况.</p>
<p>考虑将这个图分成三部分,上面三条边,中间一条边,下面三条边.那么这三部分一定不能全选至少两部分,不然会构成环.反之一定构不成环.</p>
<p>先手必败当且仅当,这三部分内部的边上石子均相等,并且所有边异或值为$0$.</p>
<p>否则,考虑将上部分和下部分三条边先全改成相等的,会修改较大的两条边.</p>
<p>接下来,我们剩了三条边,我们只能选择改其中一条,使得他们仨异或值为$0$.</p>
<p>换句话说,我们现在有$x_1 , x_2 , x_3$,我们要将其中一个$x_i$改为$y_i$,其他不变,使得他们仨异或值为$0$.和Nim游戏类似,假设他们仨异或值的最高位为$k$.那么一定有一个$x_i$的第$k$位为$1$,将它改为$0$,后面就可以随意变换.</p>
<p>思路具体怎么想到的呢,可以发现整个图只有三个环,并且这三个环都可以由这几部分组成.接下来就可以每个部分的$[ l_i , r_i ]$求个交,用FWT做一遍异或卷积.数位dp也可以做.</p>
<h5><span id="problem6">Problem6</span></h5><p>Nim游戏,但是每堆石子有一个$K_i$.如果这堆石子剩$x_i$个每次最多取$\lfloor \frac{ x_i }{ K_i } \rfloor$个石子.求先手是否必胜.</p>
<p>结论是</p>
<p>SG(n-\lfloor\frac n k\rfloor,k)&amp;n\ne 0(\mod k)\\</p>
<p>\frac n k&amp;n=0(\mod k)\\</p>
<p>\end{cases}\\</p>
<p>考虑数学归纳就可以证明.</p>
<p>然后我们就只需要对于$k$是否大于$\sqrt{ n }$讨论一下,如果$k &lt; \sqrt{ n }$暴力,最多只会做$\sqrt{ n }$次.否则,意识到此时可以通过求一个区间$[ l , r ]$,满足$\forall x \in [ l , r ] , \lfloor \frac{ x }{ k } \rfloor$均相等,加速一下.这种区间最多只会有$\sqrt{ n }$个.</p>
<h5><span id="problem7">Problem7</span></h5><p>一个数$N$,两个人轮流令他减去一个数,第一次不能减完,每次减的不能超过上一次.不能操作者输.</p>
<p>先手必败当且仅当$N = 2^k$,不然,每次选lowbit即可.</p>
<h5><span id="problem8">Problem8</span></h5><p>A和B,有$n$颗石子,每次可以取$x$颗,其中$1 \leq x \leq \lceil \frac{ n }{ 2 } \rceil \\$.</p>
<p>仍然令石子数量为状态,注意到$SG ( x ) = 0$当且仅当$x + 1 = 2^k - 1$,也即$x = 2^k - 2 \\$.首先,注意到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
n - \lceil \frac{ n }{ 2 } \rceil & = \lfloor \frac{ n }{ 2 } \rfloor \\
SG ( n ) & = mex \{ SG ( y ) | \lfloor \frac{ n }{ 2 } \rfloor \leq y \leq n - 1 \} \\

\end{aligned}</script><p>设$n = 2^k - w$,其中:</p>
<script type="math/tex; mode=display">
\begin{aligned}
- 2^{ k - 1 } + 2 & \leq w \leq 2 \\
\lfloor \frac{ 2^k - w }{ 2 } \rfloor & = 2^{ k - 1 } - \lfloor \frac{ w }{ 2 } \rfloor \\

\end{aligned}</script><p>当$w = 2$时,原式$= 2^{ k - 1 } - 1 &gt; 2^{ k - 1 } - 2 \\$.反之.$2^k - 2 \leq$原式.因此数学归纳即可证明.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8C%97%E5%A4%A7%E7%9B%B8%E5%85%B3%E9%80%89%E6%8B%94%E6%95%B0%E5%AD%A6%E7%9C%9F%E9%A2%98%E6%B1%87%E6%80%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8C%97%E5%A4%A7%E7%9B%B8%E5%85%B3%E9%80%89%E6%8B%94%E6%95%B0%E5%AD%A6%E7%9C%9F%E9%A2%98%E6%B1%87%E6%80%BB/" class="post-title-link" itemprop="url">北大相关选拔数学真题汇总</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-08-15 21:23:40" itemprop="dateModified" datetime="2025-08-15T21:23:40+08:00">2025-08-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">大学课程</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8C%97%E5%A4%A7%E7%9B%B8%E5%85%B3%E9%80%89%E6%8B%94%E6%95%B0%E5%AD%A6%E7%9C%9F%E9%A2%98%E6%B1%87%E6%80%BB/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8C%97%E5%A4%A7%E7%9B%B8%E5%85%B3%E9%80%89%E6%8B%94%E6%95%B0%E5%AD%A6%E7%9C%9F%E9%A2%98%E6%B1%87%E6%80%BB/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h3><span id="2024寒假学堂部分">2024寒假学堂(部分)</span></h3><h4><span id="problem4">Problem4</span></h4><p>设$G ( x ) = ( x^2 + x - 1 )^{ 100 } = \sum_{ k = 0 }^{ 200 } a_k x^k$,求$2 a_0 - a_1 - a_2 + 2 a_3 - a_4 - a_5 + \cdots + 2 a_{ 198 } - a_{ 199 } - a_{ 200 }$.</p>
<h5><span id="solution4">Solution4</span></h5><p>考虑求出$\sum_{ 0 \leq k \leq 66 }{ a_{ 3 k } }$.直接取三次单位根$\omega_3 = - \frac{ 1 }{ 2 } + \frac{ \sqrt{ 3 } }{ 2 } i$,自然有$1 + \omega_3 + \omega_3^2 = 0$,所以$G ( 1 ) + G ( \omega_3 ) + G ( \omega_3^2 ) = 3 \sum_{ 0 \leq k \leq 66 }{ a_{ 3 k } }$.</p>
<p>所以答案显然是$G ( \omega_3 ) + G ( \omega_3^2 ) = ( - 2 )^{ 100 } + ( - 2 )^{ 100 } = 2^{ 101 }$.</p>
<h4><span id="problem10">Problem10</span></h4><p>等差数列中,$a_1 &gt; 0$,公差$d &lt; 0 , \frac{ a_{ 31 } }{ a_{ 30 } } &lt; - 1$,求最大的正整数$n$,使得$S_n &gt; 0$.</p>
<h5><span id="solution10">Solution10</span></h5><p>显然$S_{ 60 } = 30 ( a_{ 30 } + a_{ 31 } ) &lt; 0 , S_{ 59 } = 59 a_{ 30 } &gt; 0$.</p>
<h4><span id="problem11">Problem11</span></h4><p>全为整数的等差数列,$d = 4$,求所有满足$S_n = 2024$的$n$的和.</p>
<h5><span id="solution11">Solution11</span></h5><p>则$n ( 2 n - 2 + a_1 ) = 2024 = 2^3 \times 11 \times 23$.显然只要$n | 2024$即可.</p>
<p>所有$n$的和自然是$( 1 + 2 + 4 + 8 ) ( 1 + 11 ) ( 1 + 23 ) = 15 \times 12 \times 24 = 4320$.</p>
<h4><span id="problem14">Problem14</span></h4><p>整数数列$U_n$满足$U_0 = 1$,且当$n \geq 1$的时候$U_{ n + 1 } U_{ n - 1 } = kU_n$,其中$k$是一个正整数.问能让$U_{ N } = N$的$k$的个数有多少个,其中$N = 2024$.</p>
<h5><span id="solution14">Solution14</span></h5><p>则$U_{ n + 1 } = \frac{ kU_n }{ U_{ n - 1 } } , \frac{ U_{ n + 1 } }{ U_n } = k \frac{ U_n }{ U_{ n - 1 } } \frac{ 1 }{ U_n }$.</p>
<p>观察上面的式子,不难想到换元后求前缀积,但其实注意到我们可以直接求前缀积,设$T_n = \prod_{ k = 1 }^n U_k , W_n = U_n \prod_{ k = 1 }^{ n - 2 } U_k$.</p>
<p>注意到$W_n = kW_{ n - 1 } , W_1 = U_1 , W_n = k^{ n - 1 } U_1$.又注意到$T_n = kU_{ n - 1 } W_{ n - 1 } = kW_{ n - 1 } \frac{ T_{ n - 1 } }{ T_{ n - 2 } } = k^{ n - 1 } U_1 \frac{ T_{ n - 1 } }{ T_{ n - 2 } } = ( k^{ n - 1 } U_1 ) ( k^{ n - 2 } U_1 ) \frac{ 1 }{ T_{ n - 3 } }$,$T_{ n - 3 } = ( k^{ n - 4 } U_1 ) ( k^{ n - 5 } U_1 ) \frac{ 1 }{ T_{ n - 6 } }$.所以$T_{ n } = k^6 T_{ n - 6 }$,所以$U$存在长度为$6$的循环节.所以$U_{ N } = \frac{ T_N }{ T_{ N - 1 } } = \frac{ T_2 }{ T_1 } = U_2 = kU_1$.(其实直接暴力找循环节也是可以的)</p>
<p>所以$k$需要是$N$的因子.</p>
<p>哦,还不如直接找循环节,还要判断这是个整数序列.</p>
<p>设$w = U_1$,则$U$的前六项是:$1 , w , kw , k^2 , \frac{ k^2 }{ w } , \frac{ k }{ w }$.要求$kw = N , w | k$,所以$( 11 \times 23 ) | k$,$k \equiv 0 \pmod{ 4 }$.所以$k = 4 \times 11 \times 23$或$k = 8 \times 11 \times 23$.</p>
<h4><span id="problem15">Problem15</span></h4><p>求使方程$\lfloor \frac{ 10^n }{ x } \rfloor = N = 2024$恰有两个整数解的正整数$n$的个数.</p>
<h5><span id="solution15">Solution15</span></h5><p>我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
N & \leq \frac{ 10^n }{ x } < N + 1 \\
xN & \leq 10^n < x ( N + 1 ) \\
\frac{ 10^n }{ N + 1 } & < x \leq \frac{ 10^n }{ N } \\
\lfloor \frac{ 10^n }{ N + 1 } \rfloor & < x \leq \lfloor \frac{ 10^n }{ N } \rfloor \\
\lfloor \frac{ 10^n }{ N } \rfloor - \lfloor \frac{ 10^n }{ N + 1 } \rfloor & = 2 \\
\frac{ 10^n }{ N ( N + 1 ) } - \frac{ 10^n \bmod N }{ N } + \frac{ 10^n \bmod{ ( N + 1 ) } }{ N + 1 } & = 2
\end{aligned}</script><p>显然$\lfloor \frac{ 10^n }{ N ( N + 1 ) } \rfloor = 1 , 2 , 3$.而$N ( N + 1 ) = 4098600$,所以只有$n = 7$可能满足条件,带入检验可行.</p>
<h4><span id="problem18">Problem18</span></h4><p>用六种颜色给正方形六个面染色,旋转平移后相同算一种方案,要求每个面颜色都不同,求方案数.</p>
<h5><span id="solution18">Solution18</span></h5><p>钦定一个面,然后枚举对面,中间四个是一个环,方案数是$5 \times 3 ! = 30$.</p>
<h4><span id="problem19">Problem19</span></h4><p>$f ( x ) = \lfloor 2 x \rfloor + \lfloor 4 x \rfloor + \lfloor 6 x \rfloor + \lfloor 8 x \rfloor , x \in \mathbb{ R }$,求其不超过$n = 2024$的正整数取值有多少种.</p>
<h5><span id="solution19">Solution19</span></h5><p>显然$f ( x + 1 ) = f ( x ) + 20$,因此我们先考虑$x \in [ 0 , 1 )$的情况.</p>
<p>手动枚举一下知道此时$f ( x )$有$12$种不同的取值,前六种是$\{ 0 , 1 , 2 , 4 , 5 , 6 \}$,后六种对应了前六种$+ 10$.而$2024 = 101 \times 20 + 4$,所以共有$101 \times 12 - 1 + 4 = 1215$种取值.</p>
<h4><span id="problem20">Problem20</span></h4><p>从$[ 1 , n ] , n = 2024$中分别独立随机两个正整数(可以相同)$a , b$,则求$3^a + 7^b \equiv 8 \pmod{ 10 }$的概率.</p>
<h5><span id="solution20">Solution20</span></h5><p>考虑$\varphi ( 10 ) = 4$,所以原题答案等价于$n = 4$的时候的答案.在这$16$中可能性中满足条件的只有三种,概率为$\frac{ 3 }{ 16 }$.</p>
<h3><span id="2023强基部分">2023强基(部分)</span></h3><h4><span id="problem3">Problem3</span></h4><p>已知$a_1 = \frac{ 5 }{ 2 } , a_{ n + 1 } = a_n^2 - 2$,求$\lfloor a_n \rfloor \bmod 7 , n = 2023$.</p>
<h5><span id="solution3">Solution3</span></h5><p>这个一看就不是好解的,想都别想直接数学归纳,注意到$a_n = \frac{ 4^{ 2^{ n - 1 } } + 1 }{ 2^{ 2^{ n - 1 } } }$,那么$\lfloor a_n \rfloor = 2^{ 2^{ n - 1 } }$.</p>
<p>而$\varphi ( 7 ) = 6 , \varphi ( 6 ) = 2$.由扩展欧拉定理,立刻有:$2^{ 2^{ 2022 } } \equiv 2^{ 2^{ 2022 } \bmod 6 } \equiv 2^{ 2^{ 6 } } \equiv 16 \equiv 2 \pmod{ 7 }$.</p>
<h4><span id="problem4">Problem4</span></h4><p>$50$个队伍两两打比赛,胜一场积分$+ 1$,负一场积分不变,无平局.</p>
<p>且任取$27$支队伍,其中一定有一支队伍负于其它的$26$支,也一定有一支队伍胜于其它的$26$支.</p>
<p>问$50$支队伍最少有多少种不同的积分.</p>
<h5><span id="solution4">Solution4</span></h5><p>答案是$50$.</p>
<p>因为是竞赛图,缩点之后是一条链.</p>
<p>如果所有强连通分量的大小都$\leq 27$的话,显然我们全选一个强连通分量就完蛋了.因此所有的强连通分量的大小都$&gt; 27$,唯一的可能是所有点在一个强连通分量中,我们在其中取出一个长度为$k$的简单环,由鸽笼原理,剩下的$n - k$个点中至少有$\frac{ n - k }{ 2 }$个点对着$k$个点只输或者只赢(如果有输有赢就无所谓了),这样的话只需要$k + \frac{ n - k }{ 2 } \geq 27$即可,此时$k \geq 4$即可.由于这是竞赛图,显然存在长度为$4$的简单环.</p>
<p>还有一种更简单的做法,考虑取一个积分最多的点,假设为$u$.我们任意取一个击败过它的点(如果有的话),假设为$v$,再取$25$个被$u$击败的点(显然这些点存在),设这些点集为$S$.则$u , v , S$组成的集合中,有一个点可以击败其它所有点,根据假设,只能是$v$.由此,可以知道,只要是$u$能击败的点,$v$一定能击败,而且$v$能击败$u$,因此$\deg_v &gt; \deg_u$,与假设不符.因此一定不存在一个$v$可以击败$u$.删掉$u$后做数学归纳,可知原图一定是拓扑图.</p>
<h4><span id="problem8">Problem8</span></h4><p>一只蚂蚁第一天在$( 0 , 0 )$,第$k + 1$天向上下左右随机一个方向移动$\frac{ 1 }{ 4^k }$单位,求第$n$天的可能位置数量,$n = 2023$.</p>
<h5><span id="solution8">Solution8</span></h5><p>不妨设第$n$天不同位置数量为$S_n$,显然只要前面岔开了,后面永远无法走到一个点.所以$S_1 = 1 , S_{ n + 1 } = 4 S_n , S_{ 2023 } = 4^{ 2022 }$.</p>
<h4><span id="problem10">Problem10</span></h4><p>集合$U = \{ 1 , 2 , \cdots , n \} , n = 10$,求$U$中的满足元素两两互素的三元子集个数.</p>
<h5><span id="solution10">Solution10</span></h5><p>集合是无序的,这个很难搞,我们先从$U$中把$1$去掉最后再加上.</p>
<p>先考虑可以重复放$1$的情况:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{ i = 1 }^n \sum_{ j = 1 }^{ n } \sum_{ k = 1 }^{ n } [ \gcd ( i , j ) & = 1 ] [ \gcd ( i , k ) = 1 ] [ \gcd ( j , k ) = 1 ] \\

\end{aligned}</script><p>这个推下去感觉就头大了,退一步考虑暴力算吧.</p>
<p>先考虑全是奇数的情况,只能从$1 , 3 , 5 , 7 , 9$中选,答案应该是$1 + 2 \binom{ 3 }{ 2 } = 7$.</p>
<p>接下来考虑选一个偶数,如果选$2 , 4 , 8$是等价的,答案此时是$3 ( \binom{ 5 }{ 2 } - 1 ) = 27$.如果选$6$的话答案是$\binom{ 3 }{ 2 } = 3$.如果选$10$的话方案数是$\binom{ 4 }{ 2 } - 1 = 5$,加起来方案数是$42$.</p>
<h4><span id="problem11">Problem11</span></h4><p>集合$U = \{ 1 , 2 , \cdots , n \} , n = 366$,则$U$的互不相交且各元素之和为$17$的倍数的二元子集最多有多少个?</p>
<h5><span id="solution11">Solution11</span></h5><p>考虑$\lfloor \frac{ 366 }{ 17 } \rfloor = 21 , 366 \equiv 9 \pmod{ 17 }$.答案显然是$21 \times 8 + 10 + 1 = 179$个.</p>
<h4><span id="problem12">Problem12</span></h4><p>三个互不相同的数的$\gcd = 20 , \text{ lcm } = 20000$,求选取这三个数的方案数(顺序不同算不同的方案).</p>
<h5><span id="solution12">Solution12</span></h5><p>显然等价于$\gcd = 1 , \text{ lcm } = 1000 = 2^3 \times 5^3$.先只分析其中一个质因子,方案应该是$( 0 , 0 , 3 ) , ( 0 , 1 , 3 ) , ( 0 , 2 , 3 ) , ( 0 , 3 , 3 )$,打乱一下顺序的话就共有$3 + 6 + 6 + 3 = 18$种方案.如果可以重复,平方一下得到$324$.</p>
<p>接下来去掉重复的情况,只有可能两个质因子都相同才会重复,拿上面的三元组算一下,此时方案数共有$2 \times 2 \times 3 = 12$种,于是答案为$312$.</p>
<h4><span id="problem14">Problem14</span></h4><p>求$\lfloor \frac{ k^2 }{ n } \rfloor , k \in [ 1 , n ] , n = 2023$种有多少个不同的元素.</p>
<h5><span id="solution14">Solution14</span></h5><script type="math/tex; mode=display">
\begin{aligned}
\lfloor \frac{ k^2 }{ n } \rfloor & = d \\
d & \leq \frac{ k^2 }{ n } < d + 1 \\
nd & \leq k^2 < n ( d + 1 )
\end{aligned}</script><p>由于两个完全平方数的差是逐渐增大的,应该存在一个$k_0$,$\leq k_0$的$k$会扎堆,但是这些$d$全都能取到,$&gt; k_0$的则不会有两个$k$得到相同的元素.所以前者统计不同的$d$,后者统计不同的$k$考虑$( k + 1 )^2 - k^2 = 2 k + 1$.分界线应该是$k_0 = 1011$.</p>
<p>所以答案应该是$n - k_0 + \lfloor \frac{ k_0^2 }{ 2 k_0 + 1 } \rfloor + 1 = 1012 + 506 = 1518$.</p>
<h4><span id="problem15">Problem15</span></h4><p>对四元组$( a , b , c , d )$计数,满足$101 | ( a + b + c + d )$且$0 &lt; a &lt; b &lt; c &lt; d \leq 101$.</p>
<h5><span id="solution15">Solution15</span></h5><p>这题真的厉害啊.</p>
<p>不妨设$S_k$为满足$( a + b + c + d ) \equiv k \pmod{ 101 }$的满足$0 &lt; a &lt; b &lt; c &lt; d \leq 101$的四元组数量.不难发现$\sum S_k = \binom{ 101 }{ 4 }$.</p>
<p>注意到$( a , b , c , d ) \mapsto ( a + 1 , b + 1 , c + 1 , d + 1 )$,注意这里是$\pmod{ 101 }$意义下的加法,这是一个双射,所以$S_{ k } = S_{ k + 4 }$,下标同样也是$\pmod{ 101 }$意义下进行的.又因为$\gcd ( 101 , 4 ) = 1$,所以所有的$S_k$均相等.$S_0 = \frac{ \binom{ 101 }{ 4 } }{ 101 } = 40425$.</p>
<h4><span id="problem16">Problem16</span></h4><p>问方程$x \lfloor x \rfloor = 6$的解的个数.</p>
<h5><span id="solution16">Solution16</span></h5><p>$6 = x \lfloor x \rfloor \geq \lfloor x \rfloor^2$,所以$\lfloor x \rfloor = \pm 1 , \pm 2$.显然都不可以.所以个数为$0$.</p>
<h4><span id="problem17">Problem17</span></h4><p>设$R ( n ) = \sum_{ k = 2 }^{ 10 } ( n \bmod k )$,求满足$R ( n ) = R ( n + 1 )$的十进制下的两位数$n$的个数.</p>
<h5><span id="solution17">Solution17</span></h5><p>从$R ( n )$到$R ( n + 1 )$,应该是加了若干个$1$,然后又丢了几个$k - 1$这样的.那就一定需要丢掉的数字之和为$9$.枚举一下,丢了的只有可能是以下情况:$( 9 ) , ( 7 + 2 ) , ( 6 + 3 ) , ( 5 + 4 ) , ( 4 + 3 + 2 )$,分别对应了$n + 1$应该是分别以下数的倍数$( 9 ) , ( 14 ) , ( 6 ) , ( 20 ) , ( 12 )$,并且和分别要求不是另一些数的倍数,这就去掉了其中的若干个,最后剩下的是:$( 7 + 2 )$,并且分别不能是以下数字的倍数$( 3 , 4 , 5 )$.</p>
<p>取一下的话$n + 1$可以是:$14 , 98$,$n = 13 , 97$,验证一下均合法,所以答案为$2$.</p>
<h4><span id="problem18">Problem18</span></h4><p>已知$a &lt; b &lt; c &lt; d$,而$x , y , z , w$是$a , b , c , d$的一个排列,求$( x - y )^2 + ( y - z )^2 + ( z - w )^2 + ( w - x )^2$得到的不同数个数.</p>
<h5><span id="solution18">Solution18</span></h5><p>圆排列个数是$3 ! = 6$个,只需要判掉相同的圆排列即可.</p>
<p>显然翻转后是相同的,所以最多有三个不同数,排列分别是$( x , y , z , w ) , ( x , z , w , y ) , ( x , w , y , z )$.</p>
<p>考虑:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& ( x - y )^2 + ( y - z )^2 + ( z - w )^2 + ( w - x )^2 \\
= & 2 ( x^2 + z^2 + y^2 + w^2 ) - 2 ( xy + yz + zw + wx )
\end{aligned}</script><p>显然只要$xy + yz + zw + wx$不同,那么两个数就不同.不难判断上面三个数互不相同.</p>
<h4><span id="problem19">Problem19</span></h4><p>已知$0 &lt; x_1 &lt; x_2 &lt; \cdots &lt; x_9$且$\sum_{ k = 1 }^9 x_k = 220$,在$\sum_{ k = 1 }^5 x_k$最大的前提下,最小化$x_9 - x_1$.</p>
<h5><span id="solution19">Solution19</span></h5><p>不妨枚举一下$x_5$选啥,设$f ( S , m , k )$表示选出$k$个互不相同的数,使得它们$\leq m$且总和为$S$,是否可行.不难发现$f ( S , m , k ) = [ \frac{ k ( k + 1 ) }{ 2 } \leq S \leq \frac{ k ( 2 m - k + 1 ) }{ 2 } ]$.</p>
<p>那我们要求的就是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\max_{ 5 \leq x_5 } \{ S | f ( 220 - 4 x_5 - S , + \infty , 4 ) & = 1 \land f ( S - x_5 , x_5 - 1 , 4 ) = 1 \} \\
& = \max_{ 5 \leq x_5 } \{ S | 4 x_5 + S \leq 210 \land 10 + x_5 \leq S \leq 5 x_5 - 10 \} \\
& = \max_{ 5 \leq x_5 } ( \min \{ 5 x_5 - 10 , 210 - 4 x_5 \} )
\end{aligned}</script><p>立刻得到$x_5 = 24 , 25 , S = 110$,那么后面的选法就一定了,后面四个数一定是$26 , 27 , 28 , 29$,只需要让$x_1$最大即可</p>
<p>$x_5 = 24$时,此时最优显然是$20 , 21 , 22 , 23 , 24 , 26 , 27 , 28 , 29$,$x_9 - x_1 = 9$.</p>
<h4><span id="problem20">Problem20</span></h4><p>有一个$n$边形,其中有$\binom{ n }{ 2 }$条对角线,不存在三线交于一点的情况,问这些对角线将该$n$边形分成了多少个部分.$n = 10$.</p>
<h5><span id="solution20">Solution20</span></h5><p>平面图同样符合欧拉定理.</p>
<p>考虑内部一定多出来了$\binom{ n }{ 4 }$个点(任意四个点有且只有一种交法),每交一个点就会多出$2$条边,所以多出来了$2 \binom{ n }{ 4 } + \frac{ n ( n - 3 ) }{ 2 }$条边.</p>
<p>考虑内部的若干个部分一定是$a_3$个三角形,$a_4$个四边形,…,$a_k$个$k$边形,总之我们发现:</p>
<script type="math/tex; mode=display">
\begin{cases}
\sum_{ j = 3 }^k ( j - 2 ) \pi a_j = ( n - 2 ) \pi + 2 \pi \binom{ n }{ 4 } \\
\sum_{ j = 3 }^k ja_j = n + 4 \binom{ n }{ 4 } + n ( n - 3 )
\end{cases}</script><p>两式得到:$\sum_{ j = 3 }^k a_j = \frac{ ( n - 1 ) ( n - 2 ) }{ 2 } + \binom{ n }{ 4 }$.</p>
<p>$n = 10$的时候,答案为$246$.</p>
<h3><span id="2024强基部分">2024强基(部分)</span></h3><h4><span id="problem1">Problem1</span></h4><p>求$\sum_{ i = 1 }^n \lfloor \frac{ 19^i }{ 20 } \rfloor \bmod 7 , n = 2024$.</p>
<h5><span id="solution1">Solution1</span></h5><script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ i = 1 }^n \lfloor \frac{ 19^i }{ 20 } \rfloor \\
= & \sum_{ i = 1 }^n \lfloor \frac{ \sum_{ k = 0 }^i 20^k ( - 1 )^{ i - k } \binom{ i }{ k } }{ 20 } \rfloor \\
= & - \lfloor \frac{ n }{ 2 } \rfloor + \sum_{ i = 1 }^{ n } \frac{ 19^i - ( - 1 )^i }{ 20 } \\
= & - \lfloor \frac{ n }{ 2 } \rfloor + \frac{ \frac{ 19 }{ 18 } ( 19^n - 1 ) - ( \frac{ ( - 1 )^n - 1 }{ 2 } ) }{ 20 }
\end{aligned}</script><p>带入$n = 2024$并$\bmod 7$,原式为:</p>
<script type="math/tex; mode=display">
\equiv - 4 + \frac{ 5 }{ 4 } ( 1 - 5^n ) \equiv - 4 + 3 ( 1 - 5^n )</script><p>注意到$2024 \bmod 6 = 2$,原式$\equiv - 4 - 9 \equiv 1$.</p>
<h4><span id="problem3">Problem3</span></h4><p>求长度为$n$的排列个数,使得排列中$\nexists i \in [ 1 , n - 1 ] , a_i = a_{ i + 1 } - 1$.$n = 8$.</p>
<h5><span id="solution3">Solution3</span></h5><p>一眼容斥,也就是每个长度为$k$的连续段的容斥系数应该是$( - 1 )^{ k - 1 }$.那么设分成了$w$个段,总的容斥系数应该是$( - 1 )^{ n - w }$,答案就是$f_{ n ‘ } = \sum_{ w = 1 }^n ( - 1 )^{ n - w } w ! \binom{ n - 1 }{ w - 1 } = \sum_{ w = 0 }^{ n ‘ } ( - 1 )^{ n ‘ - w } \binom{ n ‘ }{ w } ( w + 1 ) ! = n ‘ ! \sum_{ w = 0 }^{ n ‘ } \frac{ ( - 1 )^w }{ w ! } ( n ‘ - w + 1 )$,此时已经能算出答案是$16687$.</p>
<p>注意到这个形式和错排非常像,类似错排去凑递推公式.设$g_n$为错排数量,显然有$f_{ n } = nf_{ n - 1 } + g_{ n }$,立刻算出答案是$16687$.</p>
<h4><span id="problem4">Problem4</span></h4><p>已知数列$1 , 2 , 2 , 3 , 3 , 3 , 4 , 4 , 4 , 4 , \cdots$,求其第$n$项$\bmod 5$的值,$n = 2024$.</p>
<h5><span id="solution4">Solution4</span></h5><p>考虑第一个值为$k$的地方应该在哪里.显然$a_{ \frac{ k ( k - 1 ) }{ 2 } + 1 } = k$.注意到$a_{ 2081 } = 65$,所以$a_n = 64$,其$\bmod 5 = 4$.</p>
<h4><span id="problem5">Problem5</span></h4><p>求四元组$( a_1 , a_2 , a_3 , a_4 )$的个数,满足$a_1 , a_2 , a_3 , a_4 \in \{ 1 , 2 , 3 \}$,且$10 &lt; a_1 a_2 a_3 a_4 &lt; 20$.</p>
<h5><span id="solution5">Solution5</span></h5><p>排个序按照字典序开搜,只有三种可能:$\{ 3 , 3 , 2 , 1 \} , \{ 3 , 2 , 2 , 1 \} , \{ 2 , 2 , 2 , 2 \}$,打乱顺序的话就有$25$种可能.</p>
<h4><span id="problem8">Problem8</span></h4><p>求$\mathbb{ R }$上方程$x^2 - 13 \lfloor x \rfloor + 11 = 0$的解的个数.</p>
<h5><span id="solution8">Solution8</span></h5><p>首先注意到$\lfloor x \rfloor = \frac{ x^2 + 11 }{ 13 }$,那么自然有方程组:</p>
<script type="math/tex; mode=display">
\begin{cases}
\frac{ x^2 + 11 }{ 13 } \leq x \\
x < \frac{ x^2 + 11 }{ 13 } + 1
\end{cases}</script><p>只需要解这个方程组即可.但是这个方程组很难搞.</p>
<p>先考虑$x^2 \equiv 2 \pmod{ 13 }$这个性质,由勒让德判别符号,算出该方程在整数范围内无解.</p>
<p>没办法,只能设$x = \sqrt{ 2 + 13 k }$的形式,带入有不等式:</p>
<script type="math/tex; mode=display">
\begin{aligned}
k - x + 1 & \leq 0 < k - x + 2 \\
1 & \leq \sqrt{ 2 + 13 k } - k < 2 \\
\begin{cases}
0 < k^2 - 9 k + 2 \\
k^2 - 11 k - 1 \leq 0
\end{cases}
\end{aligned}</script><p>冷静一下!注意到$0 \leq k \leq 13$,又根据第一个不等式得知大部分$k$应该会很大,开始暴力枚举一下,合法的情况有:$k = 0 , 9 , 10 , 11$,共有四个解.</p>
<h4><span id="problem9">Problem9</span></h4><p>在一个体积为$1$的正方体内部找一个点,过这个点作平行于正方体的面的三个平面,这样整个正方体会被分为八个长方体,最小化这八个部分中,体积$\leq \frac{ 1 }{ 8 }$的长方体的个数.</p>
<h5><span id="solution9">Solution9</span></h5><p>原本想考虑先横着切一刀,分为一个大部分一个小部分,大部分均分即可,小部分选一个很大的部分,剩下三个部分体积$\leq \frac{ 1 }{ 8 }$.考虑设这个点是$( x , x , h )$,那么必然有$\begin{cases}( 1 - h ) x^2 &gt; \frac{ 1 }{ 8 } \ h ( 1 - x )^2 &gt; \frac{ 1 }{ 8 }\end{cases}$,化简,只要$8 &gt; \frac{ 1 }{ x^2 } + \frac{ 1 }{ ( 1 - x )^2 }$即可,这个根据基本不等式不可能满足,寄了.</p>
<p>但是四个肯定是好构造的,我们直接取$( 0 . 5 , 0 . 5 , 0 . 1 )$即可.那么是不是可以证明答案一定$&gt; 3$呢?</p>
<p>考虑一个面上的四个长方体,其中较小的两个一定是相邻的.因此,最终体积$\leq \frac{ 1 }{ 8 }$的长方体肯定也是相连的.接下来证明三个的不行,只需要设这个点为$( x , y , h ) , x , y , h \leq \frac{ 1 }{ 2 }$,然后证明$8 &gt; \frac{ 1 }{ xy } + \frac{ 1 }{ ( 1 - x ) ( 1 - y ) } , x , y \leq \frac{ 1 }{ 2 }$这个不等式无解即可.</p>
<p>由基本不等式,$\frac{ 1 }{ xy } + \frac{ 1 }{ ( 1 - x ) ( 1 - y ) } \geq 2 \sqrt{ \frac{ 1 }{ x ( 1 - x ) y ( 1 - y ) } } \geq 2 \sqrt{ 4 \times 4 } = 8$,不符题意.</p>
<p>这样就是最少是四个.</p>
<h4><span id="problem11">Problem11</span></h4><p>设$S ( n )$表示正整数$n$的十进制数码和,求满足$S ( n ) \equiv S ( n + 1 ) \equiv 0 \pmod{ 5 }$的最小的$n$.</p>
<h5><span id="solution11">Solution11</span></h5><p>显然必须发生进位,不妨设$n = 10^k a + 10^k - 1$,$a \ne 9 \pmod{ 10 }$,$S ( n ) = S ( a ) + 9 k , S ( n + 1 ) = S ( a ) + 1$,</p>
<p>此时显然有$9 k - 1 \equiv 0 \pmod{ 5 }$,$k \equiv 4 \pmod{ 5 }$.$n_{ \min } = 49999$.</p>
<h4><span id="problem12">Problem12</span></h4><p>求满足以下条件的最大的正整数$n$:十进制下每一位数字互不相同,且$\forall m , 10^m \leq n , \lfloor \frac{ n }{ 10^m } \rfloor | n$.</p>
<h5><span id="solution12">Solution12</span></h5><p>显然不可能是五位数及以上,而且如果是四位数的话最后一位必然是$0$.</p>
<p>不妨设其为$\overline{ ab }$,其中$b = 10 c$,$a$是$b$的因子,不妨枚举一下$k = \frac{ b }{ a }$.注意到因为$a$中不能有$0$,所以$k \in \{ 2 , 4 , 5 , 8 \}$.取$k = 2$试出来$3570$是合法的,而且显然$k \in \{ 4 , 5 , 8 \}$的时候不可能有更大的答案了.</p>
<h4><span id="problem20">Problem20</span></h4><p>$a_1 = \sqrt{ 2 } , a_{ n + 1 } = \lfloor a_n \rfloor + \frac{ 1 }{ a_n - \lfloor a_n \rfloor }$,求$\sum_{ k = 1 }^{ n } a_k , n = 2024$.</p>
<h5><span id="solution20">Solution20</span></h5><p>这一看就是个环,设$a_n = b_n + c_n \sqrt{ 2 }$.难点显然在下取整函数.</p>
<p>没想出太好的办法,选择使用数学归纳,注意到:</p>
<script type="math/tex; mode=display">
\begin{cases}
a_1 = 0 + \sqrt{ 2 } \\
a_2 = 2 + \sqrt{ 2 } \\
a_3 = 4 + \sqrt{ 2 } \\
\cdots
\end{cases}</script><p>容易猜测$b_n = 2 ( n - 1 ) , c_n = 1$.也就是$a_n = 2 ( n - 1 ) + \sqrt{ 2 }$,数学归纳一下即可.</p>
<p>那么$\sum_{ k = 1 }^n a_k = n ( n - 1 ) + n \sqrt{ 2 }$,带入$n = 2024$即可.</p>
<h3><span id="2022图选">2022图选</span></h3><h4><span id="problem1">Problem1</span></h4><p>问能否将有限个单位正方形摆放在平面上使得:</p>
<ol>
<li><p>任意两个正方形至多有一个顶点重合</p>
</li>
<li><p>每个正方形的每个顶点都与其他某个正方形的顶点重合</p>
</li>
</ol>
<h5><span id="solution1">Solution1</span></h5><p>这个题传到我这里题面已经丧失了,但反正理解起来就两种情况</p>
<ol>
<li><p>边不能相交.此时不可能.考虑扫描线,从上到下扫一条线,然后第一次扫到的最右边的那个顶点显然不可能和其它的某个正方形顶点重合.</p>
</li>
<li><p>边可以相交,放到正十二边形的边上.</p>
</li>
</ol>
<h4><span id="problem2">Problem2</span></h4><p>求$\lfloor ( \frac{ 1 + \sqrt{ 5 } }{ 2 } )^{ 12 } \rfloor$.</p>
<h5><span id="solution2">Solution2</span></h5><p>考虑$( \frac{ 1 + \sqrt{ 5 } }{ 2 } )^3 = 2 + \sqrt{ 5 }$,$\lfloor ( \frac{ 1 + \sqrt{ 5 } }{ 2 } )^{ 12 } \rfloor = 161 + \lfloor 72 \sqrt{ 5 } \rfloor = 321$.</p>
<p>也可以考虑类似斐波那契数列,取$f_n = ( \frac{ 1 + \sqrt{ 5 } }{ 2 } )^{ n } + ( \frac{ 1 - \sqrt{ 5 } }{ 2 } )^{ n }$,其满足$f_n = f_{ n - 1 } + f_{ n - 2 } , f_0 = 2 , f_1 = 1$,取$f_{ 12 } - 1$就是答案$321$.</p>
<h4><span id="problem3">Problem3</span></h4><p>对于一个加法乘法环,要求你利用:</p>
<ol>
<li><p>乘法结合律、交换律、对加法的分配律、逆元.</p>
</li>
<li><p>加法结合律、逆元.</p>
</li>
</ol>
<p>来证明加法的交换律.</p>
<h5><span id="solution3">Solution3</span></h5><p>倒反天罡题.</p>
<p>注意到$( a + 1 ) ( b + 1 ) = ( b + 1 ) ( a + 1 )$,所以$a + b = b + a$.</p>
<h4><span id="problem4">Problem4</span></h4><p>给你$n$个数集$a_i$,其中$| a_i | = i + 1$,要你选出$n$个两两不同的数字满足$x_i \in a_i$,求最少方案数.</p>
<h5><span id="solution4">Solution4</span></h5><p>考虑从小的往大了选,每次可能会删掉一个可选择的数字,所以是$2^n$.</p>
<h4><span id="problem5">Problem5</span></h4><p>Alice和Bob博弈.Alice先选一个数$m$,然后Bob选一个数$n ( n &gt; m )$,并构造一个$n$个点的竞赛图.Alice如果能从中选出$m$个不同的点,满足不存在某个点$x$到这$m$个点都有出边,那么Alice赢,否则Bob赢.问是否有人存在必胜策略.</p>
<h5><span id="solution5">Solution5</span></h5><p>一开始以为Alice肯定赢,结果被gank了.</p>
<p>其实Bob一定赢.为啥呢?考虑一对点合法的概率,应该是$( 1 - \frac{ 1 }{ 2^m } )^{ n - 2 }$,因此期望为$E = \binom{ n }{ m } ( 1 - \frac{ 1 }{ 2^m } )^{ n - 2 }$,只需$n$足够大的时候期望$&lt; 1$,则说明一定存在$0$,也就是Bob总有必胜策略.</p>
<p>注意到只需证明$\exists n$,$\binom{ n }{ m } &lt; ( \frac{ 2^m }{ 2^m - 1 } )^{ n - 2 }$,而$\binom{ n }{ m } = \frac{ n^{ \underline{ m } } }{ m ! } &lt; n^m$.下面证明$\exists n , n^m &lt; ( \frac{ 2^m }{ 2^m - 1 } )^{ n - 2 }$.</p>
<p>两边取$\ln$,不妨假设$n \geq 3$,有$m \ln n &lt; ( n - 2 ) \ln ( \frac{ 2^m }{ 2^m - 1 } ) , \frac{ m }{ \ln ( \frac{ 2^m }{ 2^m - 1 } ) } &lt; \frac{ n - 2 }{ \ln n }$,$\frac{ n - 2 }{ \ln n }$显然在$n \geq 3$的时候单增,所以一定存在这么一个$n$.</p>
<h3><span id="2023图选">2023图选</span></h3><h4><span id="problem1">Problem1</span></h4><p>求单位正方形中能放下的最大的等边三角形的边长.</p>
<h5><span id="solution1">Solution1</span></h5><p>首先肯定三角形有一个角卡在正方形的角上(不然可以平移过去),而且剩下两个角肯定卡在边上.</p>
<h4><span id="problem2">Problem2</span></h4><p>求正整数拆分成有序的$1 , 2$序列的个数.</p>
<h5><span id="solution2">Solution2</span></h5><p>显然为斐波那契数.</p>
<h4><span id="problem3">Problem3</span></h4><p>定义$*$为集合$G$上的二元运算,已知:</p>
<ol>
<li><p>满足结合律$a ∗ b ∗ c = a ∗ ( b ∗ c )$.</p>
</li>
<li><p>存在左单位元$e$,对任意$a$满足$e ∗ a = a$.</p>
</li>
<li><p>对任意$a$存在左逆元$b$,使$b ∗ a = e$.</p>
</li>
</ol>
<p>问:</p>
<ol>
<li><p>左单位元是否也为右单位元.</p>
</li>
<li><p>左逆元是否也为右逆元.</p>
</li>
</ol>
<h5><span id="solution3">Solution3</span></h5><p>看(2),考虑设$b$是$a$的左逆元,$c$是$b$的左逆元,则$cba = ce = a , ab = ceb = e$.</p>
<p>看(1),设$b$是$a$的逆元,$ea = aba = ae$,所以左单位元也是右单位元.</p>
<p>值得一提的是,这个题如果将条件(3)改为右逆元,则不一定构成群.</p>
<p>感性理解一下改前的题,如果存在左逆元的话,说明$ab$的时候$b$不能彻底损失信息,而观察$ab = eab$知道$a$也不能损失信息,于是应该是群.</p>
<p>但怎么构造反例呢?首先得造出来左单位元对吧.答案给了一种很聪明的构造方式:考虑运算$( a_1 , b_1 ) ( a_2 , b_2 )$,想办法让其损失掉$( a_1 , b_1 )$中的信息(这样使其不存在左逆元,但可以构造出左幺元).注意到$( a_1 , b_1 ) ( a_2 , b_2 ) = ( a_1 + a_2 , b_2 )$即可,存在左幺元为$( 0 , 0 )$,右逆元为$( - a , 0 )$.</p>
<h4><span id="problem4">Problem4</span></h4><p>$f$的定义域和值域都是正整数并且$f ( xy ) = f ( x ) + f ( y ) - 1$,求:</p>
<ol>
<li><p>是否存在这样的函数.</p>
</li>
<li><p>是否存在无数个这样的函数.</p>
</li>
<li><p>是否存在严格递增的函数.</p>
</li>
</ol>
<h5><span id="solution4">Solution4</span></h5><p>令$g ( x ) = f ( x ) - 1$,则$g ( xy ) = g ( x ) + g ( y )$.</p>
<p>对于(1),取$g ( x ) = 0 , f ( x ) = 1$即可.</p>
<p>对于(2),考虑$g ( p^k ) = kg ( p )$,只需要让$g ( p )$取不同的值即可.</p>
<p>对于(3),考虑$g ( 2^a ) = ag ( 2 )$,$g ( 3^b ) = bg ( 3 )$.</p>
<p>考虑构造$a , b$,使得$2^a &lt; 3^b$但是$ag ( 2 ) \geq bg ( 3 )$.不妨取$a = \lceil \frac{ bg ( 3 ) }{ g ( 2 ) } \rceil$,那么必定有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
2^{ \lceil \frac{ bg ( 3 ) }{ g ( 2 ) } \rceil } & < 3^b \\
\lceil \frac{ bg ( 3 ) }{ g ( 2 ) } \rceil & < b \log_2 3 \\
\frac{ bg ( 3 ) }{ g ( 2 ) } + \Delta & \leq b \log_2 3 \\

\end{aligned}</script><p>于是如果存在,必定需要$\frac{ g ( p_1 ) }{ g ( p_2 ) } \geq \log_{ p_2 } p_1 \land \frac{ g ( p_2 ) }{ g ( p_1 ) } \geq \log_{ p_1 } p_2$,也就是$\frac{ g ( p_2 ) }{ g ( p_1 ) } = \log_{ p_1 } p_2$.但是左边是有理数右边是无理数,不可能.</p>
<h4><span id="problem5">Problem5</span></h4><p>对于任意$2 n - 1$个正整数(可重复),问其中是否一定有$n$个数的和能被$n$整除,这题$n = 50$.</p>
<h5><span id="solution5">Solution5</span></h5><p>考虑当$n$是合数的时候,设$n = pq$,则可以将其拆成$q - 1$组每组$2 p$个数以及一组$2 p - 1$个数,因此只需要这些都可以找到$p$个数使得其是$p$的倍数,组合起来就行了.</p>
<p>只需要解决$n$是质数的情况.</p>
<p>感觉场上的最优解应该是解决$n = 2$和$n = 5$的情况然后拼成$n = 50$.</p>
<p>$n = 2$的时候显然是对的.</p>
<p>这谁想得到啊?</p>
<p>考虑反证,如果不存在的话,显然$S = \sum_{  } ( x_{ p_1 } + x_{ p_2 } + \cdots + x_{ p_n } )^{ p - 1 } \equiv \binom{ 2 n - 1 }{ n } \equiv 1 \pmod{ n }$.</p>
<p>但是考虑左边那个多项式的每一项,形如$c \prod_{ i = 1 }^k x_{ p_i }^{ e_i }$.注意到$c$一定是$\binom{ 2 n - 1 - k }{ n - k }$的倍数,而后者$\bmod n$为$0$.</p>
<p>这玩意到底咋想到的?</p>
<p>不过其实也合理,因为$1$并不是对称的,而左边是个对称式子,某个$x$增大也无所谓,这意味着左边应该是为$0$的,我们要做的就是去证明它是$0$.</p>
<h3><span id="2024图选">2024图选</span></h3><h4><span id="problem1">Problem1</span></h4><p>问在双曲线$xy = 1$上有一个三个点都在上面的等边三角形,求其边长.</p>
<h5><span id="solution1">Solution1</span></h5><p>不会做,取个特殊值知道答案应该是$[ 2 \sqrt{ 6 } , + \infty )$.</p>
<h4><span id="problem2">Problem2</span></h4><p>我们称”能表示为两个数的平方和”的数是好的,求证:</p>
<ol>
<li><p>如果$n , m$都是好的,那么$nm$是好的.</p>
</li>
<li><p>$2024$不是好的.</p>
</li>
</ol>
<h5><span id="solution2">Solution2</span></h5><p>如果$n = a^2 + b^2 , m = c^2 + d^2$,那么$nm = a^2 c^2 + a^2 d^2 + b^2 c^2 + b^2 d^2 = ( ac - bd )^2 + ( ad + bc )^2$.</p>
<p>$2024 = 2^3 \times 11 \times 23$,使用反证法,不妨设其可以被表示为$a^2 + b^2$.</p>
<p>讨论一下:如果$a , b$均为奇数,那么$a^2 + b^2 \equiv 2 \pmod{ 8 }$,不符题意.</p>
<p>于是$a , b$应该均为偶数,那么就有$a ‘^2 + b ‘^2 = 506$.简单枚举一下就知道不存在.</p>
<p>当然这个题是个数竞结论,可以直接套用结论.</p>
<h4><span id="problem3">Problem3</span></h4><p>对于集合$G$,$e \in G$,定义域为$G$的函数$f$满足以下性质:</p>
<ol>
<li><p>$e \in G$,但$e$不在$f$的值域中.</p>
</li>
<li><p>$G$关于$f$封闭.</p>
</li>
<li><p>若$\exists A \subseteq G$,$e \in A$且$A$对$f$封闭,则$A = G$.</p>
</li>
</ol>
<p>在$G$上定义二元运算$\circ$,满足$ae = a , af ( b ) = f ( ab )$.</p>
<p>求证:</p>
<ol>
<li><p>存在幺元.</p>
</li>
<li><p>运算满足交换律.</p>
</li>
<li><p>运算满足结合律.</p>
</li>
</ol>
<h5><span id="solution3">Solution3</span></h5><p>只需要证明运算满足交换律即可.</p>
<p>考虑性质(3),我们不妨先往$A$里面扔个$e$,此时$A$一定不满足条件.我们不断从$A$中选出一个元素$w$满足$f ( w ) \notin A$,并把$A : = A \cup \{ f ( w ) \}$.不断做这个过程显然最后会得到$G$,这意味着任何一个元素$a$可以写成$f ( f ( f \cdots f ( e ) ) )$的形式.</p>
<p>不妨将$f$函数嵌套$k$次记作$f^{ ( k ) }$,那么我们要证明的是$a = f^{ ( A ) } ( e ) , b = f^{ ( B ) } ( e )$,$ab = ba$.</p>
<p>考虑$ab = f^{ ( A ) } ( e ) f^{ ( B ) } ( e ) = f^{ ( B ) } ( f^{ ( A ) } ( e ) e ) = f^{ ( A + B ) } ( e )$,因此证毕.</p>
<h4><span id="problem4">Problem4</span></h4><p>给出一个具体函数满足:</p>
<ol>
<li><p>$f ( x + y ) = f ( x ) + f ( y ) + xy$.</p>
</li>
<li><p>$f ( xy ) = f ( x ) f ( y ) + f ( x - 1 ) f ( y - 1 )$.</p>
</li>
</ol>
<h5><span id="solution4">Solution4</span></h5><p>先注意到$f ( 0 ) = 0 , f ( 1 ) = 1$.</p>
<p>以$x$为主元两边求导,立刻得到$f ‘ ( x + y ) = f ‘ ( x ) + y$,因此$f ‘ ( x )$是斜率为$1$的一次函数,立刻得到$f ( x ) = \frac{ x^2 }{ 2 } + \frac{ x }{ 2 }$.</p>
<h4><span id="problem5">Problem5</span></h4><p>对于$r = \sqrt{ 2 }$,是否存在正整数$p$和整数$q$满足$| pr - q | &lt; \frac{ 1 }{ 2024 }$且$p &lt; 2024$.</p>
<h5><span id="solution5">Solution5</span></h5><p>考虑取$0 , \sqrt{ 2 } , 2 \sqrt{ 2 } , 3 \sqrt{ 2 } , \cdots 2023 \sqrt{ 2 }$的小数部分,记作$a_0 , a_1 , \cdots a_{ 2023 }$.</p>
<p>由鸽笼原理,一定存在两个数$0 \leq x &lt; y \leq 2023$满足$| a_x - a_y | &lt; \frac{ 1 }{ 2024 }$,于是证毕.</p>
<h3><span id="2019茶选">2019茶选</span></h3><h4><span id="problem1">Problem1</span></h4><p>在一个数轴上,你站在$0$点,并按照如下算法寻找$x ( x &gt; 0 )$点处的牛:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curpos = 0;</span><br><span class="line">curdir = LEFT;</span><br><span class="line">step = 1;</span><br><span class="line">while (没有找到牛) &#123;</span><br><span class="line">沿着 curdir 方向，走 step 单位距离，如果找到牛就停止;</span><br><span class="line">如果没有找到牛，回到原点并将 curdir 设为反方向，step = step * 2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>大约至少需要多少步才能找到牛?</p>
<p>A. $3 x$  B. $5 x$  C. $7 x$  D. $9 x$  E. 以上答案都不对.</p>
<h5><span id="solution1">Solution1</span></h5><p>考虑找到牛的时候$step$为多少,应该为$2^{ 2 k }$,其中$k$满足$2^{ 2 k } \geq x &gt; 2^{ 2 ( k - 1 ) }$.此时走的步数应该是$ans = 2 \sum_{ i = 0 }^{ 2 k - 1 } 2^i + x = 2^{ 2 k + 1 } - 1 + x$步.而$x \leq 2^{ 2 k } &lt; 4 x$,所以$ans &lt; 9 x - 1$.</p>
<h4><span id="problem2">Problem2</span></h4><p>给定$10$个实数变量$x_1 , \cdots , x_{ 10 }$,满足它们均$\geq 1$且两两不同.你要寻找一组$\{ x \}$和一个实数$a$,使得存在尽可能多组$\langle b \rangle , b_i = \pm 1$,满足$\sum_{ i = 1 }^{ 10 } b_i x_i \in ( a , a + 2 )$.</p>
<p>最多存在多少组$\langle b \rangle$?</p>
<p>A. $512$  B. $252$  C. $504$  D. $684$  E.以上答案都不对.</p>
<h5><span id="solution2">Solution2</span></h5><p>不妨猜测$x$全取$1$最优,此时的答案是$\binom{ 10 }{ 5 } = 252$.</p>
<p>能不能严格证明这个事情呢?我们不妨注意到一个事情:由于$x \geq 1$,所以如果存在两组$\langle b \rangle$,使得$A$组中选择取$+ 1$恰好是$B$组的子集,那么$S_A \leq S_B - 2$,不可能同时满足条件.</p>
<p>如果我们能选出若干个互不相交的集合呢?那我们显然可以让$x$尽可能接近$1$,这样就是满足条件的.所以问题变为对于一个大小为$10$的集合,要在其中挑选出尽可能多的子集使得这些集合两两之间没有包含关系,有结论说这个东西取$\binom{ 10 }{ 5 }$最优,即Sperner定理.其实也就是Dilworth定理的特例.</p>
<h4><span id="problem3">Problem3</span></h4><p>给定无向图$G = ( V , E )$,我们称一个图是好的,如果:</p>
<ol>
<li><p>每个点的度数均为$d$.</p>
</li>
<li><p>任何一个大小不超过$\frac{ | V | }{ 2 }$的联通集合$S$,其邻居(不属于$S$但和$S$中的某个点存在直接相连的边)的大小$\geq \frac{ 5 }{ 4 } | S |$.</p>
</li>
</ol>
<p>求证:好的图中任意两个点$u , v$之间的最短路径长度$dis ( u , v ) = O ( \log | V | )$.</p>
<h5><span id="solution3">Solution3</span></h5><p>考虑以$u$为起点一点一点往外扩张,这样一直扩张到$\frac{ | V | }{ 2 } + 1$时,集合中每个点到$u$的距离不超过$O ( \log | V | )$.</p>
<p>然后以$v$做同样的事,由于这两个集合大小之和大于$| V |$,说明一定有交,且存在一条路径长度为$O ( \log | V | )$的路径,最短路径肯定比这个还短.</p>
<h4><span id="problem4">Problem4</span></h4><p>给你两个完全相同的鸡蛋和一个$n = 100$层的高楼,你每次可以将鸡蛋从某一层楼掉下去.问你最少用多少次操作才能测出能让鸡蛋摔碎的最低楼层.</p>
<h5><span id="solution4">Solution4</span></h5><p>经典信息论题.考虑构造一棵左倾的决策树,从根到任何一个叶子节点最多向右走两步,并且有$101$个叶子节点(因为还有可能从最高层掉下去不碎).</p>
<p>设$f_{ i , 1 / 2 }$表示一棵有$i$个叶子的树,最多向右走$1 / 2$步,深度最低为多少.显然$f_{ i , 1 } = i - 1$.</p>
<p>不妨设最后的最大深度为$k$,需要满足$1 + \sum_{ i = 1 }^k i = 1 + \frac{ k ( k + 1 ) }{ 2 } \geq 101 , k ( k + 1 ) \geq 200$,$k_{ \min } = 14$.</p>
<h4><span id="problem5">Problem5</span></h4><p>$n$个人要进行一场游戏.游戏设计者准备了$n$张卡片,正面分别写着$n$个人的名字,背面写了$[ 1 , n ]$共$n$个不同的数字.所有卡片都背面朝上放置在一个房间里.</p>
<p>当设计者准备完成后,$n$个人可以经过充分的讨论,并依次进入房间,一张一张地翻开$\lfloor \frac{ n }{ 2 } \rfloor$张卡片,并找到写有自己名字的卡片.当一个人操作结束后,他无法与其他人交流直到游戏结束.</p>
<p>只有所有$n$个人全部找到了写有自己名字的卡片,他们才能获胜.请问:是否存在一种策略,使得无论设计者怎样安排名字和数字的对应,他们均拥有超过$0 . 1$的胜率.</p>
<h5><span id="solution5">Solution5</span></h5><p>这题真理元素讲过.做法是每个人先翻开自己编号的位置的卡片,假设卡片上数字是$a$,如果$a$就是自己的编号就下班;反之接下来翻开$a$位置的卡片.为了防止设计者刻意安排,可以提前自己随机一个数字的映射.这样失败当且仅当场上存在一个长度大于$\frac{ n }{ 2 }$的环.</p>
<p>考虑总方案数是$n !$.不妨枚举这个环的长度为$K$,则存在一个长度$= K &gt; \frac{ n }{ 2 }$的环的方案数是$\binom{ n }{ K } ( K - 1 ) ! ( n - K ) ! = \frac{ n ! }{ K }$.所以此时的概率为$\frac{ 1 }{ K }$.</p>
<p>那么失败的概率就是$H_n - H_{ \frac{ n }{ 2 } } \approx \ln 2$.</p>
<h3><span id="2022茶选">2022茶选</span></h3><h4><span id="problem1">Problem1</span></h4><p>证明弱对偶定理,差不多就是:</p>
<p>提一个问题:最大化$z = 5 x_1 + 8 x_2 + 4 x_3$,其中:</p>
<ol>
<li><p>$x_1 , x_2 , x_3 \geq 0$</p>
</li>
<li><p>$\frac{ 1 }{ 2 } x_1 + 5 x_2 + 9 x_3 \leq 3$</p>
</li>
<li><p>$4 x_1 + 7 x_2 + 3 x_3 \leq 6$</p>
</li>
</ol>
<p>再提一个问题:最小化$v = 3 y_1 + 6 y_2$,其中:</p>
<ol>
<li><p>$y_1 , y_2 \geq 0$</p>
</li>
<li><p>$\frac{ 1 }{ 2 } y_1 + 4 y_2 \geq 5$</p>
</li>
<li><p>$5 y_1 + 7 y_2 \geq 8$</p>
</li>
<li><p>$9 y_1 + 3 y_2 \geq 4$</p>
</li>
</ol>
<p>现在请你证明:$z \leq v$.</p>
<h5><span id="solution1">Solution1</span></h5><p>下面乘一下配一下上面的系数,自然得证.</p>
<p>写成矩阵形式,设$X = \begin{bmatrix}x_1 &amp; x_2 &amp; x_3\end{bmatrix} , A = \begin{bmatrix}0 . 5 &amp; 4 \ 5 &amp; 7 \ 9 &amp; 3\end{bmatrix} , Y = \begin{bmatrix}y_1 \ y_2\end{bmatrix}$,不难发现$z \leq XAY \leq v$.</p>
<h4><span id="problem2">Problem2</span></h4><p>半径为$R$的球里放点,要求两两之间距离不能小于$1$,证明至多放$( 2 R + 1 )^3$个.</p>
<h5><span id="solution2">Solution2</span></h5><p>要求两两距离不能小于$1$等价于往其中放半径为$0 . 5$的球,这种球体积为$\frac{ 4 }{ 3 } \pi \frac{ 1 }{ 8 }$.然后原球要扩大一圈,所以原球体积变为$\frac{ 4 }{ 3 } \pi ( R + 0 . 5 )^3$.除一下得到答案.</p>
<h4><span id="problem3">Problem3</span></h4><p>一个无限长的数轴上有一辆车,它的初始坐标是个未知的整数$n$.</p>
<p>它每秒以$v$的速度行驶,其中$v$是个未知的整数(可以为负).</p>
<p>现在你每秒能进行一次这样的询问:询问整数$x$,你会得知此时车的坐标是否是$x$(Yes or No).</p>
<p>请给出一个策略,使得在有限的时间里可以获得一次Yes回答.</p>
<h5><span id="solution3">Solution3</span></h5><p>第$t$秒的时候车应该在$n + vt$处.由于我们知道现在是第几秒,枚举$n , v$然后不断check即可.这个是经典的证明$\mathbb{ Z }^2$和$\mathbb{ N }$等势.按照$| n | + | v |$排序然后一个一个遍历.</p>
<h4><span id="problem4">Problem4</span></h4><p>对满足$\forall i , | i - p_i | \leq 1$的排列计数.</p>
<h5><span id="solution4">Solution4</span></h5><p>简单题,设$f_n$为答案,考虑$p_n$取什么.</p>
<p>当$p_n = n$时,方案数为$f_{ n - 1 }$.</p>
<p>当$p_n = n - 1$时,$p_{ n - 1 } = n$,方案数为$f_{ n - 2 }$.</p>
<p>于是,$f_1 = 1 , f_2 = 2$,$f_n = f_{ n - 1 } + f_{ n - 2 }$.</p>
<h4><span id="problem5">Problem5</span></h4><p>你有一个$n \times n$的棋盘.初始所有格子都是白色的.</p>
<p>你可以选择$k$个格子染黑.此后,如果某个格子四联通的两个格子都是黑色,它自己也会变成黑色.</p>
<p>你要让所有格子最终都变黑.试证明:你一开始选择染黑的格子数$k$最小值是$n$.</p>
<h5><span id="solution5">Solution5</span></h5><p>数学归纳了半天,屁用没用.</p>
<p>注意到在扩张过程中,黑色格子的周长不会变大,所以至少是$\frac{ 4 n }{ 4 } = n$个.</p>
<h4><span id="problem6">Problem6</span></h4><p>设$F = \{ S_1 , S_2 , S_3 , . . . , S_{ | F | } \}$,定义一个集合$T$能被$F$ shattered为:$T$的任意一个子集(包括它自己和空集),都可以由$T \cap S_{ i_1 } \cap S_{ i_2 } . . .$表示.其中$S_{ i_j }$是$F$中的集合(就是说每个子集都等于$T$和某些$F$内集合的交.)</p>
<p>定义一个$F$的”VC-Dimension”是,能被他shattered的集合$T$的大小的最大值.</p>
<p>$F$中的集合们只会包含某$n$种不同的元素.证明:</p>
<ol>
<li><p>任意一个$F$能shattered的$T$至少有$| F |$个.</p>
</li>
<li><p>对于一个VC-Dimension的大小为$k$的$F$,其$| F | \leq \sum_{ i = 0 }^k \binom{ n }{ i }$.</p>
</li>
</ol>
<h5><span id="solution6">Solution6</span></h5><p>显然只要证明了(1),那么(2)是显然的.</p>
<p>那么怎么证明(1)呢?考虑数学归纳.先考虑拎出所有的$S$,满足$S , S \cup \{ x \} \in F$,然后将这些$S \cap \{ x \}$拎出来,假设有$t$个,左边删去$x$后再进行数学归纳得到$| F | - t$个集合(由于拎出了所有满足上述条件的集合,不可能删出重复的集合),右边也有$t$个集合,在这$t$个集合添上$x$这个元素即可.</p>
<p>$t = 0$怎么办?我们自己造一组满足条件的就行了.每次加入一个集合:如果这个集合存在一个前面所有的集合都没有的元素,那么显然把这个元素拎出来就行了.又注意到如果一个元素全局都有的话,那么很废物对吧,我们把这个元素删掉继续做.此时不妨设新加入的集合为$S$(选取最大的那个集合为新加入的),我们在前面的集合中找到一个与$S$有交的集合$T$,根据上面的预处理,此集合显然存在.选出一个$x \in S \setminus T$,不妨设$S = S ‘ \cup \{ x \}$,令$T ‘ = S ‘ \cap T$,然后用$T ‘$代替原本的$T$即可.</p>
<h3><span id="2023茶选">2023茶选</span></h3><h4><span id="problem1">Problem1</span></h4><p>令$p ( x )$表示$x$的最大质因子,求所有$( x , y , z )$使得:</p>
<ol>
<li><p>$x &lt; y &lt; z$且$x + z = 2 y$.</p>
</li>
<li><p>$p ( xyz ) \leq 3$.</p>
</li>
</ol>
<h5><span id="solution1">Solution1</span></h5><p>不妨令$g = \gcd ( x , y , z )$,令$x ‘ = \frac{ x }{ g }$,则只需要解:$x ‘ + z ‘ = 2 y ‘$.</p>
<p>我们有$y - x = z - y$,则$\gcd ( y ‘ , x ‘ ) = \gcd ( y ‘ , y ‘ - x ‘ ) = \gcd ( y ‘ , z ‘ ) = 1$,用这个能解决不少讨论.</p>
<p>此时有以下两种情况:</p>
<ol>
<li><p>$2 \nmid x ‘ , 2 \nmid z ‘$.</p>
</li>
<li><p>$2 \mid x ‘ , 2 \mid z ‘ , 2 \nmid y ‘$.</p>
</li>
</ol>
<p>先看(1),设$x ‘ = 3^a , z ‘ = 3^c , y ‘ = 2^b$.方程变为$3^a ( 1 + 3^{ c - a } ) = 2^{ b + 1 }$,一定有$a = 0$,只需解$1 + 3^{ c } = 2^{ b + 1 }$.</p>
<p>当$b \leq 2$的时候,经检验有$\begin{cases}c = 0 \ b = 0\end{cases}$(舍)和$\begin{cases}c = 1 \ b = 1\end{cases}$两组解.</p>
<p>当$b \geq 3$的时候,注意到$3^{ c } \equiv - 1 \pmod{ 4 }$,所以$c$是偶数.又注意到$3^{ c } \equiv - 1 \pmod{ 8 }$,但是奇数的平方$\bmod 8$应该是$1$,不符.</p>
<p>再看(2),设$x ‘ = 2^d , z ‘ = 2^e , y ‘ = 3^b$.</p>
<p>当$e = 1$时,显然不符.</p>
<p>当$d = 1 , e &gt; 1$时,要解$2^{ e - 1 } + 1 = 3^{ b }$.当$e = 2$的时候有一组解$\begin{cases}e = 2 \ b = 1\end{cases}$.当$e \geq 3$的时候,有$3^b \equiv 1 \pmod{ 4 }$,说明$b$是偶数.</p>
<p>那必然有$2^{ e - 1 } = 3^b - 1 = ( 3^{ \frac{ b }{ 2 } } + 1 ) ( 3^{ \frac{ b }{ 2 } } - 1 )$.令$t = 3^{ \frac{ b }{ 2 } } - 1$,则$2^{ e - 1 } = t ( t + 2 )$.则要么$t = 2$,要么$t + 2 = 2$.解出$b - 2$,此时有$\begin{cases}e = 4 \ b = 2\end{cases}$.</p>
<p>综上,解出来的解有$\begin{cases}x ‘ = 2 \ y ‘ = 3 \ z ‘ = 4\end{cases} , \begin{cases}x ‘ = 1 \ y ‘ = 2 \ z ‘ = 3\end{cases} , \begin{cases}x ‘ = 2 \ y ‘ = 9 \ z ‘ = 16\end{cases}$.</p>
<p>但其实有更厉害一点的做法,考虑升幂引理.</p>
<p>先看方程$2^x + 1 = 3^y$,考虑两边$\bmod 3$知道$x$是奇数,于是$v_3 ( 2^x + 1 ) = v_3 ( 3 ) + v_3 ( x ) = y , 3^{ y - 1 } | x , x \geq 3^{ y - 1 }$,用这个放缩一下就行.</p>
<p>再看方程$2^x = 3^y + 1$.仍然考虑两边$\bmod 4$,知道$y$是奇数.$x = v_2 ( 3^y + 1 ) = v_2 ( 3 + 1 ) = 2$,当场下班.</p>
<h4><span id="problem2">Problem2</span></h4><p>给定两个随机分布：</p>
<p>$x ∼ D_1$:从${ 0 , 1 , … , p − 1 }$中等概率随机一个$y$,令$x = y   \bmod  { 2^k }$.</p>
<p>$x ∼ D_1$:从${ 0 , 1 , … , 2^k - 1 }$中等概率随机一个$y$,令$x = y$.</p>
<p>定义二者的统计距离为:$SD ( D_1 , D_2 ) = \frac{ 1 }{ 2 } \sum_{ i = 0 }^{ 2^k - 1 } | P_{ D_1 } ( x = i ) - P_{ D_2 } ( x = i ) |$.</p>
<p>求证:$SD ( D_1 , D_2 ) ≤ \frac{ 2^k }{ 4 p }$.</p>
<h5><span id="solution2">Solution2</span></h5><p>令$w = p \bmod{ 2^k }$.则$SD ( D_1 , D_2 ) = \frac{ w }{ 2 } ( P_{ D_1 } ( x = 0 ) - P_{ D_2 } ( x = 0 ) ) + \frac{ 2^k - w }{ 2 } ( P_{ D_2 } ( x = w ) - P_{ D_1 } ( x = w ) )$.</p>
<p>令$k = \lfloor \frac{ p }{ 2^k } \rfloor = \frac{ p - w }{ 2^k }$不难发现$P_{ D_1 } ( x = 0 ) = \frac{ k + 1 }{ p } , P_{ D_1 } ( x = w ) = \frac{ k }{ p }$.</p>
<p>则$SD ( D_1 , D_2 ) = \frac{ w }{ 2 } ( \frac{ p - w + 2^k }{ p 2^k } - \frac{ 1 }{ 2^k } ) + \frac{ 2^k - w }{ 2 } ( \frac{ 1 }{ 2^k } - \frac{ p - w }{ p 2^k } ) = \frac{ 1 }{ 2^{ k + 1 } } ( \frac{ w ( 2^k - w ) }{ p } + \frac{ w ( 2^k - w ) }{ p } ) = \frac{ w ( 2^k - w ) }{ p 2^k }$.</p>
<p>要证明$\frac{ w ( 2^k - w ) }{ p 2^k } \leq \frac{ 2^k }{ 4 p } \Leftrightarrow w ( 2^k - w ) \leq ( 2^{ k - 1 } )^2$.由基本不等式显然.</p>
<h4><span id="problem3">Problem3</span></h4><p>给你一个单增函数$f$,满足定义域和值域都是$\mathbb{ N }$,并且$f ( f ( n ) ) = 3 n$,求$f ( 2023 )$.</p>
<h5><span id="solution3">Solution3</span></h5><p>首先我们不妨先试一下$f ( f ( 1 ) ) = 3$.由于$f ( 1 ) \geq 2$,且$f ( 1 ) \ne 3$,所以$f ( 1 ) = 2 , f ( 2 ) = 3$.</p>
<p>考虑$f ( 3 n )$,必然存在一个$n &lt; m &lt; 3 n$,使得$f ( n ) = m , f ( m ) = 3 n$.</p>
<p>用这个找前几项,发现规律是把$n$写成三进制形式,如果首位是$1$就变成$2$,首位是$2$就改为$1$再在后面加个$0$.容易验证这是合法的$f$且$f ( 2023 ) = 3882$.</p>
<p>但问题没有解决,需要证明它是唯一的$f$.</p>
<p>考虑数学归纳假设现在$f ( x ) , x \in [ 1 , 3 k ]$都确定了.</p>
<p>注意到如果$f ( n ) = m , f ( m ) = 3 n , f ( 3 n ) = 3 m , f ( 3 m ) = 9 n$.所以如果$f ( n ) = m$,我们实际上有$f ( 3^k m ) = 3^{ k + 1 } n , f ( 3^k n ) = 3^k m$.数学归纳即可以证明$f ( 3 k + 3 )$一定是确定的.</p>
<p>接下来要证明$f ( 3 k + 1 )$和$f ( 3 k + 2 )$一定是确定的.</p>
<p>手玩发现确定它们的方式有两种:</p>
<ol>
<li><p>$f ( 3 k ) + 3 = f ( 3 k + 3 )$.</p>
</li>
<li><p>$\exists n , f ( n ) = 3 k + w ( w \in \{ 1 , 2 \} )$.</p>
</li>
</ol>
<p>如果我们能说明至少可以取二者其一就行.</p>
<p>由归纳假设,不难发现当$k$在三进制下首位如果是$2$,则一定满足(2).</p>
<p>当$k$在三进制下首位是$1$,则一定满足(1).</p>
<p>于是证毕.</p>
<h4><span id="problem4">Problem4</span></h4><p>对于一个$n \times n$的包含$[ 1 , n^2 ]$各一个的矩阵(下称为排列矩阵),定义一次操作为:将每行都任意重排;或将每列都任意重排.求证:</p>
<ol>
<li><p>如果一个排列矩阵满足每行恰有模$n$余$[ 0 , n - 1 ]$的数各一个,则称它是好的.求证:好的矩阵可以通过两次操作变为一个满足第$i$行第$j$列为$( i - 1 ) n + j$的矩阵(不妨称为有序矩阵).</p>
</li>
<li><p>求证:任意排列矩阵可以通过一次操作变为好的.</p>
</li>
</ol>
<h5><span id="solution4">Solution4</span></h5><p>这题原题啊,AGC037D.</p>
<p>(1)显然,注意到有序矩阵的每列$\bmod n$不相同,可以先将每行按照$\bmod n$排序,再每列排序即可.</p>
<p>(2)的话我们考虑一次列操作.将$\bmod n$不同的数字分类,然后建一个二分图:左侧的点是数字分的类,右侧的点代表行,注意到这个东西是$n$正则二分图,根据Hall定理一定存在完美匹配.</p>
<h4><span id="problem5">Problem5</span></h4><p>有$n ( \geq 2 )$个硬币排成一个环.你被蒙上眼睛,你每次操作可以选择一个硬币的子集并将它们翻面.但是你每次操作之后,硬币的位置将会任意旋转(即变为原来的一个循环同构).如果你存在一种策略,使得对于任意初始局面和任意中途的旋转方案,有限步内一定可以令存在一个时刻所有硬币正面朝上,则称$n$是好的.求证:</p>
<ol>
<li><p>$4$是好的.</p>
</li>
<li><p>如果$n$是奇数,那么$n$不是好的.</p>
</li>
<li><p>求出所有好的$n$.</p>
</li>
</ol>
<h5><span id="solution5">Solution5</span></h5><p>首先可以证明$2$是好的.</p>
<p>这么干:如果一开始都正面向上就赢了.不然第一步全翻,这样如果一开始是反面向上也赢了.下一次随便翻一个,再下一次全翻,这样四次中至少赢了一次.</p>
<p>从上面的观察可以发现啊,我们场上一定会进行若干次全局翻转操作,并且最后一次一定是一个全局翻转,不然我们每次只需要让一个位置保持不被翻到就输麻了.</p>
<p>转全局太复杂了,考虑转操作,问题转化为现在你要排若干个操作,使得它们任意旋转后,仍然可以保证前缀异或和取到了所有的情况.注意到不妨让第一轮轮空,此时最少需要$2^n$步.</p>
<p>不妨每进行一次非全局操作就全局翻一次,这样$0$和$1$就没区别了.</p>
<p>先考虑全局异或和为偶数的时候:</p>
<p>注意到$1100$来一个$1010$之后啥也不变,但是$1010$来一个$1010$一定赢了.所以上来先来一个$1010$,如果赢了就下班,没赢就来个$1100$,这样$1100$要么下班,要么变成了$1010$,再重复上面的操作.</p>
<p>如果全局异或和为奇数,那就随便异或一下,再按照偶数的做.</p>
<p>总的来说,先按照偶数的操作,不会改变全局异或和.如果没结束说明是奇数,变一下重复以上操作.</p>
<p>总结一下的话就是操作序列是:$0000 , 1111 , 1010 , 1111 , 1100 , 1111 , 1010 , 1111 , 1000 , 1111 , 1010 , 1111 , 1100 , 1111 , 1010 , 1111$.</p>
<p>上面的构造启发我们手玩一下$n = 3$,注意到此时的问题在于$100$和$110$,都很完蛋.</p>
<p>我们先考虑弱化版问题:就是我们摘下了眼罩,但是选择策略在旋转之前.如果这种情况我们都做不到那蒙上眼更做不到了对吧.</p>
<p>我们不妨将所有的状态分为两类:一类叫做成功状态,即如果一个状态是成功的,那它可以通过有限次操作得到全$0$;另一类叫做失败状态,即只要初值是它,一定有一种旋转的方式使得一直得不到全$0$.</p>
<p>我们来仔细看一下这两个状态应该是啥样的:</p>
<p>对于一个成功状态,应该有一个固定的选择翻面策略,使得它可以在有限次操作内达到另一个更接近全$0$的成功状态.我们不妨令一个成功状态的度为$d$表示它可以经过$d$步到达全$0$,显然全$1$的$d = 1$,$n = 4$的时候,$1010$的$d = 2$,因为其可以通过一次操作转化为全$1$,$1100$的$d = 3$,因为其可以用一次操作转化为$1010$.</p>
<p>仔细思考上面的过程,也就意味着:任何一个成功状态的所有出边,必然要指向$d$比它更小的成功状态.</p>
<p>对于一个失败状态,应该有一个任意的选择旋转策略,使得它怎么翻都还是失败状态.</p>
<p>这个定义还是挺粗糙的,我们先看失败状态吧.</p>
<p>显然$n = 3$的时候,$\{ 110 , 100 \}$就是失败状态.</p>
<p>而对于$n$取任意来说,一定得存在一个$d = 2$的成功状态.一个显然的$d = 2$的成功状态要满足的条件是,假设它是$a$,那么存在一个数$b$,使得$a \oplus b$是全$1$或者全$0$.既然$a$和$b$旋转后只有两种结果,那么$b$的循环节必定为$2$,也就是$b$一定要是$101 \cdots 010$这样的,于是$n$是奇数的时候一定不符合,这就证明了(2).</p>
<p>同理寻找$d = 3$的成功状态,现在我们已知的四种成功状态是$111 \cdots 111$,$000 \cdots 000$,$101 \cdots 010$,$010 \cdots 101$,所以考虑构造一个循环节长度为$4$的串,使得异或完它是这上面四种其一,注意到$1100 \cdots 1100$就是一个合法的串.</p>
<p>做到这里发现上面那个东西完全无法扩展啊.更要命的是我们现在还是睁着眼的,甚至没证明闭着眼是一样的.</p>
<p>找qyc讨论了一下得到了另一个思路的做法:</p>
<p>先证明$n = 2^k$一定是好的.考虑数学归纳,不妨这么干:构造一个长度为$2^{ k - 1 }$的串$b$,使得其$b_i = a_i \oplus a_{ i + 2^{ k - 1 } }$.然后由数学归纳,可以造出$b$全$0$的情况.而如果$b$全$0$,则原串一定存在长为$2^{ k - 1 }$的循环节,并且消除循环节的过程不会改变$b$的值,仍然是数学归纳下去就做完了.</p>
<p>不然,设$n = 2^k m$,</p>
<p>模仿上面的过程,不妨使用数学归纳证明其不成立.仍然是构造$b$数组,由于$b$数组都不可能全$0$,显然也不可能成立.</p>
<p>这个能不能顺便证明$n$是奇数一定不行呢?还真可以.</p>
<p>考虑你现在要卡掉蒙眼的对手的构造,你选出一个位置来备用,剩下了$n - 1$个位置.</p>
<p>接下来无论对手怎么出,你都可以通过乱搞这个备用的位置,来保证前$n - 1$个位置的异或值为$1$.因此对手一定不能完成任务.</p>
<h3><span id="2024茶选">2024茶选</span></h3><h4><span id="problem1">Problem1</span></h4><p>连续扔一枚硬币,连续扔出三个正面则停止.假设硬币扔出正面反面的概率都为$50 \%$,求期望停止时间.</p>
<h5><span id="solution1">Solution1</span></h5><p>简单题,设$f_0 , f_1 , f_2 , f_3$,然后有$\begin{cases}f_3 = 0 \ f_2 = \frac{ 1 }{ 2 } f_3 + \frac{ 1 }{ 2 } f_0 + 1 \ f_1 = \frac{ 1 }{ 2 } f_2 + \frac{ 1 }{ 2 } f_0 + 1 \ f_0 = \frac{ 1 }{ 2 } f_1 + \frac{ 1 }{ 2 } f_0 + 1\end{cases}$,算出$f_0 = 14$.</p>
<h4><span id="problem2">Problem2</span></h4><p>Alice和Bob玩游戏,一共有三轮.每一轮中,Alice选择一个实数,Bob将这个数填到下式中任意一个框中.进行三轮后,如果下式方程有三个不同的整数解则Alice赢,反之Bob赢,求是否有必胜策略.</p>
<script type="math/tex; mode=display">
x^3 + □ x^2 + □ x + □ = 0</script><h5><span id="solution2">Solution2</span></h5><p>纯粹的构造.</p>
<p>简单分析一下,不妨设三个解为$- A , - B , - C$,方程应该可以写作$( x + A ) ( x + B ) ( x + C ) = 0$.</p>
<p>拆开有$x^3 + ( A + B + C ) x^2 + ( AB + AC + BC ) x + ABC = 0$.</p>
<p>这么对称,不妨猜一手Alice先选择$0$,讨论一下:</p>
<ol>
<li>Bob令$ABC = 0$.不妨令$C = 0$.</li>
</ol>
<p>此时方程变为$x^2 + ( A + B ) x + AB = 0$.直接秒了,随便选一个数就行(比如选$3$,如果Bob令$AB = 3$,就再选$4$;如果令$A + B = 3$,就再选$2$)</p>
<ol>
<li>Bob令$A + B + C = 0 , C = - A - B$.</li>
</ol>
<p>不妨令$C ‘ = - C , D = AB$,则$AB + AC + BC = D - C ‘^2 , ABC = DC ‘$.</p>
<p>接下来Alice要选择一个数字$k$,如果Bob又令$D - C ‘^2 = k$,发现在此时如果$k$是一个负的完全平方数,并且Alice接下来选择$0$,当场就下班了.</p>
<p>所以不妨直接让$k = - n^2$,然后看当$DC ‘ = - n^2$的时候如何去解.此时有$AB ( A + B ) = n^2$.不难发现取勾股数就很优秀.</p>
<p>总结一下就是,Alice第二步选择$- 3^2 \times 4^2 \times 5^2$,这样就赢了.</p>
<ol>
<li>Bob令$AB + AC + BC = 0 , C = - \frac{ AB }{ A + B }$.</li>
</ol>
<p>我是构造不出来了.但我可以抄答案,答案是你接下来选择$6^2 \times 7^3$,两种情况如下:</p>
<script type="math/tex; mode=display">
\begin{aligned}
( x + 2 \times 7 ) ( x - 3 \times 7 ) ( x - 6 \times 7 ) & = 0 \\
( x - 2 \times 6^2 \times 7^2 ) ( x + 3 \times 6^2 \times 7^2 ) ( x + 6 \times 6^2 \times 7^2 ) & = 0
\end{aligned}</script><p>后来又找人讨论了一下这个是咋得出来的啊.考虑$ABC \ne 0$,我们有的条件其实是$\frac{ 1 }{ A } + \frac{ 1 }{ B } + \frac{ 1 }{ C } = 0$.方程现在是$x^3 + ( A + B - \frac{ AB }{ A + B } ) x^2 - \frac{ A^2 B^2 }{ A + B } = 0$.不妨令$a = A + B , b = AB$,方程实际上是$x^3 + ( a - \frac{ b }{ a } ) x^2 - \frac{ b^2 }{ a } = 0$.最好能让$a$小一点,因此我们不妨直接取$a = 1$,此时$A = - n , B = n + 1 , C = n ( n + 1 )$,只要能构造这样的两组$A , B , C$使得它们的$a_1 - \frac{ b_1 }{ a_1 } = - \frac{ b_2^2 }{ a_2 }$即可.直接造看上去没啥前途,但是不难发现$A = - nk , B = ( n + 1 ) k , C = n ( n + 1 ) k$依然合法.此时有$k_1 = a_1 , b_1 = - n ( n + 1 ) a_1^2 , k_2 = a_2 , b_2 = - n ( n + 1 ) a_2^2$,我们有$a_1 ( n^2 + n + 1 ) = - n^2 ( n + 1 )^2 a_2^3$.取$n = 2$试试看!此时有$7 a_1 = - 36 a_2^3$.取$a_2 = 7 , a_1 = - 6^2 \times 7^2$,这就是上面那组答案的构造过程.</p>
<h4><span id="problem3">Problem3</span></h4><p>人们之间可能会有讨厌的情况,讨厌关系是相互的.一个人最多讨厌另外$3$个人.现在希望将全部的人分成两组,使得每个人在自己的组内至多只讨厌$1$个人.这是一定可以办到的吗?</p>
<h5><span id="solution3">Solution3</span></h5><p>考虑增广,对于一个不合法的点,它应当连了两个同色点.不妨将这个点反色,那么同色边的数量一定减少,因此一定存在操作终点.而只要当前不合法就一定可以继续操作,因此操作终点一定合法.</p>
<h4><span id="problem4">Problem4</span></h4><p>有公式:</p>
<script type="math/tex; mode=display">
\sum_{ S \subseteq \{ 1 , 2 , \cdots , n \} } ( P ( f ( R ) \oplus \bigoplus_{ i \in S } R_i = 0 ) - P ( f ( R ) \oplus \bigoplus_{ i \in S } R_i = 1 ) )^2 = 1</script><p>其中$f$是任意一个将$\{ 0 , 1 \}^n \rightarrow \{ 0 , 1 \}$的函数,$\oplus$是二进制意义下的异或运算,$R$是$\{ 0 , 1 \}^n$上的均匀分布,$R_i$表示第$i$位.再定义$\chi_S ( r ) = \prod_{ i \in S } ( - 1 )^{ r_i }$.</p>
<p>按照下面的步骤证明上面的式子,也就是说,求证:</p>
<ol>
<li><p>$\chi_S ( r ) \times \chi_S ( r ‘ ) = \chi_S ( r \oplus r ‘ )$.</p>
</li>
<li><p>当$r \ne 0$时,$\sum_{ S \subseteq \{ 1 , \cdots , n \} } \chi_S ( r ) = 0$.</p>
</li>
<li><p>$[ f ( r ) \oplus \bigoplus_{ i \in S } r_i = 0 ] - [ f ( r ) \oplus \bigoplus_{ i \in S } r_i = 1 ] = ( - 1 )^{ f ( r ) } \chi_S ( r )$.</p>
</li>
<li><p>证明原命题.</p>
</li>
</ol>
<h5><span id="solution4">Solution4</span></h5><p>(1)显然.</p>
<p>(2)也很经典,挑选一个$j$,使得$r_j = 1$,然后所有的集合分为两类:一类是包含$j$,一类不包含,两类集合一一对应并且$\chi$互为相反数.</p>
<p>(3)显然.</p>
<p>来看(4),注意到$P ( f ( R ) \oplus \bigoplus_{ i \in S } R_i = 0 ) = \frac{ 1 }{ 2^n } \sum_{ r } [ f ( r ) \oplus \bigoplus_{ i \in S } r_i = 0 ]$,而$\sum_{ r } [ f ( r ) \oplus \bigoplus_{ i \in S } r_i = 0 ] - [ f ( r ) \oplus \bigoplus_{ i \in S } r_i = 1 ] = \sum_r ( - 1 )^{ f ( r ) } \chi_S ( r )$,要证明的只是$\sum_{ S } \frac{ 1 }{ 4^n } ( \sum_r ( - 1 )^{ f ( r ) } \chi_S ( r ) )^2 = 1$,而:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& \sum_{ S } ( \sum_r ( - 1 )^{ f ( r ) } \chi_S ( r ) )^2 \\
= & \sum_S \sum_{ r } \sum_{ r ' } ( - 1 )^{ f ( r ) + f ( r ' ) } \chi_S ( r \oplus r ' ) \\
= & \sum_{ r } \sum_{ r ' } ( - 1 )^{ f ( r ) + f ( r ' ) } \sum_S \chi_S ( r \oplus r ' ) \\
= & \sum_{ r } 2^n = 4^n
\end{aligned}</script><p>于是证毕.</p>
<h4><span id="problem5">Problem5</span></h4><p>Alice在手心上写了两个不同的实数.你可以看其中一只手上的,然后猜哪边的数大.设计一种策略使得不论两个数是什么,猜对的概率都严格大于$50 \%$.</p>
<h5><span id="solution5">Solution5</span></h5><p>我对这个题有亿点小疑问,但是先说策略.</p>
<p>随机(无需均匀)一个数$x$,然后随机一只手,看上面的数字$a$,如果$a \geq x$就认为$a$大,反之认为$b$大.只要随机到一个区间内的实数的概率不为$0$即可.</p>
<p>但是怎么随机实数呢?好像可以按照正态分布随机,我其实也不太懂.</p>
<h4><span id="problem6">Problem6</span></h4><p>使用一些长方形的砖头搭墙.如果每块砖头都有至少一条边的长度是整数,且搭出的墙面是没有缝隙的长方形,求证:这个长方形也至少有一条边长是整数.</p>
<h5><span id="solution6">Solution6</span></h5><p>这个题是经典知乎题,下面搬一下知乎上面整理的这个题的答案:</p>
<p>数论证明:令$p$为素数,把整个图形放大$p$倍(也就是长度$1$变成长度$p$).下面把每个交叉点$( x , y )$换成其整数部分$( \lfloor x \rfloor , \lfloor y \rfloor )$,我们就得到了一个新的大矩形,它被划分为很多两边长均为整数的小矩形,而且每个小矩形有一边长能被$p$整除.这样这个新的大矩形的面积也能被$p$整除,所以它的有一边长能被$p$整除.这条边只是被换成了它长度的整数部分,所以变化不超过$1$,所以在放大之前这条边的长度和某个整数相差不超过$1 / p$.因为素数有无穷多个,所以原来的大矩形某一条边长度与某个整数相差无限小,证毕.</p>
<p>图论证明:令所有的交叉点为顶点.每个小矩形都有一边长为整数,我们把这两条边长为整数的边在图上标出(允许两顶点之间的重复边),另外两条边不连.这样除了大矩形的四个角以外每个顶点有$2$条边或者$4$条边(这是因为这个点,要么是处于一个丁字路口(两条边),要么是十字路口(四条边)),而大矩形四个角每个角只连了一条边.所以从大矩形一角开始存在一条欧拉路径在另一个角结束.因为图上连边的边长都是整数,把这个欧拉路径投影到大矩形的长宽,我们就得到了大矩形至少有一边长为整数.</p>
<p>组合证明:考虑Sperner引理(和染色有关的那个).假设结论不成立.把每个小矩形画上对角线,然后把所有交叉点$( x , y )$染色:如果$x$是整数,染X颜色.如果$x$不是整数但$y$是整数,染Y颜色.如果都不是整数,染Z颜色.由Sperner引理,三顶点被染不同颜色的三角形有奇数个(简单来说就是,你考虑大矩阵的左侧两个点都是X颜色,右侧一个是Y一个是Z,并且在最下面这条边(两个端点分别被染成了X颜色和Y颜色)上面只可能出现X和Y两种颜色,由于这两种颜色交替出现,那么连接不同颜色的边就会有奇数个,同理对于全局来说,三条边上连接不同颜色的边总共奇数个,内部的每一条边会在两个三角形中被各算一次,因此三个顶点染成不同颜色的三角形应该有奇数个),但由题目条件这种三角形不存在(如果一个点被染成了X颜色,那么上面的点如果存在也该被染成了X颜色,Y颜色同理,俩总会矛盾一个),矛盾.</p>
<p>扫描线证明:设大矩形为$[ 0 , a ] \times [ 0 , b ]$,并假设$b$不是整数.把所有小矩形的下边界去掉,然后令$f ( t )$为所有上边界$y$坐标不是整数,并且与直线$y = t$相交的小矩形的$x$方向边长之和.那么$f ( 0 ) = 0$,而且当$f ( t )$变化的时候,它一定会变成另一个整数(原因在于一个小矩阵(假设已加入扫描线)上方的矩阵,如果想要退出扫描线,则必然横向长度是整数.同理对于一个没有加入扫描线的小矩阵上方的矩阵,如果想要加入扫描线,也需要横向长度是整数).所以$f ( b )$是整数.而因为$b$不是整数,$f ( b )$就是最靠上的所有小矩形的宽之和,等于$a$,所以$a$是整数.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" class="post-title-link" itemprop="url">动态规划相关</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/OI/" itemprop="url" rel="index"><span itemprop="name">OI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h2><span id="动态规划的设计">动态规划的设计</span></h2><h3><span id="分析状态">分析状态</span></h3><h5><span id="example1">Example1</span></h5><p>给定一个序列,初始为空,进行多次操作,每次在序列末尾等概率加入一个$[ 1 , m ]$中的数字,然后进行以下判断:</p>
<ol>
<li><p>如果当前序列末尾两个数字相同且小于$t$,假设都是$x$,那就将它们都删去,加入一个$x + 1$.</p>
</li>
<li><p>如果当前序列没有可以删的数字,并且序列长度为$n$,终止操作.</p>
</li>
</ol>
<p>给定$n , m , t$,求最终序列的元素和的期望.</p>
<p>$n , m \leq 10^3 , t \leq 10^9$.</p>
<p>首先$t \leq 10^9$显然是没用的,因为它最多也就能这么凑:$m + n - 2 , m + n - 3 , \cdots , m , m$,合成一个$m + n - 1$,因此我们令$t = \min \{ t , m + n - 1 \}$即可.</p>
<p>然后我们发现一个事实:如果这个序列某一个位置$i$,有$a_i &lt; a_{ i + 1 }$,那么无论后面怎么做,这里的$a_i$都必不可能被删除.以此,我们不妨设$f_{ i , j }$表示序列长度为$i$,序列开头元素为$j$的期望.然后发现中间的枚举巨大麻烦,完全不可以转移.</p>
<p>题解的思维顺序感觉很乱,于是我来<del>马后炮一下</del>重整一下顺序.</p>
<p>首先,我们的限制一共有两种:一个是数的大小不能超过$t$,另一个是序列的长度不能超过$n$.我们不妨设$ans_{ n , t }$表示在上述两种限制下的答案.接下来我们要做的,无非是开始分析转移$ans$需要求出哪些量,这些量又可以如何转移即可.</p>
<p>分析一下$ans_{ n , t }$,考虑枚举一下开头元素是什么,那么第二个位置就不能是这个元素,然后后面再计算贡献,因此我们自然有$ans_{ n , t } = \sum_{ x = 1 }^t E ( n 个 位 置 , 第 一 个 位 置 是 x 并 且 没 有 被 删 去 )$.</p>
<p>然后你就会发现这个问题真正难做的地方:我们这么顺着做,每次把第一个元素抠出去,但是这个元素是会影响后面的操作的!举个栗子:</p>
<p>如果插入的数是:$3 , 3 , 3$,最终的答案应该是$4 , 3$.</p>
<p>但如果我们一开始把第一个位置扣出去,就变成了$3 , [ 3 , 3 ]$,最终的答案就变成了$3 , 4$.也就是说,这里的动态规划问题在转移子问题的时候,需要前面的那个位置作为信息.不妨设$g_{ i , j }$表示当前后面还有$i - 1$个位置,当前前面已经放好了一个$j$,这个$j$不能被删掉的期望,显然有$ans_{ n , t } = \sum_{ x }^t g_{ n , x } P ( 最 终 序 列 中 , 这 里 是 k )$,问题只在于如何求$g$.这个$g_{ n , k }$是钦定了这个位置放$k$的期望,后面我们需要将它乘上这个位置放$k$的概率才能得到真实的答案.这很合理,因为我们通常的一切概率与期望的递推通常都是有一个隐含的条件概率乘法的.</p>
<p>可能第一反应是,这个$g_{ n , k } = ( k + \sum_{ j \ne k } g_{ n - 1 , j } )$.但是实际上这个是不对的.这里的$k$不能删掉不意味着后面的$j$不能删掉,事实上后面的$j$爱怎么删怎么删,只要不搞出一个$k$来就可以.因此我们需要设$f_{ i , j }$表示当前后面还有$i$个位置,第一个位置不能是$j$,也不能曾经是$j$(因为这里只要是$j$都应该与前面合并),剩下的乱选的方案数.这个东西看上去它就不好转移,因为它限制太强了.我们正难则反!设$f_{ i , j }$表示后面还有$i$个位置,第一个位置现在或曾经是过$j$的期望.那么全集是什么呢?全集是$ans_i$.</p>
<p>还没完啊,我们还需要求一下这里是$k$的概率,由于还有一个类似的$f$,我们还要求一下这里曾经是$k$的概率.设前者为$q_{ i , k }$,后者为$p_{ i , k }$.我们来强调一下这里设计的原则:这里的$p$其实还蛮奇怪的,因为它设计的是:只要我当前在队首拿到了$k$,我立刻停止后面的操作.这很好理解,因为后面无论怎么玩,这里都曾出现过$k$了.但是这个理解方式可以帮助我们写出下面的转移方程.</p>
<p>对于前者,我们发现这里是$k$等价于这里是$k$并且后面没有出现过$k$,也就是$q_{ i , k } = p_{ i , k } ( 1 - p_{ i - 1 , k } \times [ k &lt; t ] )$.这里加一个限制是因为有不能超过$t$的限制.</p>
<p>对于后者,这里的$k$有很多种可能出现过,一种是直接加入,一种是合并而来,于是$p_{ i , k } = \frac{ 1 }{ m } [ k \leq m ] + p_{ i , k - 1 } p_{ i - 1 , k - 1 }$.</p>
<p>因此我们几经辗转,终于得到了$g$的转移式子:</p>
<script type="math/tex; mode=display">
q_{ i , k } g_{ n , k } = p_{ i , k } ( k + ans_{ i - 1 } - f_{ i - 1 , k } p_{ i - 1 , k } )</script><p>就差$f$了.$f$有两种可能:要么最后仍然是$k$,要么这个$k$已经被杀掉了.于是:</p>
<script type="math/tex; mode=display">
p_{ i , k } f_{ i , k } = q_{ i , k } g_{ i , k } + ( p_{ i , k } - q_{ i , k } ) f_{ i , k + 1 }</script><h5><span id="example2cf1007e">Example2(CF1007E)</span></h5><p>首先我们需要发现一个很强的性质:作用到了第$i$个站台就会清空前面所有站台.清空后就和$a_i$无关了,而如果还没涉及到一定和$a_i$有关,那么涉及到了一半怎么办呢?我们考虑这里涉及到了一半,那么前面一定被清空了,我们根据前面的清空情况现场计算这里的答案.</p>
<p>这启发我们:我们可以对这个做文章,我们设$f_{ i , j }$表示只考虑前$i$个站台,要撑$j$个单位时间需要的最少火车数量.$g_{ i , j }$表示只考虑前$i$个站台,要撑$j$个单位时间,并且$[ 1 , i - 1 ]$全部清空需要的最少火车数.另外,这两个dp数组都要求不能有火车漏到后面,也就是火车不能坐上后面的人,不然设为$+ \infty$表示无法满足(对于全局,我们在$n + 1$处放一个$a = + \infty , b = 0 , c = + \infty$来保证一定会满载).为什么需要$g$作为辅助dp数组呢?我们先对着$f$分析.</p>
<p>考虑$f_{ i , j }$的转移,根据上面的分析,我们有两种可能:</p>
<p>第一种,前$j$轮中根本没接走站台$i$的人.此时需要满足$f_{ i - 1 , j } \ne + \infty \land a_i + j \times b_i \leq c_i$.那么这里怎么更新$g$呢?设$L = sa_{ i - 1 } + sb_{ i - 1 } \times j$,显然$g_{ i , j } = \lceil \frac{ L }{ K } \rceil$,并且需要保证此时没有用到$i$以后的站台,因此需要保证$\lceil \frac{ L }{ K } \rceil K \leq sa_{ i } + sb_i \times j$.注意到由于这里保证了$f_{ i - 1 , j }$是可以取到的,因此我们可以撑到第$j$秒,剩下的火车在$j + \varepsilon$秒全选.</p>
<p>第二种,前$j$轮中有火车接走站台$i$的人.设最后一次是在$r$时间接走的站台$i$,那么此时必然清空了$[ 1 , i - 1 ]$,这里用了$g_{ i , r }$.然后为了防止这里在$[ r + 1 , j ]$这段时间中爆掉,因此还需要$w = \lceil \frac{ \max \{ 0 , rem + ( j - r ) b_i - c_i \} }{ K } \rceil$,其中$rem$是$r$时刻$i$剩下的人数.这些火车都要在$r$时刻之前解决(因为我们设了最后一次在$r$时间接走),不难发现我们其实不在乎前面具体怎么解决的,而只要在$r$这里保证没出问题就行.另外还要保证这个过程没有走到后面,也就有$wK \leq rem$.但是,接下来在$[ r + 1 , j ]$时刻就只需要对前面做操作,不过和一开始不一样的是,此时被清空了,因此我们设$f_{ i , j , 0 }$表示只考虑前$i$个站台,要撑$j$个单位时间需要的最少火车数量,但是$[ 1 , i ]$都被清空为$0$过.</p>
<p>每一步看上去都很合理,但是如何想到可以这么dp的呢?说到底,dp是解决一个最优子问题的,我们发现我们知道时间,以及前面是否清空,就可以得知目前的状态.另外,由于我们是枚举目前的状态,因此中间的转移过程是易知的.</p>
<p>这个题的启发性大概有以下几点:</p>
<ol>
<li><p>设计状态的时候,只考虑记录经过的时间/前面的初始值/目前考虑到第几位,由上面三点可以还原出所有状态.</p>
</li>
<li><p>由于我们确定了当前考虑到了第几位,我们就可以进行递推:原因很简单,只要我们考虑到某一位,就一定会影响前面所有的位置(全部清空以至于到达这里).一开始我犯了一个错是将$g_{ 1 , t , 0 / 1 }$全部设为$0$,因为我觉得无论如何$0$位置都是清空的,但实际上这是错误的!因为在$t$时刻的$1$位置不一定合法.这就是这个设计巧妙的地方:它时刻保证了前$i$个的合法性,并且如果我们想要让$i$位置合法,一定要求让$[ 1 , i - 1 ]$合法.</p>
</li>
<li><p>转移的时候,由于钦定了某一时刻是否选,因此我们可以直接算出从$r \rightarrow t$这个过程中会积累的量,这些量必然要在$r$时刻清理掉.由于钦定导致限制加强,因此这里就容易处理了.</p>
</li>
</ol>
<h3><span id="可删除dp">可删除dp</span></h3><h5><span id="example1">Example1</span></h5><p>定义一个有根树为大菊花,当且仅当这棵树的根的度数$\leq m \land \nexists x \ne root , \deg ( x ) &gt; 2$.对于每一条边,求将这条边连接的两个点合并后,以新点为根的大菊花数量.$( n \leq 5 \times 10^5 , m \leq 50 )$</p>
<p>注意到以一个点为根的大菊花数量是一个关于树的大小的背包合并.这样通过前缀后缀做到$O ( nm^2 )$.</p>
<p>注意到这个背包是可删除的,所以就能做到$O ( nm )$.</p>
<h3><span id="dp分界点">dp分界点</span></h3><h4><span id="example12022zrtg十连测day7-permutation">Example1(2022zrtg十连测day7 Permutation)</span></h4><p>首先注意到$[ 3 , n ]$一定会被分成两段递减的序列,分别跟在$1$和$2$的后面,假设$1$在$2$前面,这样算出答案后乘以$n$即可.</p>
<p>注意到$i + 1$一定可以放到$i$的前面,设$f_i$表示在$i$和$i + 1$之间有分界点,这两个点后面分界合法的方案数.每次可以枚举下一个合法的分界点,不难发现这个分界点也即$i$的倍数$\pm 1$之类的,于是可以实现,复杂度$O ( n \ln n )$.</p>
<h3><span id="基于贪心的dp">基于贪心的dp</span></h3><h4><span id="example1cf1666e">Example1(CF1666E)</span></h4><p>先想一下别的东西怎么求.</p>
<p>如果我们要求最大值最小或者最小值最大怎么办?我们可以二分后贪心,而显然它们的差就是一个答案的下界,问题在于这个下界是否可以取到.</p>
<p>我们冷静一下,发现在可能的方案中,第$i$条线段的右端点的位置一定是一段连续的区间.</p>
<p>设$f_i$表示第$i$个分界点可能的最小值,$g_i$表示第$i$个分界点可能的最大值.假设我们目前二分的最大值要小于等于$mx$,最小值要大于等于$mn$,那么我们有转移:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i + 1 } & = \max \{ a_{ i + 1 } , f_i + mn \} \\
g_{ i + 1 } & = \min \{ a_{ i + 2 } , g_i + mx \} \\

\end{aligned}</script><p>注意到$f$与$g$的转移是无关的,而显然对于第$i$个分界点,它可以取$[ f_i , g_i ]$中一个数,一定存在一个取法使得答案能取到下界.</p>
<p>为啥呢?只需让$ans_{ i }$表示第$i$条分界线是啥,那么我们$ans_i$是可以取$[ ans_{ i + 1 } - mx , ans_{ i + 1 } - mn ]$中的任何一个数字的,我们将其和上面求出的$[ f_i , g_i ]$求一下交集.如果交集为空,说明要么$ans_{ i + 1 } - mn &lt; f_i , f_{ i + 1 } &lt; ans_{ i + 1 } &lt; f_i + mn$,这是不可能的.另一种情况同理不可能,这就保证了一定可以取到答案.一定能使极差$\leq mx - mn$.</p>
<h3><span id="数位dp">数位dp</span></h3><h4><span id="example12022qbxt国庆day3string">Example1([2022qbxt国庆Day3]string)</span></h4><p>首先设$f_{ i , j }$表示长度为$i$的,以$S [ n - j + 1 . . . n ]$为子序列的字符串个数.</p>
<p>考虑按位处理,每次将$T$的一个后缀设为极大,然后不断地向前扩展这个后缀的长度,直到所到的位置再改为极大就会超出$k$.这个时候我们停止更改,并且继续倒着修改,仍然修改每位,直到最后所积累的总数恰好为$k$.</p>
<p>当然,做的时候一定要时刻铭记后面的部分设为的是极大字符串还是极小字符串,这里设为极大是简单的,因为可以直接继承上一位的枚举.</p>
<p>考虑这个过程,我们每将一个位置的值设为更大,相当于松弛了后面的所有序列,因此也就是一个数位dp.</p>
<h4><span id="example2cf1194g">Example2([CF1194G])</span></h4><p>第一反应就是枚举$x ‘$和$y ‘$,然后用数位dp枚举$d$使得$x = dx ‘ , y = dy ‘$.</p>
<p>但是有一个问题在于如果$\gcd ( x ‘ , y ‘ ) \ne 1$怎么办,这样有可能会算重.我们发现我们只判断$\gcd ( x ‘ , y ‘ ) = 1$的情况就行,然后写一个$2^8$判断$x ‘ , 2 x ‘ , 3 x ‘ , 4 x ‘$以及对应的$y ‘$出现了没有.复杂度$( 9^4 \times 2^8 \times \log_{ 10 } n )$,有点难过.</p>
<p>但是我们发现这个$2^8$可能大了点,注意到只要出现一个我们就不用再记了,因此唯一需要记的是一对都没出现过的情况,这里只有$3^4 \times 2$的状态量,就可以快一点.</p>
<h3><span id="树形dp">树形dp</span></h3><h4><span id="example1jloi2016侦察守卫">Example1([JLoi2016]侦察守卫)</span></h4><p>首先第一反应是记录子树内到子树根节点的最远的未被覆盖的点和最近的监测站,但是这样是$O ( nd^2 )$的复杂度.冷静一下,发现这两个一定只会有一个值有意义,这样就是$O ( nd )$的了.</p>
<p>写的时候犯了个很蠢的错:树形dp由于需要合并,所以如果有多步转移,一定要先把所有dp值都会进行的dp转移写成赋值转移,把其它的写成取$\min$转移.</p>
<h3><span id="轮廓线dp插头dp">轮廓线dp(插头dp)</span></h3><h4><span id="example1">Example1</span></h4><p>现在有一个$[ 1 , n ]$的排列,现在要从中选出一个集合$S$,满足$\forall x \in S , 2 x \notin S , 3 x \notin S$,求方案数.</p>
<p>首先考虑将每个数分解为$a \times 2^b \times 3^c$的形式,显然$a$不相同的数之间互不干扰.</p>
<p>对于$a$相同的一群数,我们考虑将$( b , c )$作为它在矩阵上的位置,不难发现上面的要求其实也就是选一个数就不能选它右边的数和下边的数,可以使用轮廓线dp转移.</p>
<h3><span id="高斯消元处理后效性">高斯消元处理后效性</span></h3><h4><span id="example1">Example1</span></h4><p>$n$个点的树,一开始位于一号点,每个点有一个颜色($0$或$1$),每次随机选择一个点$v$,从当前所在点移动到$v$并将$v$的颜色取反(不是将这条路径上的颜色取反),当整棵树颜色相同时停止,求期望移动距离(每条边的长度为$1$,当然不为$1$也能做).</p>
<p>$n \leq 100000$.</p>
<p>首先我们发现这个树形结构很难搞,怎么办呢?</p>
<p>我会弱化问题!先考虑期望进行多少轮.</p>
<p>不难发现这个问题下,这个树没有任何意义,我们只需要看当前选中的点是$1$还是$0$就可以.不妨设$f_{ i }$表示当前有$i$个点是$1$,最后全$1$或者全$0$所需要的期望步数,显然$f_0 = f_n = 0$,$f_{ i } = \frac{ 1 }{ 2 } ( f_{ i + 1 } + f_{ i - 1 } ) + 1$.欸,这不luoguP7099嘛.看来这个思路很对啊!</p>
<p>但是其实寄了,这个东西怎么想都很难拓展.一开始还想过计算每条边对期望的贡献,但也很难搞.</p>
<p>正确的做法是什么呢?正确的做法是我们统计每个点的贡献!你可能会很好奇这个点能有什么贡献,事实上,假设我们当前在$u$,只要当前没有结束,我们还要选点$v$,对答案的期望的贡献就是$u$到这棵树上所有点的距离之和除以$n$,而这是一个定值.也就是说,只要我们统计一下到了每个点$u$多少次(要求不是最后一次),我们就可以全部加一加乘一乘得到答案.我们脱离了树的结构!</p>
<p>我们设$f_{ i , j , 0 / 1 }$表示当前场面上有$i$个$1$,$j$号点这里是$0$还是$1$,它在结束前能被期望选多少次,注意$f_{ n / 0 , j , 0 / 1 } = 0$.但是这个转移显然有点垃圾,我们再冷静一下:似乎我们不在乎每个点具体编号,只在乎它当前的颜色,于是我们可以设$f_{ i , 0 / 1 }$表示当前有$i$个$1$,$0 / 1$染色的点在接下来的操作中期望选择多少次.</p>
<p>我们可以写出以下转移:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ 0 / n , 0 / 1 } & = 0 \\
f_{ i , 0 } & = \frac{ i }{ n } f_{ i - 1 , 0 } + \frac{ n - i - 1 }{ n } f_{ i + 1 , 0 } + \frac{ 1 }{ n } ( f_{ i + 1 , 1 } + [ i + 1 \ne n ] ) \\
f_{ i , 1 } & = \frac{ i - 1 }{ n } f_{ i - 1 , 1 } + \frac{ n - i }{ n } f_{ i + 1 , 1 } + \frac{ 1 }{ n } ( f_{ i - 1 , 0 } + [ i - 1 \ne 0 ] )
\end{aligned}</script><p>为啥最后加上了$[ i + 1 \ne n ]$呢?因为我们统计的是在没结束的情况下的答案.</p>
<p>乍一看这个转移成环并且极其复杂,可能需要高斯消元,但实际上不用,我们冷静观察一下:</p>
<p>我们假设我们已经求出了$f_{ i , 0 / 1 }$和$f_{ i - 1 , 0 / 1 }$,我们发现我们可以用这两个方程求出$f_{ i + 1 , 0 / 1 }$,然后就比较典了:我们将所有的函数表示成$af_{ 1 , 0 } + bf_{ 1 , 1 } + c$的形式(之所以这么表示,是因为我们架设了$f_{ 1 , 0 / 1 }$已经求出来了,虽然实际上没求出来),而由于我们有右边界,我们可以用它表示出$f_{ n , 0 / 1 }$,而$f_{ n , 0 / 1 }$我们已知,这样就可以解一个二元一次方程组.</p>
<h3><span id="最短路处理后效性">最短路处理后效性</span></h3><h4><span id="example12022qbxt国庆day2operation">Example1([2022qbxt国庆Day2]operation)</span></h4><p>首先注意到,$a_i = 1$的时候和$a_i \ne 1$的时候其实没有太大区别,我们在操作完后也需要用各种方式抵消影响.我们设$f_i$为$a_i = 1$,而其他$a$全都为$0$时的答案,不难发现最后的答案也就是$\sum{ a_i f_i }$.</p>
<p>而上面的转移自然是:$f_i = \min \{ b_i , w + \sum_{ j = l }^r f_j \}$.</p>
<p>但是,这个转移是有后效性的,不能直接进行dp,不过我们考虑用类似最短路的操作来处理.</p>
<p>换句话说,由于每次$f_i$最小的点不可能再被更新到,我们就把它设为已更新的点.当一个区间中的所有点都被标记为已更新后,我们就拿这个区间去更新别的点.</p>
<p>我们把每个线段挂到线段树上的节点,当我们把一个点标记为已更新,也就是检查这个点对应的线段树上叶子节点到根的路径上所有的线段树节点对应的区间是否全更新.均摊下来,一个区间只会被检查$\log n$次,这样就做完了.</p>
<h3><span id="组合意义">组合意义</span></h3><h5><span id="example1noi2009-管道取珠">Example1([NOI2009] 管道取珠)</span></h5><p>考虑组合意义,$\sum a_i^2$的意义也即满足操作序列$u$和操作序列$v$的最终结果相同的二元组$( u , v )$的数量.</p>
<p>不妨设$dp_{ i , j , k }$为第一个装置上方已经动了$i$个珠子,下放动了$j$个珠子,第二个装置上方动了$k$个珠子,下方动了$i + j - k$个珠子,并且两个装置截至目前的操作序列完全一样的方案数.显然$dp_{ n , m , n }$即答案.</p>
<h5><span id="example2">Example2</span></h5><p>求长度为$n$的排列的$( \sum_{ i = 2 }^{ n - 1 } [ a_i &lt; a_{ i - 1 } \And a_i &lt; a_{ i + 1 } ] )^k$的期望$( n \leq 10^9 , k \leq 500 )$.</p>
<p>$O ( n^2 k^2 )$是显然的,枚举最小值在哪就行.</p>
<p>注意到我们要求的是$\sum ans^k$,而加入$1$的时候,对于每个长度为$n - 1$的排列,有$( n - 2 - 2 ans )$个位置加入后会使答案加一,那我们要求的也就是:</p>
<script type="math/tex; mode=display">
\sum ( n - 1 - 2 ans ) ( ans + 1 )^k + \sum ( 2 ans + 2 ) ans^k</script><p>推一推式子就可以做到$O ( nk^2 )$,然后上拉格朗日插值就做完了.</p>
<p>等一下,这是noip模拟赛啊,哪来的拉格朗日插值?</p>
<p>注意到我们可以考虑组合意义,$ans^k$等价于从所有的地方中可重复地选出$k$个位置,如果随便选肯定可以钦定,问题在于可能会选出两个间隔为$1$的位置,这就比较麻烦了.所以我们不妨直接把所有被选中的位置求出来,能合并成一段波动序列的合并.这样,我们设$f_{ i , j }$表示已经选了$i$段波动序列,其中有$j$个谷的方案数.最后这些谷每个至少被选中一次,做一个辅助数组维护波动序列的数量即可,复杂度$O ( k^3 )$.</p>
<h3><span id="二项式定理展开">二项式定理展开</span></h3><h4><span id="example1">Example1</span></h4><p>求$\sum_{ i = 1 }^n \sum_{ j = 1 }^n ( a_i \oplus a_j )^2$,$n \leq 10^5$,$a_i \leq 10^9$.</p>
<p>考虑设$f_i$表示只考虑前$i$低的位置,高位全部默认为$0$的方案数.如果我们设$cnt_i$表示$a$中第$i$位为$1$的数个数,那根据$( a + b )^2 = a^2 + 2 ab + b^2$,我们只需要求出$g_{ i }$表示只考虑前$i$低的位置,第$i + 1$位是$1$的数和第$i + 1$位是$0$的数两两异或之和,显然有$f_i = f_{ i - 1 } + 2 cnt_i \times 2^i \times g_{ i - 1 } + cnt_i 2^{ i + 1 }$.</p>
<p>$g$可以用$O ( n \log a )$的复杂度求,这样总复杂度$O ( n \log^2 a )$.</p>
<h3><span id="线头dp">线头dp</span></h3><h5><span id="example120zr普及组五连测day1区间">Example1([20zr普及组五连测day1]区间)</span></h5><p>令$dp_{ i , j , k }$表示目前倒到第$i$个水杯,前面还有$j$个延续过来的未结束的线头,目前已经选定了$k$个人,转移的话需要枚举当前有几个人在此开始以及有多少人在此结束,这样是$O ( n^5 )$的复杂度,不太能接受.但不妨考虑先将有几个人在此开始以及前面的继承处理到目前的数组中,然后再选择若干个人结束,这样分开了两个过程,于是实现了$O ( n^4 )$的复杂度.</p>
<h5><span id="example22022qbxt国庆day6rps">Example2([2022qbxt国庆Day6]rps)</span></h5><p>首先三次询问的做法没区别,我们只考虑r的情况.</p>
<p>注意到我们肯定是想拿s去把p杀掉,不然p就会把r杀掉.考虑一个线头dp,设$dp_{ i , 0 / 1 / 2 }$表示前$i$个数,0:无接头;1:有接头无线头;2:有线头的情况.这样一个线头每延申就会使答案减少,而如果我们把一个?改为s也会使答案减少,大概做一做.</p>
<h5><span id="example3coci2020-20212-svjetlo">Example3([COCI2020-2021#2] Svjetlo)</span></h5><p>首先发现,我们得到的序列不可能首尾相同,不然我们可以同时去掉开头和结尾.</p>
<p>然后发现,如果一棵子树内的点全部被点亮,这棵子树可以直接删去.这一步是必须做的,不然会多一步讨论.</p>
<p>我们设$dp_{ u , 0 / 1 , 1 / 2 }$为$u$的状态为$0 / 1$,以$u$为根的子树内有$1 / 2$个线头的方案数.注意如果子树内有$0 / 2$个线头,那么会在$u$处存在两个接头;不然则会只存在一个接头.</p>
<p>通过不断将下方的点合并到当前子树的根节点上,我们可以完成整个过程.</p>
<p>注意到两个接头如果在相邻的两个节点就可以自动接起来,因此$dp_{ u , s , 2 }$的两个接头实际上一个位于$u$,另一个位于$u$的随便一个儿子.</p>
<p>换句话说,做线头dp的时候一定要注意,线头的相接是自然的过程(即两个线头相邻就会相接)还是需要手动接起来的过程.</p>
<h5><span id="example4cf626f">Example4(CF626F)</span></h5><p>先按照权值排序,一个人可以选择新建一个组,加入一个组,加入一个组并删除这个组</p>
<p>设$dp_{ i , j , k }$表示目前走到$i$,前面分成$j$组,总贡献不超过$k$的方案数.做的过程中是一个线头dp,每次每组的贡献都要加上当前位置和前面位置的差值.</p>
<h5><span id="example5xvii-open-cup-named-after-ev-pankratiev-grand-prix-of-japanopenstrain-contest-1489-jtravel-in-sugar-country">Example5([XVII Open Cup named after E.V. Pankratiev. Grand Prix of Japan(openstrain contest 1489) J]Travel in Sugar Country)</span></h5><p>一条线段上有$n ( \leq 100 )$个商店,要从中选出$k ( \leq 10 )$个不同的商店$s_1 , s_2 , \cdots , s_k$,使得按顺序遍历这$k$个商店的路径长度是$m ( \leq 30 )$的倍数,求方案数.</p>
<p>这种来回走的也是一种线头dp的形式.</p>
<p>我们设$dp_{ i , j , w , l }$表示目前在判断了$i$个商店,选了$j$个,并且目前整个图有$w$条”路径”(连续走动),走过的路在$\bmod m$一意义下为$l$的方案数.最后的答案就是$dp_{ n , k , 1 , 0 }$.</p>
<p>首先,我们对每个点求出$D ( 1 , x )$,然后$D ( x , y ) = | D ( 1 , y ) - D ( 1 , x ) |$,不难发现$x$越大$D ( 1 , x )$越大(不考虑取膜的问题),因此如果我们按照从左到右的顺序逐渐往里加入,那么我们就需要讨论这个新加入的点它的左右点的$D$和它的大小关系,也就是它左右点的加入时间,这显然可以使用线头dp实现.</p>
<p>我们先枚举一下起点和终点并将它们扔到图上,这样初始图上有一条路径($s_1 \rightarrow s_1$),接下来,我们每插入一个点$x$,我们考虑它的贡献:</p>
<ol>
<li><p>新建一条路径,此时这个点的左右端点必然都是在他后面加入,它对总长度的贡献是$- 2 D ( 1 , x )$,对方案数的贡献为$1$.</p>
</li>
<li><p>插入到原来一条路径的开头/结尾.此时这个点有一个端点是比它早的,有一个会比它晚,对总长度的贡献为$0$.</p>
</li>
<li><p>作为中心点合并两条路径,此时对总长度的贡献为$2 D ( 1 , x )$.</p>
</li>
</ol>
<p>这样我们就做到了$O ( n^4 km )$的复杂度.如果我们加两维$0 / 1$表示目前起点和终点是否加入,就可以把复杂度优化到$O ( n^2 km )$.</p>
<h3><span id="相对顺序不变">相对顺序不变</span></h3><p>如果遇到一些会不断改变当前状态的题目,有时可以考虑改变前后的一些元素的相对顺序是否改变.以及如果有两个物体相遇后交换位置的题目,如果物体本质相同,同样可以考虑直接穿过而不是交换.</p>
<h4><span id="example1bzoj4621tc605">Example1([bzoj4621]Tc605)</span></h4><p>注意到最终的序列一定是由若干个数字段组成,而数字段的顺序也即原本序列的顺序,于是此题显然.</p>
<h3><span id="拆分区间">拆分区间</span></h3><p>有的时候,注意到一个区间可以通过某些方式拆分成两个区间(断点可能是需要枚举的,也可能是固定的),从而可以递归处理/区间dp.</p>
<h4><span id="example122zr提高组十连测day4零二">Example1([22zr提高组十连测day4]零二)</span></h4><p>先考虑数字两两不同的时候怎么做,我们先找到$A$中的全局最大值所在位置和$B$中的全局最大值所在的位置.由于从堆中取出全局最大值后,堆一定成为了空堆.因此我们注意到此时$A$取出的数量和$B$的长度一定是相等的.</p>
<p>进一步考虑,这意味着一个全局最大值将把$B$序列分成两部分,这两部分将由$A$中相等的两部分分别生成.不妨假设这个全局最大值的位置是$x$,那么对于$[ 1 , x ]$这一段的$A$生成的$B$数组,它的最大值一定在末尾位置,而前面任意,显然它的数量等价于直接删掉最大值后的$A$能生成的$B$的数量.对于$[ 1 , x + 1 ]$则任意.</p>
<p>那么我们所需要做的就是求出$A$的某一段删掉若干次最大值后的序列所能生成的$B$的数量.不妨设$dp_{ l , r , i }$表示$[ l , r ]$中所有$\leq i$的数字组成的序列所能生成的数量.</p>
<p>如果$[ l , r ]$这段区间中没有数字$i$,那显然$dp_{ l , r , i } = dp_{ l , r , i - 1 }$,不然,我们可以枚举两端分开的位置,那这个位置一定在数字$i$的后面.于是可以转移.</p>
<p>至于可能出现相同数字的情况,我们只需要把每个数字的下标作为第二关键字即可,容易发现这样做之后转化为了两两不同的情况.</p>
<h4><span id="example2sdoi2010地精部落">Example2([SDOI2010]地精部落)</span></h4><p>注意到第$n$个元素一定是山峰.所以我们考虑用第$n$个元素分割整个区间为两部分.</p>
<p>设$f_n$为$n$个元素且开头为山谷的答案.枚举第$n$个元素在位置$k$($k - 1$是奇数),则$f_k f_{ n - 1 - k } \binom{ n - 1 }{ k } \rightarrow f_n$.</p>
<h4><span id="example3">Example3</span></h4><p>给定数组$a$,每次可以选择一个数删掉并把两边的数接起来,要求操作过程中不能出现相邻的数相同,求方案数.$n \leq 500$.</p>
<p>考虑枚举最后选的点,那么这个点左右一定互不相干.我们假设$f_{ l , r }$为将$[ l , r ]$删干净后再去删$a_{ l - 1 } , a_{ r + 1 }$的方案数,然后枚举$[ l , r ]$中最后删哪个点即可做区间dp.</p>
<h4><span id="example4agc039e-pairing-points">Example4([AGC039E] Pairing Points)</span></h4><p>注意到这么一个事实:如果场上已经有了一个叉,那么接下来的边不能再穿过这个叉了.</p>
<p>首先需要破环为链,考虑从$1$号点这里断开,枚举$1$号点连接哪个点,然后就可以让$( 2 , 2 n )$这些点断开了.我们设计$f_{ i , j , k }$或$[ i , j ] ( k )$表示区间$[ i , j ]$中的$k$向外连了一条边.答案是枚举$1$号点连了哪个点,也就是$\sum_{ i = 3 }^{ 2 n - 1 } f_{ 2 , 2 n , i }$.</p>
<p>于是我们现在的问题在于如何求$f_{ i , j , k }$.由于边要联通,所以与$k$相连的这条边必然被$[ i , j ]$中的某两个点所连接的边穿过.我们考虑枚举最靠外的那条边,假设为$x \leftrightarrow y$.这样整个区间被分为了两个部分:$[ i , k ] ( x ) , [ k , j ] ( y )$.但是问题并没有得到解决.因为$[ i , x ]$和$[ y , j ]$之间的确不可能出现连边了,但$[ x , k ]$和$[ k , y ]$之间仍然可能出现连边.但我们发现:在$[ i , k ]$中一定存在一个分界线,使得分界线两侧是连到不同的两边的.</p>
<p>我们不妨再枚举一下这两个分界线,分别设为$p , q$.现在整个区间被分为了三个部分:$[ i , p ] ( x ) , [ p , q ] ( k ) , [ q , j ] ( y )$,三个部分之间并没有连边,于是成功将区间拆分.</p>
<p>这个故事告诉我们:拆分区间的很重要的条件是:将一个区间拆分为若干相互无联系的区间,而我们的重点就是找到一种方式使得区间间相互无联系.</p>
<h4><span id="example5agc035d-add-and-remove">Example5([AGC035D] Add and Remove)</span></h4><p>首先自然想到区间dp.但是难以处理的是如果一个区间$[ l , r ]$中间删掉一个点$p$之后,$[ l , p - 1 ]$和$[ p + 1 , r ]$会拼起来,仍然会相互影响.</p>
<p>换一种方式,我们找到$[ l + 1 , r - 1 ]$中最后删除的点$p$,这样区间$[ l , r ]$的答案就是最终三个数的答案.这么枚举的好处是,我们发现删除$[ l + 1 , p - 1 ]$的时候,对$p$产生的贡献和删除$[ p + 1 , r - 1 ]$的时候对$p$的贡献是完全独立的,他俩可以分开.</p>
<p>再看每个位置的贡献,我们考虑计算出这个位置会对答案贡献多少倍,不妨假设$a_l$贡献了$x$倍,$a_r$贡献了$y$倍,那么由于$a_p$会两边都贡献到,所以$a_p$会对答案贡献$x + y$倍.</p>
<p>于是设计一个dp是:$f_{ l , r , x , y }$表示删除$[ l + 1 , r - 1 ]$后,$xa_l + ya_r$最小是多少.自然有$f_{ l , r , x , y } = \min \{ f_{ l , p , x , x + y } + f_{ p , r , x + y , y } + ( x + y ) a_p \}$.</p>
<p>至于复杂度,前两维肯定是$n^2$的空间复杂度,而后两维则意味着每次向下会由两个转移而来,最多转移$n$层,因此是$2^n$的空间,于是时间复杂度不会超过$O ( n^3 2^n )$,其实经过一些奇怪计算应该是不会超过$O ( 2^n )$的.</p>
<h4><span id="example6cf607bzuma">Example6([CF607B]Zuma)</span></h4><p>这个题的关键在于拆分区间,因此一定要判断哪个点是最后删除的.</p>
<p>我们不妨设$f_{ l , r }$表示删除$[ l , r ]$区间的代价.接下来我们无非要枚举$k$,使得$k$是最后删的.但发现这很难处理.</p>
<p>所以我们怎么办呢?我们考虑判断边界是如何删掉的.比如$l$,它要么是自己被删,要么一定是找到一个和它一样的点,这两个点一起删.我们注意到如果$a_l = a_k$,那么这等价于$f_{ l + 1 , k - 1 } + [ l = k - 1 ] + f_{ k + 1 , r }$.因此可以做区间dp了.</p>
<h4><span id="example7loj-3215">Example7(LOJ 3215)</span></h4><p>首先考虑一下$m = 2^k - 1$的情况,首先我们要判断有几个数最高位是$1$,然后接下来判断第二位哪些数字是$1$.</p>
<p>我们发现这类似一个拆分区间的过程,因为当我们决定了最高位之后,最高位是$1$的就一定大于最高位是$0$的了,这两个区间就没有影响了.因此可以设$f_{ l , r , k }$表示$[ l , r ]$这个区间,前面已经有了$k$个$1$的最大贡献.</p>
<p>那么对于$m \ne 2^k - 1$的情况我们怎么办呢?我们只需要类似数位dp那样在状态里加一个lim防止超过$m$就行了.</p>
<h3><span id="相互独立">相互独立</span></h3><h5><span id="example12019zrtg十连测day1-origami">Example1(2019zrtg十连测day1 origami)</span></h5><p>看上去很不好做,先考虑宽为$1$怎么做.</p>
<p>这个时候放在最下面的显然是一段区间,不难发现有一个暴力做法是,我们枚举这段区间$[ l , r ]$,然后看$[ 1 , l - 1 ]$和$[ r + 1 , m ]$能不能折进来.也就是判断以$r$和$r + 1$为中心的回文串最大长度以及在这个范围内有没有已经折进来的区间.想到这一步,不难发现左右是独立的.</p>
<p>于是我们设$f_i$表示能不能折成以$[ 1 , i ]$为最下层,$g_i$表示能不能折成$[ i , n ]$为最下层,那$[ l , r ]$能折出来当且仅当$f_r = g_l = 1$,做个前缀和就可以知道有多少个区间能折出来.</p>
<p>通过上面的启示,我们不难发现横着折和竖着折也是相互独立的,于是分别算出答案后乘起来就好.</p>
<h5><span id="example2cf1616g-just-add-an-edge">Example2(CF1616G Just Add an Edge)</span></h5><p>我们来一点一点捋这个题:</p>
<p>首先,任意一条路径一定形如$1 \rightarrow x \cup y \rightarrow n$,并且$1 \rightarrow x$和$y \rightarrow n$不交,然后添加边$x \rightarrow y$.</p>
<p>那么什么时候$1 \rightarrow x$和$y \rightarrow n$没有交并且他们的并是$[ 1 , n ]$呢?考虑将$1 \rightarrow x$这条路径上的点染色为$0$,$y \rightarrow n$上的点染色为$1$,由于边只有从前往后的,因此$[ 1 , y - 1 ]$必然为$0$,$[ x + 1 , n ]$必然为$1$.至于中间部分一定是一段一段地跳跃.</p>
<p>我们用dp做中间的跳跃过程,具体地,假设我们已经确定了$y$,现在想要找到$x$,我们现在假设染色的末尾是$( i , i + 1 )$,也就是$i$染色和$i + 1$的染色不一样,然后不断向后接上就行.</p>
<p>那么怎么优化这个dp呢?我们找到任意一个$p$,满足$p \nrightarrow p + 1$,那么$p$和$p + 1$永远不可能染同种颜色,我们直接以它为断点,自然发现$p$的左右两部分独立.</p>
<p>然后就是这题的细节部分,首先是计数的时候有可能算上了$p \rightarrow p + 1$这条边,要特判.另外的问题是会发现首尾的位置很特殊,这里的做法是建立$0$和$n + 1$两个虚点,向所有点连边.</p>
<p>总之$O ( nm )$的dp是自然的,而且会发现这个是一个类似连续性的东西,因此想到了在中间找断点中间合并,进一步发现左右两部分无关.</p>
<h3><span id="费用提前延后计算">费用提前/延后计算</span></h3><p>有的时候,我们注意到一个费用是很难及时算到dp数组里的,但是这个费用可能可以早在之前题前算上或之后再补上.</p>
<h5><span id="example122zr提高组十连测day3多">Example1([22zr提高组十连测day3]多)</span></h5><p>首先考虑已知一个序列,如何快速求它最后有几个位置不是$0$.考虑从后往前枚举,每次判断当前数是否在以前已经枚举到过,如果枚举过就将其$- 1$并重复判断操作,直到为$0$或得到一个没有出现过的数.</p>
<p>考虑设计dp状态,判断一个位置是否能是$0$相当于判断后面的已知序列的$mex$,这个要记入状态中,于是考虑设$dp_{ i , j }$表示当前到了第$i$个位置,后面的数的$mex - 1$是$j$的方案数.</p>
<p>但是如果直接这么设会发现,当前$i$的加入有可能会改变$mex$的值,而这个改变是很难处理的,因为如果$i$位置选择了$j + 1$这个数字,那么$mex$要向上伸展到某一个值,而如果不选择$j + 1$,也有可能选择一个更大的值后不断落到$j + 1$,这意味着我们转移时需要枚举补上$j + 1$这个数字后的$mex$并用刷表法转移.</p>
<p>不妨设这个数字是$k$.如果我们插入一个数字后直接更新当前的答案,可以发现这个$k$是没有办法处理的.所以考虑延后计算费用,即当我们插入的数字并没有引起$mex$的改变的时候,忽略此时带来的组合数贡献(因为这个数字可以任选,可以理解为将其暂时存下来后来需要它的时候再把它乘入答案);当我们引起改变的时候,我们从之前存下来的那些数字中取出一些补全$[ j + 2 , k ]$这些数字.</p>
<p>另外,注意到计算组合数的时候每个数字有两个,没有办法判断当前还剩下哪些数字,不妨直接认为两个相等的数字本质不同,算完答案后再整体除以$2^{ n }$.</p>
<h5><span id="example2022zrnoip十连测day9-消失vanish">Example(2022zrnoip十连测day9-消失(vanish))</span></h5><p>$O ( n^3 )$的暴力是显然的:设$f_{ i , j , k }$表示目前考虑到第$i$个位置,前面还有$j$个A,已经选了$k$个B的方案数,对A也类似做一做,最后枚举中点合并即可.</p>
<p>问题在于如何优化到$n^2$.</p>
<p>第一反应是删掉一维,但是这三维好像哪一位都不能删:第二维要累积答案,第三维要最后做合并.但是,注意到第二维和第三维可以合并!换句话说,我们做一个费用提前计算,每次加入A的时候,枚举它接下来要杀掉几个B,那我们接下来就额外多需要一些B.于是我们设$f_{ i , j }$表示目前考虑到$i$,还需要$j$个B才能凑齐$c_B$个B的答案,就可以实现了.</p>
<p>咋说呢,大概是发现答案和后两维有关,而且注意到后两维之和是不大的,于是考虑把它俩合并起来做费用提前计算.</p>
<h3><span id="建立双射">建立双射</span></h3><h5><span id="example1sdoi2010地精部落">Example1([SDOI2010]地精部落)</span></h5><p>设$f_{ i , j }$表示长度为$i$,开头为山峰且高度为$j$的方案数;$g_{ i , j }$表示长度为$i$,开头为山谷且高度为$j$的方案数.注意到这俩显然是一个双射,也就是$f_{ i , j } = g_{ i , i - j + 1 }$.</p>
<p>首先我们可以插入一个数,假如插入的数是山峰,那原本的所有大于等于$j$的数都向上平移一格,于是自然有:$f_{ i , j } = \sum_{ k = 1 }^{ j - 1 } g_{ i - 1 , k } = \sum_{ k = 1 }^{ j - 1 } f_{ i - 1 , i - k }$.</p>
<p>另外,这个式子可以稍微转化为:$f_{ i , j } = f_{ i - 1 , i - j + 1 } + f_{ i , j - 1 } = g_{ i - 1 , j - 1 } + f_{ i , j - 1 }$.</p>
<p>上式可以这么理解:我们讨论一下$j$和$j - 1$是否相邻,如果相邻必然是$j$是山峰,$j - 1$是山谷,不然则交换它俩后也仍然是合法的序列.</p>
<h5><span id="example22019zrtg十连测day1-group">Example2(2019zrtg十连测day1 group)</span></h5><p>首先注意到$2 k \leq n \land nk \leq 10^5$,不难发现$k \leq 500$.</p>
<p>冷静一下,发现如果我们把所有组长列出来按照经验排序,再把所有组员列出来按照经验排序,然后按照顺序匹对一定是最优的.</p>
<p>再冷静一下,类似卡特兰数,这等价于先把所有人按照经验从小到大排序,然后任意前缀选择的组长数量大于等于组员,枚举这个差量和前面选的组长的总量就可以做到$O ( nk^2 )$.当然其实只要控制组长的数量大于等于组员的数量即可.</p>
<p>注意经验相同的话要让想当组长的到前面.</p>
<p>另外当时还推了个性质:都可以的人群中一定存在一个分界点$w$,使得成为组长的经验$\geq w$,成为组员的经验$\leq w$,但是没用上这个性质.</p>
<h5><span id="example3agc056b">Example3(AGC056B)</span></h5><p>双序列计数,考虑把$x$双射到某个东西上.</p>
<p>考虑最后的图一定是个$DAG$,但同层之间没有啥限制,我们不妨假设同层的最左侧是最大值,这样就完成了映射.</p>
<p>设$dp_{ l , r , mx }$表示只考虑$[ l , r ]$这一段的线段,然后最大值所在位置需要$\geq mx$的答案.转移的话枚举一手最大值扔哪,然后大概能做?</p>
<h3><span id="分维处理">分维处理</span></h3><p>简单来说就是如果问题有两维,我们找到简单的那一维处理.</p>
<h5><span id="example1cf1621gweighted-increasing-subsequences">Example1([CF1621G]Weighted Increasing Subsequences)</span></h5><h2><span id="动态规划的优化">动态规划的优化</span></h2><h3><span id="递进转移">递进转移</span></h3><p>瞎起的名,主要用于大量字符串算法.比如SA中的求height.</p>
<h5><span id="example1">Example1</span></h5><p>有$m$种礼物,每种礼物有无数个(有有限个也能做),$n$个朋友,第$i$个朋友喜欢第$j$个礼物的概率是$p_{ i , j }$,$\forall i , \sum p_{ i , j } = 1$.</p>
<p>现在你可以选$n$件礼物.购买完成后你会按照朋友的编号逐个进行以下操作:如果自己手上的礼物有他喜欢的那一个,就将那个给他.求一种策略,最大化拿到喜爱的礼物的朋友个数的期望值.</p>
<p>$n \leq 3000 , m \leq 300$.</p>
<p>首先一个显然的想法是:不同礼物对期望的贡献是独立的,也就是和的期望等于期望的和,我们只需要算出每个礼物的贡献即可.进一步地,我们需要求出$g_{ i , j }$表示第$i$种礼物一共选了$j$个,被拿走的期望个数.然后我们只需要对其做背包就可以了.</p>
<p>那么$g$怎么求呢?这个是简单的,我们设$f_{ i , j }$表示喜欢第$i$种礼物的人有$j$个的概率,不难发现$g_{ i , j } = \sum_{ k = 0 }^n \min \{ j , k \} f_{ i , k }$.递推式就有$g_{ i , j } = g_{ i , j - 1 } + \sum_{ k = j }^n f_{ i , k }$.$f$同样是做一个背包.</p>
<p>但是,这两个背包的复杂度都是$O ( n^2 m )$的.我们需要对它们进行优化.</p>
<p>先看最后求答案的背包:自然的想法是,不难发现$g_{ i , j }$满足四边形不等式,而其转移是经典的$k$点最短路,因此可以用决策单调性优化.</p>
<p>但实际上有点多此一举,事实上我们这么考虑:由于$g_i$是上凸函数,它的斜率逐渐减少,那么我们就必然是能选小的就选小的.我们可以设计一个贪心来解决这个问题:记录下来当前每种礼物选了几个,设为$c_i$,每次选当前$g_{ i , c_i + 1 } - g_{ i , c_i }$最大的那个即可,这可以用堆实现.为啥这个是对的呢?因为$c_i$越大,能有的贡献就越小,不可能出现为了后面的贡献而让前面吃亏的情况,这就可以贪心了.于是第一个背包得到了解决.这里复杂度$O ( n^2 \log n )$,不太确定有没有$O ( n^2 )$的做法.</p>
<p>但是第二个背包,也就是$f$怎么求呢?我们发现我们没有必要把$g$全都求出来,只需要求目前需要的一部分就可以了,由于$\sum f = 1$,因此后缀和可以改为前缀和,考虑到每往后推一位是$O ( n )$的,但是只会往后推总共$O ( n )$位,因此这里复杂度$O ( n^2 )$.</p>
<h5><span id="example2">Example2</span></h5><p>给一个字符串,求一个最大长度$L \leq \frac{ n }{ 2 }$,使得前$L$个字符与后$L$个字符循环同构.</p>
<p>不难发现循环同构一定长这样:</p>
<script type="math/tex; mode=display">
ABSBA</script><p>我们枚举$A$的长度,然后就只需要求$B$,设$f_{ i }$表示字符串去掉开头和结尾的$i$个字符后的border,有$f_{ i - 1 } \leq f_i + 1$.然后就做完了.</p>
<h3><span id="反向操作">反向操作</span></h3><p>其实本质上是因为,DAG把边反向后仍然是一个DAG,这意味着我们大部分dp都可以进行反向操作.</p>
<h4><span id="example1cf1810g">Example1(CF1810G)</span></h4><p>其实这题有一个很自然的容斥做法,但我们先略过.</p>
<p>一般而言先考虑对于每个$k$暴力做.那怎么维护最大前缀和这个东西呢?如果我们从左往右扫,其实是很难维护的.因为我们无法接受加一维以维护它.更进一步为什么无法维护呢?因为你新加一个元素,它是不会影响前面的前缀和的,只会影响一个.这导致你的取$\max$操作很艰难.但如果!我把这个dp反过来,我设$f_{ i , j }$表示<strong>从后往前</strong>dp到$i$,当前的最大前缀和是$j$的概率是多少,这个dp的转移极其简单:</p>
<script type="math/tex; mode=display">
P \times f_{ i , j } \rightarrow f_{ i - 1 , \max \{ 0 , j + a_{ i - 1 } \} }</script><p>最后在$f_{ 1 , j }$处乘上$h_j$.</p>
<p>但是这样是$O ( n^3 )$的,怎么办呢?</p>
<p>考虑把这个dp反过来!我们设$g_{ i , j }$表示如果初始只有$f_{ i , j } = 1$,dp到最后的答案是多少.于是只需要:</p>
<script type="math/tex; mode=display">
\begin{aligned}
P \times g_{ i - 1 , \max \{ 0 , j + a_{ i - 1 } \} } & \rightarrow g_{ i , j } \\

\end{aligned}</script><p>我认真考虑过这个$P$应该乘在哪边.实际上确实应该在左边.原因比较简单,因为答案是一串乘法,你不能把这些$P$变成除法.但还有一个问题是,为什么反向的时候没有把这些反向呢?</p>
<p>原因是这类型dp比较特殊,我们要算的其实是一个类似DAG路径上的信息,因此边权无需改变.</p>
<h3><span id="矩阵加速">矩阵加速</span></h3><h4><span id="example1luogup4007小y和恐怖的奴隶主">Example1(luoguP4007小Y和恐怖的奴隶主)</span></h4><p>首先考虑直接将随从的状态压起来,拿组合数分析一下会发现状态数大概小于等于$200$.也就是说转移矩阵大概是$200 \times 200$的,设状态数为$S$.</p>
<p>继续考虑,如果直接做的话复杂度是$O ( TS^3 \log n )$,过不了.</p>
<p>我们考虑将一个$n$在$w$进制下分解,然后预处理每一位所对应的矩阵,这样复杂度来到了$O ( wS^3 \log_w n + TS^2 \log_w n )$,平衡一下复杂度即可,大概取$w = 4$会比较优秀.</p>
<h4><span id="example2noi-online3提高组魔法值">Example2([NOI Online#3提高组]魔法值)</span></h4><p>重新定义矩阵乘法:用$\oplus$替换原本的$+$,然后用邻接矩阵作为转移矩阵.</p>
<p>直接做仍然过不了,不过可以用和上面那个题一样的方法来优化复杂度.</p>
<h4><span id="example3cf-1474f">Example3([CF 1474F])</span></h4><p>首先需要注意到,LIS的起点和终点一定在这条线的拐角处,也就是山谷和山峰处.</p>
<p>LIS的长度是好求的.问题在于计数上.</p>
<p>首先枚举一下LIS的起点和终点,但是接下来似乎怎么dp都需要和值域有关.而且如果从起点走到终点,判断中间具体的方案数,这个东西似乎也不能快速处理,一条线上的似乎也很难捆绑更新.</p>
<p>我们冷静一下,令$f_i = \sum_{ j , a_j = a_i - 1 } f_j$,这个东西一条直线上的位置不能捆绑更新的原因在于,随着我们从左往右走,是需要不断更新后面的$\sum$的值的,这一点很难处理.每次移动需要加入一条横线上的点对应的$f$.</p>
<p>再冷静一下,既然从左到右扫不行,我们能不能考虑从下往上扫呢?考虑设$f_{ i , j }$表示所有$a_x = i$的$x$中第$j$小的$x$的答案,我们仍然可以从下往上扫.</p>
<p>但是,这么扫的复杂度仍然和值域有关.这怎么办呢?这个加入可规律多了,注意到在经过一个山峰或山谷之前,我们需要处理的点的数量和相对顺序都是恒定的,而它们的转移也之和上一次转移(上一条横线)有关,于是可以直接拿矩阵加速这个过程.</p>
<h4><span id="example4cf-1152f2">Example4([CF 1152F2])</span></h4><p>注意到$m$和$k$很小,这一定是突破口.</p>
<p>又注意到如果$a_{ i + 1 } &gt; a_i$,那么限制很强,反之很弱.而且又要求没有相同的数字.考虑从小到大加入数字,这样每加入一个数字$x + 1$,我们考虑它只能插入$[ x + 1 - m , x ]$后面,我们直接用一个二进制数$S$表示$[ x + 1 - m , x ]$中的数字是否存在,然后就可以在转移上直接调用$popcount ( S )$.设$dp_{ i , j , S }$表示目前考虑完了数字$i$,插入了$j$个数字,存在情况是$S$.直接对它做矩阵加速就可以做到$O ( ( 2^m k )^3 \log n )$.</p>
<h4><span id="example5noi2020-美食家">Example5([NOI2020] 美食家)</span></h4><p>设$dp_{ i , j }$表示第$i$天走到城市$j$的最大收益,一眼矩阵加速.</p>
<p>但是有两个问题需要解决:</p>
<p>第一个问题是,怎么处理美食节.这个没什么,在两个美食节之间做矩阵加速,在美食节节点上特殊处理一下就行.不过这样复杂度要乘上$k$.我们可以一开始就预处理出转移矩阵的二的幂次,然后这里就可以加快速度.</p>
<p>第二个问题是,怎么处理边权.一个自然的想法是拆边,但边很多,拆不过来.怎么办呢?我们可以拆点.将一个点拆成若干个点连起来,对于一条边就找到对应的点连过去就行.</p>
<h3><span id="分步合并">分步合并</span></h3><p>大概是有的时候如果询问比较多,我们可能需要处理前缀/后缀数组然后拼起来答案.</p>
<p>这个时候我们会发现,如果要拼起来答案就要枚举一个区间,但是实际上可以一步一步来.</p>
<h4><span id="example2022qbxt国庆day6permutation">Example([2022qbxt国庆Day6]permutation)</span></h4><p>首先遇到排列先扔平面直角坐标系上.</p>
<p>考虑合法序列一定长什么样,如果我们把这个序列的若干个下降子段拿一个矩阵括起来,那这些矩阵显然横纵坐标都不能相交.</p>
<p>我们设$f_{ l , r }$表示$a_l$和$a_r$必选的前提下,$[ l , r ]$这个区间的下降子序列个数.</p>
<p>然后,我们考虑枚举删掉点,对着剩下来的序列做dp.</p>
<p>考虑设$dp_{ i , j }$表示前$i$个点,最大值为$j$的方案数,不难发现最后一个矩阵的最小值一定是$a_{ i }$.然后$dp_{ a , b } = \sum_{ i &lt; a , j &lt; b } dp_{ i , j } f_{ i + 1 , a }$.</p>
<p>这个转移是$n^4$的,但是这显然是一个前缀和的形式,于是做一下二维前缀和就可以做到$n^2$,这样我们就得到了一个复杂度$O ( n^3 )$的东西.</p>
<p>继续考虑,由于是多个点,我们考虑维护前缀后缀然后在这个点拼起来.注意到,如果我们想求这个点不选的方案数,那还需要枚举它左右两边选的点,很麻烦,所以我们求一下这个点必选的方案数.这样我们每次需要枚举这个点$i$,它所在矩阵的最左边的点$k$,最右边的点$k$,然后此时的答案为$pre [ j - 1 ] [ a [ k ] - 1 ] \times nxt [ k + 1 ] [ a [ j ] + 1 ] \times f [ j ] [ i ] \times f [ i ] [ k ]$.</p>
<p>冷静一下,这样一步枚举了两边的分界点,所以可能不是很优秀,我们一步一步来.</p>
<p>设$g_{ i , j }$为接下来我们要选$[ i , j ]$,$i$是矩阵左端点,$j$任意且这两个点必在矩阵中,左右两边的方案数.初始条件$g_{ i , j } = pre [ i - 1 ] [ a [ j ] - 1 ] \times nxt [ j + 1 ] [ a [ i ] + 1 ]$.</p>
<p>然后我们不断转移右端点,将右端点往里缩,这一步可以使用树状数组优化,最后更新答案即可.</p>
<p>很厉害.</p>
<h3><span id="合并更新">合并更新</span></h3><h4><span id="example2022zrtg十连测day7-zero">Example(2022zrtg十连测day7 Zero)</span></h4><p>设$k = \max \{ i , j \}$,首先可以求出$x , y , z$分别表示:</p>
<ol>
<li><p>$x$:只包含第一行的格子的以$k$为右端点的和为$0$的最小矩形的左端点$- 1$.</p>
</li>
<li><p>$y$:只包含第二行的格子的以$k$为右端点的和为$0$的最小矩形的左端点$- 1$.</p>
</li>
<li><p>$z$:同时包含两行的格子的以$k$为右端点的和为$0$的最小矩形的左端点$- 1$.</p>
</li>
</ol>
<p>那么自然有转移:</p>
<script type="math/tex; mode=display">
\begin{gathered}
f ( i , k ) \leftarrow \max \{ f ( i , k - 1 ) , f ( i , y ) + 1 \} \\
f ( k , j ) \leftarrow \max \{ f ( k - 1 , j ) , f ( x , j ) + 1 \} \\
f ( k , k ) \leftarrow \max \{ f ( k , k - 1 ) , f ( k - 1 , k ) , f ( z , z ) + 1 \}
\end{gathered}</script><p>转移正确的原因是两维转移顺序无所谓,所以可以乱转移.</p>
<p>冷静一下这个过程,我们先只考虑第一个转移:注意到$f ( i , k )$关于$i$不降,于是显然当$f ( i , y ) \ne f ( i , k - 1 )$的时候才会由$f ( i , y ) + 1$转移过来.我们不妨设$p_i$表示最小的位置满足$f ( i , p_i ) = f ( i , k - 1 )$,那转移也就是$f ( i , k ) \leftarrow f ( i , k - 1 ) + [ p_i \leq y ]$.并且每进行一次转移,都会满足$p_i \leq y$的$p_i$设为$k$.</p>
<p>也就是说我们需要维护:我们令一个点为它对应的$i$在当前$k$的$f$值,将这个点放到$p_i$位置上.然后我们每次找到$y$并把所有在$y$位置前的点都合并到$k$这个点上,并打一个加法$tag$,这显然可以并查集启发式合并.</p>
<p>把前两个转移这么一起做,然后用二分可以得到两个转移分别的$p_k$.</p>
<p>最后还需要处理一下$f_{ k , k }$,暴力转移即可.</p>
<p>有一个问题是为啥能想到按照$\max \{ i , j \}$为顺序进行转移,这里是由于转移顺序无区别,我们需要规定一个顺序进行转移,于是考虑到找到较长的那一部分进行转移.</p>
<h3><span id="交换状态和值">交换状态和值</span></h3><p>通常是dp值较小而状态较大的情况,而且二者间通常需要满足单调性.</p>
<h5><span id="example1cf1620f">Example1(CF1620F)</span></h5><p>首先讨论一下最大值最小值之类的不难发现:这题是二分图的充要条件是$\nexists 1 \leq i &lt; j &lt; k \leq n$,$a_i &gt; a_j &gt; a_k$.</p>
<p>然后相当于是整个序列可以拆分成两个上升子序列,一个想法是$dp_{ i , j }$表示现在做到$i$,另一个上升子序列的终点是$j$,是否合法.然后继续做.但这样复杂度挂掉了.</p>
<p>咋优化咧?注意到dp状态很大而值很小,且显然在$i$一定的情况下,$j$的值越小越容易满足.所以设$dp_i$表示一个上升子序列的终点是$i$,另一个上升子序列的终点最小是多少,这样就可以做了.</p>
<h5><span id="example2agc033d">Example2(AGC033D)</span></h5><p>首先自然的设计是$dp_{ l , r , u , d }$,然后优化一下就是$O ( n^4 )$.然后咋做?</p>
<p>注意到答案不超过$\log$级别,所以设$dp_{ l , r , u , c }$表示答案为$c$的时候,最大的$d$是多少.然后就$O ( n^3 \log n )$.</p>
<h5><span id="example3">Example3</span></h5><p>给定一个序列,两个人博弈.Alice每次可以使序列最左边的数$a_i$减去$[ 1 , a_i ]$中的一个数字,减成$0$就删掉.Bob可以对最右边的数做类似的操作,不能操作者输.问结果.$( n \leq 2000 )$</p>
<p>先考虑一个$O ( n^2 a^2 )$的dp,比较显然,因为一个人取数显然要么取$1$要么全取,又发现不可能两个人一起取一堆(先取的那个人取完就赢了),于是设$dp_{ l , r , x , y }$表示目前Alice在取第$l$堆,Bob在取第$r$堆,第$l$堆为$x$,第$r$堆为$y$的情况下谁赢.直接转移.</p>
<p>诶,好像优化不动了,无论咋做都要知道当前这堆数字是啥啊,那就一定要把$a$存状态里诶.</p>
<p>能不能再更新一下策略,注意到最后Alice如果要全选的话,剩下的是$1$还是更大的数好像无所谓.那:如果$a_1 = x$的时候,Alice能赢,那$a_1 = x + 1$的时候Alice一定能赢.也就是这个东西满足单调性.又冷静一下,如果两个人不断一直持续选$1$,那最后一定会选到一个人清空堆为止.而且清空堆的那个一定输了.因为如果清空了还赢了,那他一开始就直接清空了.不可能一开始选着选着一个人还没清空堆另一个人就跑了.这个性质启示我们或许后两维可以删掉一维,因为大部分情况下那一维都应该等于$a_l$或$a_r$.</p>
<p>然后咧?另一维怎么去掉呢?</p>
<p>等一下,我们开一个四维的dp存$0 / 1$是不是太奢侈了?</p>
<p>所以我们把一个状态改为dp的值,设$dp_{ l , r }$表示当前Alice在$l$,Bob在$r$,Bob还没动$a_r$的前提下,$a_l$至少要是多少Alice才能赢,Bob做一个类似的dp.最后只需要比较$dp_{ 1 , 1 }$和$a_1$的大小就行.</p>
<p>问题来了,这玩意咋转移啊?</p>
<p>首先,如果当前Alice开始选$l$,Bob开始选$r$,那Alice的获胜条件显然是$dp_{ l , r } \leq a_r$</p>
<p>如果可以全选(也就是Alice开始选$l + 1$,Bob开始选$r$的时候Alice能赢),就直接让$dp_{ l , r } = 1$.不然,由于清空堆的人要输,所以Alice为了不输,必须要让$dp_{ l , r - 1 }$也满足条件,一个自然的想法是$dp_{ l , r - 1 } + a_r + 1$,但是这个值好像没有必要:因为Bob并不是只有会不断清空$a_r$的,如果目前的$[ l + 1 , r ]$这个状态,Bob的值已经赢不了了,那我Alice就可以直接把左边清空.所以一旦Bob走到了不能稳赢$[ l + 1 , r ]$的值,Bob就必须全清空,所以如果我们设$g_{ l , r }$是Bob的$dp$数组,那其实这里应该是$a_r + 1 + dp_{ l , r - 1 } - g_{ l + 1 , r }$,因为Bob的策略一定是一步一步走到$g_{ l + 1 , r }$后清空,这个情况我们已经杀了他了.</p>
<h5><span id="example4uoj708">Example4(uoj708)</span></h5><p>自然的想法是$dp_{ i , j }$表示$i$子树内划分成$j$个连通块是否合法,然后我们发现如果$j$满足条件,那么$j + 2$一定满足条件(判掉一些边界情况).</p>
<h3><span id="斜率优化">斜率优化</span></h3><p>一般的斜率优化就略了.</p>
<p>值得一提的是,斜率优化还有一种理解方式是:将前面的点当作直线,后面的当作一条平行于$y$轴的直线进行查询.</p>
<h5><span id="example1codechef-tsum2">Example1(Codechef TSUM2)</span></h5><p>点分治+斜率优化,注意需要使用第二种理解方式的斜率优化.</p>
<p>不过第一种应该也可以用.</p>
<h3><span id="wqs二分">WQS二分</span></h3><p>能用WQS二分解决的问题通常形如:需要在$n$个物品中选择恰好$m$个,使得最后答案最大.并且如果令$f_i$表示选了$i$个的最大答案,$f_i$必须是凸函数且是单调不降的.</p>
<p>遇到这种问题,我们通常二分一个数$C$,每选择一个物品就减去$C$的答案.不难发现这样我们一定能逼近$f_m$.</p>
<h3><span id="四边形不等式">四边形不等式</span></h3><p>对于定义在$\mathbb{ Z }$上的二元函数$w$,若对定义域上任意$a , b , c , d ( a \leq b \leq c \leq d )$都有$w ( a , c ) + w ( b , d ) \leq w ( a , d ) + w ( b , c )$,也就是交叉小于包含,则称函数$w$满足四边形不等式.如果等式成立,那么我们称其满足四边形恒等式.</p>
<p>不难发现这意味着:$w$所形成的矩阵中的任意一个子矩阵的差分(左上角+右下角-左下角-右上角)都小于等于$0$.</p>
<p>如果它还满足$\forall 1 \leq l ‘ \leq l \leq r \leq r ‘ \leq n , w ( l , r ) \leq w ( l ‘ , r ‘ )$，我们称其满足区间包含单调性.</p>
<p>需要声明的一点是:四边形不等式只能处理$\min$型dp的问题,对于$\max$型dp需要取相反数改成$\min$.</p>
<h4><span id="判定性质定理">判定/性质定理</span></h4><h5><span id="定理1">定理1</span></h5><p>若二元函数$w ( x , y )$满足$w ( a , b ) + w ( a + 1 , b + 1 ) \leq w ( a , b + 1 ) + w ( a + 1 , b )$.其中$a &lt; a + 1 \leq b &lt; b + 1$,则$w$满足四边形不等式.</p>
<p>证明:</p>
<p>对于$a + 1 &lt; c$ 有</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( a , c ) + w ( a + 1 , c + 1 ) & \leq w ( a , c + 1 ) + w ( a + 1 , c ) \\
w ( a + 1 , c + 1 ) & \leq w ( a , c + 1 ) + w ( a + 1 , c ) - w ( a , c ) \\

\end{aligned}</script><p>同时有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( a + 1 , c ) + w ( a + 2 , c + 1 ) & \leq w ( a + 1 , c + 1 ) + w ( a + 2 , c ) \\
w ( a + 1 , c ) + w ( a + 2 , c + 1 ) - w ( a + 2 , c ) & \leq w ( a + 1 , c + 1 ) \\

\end{aligned}</script><p>联立得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( a + 1 , c ) + w ( a + 2 , c + 1 ) - w ( a + 2 , c ) & \leq w ( a , c + 1 ) + w ( a + 1 , c ) - w ( a , c ) \\
w ( a + 2 , c + 1 ) + w ( a , c ) & \leq w ( a + 1 , c ) + w ( a + 2 , c + 1 )
\end{aligned}</script><p>同理可推至四边形不等式定义式.</p>
<p>事实上,这意味着一个$2 \times 2$的子矩阵的差分满足条件,那么自然满足四边形不等式,无需推导.</p>
<h5><span id="定理2">定理2</span></h5><p>若$w_1 ( l , r ) , w_2 ( l , r )$满足四边形不等式(或区间包含单调性),则$\forall c_1 , c_2 \geq 0$,$( c_1 w_1 + c_2 w_2 )$满足四边形不等式(或区间包含单调性).</p>
<p>证明显然.</p>
<h5><span id="定理3">定理3</span></h5><p>若$\exists f ( x ) , g ( x )$使得$w ( l , r ) = f ( r ) - g ( l )$,则$w$满足四边形恒等式.当$f , g$单调递增时,$w$还满足区间包含单调性.</p>
<p>证明显然.</p>
<h5><span id="定理4">定理4</span></h5><p>设$h$是一个单调递增的下凸函数(一阶导数单调递增),若$w ( l , r )$满足四边形不等式和区间包含单调性,则复合函数$h ( w ( l , r ) )$也满足四边形不等式和区间包含单调性.</p>
<p>令$l_1 \leq l_2 \leq r_1 \leq r_2$,由于$w$满足四边形不等式,于是有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( l_1 , r_1 ) + w ( l_2 , r_2 ) & \leq w ( l_1 , r_2 ) + w ( l_2 , r_1 ) \\
0 & \leq w ( l_1 , r_1 ) - w ( l_2 , r_1 ) \leq w ( l_1 , r_2 ) - w ( l_2 , r_2 )
\end{aligned}</script><p>令$t = w ( l_1 , r_2 ) - w ( l_2 , r_2 )$,我们有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( l_1 , r_1 ) & \leq w ( l_2 , r_1 ) + t \\
w ( l_1 , r_2 ) & = w ( l_2 , r_2 ) + t \\
h ( w ( l_1 , r_1 ) ) - h ( w ( l_2 , r_1 ) ) & \leq h ( w ( l_2 , r_1 ) + t ) - h ( w ( l_2 , r_1 ) ) \\
h ( w ( l_1 , r_2 ) ) - h ( w ( l_2 , r_2 ) ) & = h ( w ( l_2 , r_2 ) + t ) - h ( w ( l_2 , r_2 ) )
\end{aligned}</script><p>不妨令$\Delta h ( x ) = h ( x + t ) - h ( x )$,由于$h$是下凸函数,所以$\Delta h$函数单调递增.</p>
<p>那么也就有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
h ( w ( l_1 , r_1 ) ) - h ( w ( l_2 , r_1 ) ) & \leq \Delta h ( w ( l_2 , r_1 ) ) \\
h ( w ( l_1 , r_2 ) ) - h ( w ( l_2 , r_2 ) ) & = \Delta h ( w ( l_2 , r_2 ) )
\end{aligned}</script><p>由于$w ( l_2 , r_1 ) \leq w ( l_2 , r_2 )$,所以$\Delta h ( w ( l_2 , r_1 ) ) \leq \Delta h ( w ( l_2 , r_2 ) )$于是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
h ( w ( l_1 , r_1 ) ) - h ( w ( l_2 , r_1 ) ) & \leq h ( w ( l_1 , r_2 ) ) - h ( w ( l_2 , r_2 ) ) \\
h ( w ( l_1 , r_1 ) ) + h ( w ( l_2 , r_2 ) ) & \leq h ( w ( l_1 , r_2 ) ) + h ( w ( l_2 , r_1 ) )
\end{aligned}</script><p>证毕.</p>
<h5><span id="定理5">定理5</span></h5><p>设$h$是一个下凸函数(一阶导数单调递增),若$w ( l , r )$满足四边形恒等式和区间包含单调性,则复合函数$h ( w ( l , r ) )$也满足四边形不等式.</p>
<p>证明类似定理4,因为满足四边形恒等式所以不必用到$h$单调递增的性质.</p>
<h4><span id="决策单调性">决策单调性</span></h4><p>对于形如$f_i = \min_{ 1 \leq j &lt; i } \{ f_j + w ( j , i ) \}$的状态转移方程,记$p_i$为$f_i$的最优决策.若$p$在$[ 1 , n ]$上单调不降,则称$f$具有决策单调性.</p>
<p>值得一提的是,我们也可以把题目中的$\min$改为$\max$,并且把$+ w$改为$- w$,那么下面的结论同样成立.</p>
<h5><span id="最短路型dp">最短路型dp</span></h5><p>定理：对于形如$f_i = \min_{ 1 \leq j &lt; i }{ f_j + w ( j , i ) }$的状态转移方程,若$w$满足四边形不等式,则$f$有决策单调性.</p>
<p>证明:</p>
<p>$\forall i \in [ 1 , n ] , \forall j \in [ 0 , p_i - 1 ]$,根据$p$的定义,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ p_i } + w ( p_i , i ) & \leq f_j + w ( j , i ) \\
f_{ p_i } - f_j & \leq w ( j , i ) - w ( p_i , i ) \\

\end{aligned}</script><p>而对于$k \in [ i + 1 , n ]$,根据$w$的四边形不等式,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
w ( j , i ) + w ( p_i , k ) & \leq w ( j , k ) + w ( p_i , i ) \\
w ( j , i ) - w ( p_i , i ) & \leq w ( j , k ) - w ( p_i , k ) \\

\end{aligned}</script><p>联立得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ p_i } - f_j & \leq w ( j , k ) - w ( p_i , k ) \\
f_{ p_i } + w ( p_i , k ) & \leq w ( j , k ) + f_j \\

\end{aligned}</script><p>即:$j$对$k$的更新一定不如$p_i$对$k$的更新更优,因此$p_k \in [ p_i , n ]$,因此$f$有决策单调性.</p>
<h6><span id="example1loj6039雅礼集训2017day5珠宝">Example1(LOJ6039[雅礼集训2017Day5]珠宝)</span></h6><p>首先发现代价很小但是物品很多,于是想到按照代价分类.然后同种代价要选肯定由价值从小往大选,这一段可以前缀和做.</p>
<p>于是我们设$f_i$表示价值为$i$的答案,自然有:$f_i = \max \{ f_{ i - kc } + sum_{ c , k } \}$.</p>
<p>如果我们把$c$相同的分层,那这显然是一个最短路型dp,其中$w ( i , j ) = sum_{ c , \frac{ i - j }{ c } }$.</p>
<p>显然这个转移只会让$\mod c$相同的相互转移,于是后面的$w ( i , j )$可以理解为一段数字的和,自然满足四边形不等式($\max$也满足,因为交叉等于包含).</p>
<h5><span id="k点最短路型dp">k点最短路型dp</span></h5><p>对于形如$f_{ x , j } = \min_{ i = 1 }^{ x - 1 } \{ f_{ i , j - 1 } + w_{ i , x } \}$的状态转移方程,若$w$满足四边形不等式,则$f$有决策单调性.证明同上.</p>
<p>值得一提的是,如果形如$f_x = \min_{ i = 1 }^{ x - 1 }{ w_{ i , x } }$,我们也可以看作$k$点最短路型的$k = 1$的特例.</p>
<h6><span id="example1-基站选址">Example1 基站选址</span></h6><p>令$f ( i , j )$为在第$j$个位置建造第$i$个基站的代价最小值,那么我们有转移:</p>
<script type="math/tex; mode=display">
f ( i , j ) = \min_{ 1 \leq k < j } \{ f ( i - 1 , k ) + \sum_{ l = k + 1 }^{ j - 1 } w_l [ d_l - s_l > d_k ] [ d_l + s_l < d_j ] + c_j \}</script><p>考虑后面的式子,不难发现满足四边形不等式(可能出现包含的时候中间部分贡献一次答案,交叉的时候中间部分不贡献答案的情况),于是可以使用四边形不等式优化.</p>
<p>考虑使用二分维护决策单调性,那么后面的是一个经典的二维数点.但由于维护决策单调性时$d_k$单调递增,更新答案时$d_j$单调递增,于是可以直接使用线段树维护,复杂度$O ( nk \log n )$.当然也可以直接用一个主席树维护.</p>
<p>也可以考虑分治维护,更加好写,复杂度$O ( nk \log^2 n )$.</p>
<p>另外,我们可以再使用WQS二分处理第一维,复杂度$O ( n \log k \log n )$.</p>
<h6><span id="example2cf-gym-102984f">Example2(CF gym 102984F)</span></h6><p>自然的设计是$f_{ i , j , k }$表示前$i$个,已经打了$j$个,末尾有连续$k$个的最大价值.但是这个状态都已经超了.</p>
<p>我们可以用一下经典套路,把它转化为$f_{ i , j }$表示前$i$个,目前打了$j$个且第$i$个没打中,然后每次枚举一个打中了的区间,这样看上去就有了优化的可能性.而如果我们把它改成$f_{ i , j }$表示前$i$个,目前有$j$个没打中而且第$i$个没打中,这就是经典的k点最短路dp.</p>
<p>接下来我们尝试证明决策单调性:$dp_{ i , j } = \max \{ dp_{ k , j - 1 } + \sum_{ l = k + 1 }^{ i - 1 } C_{ l - k } A_l + P \}$.</p>
<p>令$w ( l , r ) = \sum_{ k = l + 1 }^{ r - 1 } C_{ k - l } A_k + P$,接下来我们证明:$w ( l + 1 , r ) + w ( l , r - 1 ) \geq w ( l , r ) + w ( l + 1 , r - 1 )$即可.讨论一下每个$A$面前的系数就能发现这是成立的.</p>
<h5><span id="区间型dp">区间型dp</span></h5><p>引理:在状态转移方程$f_{ i , j } = \min_{ i \leq k &lt; j } \{ f_{ i , k } + f_{ k + 1 , j } + w ( i , j ) \}$中(通常$f_{ i , i } = w ( i , i ) = 0 , f_{ i , i + 1 } = w_{ i , i + 1 }$),如果$w$满足四边形不等式和区间包含单调性,那么$f$也满足四边形不等式.</p>
<p>证明:</p>
<p>只需证明$f_{ i , j } + f_{ i + 1 , j + 1 } \leq f_{ i , j + 1 } + f_{ i + 1 , j }$即可,考虑$j - i = 1$的时候,显然成立.</p>
<p>使用数学归纳,假设当$b - a &lt; k$时,$f$满足四边形不等式,考虑$j - i = k$的情况:</p>
<p>设$f_{ i , j + 1 }$的最优决策为$x$,$f_{ i + 1 , j }$的最优决策为$y$,则有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i , j + 1 } + f_{ i + 1 , j } & = f_{ i , x } + f_{ x + 1 , j + 1 } + w ( i , j + 1 ) + f_{ i + 1 , y } + f_{ y + 1 , j } + w ( i + 1 , j ) \\

\end{aligned}</script><p>对于$f_{ i , j }$和$f_{ i + 1 , j + 1 }$来说,$x$和$y$不一定最优,所以有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i , j } + f_{ i + 1 , j + 1 } & \leq f_{ i , x } + f_{ x + 1 , j } + w ( i , j ) + f_{ i + 1 , y } + f_{ y + 1 , j + 1 } + w ( i + 1 , j + 1 ) \\

\end{aligned}</script><p>$w$和归纳假设都可以比较两个式子右边的大小,最终得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i , j } + f_{ i + 1 , j + 1 } & \leq f_{ i , j + 1 } + f_{ i + 1 , j } \\

\end{aligned}</script><h6><span id="定理">定理</span></h6><p>记$p_{ i , j }$为$f_{ i , j }$的最优决策,若$f$满足四边形不等式,那么对于$\forall i &lt; j ， 有 p_{ i , j - 1 } \leq p_{ i , j } \leq p_{ i + 1 , j } \\$.</p>
<p>证明:</p>
<p>记$p = p_{ i , j }$,$\forall k , i &lt; k \leq p$,因为$f$满足四边形不等式,所以有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i , k } + f_{ i + 1 , p } & \leq f_{ i , p } + f_{ i + 1 , k } \\
f_{ i + 1 , p } - f_{ i + 1 , j } & \leq f_{ i , p } - f_{ i , k }
\end{aligned}</script><p>根据$p$定义,有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i , p } + f_{ p + 1 , j } & \leq f_{ i , k } + f_{ k + 1 , j } \\
f_{ i , p } - f_{ i , k } & \leq f_{ k + 1 , j } - f_{ p + 1 , j }
\end{aligned}</script><p>由上两式移项联立,得到:</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{ i + 1 , p } - f_{ i + 1 , k } & \leq f_{ k + 1 , j } - f_{ p + 1 , j } \\
f_{ i + 1 , p } + f_{ p + 1 , j } & \leq f_{ i + 1 , k } + f_{ k + 1 , j } \\
f_{ i + 1 , p } + f_{ p + 1 , j } + w_{ i + 1 , j } & \leq f_{ i + 1 , k } + f_{ k + 1 , j } + w_{ i + 1 , j } \\

\end{aligned}</script><p>因此对于$f_{ i + 1 , j }$,$p$比任意的$k &lt; p$更优,因此$p_{ i + 1 , j } \geq p_{ i , j }$,另一方向同理.</p>
<h4><span id="四边形不等式判断凸性">四边形不等式判断凸性</span></h4><p>判断一个函数的凸性只需判断$f ( k ) + f ( k + 2 ) \geq 2 f ( k + 1 )$,而这只需证明$k$的时候的答案和$k + 2$时的答案可以调整出两个$k + 1$的答案(不一定是最小答案)并且这两个$k + 1$的答案的和小于等于$k$时和$k + 2$时的答案之和即可.</p>
<h5><span id="example1cf1661f">Example1(CF1661F)</span></h5><p>首先考虑四个点$( a , b , c , d )$,注意到其一定满足四边形不等式,也就是$w_{ ac } + w_{ bd } \geq w_{ ad } + w_{ bc }$.</p>
<p>我们现在想证明,设$f_k$为新增$k$个传送机后的减少的答案,我们考虑证明$f_k + f_{ k + 2 } \geq 2 f_{ k + 1 }$.</p>
<p>我们画出$f_k$时选的点和$f_{ k + 2 }$时选的点,注意到我们可以用这两次调整出两个$k + 1$的答案,并且这两个答案的和小于等于$f_k + f_{ k + 2 }$,于是证明了最小的$f_{ k + 1 }$是更小的.</p>
<p>于是我们可以使用二分,每次二分一个最小增加量$w$,然后对于每一段二分出在这一段中再增加一个传送机的增加量小于等于$w$的最大的传送机数量,然后就可以做了.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://lwlaymh.github.io/2025/06/23/%E5%AD%A6%E4%B9%A0-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F1.jpg">
      <meta itemprop="name" content="LWLAymh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LWLAymh的备忘录">
      <meta itemprop="description" content="不过是白日梦里一瞬息">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LWLAymh的备忘录">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">人工智能基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-23 00:00:25" itemprop="dateCreated datePublished" datetime="2025-06-23T00:00:25+08:00">2025-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">大学课程</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%9F%BA%E7%A1%80/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/06/23/%E5%AD%A6%E4%B9%A0-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%9F%BA%E7%A1%80/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <span id="more"></span>
<h3><span id="常用激活函数">常用激活函数</span></h3><h4><span id="sigmoid函数">Sigmoid函数</span></h4><p>$f ( x ) = \frac{ 1 }{ 1 + e^{ - x } } : ( - \infty , + \infty ) \to ( 0 , 1 )$.</p>
<p>$f ‘ ( x ) = f ( x ) ( 1 - f ( x ) )$.</p>
<h4><span id="tanh函数">tanh函数</span></h4><p>$f ( x ) = \frac{ e^x - e^{ - x } }{ e^x + e^{ - x } } : ( - \infty , + \infty ) \to ( - 1 , 1 )$.</p>
<p>$f ‘ ( x ) = 1 - f^2 ( x )$.</p>
<h4><span id="relu函数">ReLU函数</span></h4><p>$f ( x ) = \max ( 0 , x ) : ( - \infty , + \infty ) \to ( 0 , + \infty )$.</p>
<h4><span id="leaky-relu函数">Leaky ReLU函数</span></h4><p>$f ( x ) = \max ( \alpha x , x ) , 0 &lt; \alpha &lt; 1 : ( - \infty , + \infty ) \to ( - \infty , + \infty )$.</p>
<h4><span id="softmax函数">Softmax函数</span></h4><p>$f ( x_i ) = \frac{ e^{ x_i } }{ \sum_j e^{ x_j } }$.</p>
<h3><span id="损失函数">损失函数</span></h3><h4><span id="least-square">Least Square</span></h4><p>即$\arg \min \sum_{ i = 1 }^n ( f ( x_i ) - y_i )^2 = \arg \min ( A \beta - Y \mid A \beta - Y )$.用最小二乘法取$\hat \beta = ( A^T A )^{ - 1 } A^T Y$.</p>
<h4><span id="cross-entropy">Cross Entropy</span></h4><p>用错误的分布$q$来表示真实分布$p$的样本,则平均编码长度应该是:</p>
<script type="math/tex; mode=display">
H ( p , q ) = \sum_i p ( i ) \log ( \frac{ 1 }{ q ( i ) } ) = - \sum_i p ( i ) \log{ q ( i ) }</script><p>此为交叉熵.</p>
<p>特别地,当最终样本只有两个的时候,例如Logistical Regression问题,可以写成:</p>
<script type="math/tex; mode=display">
\begin{aligned}
H & = - ( y \log a + ( 1 - y ) \log ( 1 - a ) ) \\
\frac{ \partial H }{ \partial a } & = - ( \frac{ y }{ a } - \frac{ 1 - y }{ 1 - a } )
\end{aligned}</script><p>那如果有多个呢?考虑直接对归一化条件作偏导,先有:</p>
<script type="math/tex; mode=display">
\begin{aligned}
H ( p , q ) & = - \sum_i p_i ( \log{ q_i } - \log ( \sum_j q_j ) ) \\
\frac{ \partial H ( p , q ) }{ \partial q_k } & = - \frac{ p_k }{ q_k } + \frac{ \sum p_k }{ \sum_j q_j } \\
& = - \frac{ p_k }{ q_k } + 1
\end{aligned}</script><p>再乘以softmax那里的$q_k$,得到$- p_k + q_k = - y_k + f ( x_k )$.</p>
<h3><span id="神经网络实现">神经网络实现</span></h3><p>通过若干隐藏层,假设最后的输出层为第$L$层,则:</p>
<ol>
<li><p>对于第$l$层,取$\vec{ z }_l = ( W_l )^t \vec{ a }_{ l - 1 } + \vec{ b }_l$.这里对$W_l$作转置的目的是写代码的时候需要用行向量.</p>
</li>
<li><p>对于第$l$层,取$\vec{ a }_l = f ( \vec{ z }_l )$,这里意味着将每一个分量对$f$操作.</p>
</li>
<li><p>对于最终答案,取误差$\mathcal{ L } = \frac{ 1 }{ m } ( \vec{ y } - \vec{ a }_L \mid \vec{ y } - \vec{ a }_L )$.</p>
</li>
</ol>
<h4><span id="梯度下降法">梯度下降法</span></h4><p>换言之就是让$w : = w - \alpha \frac{ \partial \mathcal{ L } }{ \partial w }$,其中$\alpha$是一个选定的小常数,也可以采用类似模拟退火的方式动态决定.事实上可以把各个位置分开,写作$w_j : = w_j - \alpha \frac{ \partial \mathcal{ L } }{ \partial w_j }$.</p>
<p>另外,虽然是这么写,应当见到去掉下标$k$的记号仍然合理,无非是逐分量做此操作,因此下面如无特殊说明,运算均采用逐分量运算.例如可以定义$\vec{ a } \circ \vec{ b }$为两个向量逐分量相乘后得到的新向量,为表区分用$\times$表示正常的矩阵乘法.甚至采取$( \vec{ a } - \vec{ y } )^2$表示其自点积.坦白而言,笔者对此符号相当无奈,可也想不出什么更好的写法了.但总之这种写法总是强于部分参考资料上所将下标放上面的写作$a^L$的做法.笔者所能维持的精神数院人的唯一做法也只能是在下面加上向量符号,藉此泄愤.</p>
<p>顺便一提,应当见到$\times$和$\circ$这两种运算比较随意,用线性映射来理解,你这个$W \times$任意作用在一个向量上就行.</p>
<h4><span id="误差反向传播">误差反向传播</span></h4><p>既然要用梯度下降法,就应该把每一层的偏导都求出来.然而$\mathcal{ L }$是最后一层的结果,因此应该用链式法则一路求出前面的偏导.</p>
<p>更具体地,不妨设误差函数选的是$( \vec{ a } - \vec{ y } )^2$,激活函数选的是cross entropy有:</p>
<ol>
<li><p>$\frac{ \partial{ \mathcal{ L } } }{ \partial \vec{ a }_{ L } } = ( \vec{ a }_{ L } - \vec{ y } )$.(如若选择不同的误差函数,这里作适当变化)</p>
</li>
<li><p>$\frac{ \partial \vec{ a }_{ l } }{ \partial \vec{ z }_{ l } } = f ‘ ( \vec{ z }_{ l } ) = \vec{ a }_{ l } \circ ( 1 - \vec{ a }_{ l } )$.(如若选取不同的激活函数,这里作适当变化)</p>
</li>
<li><p>$\frac{ \partial \vec{ z }_{ l + 1 } }{ \partial \vec{ z }_{ l } } = \frac{ \partial \vec{ z }_{ l + 1 } }{ \partial \vec{ a }_{ l } } \frac{ \partial \vec{ a }_{ l } }{ \partial \vec{ z }_{ l } } = ( W_{ l + 1 } )^t \times ( \vec{ a }_l \circ ( 1 - \vec{ a }_l ) )$.</p>
</li>
<li><p>$\frac{ \partial \vec{ z }_{ l } }{ \partial W_{ l } } = ( \vec{ a }_{ l - 1 } )$.结果理应是一个矩阵,其实就是这个列向量不断复制若干遍,或者写成$( \vec{ a }_{ l - 1 } )^t M ( 1 )$,其中$M ( 1 )$是全$1$矩阵.</p>
</li>
<li><p>$\frac{ \partial \vec{ z }_{ l } }{ \partial \vec{ b }_{ l } } = 1$.</p>
</li>
</ol>
<p>我们应当见到:</p>
<p>不妨设$\delta_l = \frac{ \partial{ \mathcal{ L } } }{ \partial \vec{ z }_l }$.见到:</p>
<ol>
<li><p>$\delta_L = \frac{ \partial \mathcal{ L } }{ \partial \vec{ z }_L } = \frac{ \partial \mathcal{ L } }{ \partial \vec{ a }_L } \frac{ \partial \vec{ a }_L }{ \partial \vec{ z }_L } = ( \vec{ a }_{ L } - \vec{ y } ) \circ \vec{ a }_{ L } \circ ( 1 - \vec{ a }_{ L } )$.前者会因为误差函数的选取而改变,后者会因为激活函数的选取而改变.</p>
</li>
<li><p>$\delta_l = \frac{ \partial{ \mathcal{ L } } }{ \partial \vec{ z }_l } = \delta_{ l + 1 } \frac{ \partial \vec{ z }_{ l + 1 } }{ \partial \vec{ z }_l } = \delta_{ l + 1 } \circ ( W_{ l + 1 } )^t \times ( \vec{ a }_{ l } \circ ( 1 - \vec{ a }_{ l } ) )$.</p>
</li>
<li><p>$\frac{ \partial \mathcal{ L } }{ \partial W_{ l } } = \frac{ \partial \mathcal{ L } }{ \partial \vec{ z }_{ l } } \frac{ \partial \vec{ z }_l }{ \partial W_{ l } } = \delta_l \times a_{ l - 1 }^t$.</p>
</li>
<li><p>$\frac{ \partial \mathcal{ L } }{ \partial \vec{ b }_l } = \delta_l$.</p>
</li>
</ol>
<p>如此以上更新即可.</p>
<h3><span id="卷积神经网络cnn">卷积神经网络(CNN)</span></h3><p>神经网络受矩阵乘法的限制,导致对于真实的尺寸巨大的图像难以快速识别,因此产生了卷积神经网络的概念,大概有以下特征:</p>
<ol>
<li><p>空间上权值共享:不同位置使用同一个卷积核(滤波器)</p>
</li>
<li><p>稀疏链接:每一层只链接前一层的感受野.</p>
</li>
<li><p>等变表示:卷积神经网络有某种平移不变性.</p>
</li>
</ol>
<p>对于2D卷积,其公式如下:</p>
<script type="math/tex; mode=display">
S_{ r , c } = ( X * W )_{ r , c } = \sum_i \sum_j X_{ r + i , c + j } \times w_{ i , j }</script><p>其中$W$是卷积核,$X$是输入图像,$S$是输出的结果.如果一个图像有多个通道(比如色彩层之类的),每个通道上都需要应用一个卷积核.</p>
<p>下面引入一些名词:</p>
<ol>
<li><p>input size:输入图像的尺寸.</p>
</li>
<li><p>padding:填充的像素数.</p>
</li>
<li><p>filter size:卷积核的尺寸.有时也写作两个变量:filter height和filter width.3D卷积还会有一个filter depth的变量.</p>
</li>
<li><p>stride:步长.</p>
</li>
<li><p>output size:卷积后输出的尺寸.有时也写作feature size.</p>
</li>
<li><p>input channels:输入图像的通道数.</p>
</li>
<li><p>n filters:卷积核的数量.</p>
</li>
<li><p>dilation rate:膨胀率,用于空洞卷积.膨胀率为$d$的时候,卷积核中间会插入$d - 1$个$0$间隔.</p>
</li>
</ol>
<h4><span id="感受野计算">感受野计算</span></h4><p>先看output size的计算,容易见到,其各个维度方面计算是独立的.只要对于单个维度算出卷积核在上面移动的次数,最后将不同维度相乘即可.</p>
<p>对于单个维度,这个维度的移动次数应该是:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\text{ output \_ size } & = \lceil \frac{ \text{ input \_ size } + 2 \times \text{ padding } - \text{ filter \_ size } + 1 }{ \text{ stride } } \rceil \\
& = \lfloor \frac{ \text{ input \_ size } + 2 \times \text{ padding } - \text{ filter \_ size } }{ \text{ stride } } \rfloor + 1 \\

\end{aligned}</script><p>这个公式相当容易理解,原因是$\text{ stride } = 1$的时候,上面恰好是移动的次数,而$\text{ stride }$变化的时候,当然要拿到一个上取整.</p>
<p>至于所谓的空洞卷积,只需在上面的基础上改$\text{ filter _ size }$就好.</p>
<p>至于乘法操作,每得到一个$\text{ output }$当然都会需要$\text{ filter _ size }$次乘法操作.</p>
<p>再看感受野的计算,不妨设$S_i$为前$i$次卷积的$\text{ stride }$的乘积,设$k_{ i + 1 }$表示第$i + 1$层的$\text{ kernel _ size }$,则:</p>
<script type="math/tex; mode=display">
RF_{ i + 1 } = RF_i + ( k_{ i + 1 } - 1 ) \times S_i</script><p>这个公式的含义大概是每次先看对应了多大的原数据上的范围,再把原本的边界$RF_i$给补上.</p>
<h4><span id="池化pooling">池化(Pooling)</span></h4><p>池化操作它没有一个可学习的参数,只是对输入数据进行固定的操作.简单来说就是降低输入的规模,以实现更好的鲁棒性以及提高效率.</p>
<p>常见的池化操作包括:</p>
<ol>
<li><p>MaxPooling:取区域内的最大值.</p>
</li>
<li><p>MeanPooling:取区域内的平均值.</p>
</li>
<li><p>PyramidPooling:多次进行尺度不同的池化.</p>
</li>
</ol>
<h4><span id="常见卷积架构">常见卷积架构</span></h4><h5><span id="alexnet">AlexNet</span></h5><p>首次引入ReLU激活函数,Dropout 技术,以及数据增强,提高了模型的训练效率和泛化能力.</p>
<p>采用了$8$层深的网络结构,证明了深度网络的潜力.</p>
<h5><span id="vgg">VGG</span></h5><p>开始堆叠小尺寸的卷积核,获得与大卷积核相似的感受野的同时可以增加网络深度.</p>
<h5><span id="resnet">ResNet</span></h5><p>引入残差的概念,直接将输入数据累加(跳跃连接)到最后的输出中,这样网络学习的实际上是输入和输出之间的残差,从而提高了网络学习能力.</p>
<h5><span id="squeezenet">SqueezeNet</span></h5><p>SqueezeNet的基本构建单元是Fire模块.Fire模块由一个squeeze层和一个expand层组成.squeeze层使用$1 \times 1$卷积核减少通道数,而expand层则使用$1 \times 1$和$3 \times 3$卷积核增加通道数.这种设计有效地减少了参数数量和计算量.</p>
<h5><span id="mobilenet">MobileNet</span></h5><ol>
<li><p>深度卷积:在这个操作中,每个输入通道独立地进行卷积,这意味着在进行卷积时,不同通道之间没有交互.这样可以减少计算量和参数数量.</p>
</li>
<li><p>逐点卷积:逐点卷积使用$1 \times 1$的卷积核,它作用在深度卷积的输出上,将不同通道的信息整合在一起.逐点卷积可以减少参数数量,同时保持较高的性能.</p>
</li>
</ol>
<h5><span id="shufflenet">ShuffleNet</span></h5><ol>
<li><p>组卷积(Group Convolution):将通道分成几个组,并使用不同的卷积神经网络层执行标准卷积.</p>
</li>
<li><p>打乱层(Shuffle layer):通过对通道进行洗牌,将不同组的信息合并.</p>
</li>
</ol>
<h5><span id="反卷积">反卷积</span></h5><p>也就是将较小的数据特征图扩大到较大的尺寸.有的时候也把这个操作说成上采样.</p>
<ol>
<li><p>插值步骤(Interpolation Step):首先,在输入特征图的元素之间插入零,增加特征图的尺寸.</p>
</li>
<li><p>卷积步骤(Convolution Step):接下来,对扩大后的特征图应用一个标准的卷积操作.此步骤相当于在扩大的特征图上滑动卷积核,计算卷积输出.</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">LWLAymh</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"my-repository-jade-beta-79.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"有什么想法?","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/page/6/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

  <!-- 音乐播放器 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.css">
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.0/dist/APlayer.min.js"></script>
  <div id="aplayer" class="aplayer" data-id="7637648380" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#F58EA8"></div>
  <script src="https://unpkg.com/meting@1.2/dist/Meting.min.js"></script>
  <!-- 音乐播放器 end -->
</body>
</html>
