<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>LWLAymh的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="离散概率">
<meta property="og:type" content="article">
<meta property="og:title" content="LWLAymh的博客">
<meta property="og:url" content="http://lwlaymh.github.io/2022/08/25/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/index.html">
<meta property="og:site_name" content="LWLAymh的博客">
<meta property="og:description" content="离散概率">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-25T12:46:45.540Z">
<meta property="article:modified_time" content="2022-08-25T12:47:20.217Z">
<meta property="article:author" content="LWLAymh">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LWLAymh的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LWLAymh的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://LWLAymh.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-概率与期望" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/25/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/" class="article-date">
  <time class="dt-published" datetime="2022-08-25T12:46:45.540Z" itemprop="datePublished">2022-08-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="离散概率"><a href="#离散概率" class="headerlink" title="离散概率"></a>离散概率</h2><span id="more"></span>
<h3 id="基本定义"><a href="#基本定义" class="headerlink" title="基本定义"></a>基本定义</h3><p>概率空间$\Omega$:在一个给定问题中可能发生的所有情况.</p>
<p>事件:$\Omega$的一个子集.</p>
<p>基本事件$\omega$:$\Omega$中的单个元素,也可以看作集合大小为$1$的事件.</p>
<p>概率:若$\omega\in \Omega$,我们称它发生的概率为$\Pr(\omega)$,有$\Pr(\omega)\geq 0$且$\sum_{\omega\in\Omega}\Pr(\omega)=1$.</p>
<p>随机变量:在概率空间的基本事件上定义的函数.</p>
<p>联合分布:如果两个随机变量$X$和$Y$定义在同一个概率空间$\Omega$上,对于每一个在$X$取值范围内的$x$以及在$Y$取值范围内的$y$,我们称$\Pr(X=x\and Y=y)$为它们的联合分布.</p>
<p>独立:如果对于每一个在$X$取值范围内的$x$以及在$Y$取值范围内的$y$,$\Pr(X=x\and Y=y)=\Pr(X=x)\times \Pr(Y=y)$,我们称$X$和$Y$是独立的.</p>
<p>期望(均值)$E X$:我们设概率空间上的随机变量$X$的期望$EX=\sum_{x\in X(\Omega)}x\times \Pr(X=x)=\sum_{w\in\Omega}X(\omega)\Pr(\omega)$.</p>
<p>中位数:我们设概率空间上的随机变量$X$的中位数为满足$\Pr(X\leq x)\geq 0.5\and \Pr(X\geq x)\geq 0.5$的$x\in X(\Omega)$所组成的集合.</p>
<p>众数:我们设概率空间上的随机变量$X$的众数为满足$\Pr(X= x)\geq \Pr(X=x’),\forall x’\in X(\Omega)$的$x\in X(\Omega)$所组成的集合.</p>
<p>方差$VX$:我们设概率空间上的随机变量$X$的方差$VX=E((X-EX)^2)$.</p>
<p>标准差$\sigma$:我们设概率空间上的随机变量$X$的标准差$\sigma=\sqrt{VX}$.</p>
<h3 id="期望的简单运算"><a href="#期望的简单运算" class="headerlink" title="期望的简单运算"></a>期望的简单运算</h3><p>如果$X,Y$是定义在同一个概率空间上的两个随机变量,那么:</p>
<ol>
<li>$E(X+Y)=EX+EY$.</li>
<li>$E(\alpha X)=\alpha EX$.</li>
<li>如果$X$和$Y$互相独立,那么$E(XY)=(EX)(EY)$.</li>
</ol>
<p>上述法则都可以通过期望的定义简单证明.</p>
<h3 id="方差的简单运算"><a href="#方差的简单运算" class="headerlink" title="方差的简单运算"></a>方差的简单运算</h3><p>我们考虑方差的定义式:</p>
<script type="math/tex; mode=display">
E((X-EX)^2)=E(X^2-2X(EX)+(EX)^2)\\
=E(X^2)-2(EX)(EX)+(EX)^2\\
=E(X^2)-(EX)^2</script><p>也即:方差等于随机变量平方的均值减均值的平方.</p>
<p>当$X$和$Y$为独立的随机变量时,我们有:</p>
<script type="math/tex; mode=display">
V(X+Y)=E((X+Y)^2)-(EX+EY)^2\\
=E((X+Y)^2)-(EX)^2-2(EX)(EY)-(EY)^2</script><p>而又有:</p>
<script type="math/tex; mode=display">
E((X+Y)^2)=E(X^2+2XY+Y^2)\\
=E(X^2)+2(EX)(EY)+E(Y^2)</script><p>则:</p>
<script type="math/tex; mode=display">
V(X+Y)=E(X^2)+2(EX)(EY)+E(Y^2)-(EX)^2-2(EX)(EY)-(EY)^2
\\=VX+VY</script><p>即:独立随机变量之和的方差等于它们的方差之和.</p>
<p>接下来,我们可以得到切比雪夫不等式:</p>
<script type="math/tex; mode=display">
\Pr((X-EX)^2\geq \alpha)\leq \cfrac{VX}{\alpha},\alpha>0</script><p>证明如下:</p>
<script type="math/tex; mode=display">
VX=\sum_{\omega\in \Omega}(X(\omega)-EX)^2\Pr(\omega)\\
\geq \sum_{\omega\in\Omega}(X(\omega)-EX)^2\Pr(\omega)[(X(\omega)-EX)^2\geq \alpha]\\
\geq \sum_{\omega\in\Omega}\alpha\Pr(\omega)[(X(\omega)-EX)^2\geq \alpha]\\=\alpha \Pr((X-EX)^2\geq \alpha)</script><p>如果我们用$c^2VX$代替$\alpha$,我们就有:</p>
<p>$\Pr(|X-EX|\geq c\sigma)\leq \cfrac{1}{c^2}$.</p>
<p>简单来说,这个不等式说明:$X$落在$(EX-c\sigma,EX+c\sigma)$之外的概率至多为$\cfrac{1}{c^2}$.</p>
<p>另外,如果我们取$n$个独立的样本$X_1,X_2,…,X_n$,令$S=\sum_{i=1}^nX_i$,那么它的均值是$nEX$,标准差是$\sqrt n\sigma$,也就是说,$\cfrac{S}{n}$落在$(EX-\cfrac{c\sigma}{\sqrt n},EX+\cfrac{c\sigma}{\sqrt n})$之外的概率小于等于$\cfrac{1}{c^2}$.</p>
<h3 id="随机抽样调查"><a href="#随机抽样调查" class="headerlink" title="随机抽样调查"></a>随机抽样调查</h3><p>如果我们随机取得了$n$个值$X_1,X_2,…,X_n$,那么我们可以通过这些值来估计概率空间的期望和方差.</p>
<p>$\hat EX=\cfrac{\sum_{i=1}^nX_i}{n}$.</p>
<p>$\hat VX=\cfrac{\sum_{i=1}^nX_i^2}{n-1}-\cfrac{(\sum_{i=1}^nX_i)^2}{n(n-1)}$.</p>
<p>这里的$\hat VX$似乎与定义不是那么相符.但是它拥有更好的性质:$E(\hat VX)=VX$.</p>
<p>证明如下:</p>
<script type="math/tex; mode=display">
E(\hat VX)=\cfrac{1}{n-1}E(\sum_{i=1}^nX_i^2-\cfrac{1}{n}\sum_{j=1}^n\sum_{k=1}^nX_jX_k)\\
=\cfrac{1}{n-1}(\sum_{i=1}^nE(X_i^2)-\cfrac{1}{n}\sum_{i=1}^n\sum_{j=1}^nE(X_iX_j))\\
=\cfrac{1}{n-1}(\sum_{i=1}^nE(X^2)-\cfrac{1}{n}\sum_{i=1}^n\sum_{j=1}^n((EX)^2[j\ne k]+E(X^2)[j=k]))\\
=\cfrac{1}{n-1}(nE(X^2)-\cfrac{1}{n}(nE(X^2)+n(n-1)(EX)^2))\\
=E(X^2)-(EX)^2\\
=VX</script><h3 id="条件概率"><a href="#条件概率" class="headerlink" title="条件概率"></a>条件概率</h3><p>已知事件B发生时事件A发生的概率为$P(A|B)=\frac{P(AB)}{P(B)}\\$.</p>
<p>贝叶斯公式:如果有$\{B_i\}$是样本空间的一个划分,即$\forall i,j$,有$B_i\cap B_j=\empty$,并且有$\bigcup_{i=1}^nB_i=\Omega$.则有$P(B_i|A)=\frac{P(AB_i)}{P(A)}=\frac{P(AB_i)}{P(A)\sum P(B_j)}=\frac{P(A B_i)}{\sum_{j=1}^n P(A B_j)}=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^n P(A|B_j)P(B_j)}\\$.</p>
<p>简化形式:$P(B|A)=\frac{P(A|B)P(B)}{P(A)}\\$.</p>
<h3 id="概率生成函数"><a href="#概率生成函数" class="headerlink" title="概率生成函数"></a>概率生成函数</h3><p>如果$X$是定义在概率空间$\Omega$上的随机变量,那么它的概率生成函数为$G_X(z)=\sum_{k\geq 0}\Pr(X=k)z^k=E(z^X)$.</p>
<p>不难发现$G_X(z)$需要满足的条件:所有系数都非负并且$G_X(1)=1$.</p>
<p>我们发现,当我们定义了概率生成函数后,期望和方差都可以使用它来表示:</p>
<script type="math/tex; mode=display">
EX=G_X'(1)\\
E(X^2)=G''_X(1)+G_X'(1)\\
VX=G_X''(1)+G_X'(1)-(G_X'(1))^2</script><p>通常,我们也可以将方差和均值的定义扩展到任意函数上,于是我们定义:</p>
<script type="math/tex; mode=display">
Mean(G)=G'(1)\\
Var(G)=G''(1)+G'(1)-(G'(1))^2</script><p>不过,求导的过程可能会有些麻烦,但我们可以直接使用泰勒定理:</p>
<script type="math/tex; mode=display">
G(1+t)=\sum_{i\geq 0}\cfrac{G^{(i)}(1)}{i!}t^i</script><p>另外,我们不难发现:$G_{X+Y}(z)=G_X(z)G_Y(z)$.</p>
<p>根据前面的推导,我们有:</p>
<script type="math/tex; mode=display">
Mean(G_{X+Y})=Mean(G_X)+Mean(G_Y)\\
Var(G_{X+Y})=Var(G_X)+Var(G_Y)</script><p>换句话说,若$G_X(1)=1,G_Y(1)=1$,那么这个式子与直接对$G_{X+Y}$使用求导的那个公式是等价的.注意,这里并没有要求这些生成函数的系数是非负的.</p>
<p>于是我们有了另一个法则:</p>
<script type="math/tex; mode=display">
Mean(G_X)=Mean(G_{X+Y})-Mean(G_Y)\\
Var(G_X)=Var(G_{X+Y})-Var(G_Y)</script><h4 id="Example1"><a href="#Example1" class="headerlink" title="Example1"></a>Example1</h4><p>一枚硬币正面向上的概率为$p$,反面向上的概率为$q$,设硬币正面向上为H,反面向上为T,不断抛掷硬币直到抛掷出连续的THTTH为止,求期望次数.</p>
<p>考虑设$N$为所有不包含THTTH的硬币序列的生成函数,$S$为所有结尾为THTTH的硬币序列的生成函数,令$H=pz,T=qz$,$1$为空集,我们显然有:</p>
<script type="math/tex; mode=display">
1+N\times (H+T)=N+S\\
N\times THTTH=S+S\times TTH</script><p>解方程即可.</p>
<p>另外不难发现,这种方法取决于字符串的所有border,显然是通用方法.</p>
<p>我们考虑扩展这个方法,设$A$是我们要找到的字符串,$m$是它的长度,令$A^{(k)}$表示$A$字符串的前$k$个字符所组成的字符串,$A_{(k)}$表示$A$字符串的后$k$个字符所组成的字符串.这样的形式与$k$阶导的形式可能会起冲突,但至少在接下来我们的式子中不会出现导数<del>(好吧其实是因为《具体数学》上就这么写的我也懒得改了)</del>.</p>
<p>我们的方程将会变为:</p>
<script type="math/tex; mode=display">
1+N(H+T)=N+S\\
N\times A=S(\sum_{k=0}^{m-1}A^{(k)}[A^{(m-k)}=A_{(m-k)}])</script><p>如果我们设$\tilde A$为将字符串$A$中的H替换成$\cfrac{1}{p}z$,T替换成$\cfrac{1}{q}z$之后的值,那么显然有:</p>
<script type="math/tex; mode=display">
N\times A=A\times S\times (\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}])\\
N=S\times (\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}])\\
\cfrac{S-1}{H+T-1}=S\times (\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}])\\
S\times(1+(1-H-T)\times (\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}]))=1</script><p>这显然是一个卷积的形式.</p>
<p>令$w=\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}]$.</p>
<p>令$H(z)=1$,$F(z)=(1+(1-z)\times w)$,$G(z)=S$.</p>
<p>那么我们显然可以直接求$G(z)$的期望和方差,事实上:</p>
<script type="math/tex; mode=display">
EX=\sum_{k=1}^{m}\tilde A_{(k)}[A^{(k)}=A_{(k)}]\\
VX=(EX)^2-\sum_{k=1}^m(2k-1)\tilde A_{(k)}[A^{(k)}=A_{(k)}]</script><p>如果硬币是均匀的($p=q=\cfrac 1 2$)我们引入另一个符号:我们设$A:A=\sum_{k=1}^m2^{k-1}[A^{(k)}=A_{(k)}]$.那么显然期望需要的抛硬币次数就是$2(A:A)$.</p>
<h4 id="Example2-Penney游戏"><a href="#Example2-Penney游戏" class="headerlink" title="Example2(Penney游戏)"></a>Example2(Penney游戏)</h4><p>一枚均匀硬币,设硬币正面向上为H,反面向上为T.不断扔硬币直到扔出连续的HHT或HTT为止,求最后以HHT结尾的概率.</p>
<p>我们设$S_A$为所有以HHT结尾的硬币序列的生成函数,设$S_B$为所有以HTT结尾的硬币序列的生成函数.$N$为其它的硬币序列的生成函数,令$H=T=0.5z$.</p>
<p>我们显然有:</p>
<script type="math/tex; mode=display">
1+N(H+T)=N+S_A+S_B\\
N\times HHT=S_A\\
N\times HTT=S_A\times T+S_B</script><p>解方程并带入$z=1$,可以有得知以HHT结尾的概率为$\cfrac{2}3$.</p>
<p>事实上,我们使用类似Example1的方法,设这两个硬币序列分别为$A$和$B$,那么可以求出:</p>
<script type="math/tex; mode=display">
\cfrac{S_A}{S_B}=\cfrac{B:B-B:A}{A:A-A:B}</script><h3 id="二项式分布"><a href="#二项式分布" class="headerlink" title="二项式分布"></a>二项式分布</h3><p>现在有一个大小为$n+1$的概率空间,其中$\Pr(\omega_k)=\binom{n}{k}p^kq^{n-k}\\$,我们把这样的概率序列称为二项式分布.</p>
<p>如果我们令$H(z)=q+pz$,不难发现二项式分布的生成函数为$H(z)^n$.</p>
<p>不难发现,满足二项式分布的随机变量的均值是$np$,方差是$npq$.</p>
<p>与二项式分布相对应的还有负二项式分布,它的生成函数形如:$G(z)^n=(\cfrac{p}{1-qz})^n=\sum_{k}\binom{n+k-1}{k}p^nq^kz^k$.</p>
<p>我们考虑如何求$G(z)$的方差和均值,不妨设$F(z)=\cfrac{1-qz}{p}=\cfrac{1}{p}-\cfrac{q}{p}z$,则$G(z)^n=F(z)^{-n}$.</p>
<p>不难发现$F(z)$满足二项式分布.也就是说,以$(n,p,q)$为参数的负二项式分布也就是以$(-n,-\cfrac{q}{p},\cfrac{1}{p})$为参数的二项式分布.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://lwlaymh.github.io/2022/08/25/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/" data-id="cl791j4g600051gvt7kt5h8jz" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/08/15/%E5%92%8C%E5%BC%8F/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/25/%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/15/%E5%92%8C%E5%BC%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E5%8D%9A%E5%BC%88%E8%AE%BA/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E6%95%B4%E5%80%BC%E5%87%BD%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 LWLAymh<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>