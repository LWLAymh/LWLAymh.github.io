<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>LWLAymh的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="对于定义在\mathbb{Z}上的二元函数w 若对定义域上任意a,b,c,d(a\leq b\leq c\leq d)都有w(a,c)+w(b,d)\leq w(a,d)+w(b,c) 则称函数w满足四边形不等式 \begin{array}{c} 定理：若二元函数w(x,y)满足w(a,b)+w(a+1,b+1)\leq w(a,b+1)+w(a+1,b)，其中a">
<meta property="og:type" content="article">
<meta property="og:title" content="LWLAymh的博客">
<meta property="og:url" content="http://lwlaymh.github.io/2022/08/14/%E5%9B%9B%E8%BE%B9%E5%BD%A2%E4%B8%8D%E7%AD%89%E5%BC%8F/index.html">
<meta property="og:site_name" content="LWLAymh的博客">
<meta property="og:description" content="对于定义在\mathbb{Z}上的二元函数w 若对定义域上任意a,b,c,d(a\leq b\leq c\leq d)都有w(a,c)+w(b,d)\leq w(a,d)+w(b,c) 则称函数w满足四边形不等式 \begin{array}{c} 定理：若二元函数w(x,y)满足w(a,b)+w(a+1,b+1)\leq w(a,b+1)+w(a+1,b)，其中a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-14T14:25:04.338Z">
<meta property="article:modified_time" content="2022-04-27T09:24:30.969Z">
<meta property="article:author" content="LWLAymh">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LWLAymh的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LWLAymh的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://LWLAymh.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-四边形不等式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/14/%E5%9B%9B%E8%BE%B9%E5%BD%A2%E4%B8%8D%E7%AD%89%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2022-08-14T14:25:04.338Z" itemprop="datePublished">2022-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <script type="math/tex; mode=display">
对于定义在\mathbb{Z}上的二元函数w</script><script type="math/tex; mode=display">
若对定义域上任意a,b,c,d(a\leq b\leq c\leq d)都有w(a,c)+w(b,d)\leq w(a,d)+w(b,c)</script><script type="math/tex; mode=display">
则称函数w满足四边形不等式</script><script type="math/tex; mode=display">
\begin{array}{c}
定理：若二元函数w(x,y)满足w(a,b)+w(a+1,b+1)\leq w(a,b+1)+w(a+1,b)，其中a<a+1\leq b<b+1\\
则w满足四边形不等式
\\
\\
证明：\\
对于a+1<c 有\\
w(a,c)+w(a+1,c+1)\leq w(a,c+1)+w(a+1,c)\\
w(a+1,c+1)\leq w(a,c+1)+w(a+1,c)-w(a,c)\\
同时有\\
w(a+1,c)+w(a+2,c+1)\leq w(a+1,c+1)+w(a+2,c)\\
w(a+1,c)+w(a+2,c+1)-w(a+2,c)\leq w(a+1,c+1)\\
联立得到\\
w(a+1,c)+w(a+2,c+1)-w(a+2,c)\leq w(a,c+1)+w(a+1,c)-w(a,c)\\
w(a+2,c+1)+w(a,c)\leq w(a+1,c)+w(a+2,c+1)
\\
同理可推至四边形不等式定义式
\end{array}</script><script type="math/tex; mode=display">
\begin{array}{c}
对于形如f_i=\min_{1 \leq j<i}\{f_j+w(j,i)\}的状态转移方程，记p_i为f_i的最优决策\\
若p在[1,n]上单调不降，则称f具有决策单调性\\
\\
定理：对于形如f_i=\min_{1 \leq j<i}{f_j+w(j,i)}的状态转移方程\\
若w满足四边形不等式，则f有决策单调性\\
\\
证明：\\
\\
\forall i\in[1,n],\forall j\in[0,p_i-1]，根据p的定义，有：\\
f_{p_i}+w(p_i,i)\leq f_j+w(j,i)\\
f_{p_i}-f_j\leq w(j,i)-w(p_i,i)\\
而对于k\in[i+1,n]，根据w的四边形不等式，有：\\
w(j,i)+w(p_i,k)\leq w(j,k)+w(p_i,i)\\
w(j,i)-w(p_i,i)\leq w(j,k)-w(p_i,k)\\
联立得到：\\
f_{p_i}-f_j\leq w(j,k)-w(p_i,k)\\
f_{p_i}+w(p_i,k)\leq w(j,k)+f_j\\
即：j对k的更新一定不如p_i对k的更新更优\\
因此p_k\in[p_i,n]\\
因此f有决策单调性
\end{array}</script><script type="math/tex; mode=display">
对于形如f_{x,j}=\min_{i=1}^{x-1}\{f_{i,j-1}+w_{i,x}\}的状态转移方程，若w满足四边形不等式，则f有决策单调性\\
证明同上</script><script type="math/tex; mode=display">
\begin{array}{c}
定理1：在状态转移方程f_{i,j}=\min_{i\leq k<j}\{f_{i,k}+f_{k+1,j}+w(i,j)\}中（通常f_{i,i}=w(i,i)=0，f_{i,i+1}=w_{i,i+1}）\\
如果w满足四边形不等式，且对于任意的a\leq b\leq c\leq d，有w(b,c)\leq w(a,d)，那么f也满足四边形不等式\\
\\
证明：\\
显然，设j=i+1，则有f_{i,j+1}+f_{i+1,j}=f_{i,i+2}\\
\\
若f_{i,i+2}的最优决策是i，则有：\\
f_{i,i+2}=f_{i,i}+f_{i+1,i+2}+w(i,i+2)\\=w(i+1,i+2)+w(i,i+2)\\
\geq w(i+1,i+2)+w(i,i+1)\\=f_{i+1,i+2}+f_{i,i+1}\\=f_{i+1,j+1}+f_{i,j}\\
若f_{i,i+2}的最优决策是i+1，则有：\\
f_{i,i+2}=f_{i,i+1}+f_{i+2,i+2}+w(i,i+2)\\=w(i,i+1)+w(i,i+2)\\
\geq w(i,i+1)+w(i+1,i+2)\\=f_{i,i+1}+f_{i+1,i+2}\\=f_{i,j}+f_{i+1,j+1}\\
则当b-a=1时，满足四边形不等式
\\
使用数学归纳，假设当b-a<k时，f满足四边形不等式，考虑j-i=k的情况\\
设f_{i,j+1}的最优决策为x，f_{i+1,j}的最优决策为y\\
则有：f_{i,j+1}+f_{i+1,j}=f_{i,x}+f_{x+1,j+1}+w(i,j+1)+f_{i+1,y}+f_{y+1,j}+w(i+1,j)\\
对于f_{i,j}和f_{i+1,j+1}来说，x和y不一定最优，所以有：\\
f_{i,j}+f_{i+1,j+1}\leq f_{i,x}+f_{x+1,j}+w(i,j)+f_{i+1,y}+f_{y+1,j+1}+w(i+1,j+1)\\
w和归纳假设都可以使右边的式子改变，最终得到：f_{i,j}+f_{i+1,j+1}\leq f_{i,j+1}+f_{i+1,j}\\
\\
\\
\\
定理2：记p_{i,j}为f_{i,j}的最优决策，若f满足四边形不等式，那么对于\forall i<j，有p_{i,j-1}\leq p_{i,j}\leq p_{i+1,j}\\
\\
证明：\\
记p=p_{i,j}对于\forall k，i<k\leq p，因为f满足四边形不等式，所以有：\\
f_{i,k}+f_{i+1,p}\leq f_{i,p}+f_{i+1,k}\\
根据p定义，有：\\
f_{i,p}+f_{p+1,j}\leq f_{i,k}+f_{k+1,j}\\
由上两式移项联立，得到：\\
f_{i+1,p}-f_{i+1,k}\leq f_{k+1,j}-f_{p+1,j}\\
f_{i+1,p}+f_{p+1,j}\leq f_{i+1,k}+f_{k+1,j}\\
f_{i+1,p}+f_{p+1,j}+w_{i+1,j}\leq f_{i+1,k}+f_{k+1,j}+w_{i+1,j}\\
因此对于f_{i+1,j}，p比任意的k<p更优，因此p_{i+1,j}\geq p_{i,j}\\
另一方向同理
\end{array}</script>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://lwlaymh.github.io/2022/08/14/%E5%9B%9B%E8%BE%B9%E5%BD%A2%E4%B8%8D%E7%AD%89%E5%BC%8F/" data-id="cl6tfaaft0005rovt9h5sddsp" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/08/14/%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2022/08/14/%E6%95%B0%E8%AE%BA/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/14/%E5%8D%9A%E5%BC%88%E8%AE%BA/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E6%95%B4%E5%80%BC%E5%87%BD%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/14/%E5%9B%9B%E8%BE%B9%E5%BD%A2%E4%B8%8D%E7%AD%89%E5%BC%8F/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 LWLAymh<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>