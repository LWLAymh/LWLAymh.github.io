<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>LWLAymh的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="特殊的数">
<meta property="og:type" content="article">
<meta property="og:title" content="LWLAymh的博客">
<meta property="og:url" content="http://lwlaymh.github.io/2022/08/14/%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0/index.html">
<meta property="og:site_name" content="LWLAymh的博客">
<meta property="og:description" content="特殊的数">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-14T14:25:04.376Z">
<meta property="article:modified_time" content="2022-08-25T12:47:38.512Z">
<meta property="article:author" content="LWLAymh">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="LWLAymh的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LWLAymh的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://LWLAymh.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-特殊的数" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/14/%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0/" class="article-date">
  <time class="dt-published" datetime="2022-08-14T14:25:04.376Z" itemprop="datePublished">2022-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="特殊的数"><a href="#特殊的数" class="headerlink" title="特殊的数"></a>特殊的数</h1><span id="more"></span>
<h2 id="二项式系数"><a href="#二项式系数" class="headerlink" title="二项式系数"></a>二项式系数</h2><h3 id="上升幂和下降幂"><a href="#上升幂和下降幂" class="headerlink" title="上升幂和下降幂"></a>上升幂和下降幂</h3><p>定义下降幂$x^{\underline{k}}=\prod_{i=0}^{k-1}(x-i)=\frac{x!}{(x-k)!}$.</p>
<p>定义上升幂$x^{\overline{k}}\prod_{i=0}^{k-1}(x+i)=\frac{(x+k-1)!}{(x-1)!}$.</p>
<p>上升幂和下降幂的定义是可以引申到复数域的.</p>
<p>例如我们有加倍公式:$r^{\underline{k}}(r-0.5)^{\underline{k}}=\cfrac{(2r)^{\underline{2k}}}{2^{2k}},k\in\mathbb{N}$.</p>
<p>他们之间存在转换:$x^{\underline{n}}=(-1)^n(-x)^{\overline{n}}$.</p>
<p>同时存在大小关系:$x^{\underline{n}}\leq x^n\leq x^{\overline{n}}$,其中$0\leq n&lt;x$.</p>
<h3 id="二项式系数的定义"><a href="#二项式系数的定义" class="headerlink" title="二项式系数的定义"></a>二项式系数的定义</h3><p>考虑令$\binom{n}{m}$表示从一个大小为$n$的子集中选出大小为$m$的子集的方案数.第一次有$n$个选择,第二次有$n-1$个选择……第m次有$n-m+1$个选择.而由于可能可以选择重复的,但一个排列被重复选择的次数显然是$m!$,因此显然有$\binom{n}m=\cfrac{n^{\underline{m}}}{m!}$.</p>
<p>如果我们把它的定义拓展到复数域,我们有:</p>
<p>$\binom{r}{k}=\begin{cases}\cfrac{r^{\underline{k}}}{k!}&amp;k\geq 0\\0&amp;k&lt;0\end{cases},r\in\mathbb{C},k\in\mathbb{Z}$.</p>
<p>值得一提的是,如果我们这么定义,本质上其实是把$\binom{r}k$看作了一个关于$r$的$k$次多项式.</p>
<p>另外根据定义,$r\in\mathbb{Z}\and r&lt;k$时,该公式给出$0$.</p>
<p>值得一提的是,为了使二项式系数在面对$0$的时候更加简洁,通常直接定义$0!=1,0^0=1$.</p>
<h3 id="二项式系数恒等式"><a href="#二项式系数恒等式" class="headerlink" title="二项式系数恒等式"></a>二项式系数恒等式</h3><ol>
<li>阶乘展开式:$\binom{n}{m}=\cfrac{n!}{k!(n-k)!},n,k\in\mathbb{N},n\geq k\\$.</li>
</ol>
<p>证明根据定义是显然的.</p>
<ol>
<li>对称恒等式:$\binom{n}{k}=\binom{n}{n-k},n\in\mathbb{N},k\in\mathbb{Z}\\$.</li>
</ol>
<p>根据$(1)$,$0\leq k\leq n$时是显然的.而其他情况两边都会给出$0$,因此也是成立的.</p>
<ol>
<li>吸收恒等式:$\binom{r}{k}=\cfrac{r}{k}\binom{r-1}{k-1},k\in\mathbb{Z}\and k\ne 0\\$.</li>
</ol>
<p>证明根据定义是显然的.</p>
<ol>
<li>吸收恒等式的变式:$k\binom{r}{k}=r\binom{r-1}{k-1},k\in\mathbb{Z}\\$.</li>
</ol>
<p>根据$(3)$,只需要验证$k=0$的情况即可,也是显然的.</p>
<ol>
<li>相伴恒等式:$(r-k)\binom{r}{k}=r\binom{r-1}{k},k\in\mathbb{Z}\\$.</li>
</ol>
<p>证明如下:</p>
<script type="math/tex; mode=display">
(r-k)\binom{r}{k}=(r-k)\binom{r}{r-k}\\
=r\binom{r-1}{r-k-1}\\
=r\binom{r-1}{k}</script><p>问题在于:我们在上述描述中并未提到$r$的范围,但是推导过程要求$r\in\mathbb{N}$.不过,我们已经说明了二项式系数是关于$r$的$k$次多项式,因此只需要有$k+1$个$r$满足这个公式即可.而根据推导过程显然有无限个$r$满足,因此这个公式对$r\in\mathbb{C}$也是成立的.</p>
<ol>
<li>加法公式:$\binom{r}{k}=\binom{r-1}{k}+\binom{r-1}{k-1},k\in\mathbb{Z}\\$.</li>
</ol>
<p>证明可以使用定义,也可以先用$r\in\mathbb{N}$的情况给出组合意义,再使用多项式推理法证明.</p>
<ol>
<li>平行求和法:$\sum_{k\leq n}\binom{r+k}{k}=\binom{r+n+1}{n},n\in\mathbb{N}\\$.</li>
</ol>
<p>我们不妨考虑不断使用加法公式:</p>
<p>$\binom{r+n+1}{n}=\binom{r+n}{n}+\binom{r+n}{n-1}=\binom{r+n}{n}+\binom{r+n-1}{n-1}+\binom{r+n-1}{n-2}=…\\$,最终下标会减成负数,这样后面的项就全都是$0$了.</p>
<p>也可以考虑组合意义:如果$r\in\mathbb{N}$,那么我们考虑从右到左第一个没有被选上的数,假设它是$r+k+1$,那么在它右边的数全部选择了,一共是$n-k$个数,而还需要在左边的$r+k$中选择$k$个数.</p>
<ol>
<li>上指标求和法:$\sum_{0\leq k\leq n}\binom{k}{m}=\binom{n+1}{m+1},n,m\in\mathbb{N}\\$.</li>
</ol>
<p>可以组合意义解释:我们不妨假设选的最大数是$k+1$,接下来就还需要在$[1,k]$中选择$m$个.</p>
<p>如果我们将这个公式两边同时乘以$m!$,我们可以得到公式:$\sum_{0\leq k\leq n}k^{\underline{m}}=\cfrac{(n+1)^{\underline{m+1}}}{m+1},n,m\in\mathbb{N}\\$,这也就是有限微积分的公式中的一个.</p>
<ol>
<li>二项式定理:$(x+y)^r=\sum_{k}\binom{r}{k}x^ky^{r-k},r\in\mathbb{N}\or|\cfrac{x}y|&lt; 1\\$.</li>
</ol>
<p>$r\in\mathbb{N}$的情况可以使用组合意义证明,至于后半部分证明需要用到泰勒级数,暂略.</p>
<ol>
<li>$\sum_{0\leq k\leq n}\binom{n}{k}=2^n,n\in\mathbb{N}\\$.</li>
</ol>
<p>在二项式定理中令$x=y=1$即可证明.</p>
<ol>
<li>$\sum_{0\leq k\leq n}(-1)^k\binom{n}{k}=0^n,n\in\mathbb{N}\\$.</li>
</ol>
<p>在二项式定理中令$x=-1,y=1$即可证明,值得一提的是,当$n=0$的时候这个式子给出$1$,并在其他情况下给出$0$,这个式子是二项式反演的基础.</p>
<ol>
<li>上指标反转公式:$\binom{r}{k}=(-1)^k\binom{k-r-1}{k}\\$.</li>
</ol>
<p>证明根据定义是显然的.</p>
<ol>
<li>$(-1)^m\binom{-n-1}{m}=(-1)^n\binom{-m-1}{n},n,m\in\mathbb{N}\\$.</li>
</ol>
<p>根据$(12)$,这个公式两边都等于$\binom {n+m} m\\$.</p>
<ol>
<li>$\sum_{k\leq m}\binom{r}{k}(-1)^k=(-1)^m\binom{r-1}{m},m\in\mathbb{Z}\\$.</li>
</ol>
<p>证明如下:</p>
<script type="math/tex; mode=display">
\sum_{k\leq m}\binom{r}{k}(-1)^k=\sum_{k\leq m}\binom{k-r-1}{k}\\
=\binom{-r+m}{m}=(-1)^m\binom{r-1}{m}</script><ol>
<li>$\sum_{k\leq m}\binom{r}{k}(\cfrac{r}2-k)=\cfrac{m+1}2\binom{r}{m+1},m\in\mathbb{Z}\\$.</li>
</ol>
<p>可以使用归纳法证明这个公式.</p>
<ol>
<li>$\sum_{k\leq m}\binom{m+r}{k}x^ky^{m-k}=\sum_{k\leq m}\binom{-r}{k}(-x)^k(x+y)^{m-k},m\in\mathbb{Z}\\$.</li>
</ol>
<p>不妨令左边的值为$S_m$,我们有:</p>
<script type="math/tex; mode=display">
S_m=\sum_{k\leq m}\binom{m+r}{k}x^ky^{m-k}=\sum_{k\leq m}\binom{m+r-1}{k}x^ky^{m-k}+\sum_{k\leq m}\binom{m+r-1}{k-1}x^ky^{m-k}\\
=y\sum_{k<m}\binom{m-1+r}{k}x^ky^{m-1-k}+\binom{m+r-1}{m}x^m+x\sum_{k\leq m}\binom{m+r-1}{k-1}x^{k-1}y^{m-k}\\
=(x+y)S_{m-1}+\binom{m+r-1}{m}x^m\\
=(x+y)S_{m-1}+\binom{r}{m}(-x)^m</script><p>左右两边满足相同递归式,通过数学归纳法不难证明二者相等.</p>
<ol>
<li>$\sum_{k\leq m}\binom{m+k}{k}2^{-k}=2^m,m\in\mathbb{N}\\$.</li>
</ol>
<p>考虑$(16)$,将$x=y=1,r=m+1$带入,得到:</p>
<script type="math/tex; mode=display">
\sum_{k\leq m}\binom{2m+1}{k}=\sum_{k\leq m}\binom{m+k}{k}2^{m-k}\\
2^{2m}=\sum_{k\leq m}\binom{m+k}{k}2^{m-k}\\
2^m=\sum_{k\leq m}\binom{m+k}{k}2^{-k}</script><ol>
<li>三项式定理:$(x+y+z)^n=\sum_{0\leq a,b,c\leq n}[a+b+c=n]\cfrac{n!}{a!b!c!}x^ay^bz^c,n\in\mathbb{N}\\$.</li>
</ol>
<p>证明与二项式定理类似.值得一提的是,$\cfrac{n!}{a!b!c!}=\binom{n}{b+c}\binom{b+c}{c}$.</p>
<ol>
<li>多项式定理:$(\sum_{i=1}^mx_i)^n=\sum_{\forall i\in[1,m],0\leq a_i\leq n}[\sum_{i=1}^ma_i=n]\cfrac{n!}{\prod_{i=1}^ma_i!}\prod_{i=1}^mx_i^{a_i},n\in\mathbb{N}\\$.</li>
</ol>
<p>证明与二项式定理类似.</p>
<ol>
<li>$\binom{r}{m}\binom{m}{k}=\binom{r}{k}\binom{r-m}{m-k},n,k\in\mathbb{Z}\\$.</li>
</ol>
<p>证明可以使用组合意义和多项式推理法.</p>
<ol>
<li>$\sum_{k}\binom{r}{k}\binom{s}{n-k}=\binom{r+s}{n},n\in\mathbb{Z}\\$.</li>
</ol>
<p>证明可以使用组合意义和多项式推理法.</p>
<ol>
<li>范德蒙德卷积:$\sum_{k}\binom{r}{m+k}\binom{s}{n-k}=\binom{r+s}{n+m},n,m\in\mathbb{Z}\\$.</li>
</ol>
<p>证明可以使用组合意义和多项式推理法.</p>
<p>另外,这个式子可以直接使用生成函数证明.</p>
<ol>
<li>$\sum_{k}\binom{l}{m+k}\binom{s}{n+k}=\binom{l+s}{l-m+n},l\in\mathbb{N},n,m\in\mathbb{Z}\\$.</li>
</ol>
<p>有$\binom{l}{m+k}=\binom{l}{l-m-k}$,然后运用范德蒙德卷积即可得到答案.</p>
<ol>
<li>$\sum_{k}\binom{l}{m+k}\binom{s+k}{n}(-1)^k=(-1)^{l+m}\binom{s-m}{n-l},l\in\mathbb{N},n,m\in\mathbb{Z}\\$.</li>
</ol>
<p>可以数学归纳证明.</p>
<ol>
<li>$\sum_{k\leq l}\binom{l-k}{m}\binom{s}{k-n}(-1)^k=(-1)^{l+m}\binom{s-m-1}{l-n-m},l,n,m\in\mathbb{N}\\$.</li>
</ol>
<p>可以数学归纳证明.</p>
<ol>
<li>$\sum_{-q\leq k\leq l}\binom{l-k}{m}\binom{q+k}{n}=\binom{l+q+1}{m+n+1},n,m\in\mathbb{N},l+q\geq 0\\$.</li>
</ol>
<p>可以组合意义与多项式推理法证明.</p>
<ol>
<li>$\sum_{k}\binom{a+b}{a+k}\binom{a+b}{b+k}(-1)^k=\cfrac{(a+b)!}{a!b!},a,b\in\mathbb{N}\\$.</li>
</ol>
<p>可以数学归纳证明.</p>
<ol>
<li>$\sum_{k=0}^m\cfrac {\binom{m}{k}}{\binom{n}{k}}=\cfrac{n+1}{n+1-m},n,m\in\mathbb{N},n\geq m\\$.</li>
</ol>
<p>考虑恒等式$(20)$,我们有$\binom{n}{m}\binom{m}{k}=\binom{n}{k}\binom{n-k}{m-k}\\$,两边同时除以$\binom{n}{m}\binom{n-k}{m-k}\\$,于是我们得到了$\cfrac {\binom{m}{k}}{\binom{n}{k}}=\cfrac {\binom{n-k}{m-k}}{\binom{n}{m}}\\$.</p>
<p>有:</p>
<script type="math/tex; mode=display">
\sum_{k=0}^m\cfrac {\binom{m}{k}}{\binom{n}{k}}=\sum_{k=0}^m\cfrac {\binom{n-k}{m-k}}{\binom{n}{m}}\\
=\cfrac{1}{\binom{n}{m}}\sum_{k=0}^m\binom{n-k}{m-k}\\
=\cfrac{1}{\binom{n}{m}}\sum_{k=0}^m\binom{n-m+k}{k}\\
=\cfrac{\binom{n+1}{m}}{\binom{n}{m}}\\
=\cfrac{n+1}{n+1-m}</script><ol>
<li>$\binom{r}{k}\binom{r-\cfrac{1}{2}}{k}=\cfrac{\binom{2r}{2k}\binom{2k}{k}}{2^{2k}},k\in\mathbb{Z}\\$.</li>
</ol>
<p>将加倍公式两边同时除以$k!^2$即可得到这个公式.</p>
<ol>
<li>$\binom{n-\cfrac1 2}{n}=\cfrac{\binom{2n}{n}}{2^{2n}},n\in\mathbb{Z}\\$.</li>
</ol>
<p>将$(29)$中令$r=k=n$即可得到这个公式.</p>
<ol>
<li>$\binom{-\cfrac{1}2}{n}=(\cfrac{-1}{4})^n\binom{2n}{n},n\in\mathbb{Z}\\$.</li>
</ol>
<p>即$(30)$的变形.</p>
<ol>
<li>$\sum_{k}\binom{n}{2k}\binom{2k}{k}2^{-2k}=\binom{n-\cfrac 1 2}{\lfloor\cfrac{n}2\rfloor},n\in\mathbb{N}\\$</li>
</ol>
<p>首先根据$(29)$,左边$=\sum_{k}\binom{\cfrac{n}{2}}{k}\binom{\cfrac{n-1}{2}}{k}\\$,而考虑到$\cfrac{n}{2}$和$\cfrac{n-1}{2}$必有一个是自然数,因此可以直接用$(23)$化简.</p>
<ol>
<li>$\sum_{k}\binom{-\cfrac1 2}{k}\binom{-\cfrac 1 2}{n-k}=(-1)^n,n\in\mathbb{N}\\$.</li>
</ol>
<p>直接使用范德蒙德卷积即可证明.</p>
<ol>
<li>$\sum_{k}\binom{2k}{k}\binom{2n-2k}{n-k}=4^n,n\in\mathbb{N}\\$.</li>
</ol>
<p>由$(33)$和$(31)$不难推出.</p>
<ol>
<li>$\sum_{k}\binom{n}{k}\cfrac{(-1)^k}{x+k}=x^{-1}\binom{x+n}{n}^{-1},x\notin\{0,-1,…,-n\}\\$.</li>
</ol>
<p>令$f(x)=(x-1)^{\underline{-1}}$,直接做高阶差分即可得到这个式子.</p>
<ol>
<li>$\sum_{k=0}^n\binom{r}{k}\binom{r}{n-k}(-1)^k=<a href="-1">n is even</a>^{\cfrac{n}{2}}\binom{r}{\cfrac{n}2}\\$.</li>
</ol>
<p>首先不难发现,$(1-z)^r=\sum_{k\geq 0}(-1)^k\binom{r}{k}\\$.</p>
<p>考虑$(1-z)^r(1+z)^r=(1-z^2)^r$.</p>
<p>我们有$<a href="1-z">z^n</a>^r(1+z)^r=<a href="1-z^2">z^n</a>^r$,不难发现即上式.</p>
<h3 id="广义二项级数与广义指数级数"><a href="#广义二项级数与广义指数级数" class="headerlink" title="广义二项级数与广义指数级数"></a>广义二项级数与广义指数级数</h3><h4 id="卡特兰数"><a href="#卡特兰数" class="headerlink" title="卡特兰数"></a>卡特兰数</h4><p>卡特兰数$f_n$表示:长度为$2n$的合法括号序列个数.</p>
<p>卡特兰数的前几项为$1,1,2,5,14,42,132…$.</p>
<p>接下来,我们通过这个定义来证明以下其他定义方式.</p>
<p>递归定义:$f_n=\sum_{i=0}^{n-1}f_if_{n-1-i}$.</p>
<p>不妨考虑枚举一个括号序列的第一个断点,则该括号序列应形如$(A)B$.</p>
<p>考虑将其删成A和B,则A一定合法,因为若A不合法,那么这里一定不是第一个断点.</p>
<p>通项公式:$f_n=\frac 1 {n+1}C_{2n}^n=C_{2n}^n-C_{2n}^{n-1}$.</p>
<p>考虑平面直角坐标系,我们将’(‘认为是向右上走一单位长度,将’)’认为是向右下走一单位长度.</p>
<p>那么卡特兰数就相当于从$(0,0)$走到$(2n,0)$不经过第四象限的方案数.</p>
<p>考虑反射容斥,如果只是走到$(2n,0)$的方案数是$C_{2n}^n$.</p>
<p>而如果到达第四象限,说明在这条这线上存在一个点$(x,-1)$.</p>
<p>考虑将$x$以后的折线以直线$y=-1$为对称轴反转,那么终点到了$(2n,-2)$.</p>
<p>不难发现,任意从$(0,0)$走到$(2n,-2)$的方案一定唯一对应了一种从$(0,0)$走到$(2n,0)$的不合法方案.因为从$(0,0)$走到$(2n,-2)$一定会经过直线$y=-1$,将后半部分对称后就是其对应方案.而从$(0,0)$走到$(2n,-2)$的方案数为$C_{2n}^{n-1}$.</p>
<p>因而$f_n=C_{2n}^n-C_{2n}^{n-1}\\$.</p>
<p>而$C_{2n}^n-C_{2n}^{n-1}=\frac{(2n)!}{n!n!}-\frac{(2n)!}{(n-1)!(n+1)!}=\frac{(2n)!}{n!(n+1)!}=\frac{C_{2n}^n}{n+1}\\$.</p>
<p>递推定义:$f_n=\frac {4n-2}{n+1}f_{n-1}\\$.</p>
<p>使用一下上一步的通项公式:$\begin{cases}<br>f_n=\frac{(2n)!}{n!(n+1)!}\\<br>f_{n-1}=\frac{(2n-2)!}{(n-1)!(n)!}<br>\end{cases}\\$<br>不难发现$f_n=\frac{(2n-1)(2n)}{n(n+1)}f_{n-1}\\$.整理,得到$f_n=\frac{4n-2}{n+1}f_{n-1}\\$.</p>
<h3 id="二项式系数的处理"><a href="#二项式系数的处理" class="headerlink" title="二项式系数的处理"></a>二项式系数的处理</h3><h4 id="通过恒等式变形求解"><a href="#通过恒等式变形求解" class="headerlink" title="通过恒等式变形求解"></a>通过恒等式变形求解</h4><h5 id="Example1"><a href="#Example1" class="headerlink" title="Example1"></a>Example1</h5><p>即恒等式$(28)$.</p>
<h5 id="Example2"><a href="#Example2" class="headerlink" title="Example2"></a>Example2</h5><p>求$\sum_{k=0}^nk\binom{m-k-1}{m-n-1},n,m\in\mathbb{N}\and m&gt;n\\$.</p>
<p>这个式子乘了个系数$k$导致很难处理,一个自然的想法是使用吸收恒等式将$k$消去,然后对后面的式子使用上指标求和.</p>
<p>于是:</p>
<script type="math/tex; mode=display">
\sum_{k=0}^nk\binom{m-k-1}{m-n-1}=\sum_{k=0}^nm\binom{m-k-1}{m-n-1}-\sum_{k=0}^n(m-k)\binom{m-k-1}{m-n-1}\\
=m\sum_{k=0}^{m-1}\binom{m-k-1}{m-n-1}-(m-n)\sum_{k=0}^m\binom{m-k}{m-n}</script><p>不妨令$S_m=\sum_{k=0}^m\binom{m-k}{m-n}\\$,不难发现我们有:</p>
<script type="math/tex; mode=display">
S_m=\sum_{k=0}^m\binom{k}{m-n}=\binom{m+1}{m-n+1}</script><p>于是原式$=mS_{m-1}-(m-n)S_m=\cfrac{n}{m-n+1}\binom{m}{m-n}\\$.</p>
<p>不过事实上,我们有另一种方式来处理这个等式,我们直接将$k=\binom{k}{1}$带入:</p>
<script type="math/tex; mode=display">
\sum_{k=0}^nk\binom{m-k-1}{m-n-1}=\sum_{k=0}^n\binom{k}{1}\binom{m-k-1}{m-n-1}\\
=\binom{m}{m-n+1}\\
=\cfrac{n}{m-n+1}\binom{m}{m-n}</script><h5 id="Example3"><a href="#Example3" class="headerlink" title="Example3"></a>Example3</h5><p>求$\sum_{k}k\binom{n}{k}\binom{s}{k},n\in\mathbb{N}\\$.</p>
<p>第一反应仍然是使用吸收恒等式,但是注意到$n$和$s$的范围不一样,由于吸收恒等式的范围很松,因此应选择一个范围更松的数吸收,这样才能保证另一个数范围的特殊性,于是有:</p>
<script type="math/tex; mode=display">
\sum_{k}k\binom{n}{k}\binom{s}{k}=s\sum_{k}\binom{n}{k}\binom{s-1}{k-1}\\
=s\binom{n+s-1}{n-1}</script><h5 id="Example4"><a href="#Example4" class="headerlink" title="Example4"></a>Example4</h5><p>求$\sum_{0\leq k}\binom{n+k}{2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1},n\in\mathbb{N}\\$.</p>
<p>我们有:</p>
<script type="math/tex; mode=display">
\sum_{0\leq k}\binom{n+k}{2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1}=\sum_{0\leq k}\binom{n+k}{k}\binom{n}{k}\cfrac{(-1)^k}{k+1},n\in\mathbb{N}\\
=\cfrac{1}{n+1}\sum_{0\leq k}\binom{n+k}{k}\binom{n+1}{k+1}{(-1)^k}\\
=\cfrac{1}{n+1}\sum_{0\leq k}\binom{-n-1}{k}\binom{n+1}{k+1}\\=\cfrac{1}{n+1}\binom{0}{n}\\=[n=0]</script><h5 id="Example5"><a href="#Example5" class="headerlink" title="Example5"></a>Example5</h5><p>求$\sum_{k\geq 0}\binom{n+k}{m+2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1},n,m\in\mathbb{N_+}\\$.</p>
<p>考虑恒等式$(26)$,我们有:</p>
<script type="math/tex; mode=display">
\sum_{k\geq 0}\binom{n+k}{m+2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1}=\sum_{k\geq 0}\sum_{0\leq j\leq n+k-1}\binom{n+k-1-j}{2k}\binom{j}{m-1}\binom{2k}{k}\cfrac{(-1)^k}{k+1}\\
=\sum_{0\leq j\leq n-1}\binom{j}{m-1}\sum_{j+1-n\leq k,0\leq k}\binom{n+k-1-j}{2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1}</script><p>注意到如果$j+1-n\geq 0$,则$\binom{n+k-1-j}{2k}\\$应为$0$.所以有:</p>
<script type="math/tex; mode=display">
\sum_{0\leq j\leq n-1}\binom{j}{m-1}\sum_{j+1-n\leq k,0\leq k}\binom{n+k-1-j}{2k}\binom{2k}{k}\cfrac{(-1)^k}{k+1}\\
=\sum_{0\leq j<n}\binom{j}{m-1}[n-1-j=0]=\binom{n-1}{m-1}</script><h5 id="Example6"><a href="#Example6" class="headerlink" title="Example6"></a>Example6</h5><p>求$\sum_{k=0}^n(C_n^k)^2$.</p>
<script type="math/tex; mode=display">
\sum_{k=0}^n(C_n^k)^2=\sum_{k=0}^nC_{n}^k\times C_{n}^{n-k}=C_n^{2n}</script><h4 id="转化为递归式-和式求解"><a href="#转化为递归式-和式求解" class="headerlink" title="转化为递归式/和式求解"></a>转化为递归式/和式求解</h4><h5 id="Example1-1"><a href="#Example1-1" class="headerlink" title="Example1"></a>Example1</h5><p>求$Q_n=\sum_{k\leq 2^n}\binom{2^n-k}{k}(-1)^k,n\in\mathbb{N}\\$.</p>
<p>如果要转化为递归式的话,我们所掌握的只有加法恒等式,但加法恒等式只给出了杨辉三角中相邻两行的关系.但由于$Q_n$的式子中实际上只与$2^n$有关,我们不妨令$R_n=\sum_{k\leq n}\binom{n-k}{k}(-1)^k\\$,显然有$Q_n=R_{2^n}$.</p>
<p>而我们有:</p>
<script type="math/tex; mode=display">
R_n=\sum_{k\leq n}\binom{n-1-k}{k}(-1)^k+\sum_{k\leq n}\binom{n-1-k}{k-1}(-1)^k\\
=\sum_{k\leq n}\binom{n-1-k}{k}(-1)^k+\sum_{k\leq n-1}\binom{n-k-2}{k}(-1)^{k+1}\\
=\sum_{k\leq n-1}\binom{n-1-k}{k}(-1)^k+\binom{-1}{n}(-1)^n-(\sum_{k\leq n-2}\binom{n-2-k}{k}(-1)^k+\binom{-1}{n-1}(-1)^{n-1})\\
=\sum_{k\leq n-1}\binom{n-1-k}{k}(-1)^k-\sum_{k\leq n-1}\binom{n-2-k}{k}(-1)^k\\
=R_{n-1}-R_{n-2}\\
=R_{n-2}-R_{n-3}-R_{n-2}\\
=-R_{n-3}\\
=R_{n-6}</script><p>也即$R_n$具有周期性,不难计算前几项答案,最后有$Q_n\begin{cases}1&amp;n=0\\0&amp;n is  odd\-1&amp;n&gt;0\and n is even\end{cases}$.</p>
<h5 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h5><p>求$(\sum^{+\infty}_{i=0}C^{ik+r}_{nk})\mod p$.</p>
<h5 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h5><p>考虑设$f(n,r)=\sum^{+\infty}_{i=0}C^{ik+r}_{nk}\\$,则有:</p>
<script type="math/tex; mode=display">
f(n,r)=\sum^{+\infty}_{i=0}C^{ik+r}_{nk}\\=\sum_{i=0}^{+\infty}\sum_{j=0}^k C_{nk-k}^{ik+r-j}\times C_k^j\\
=\sum^k_{j=0}C_k^j\sum_{i=0}^{+\infty}C_{nk-k}^{ik+r-j}\\=\sum_{j=0}^kC_k^jf(n-1,r-j)\\</script><p>整理上式,得到:$f(n,r)=\sum_{j=0}^kC_k^jf(n-1,r-j)\\$.</p>
<p>于是我们得到了关于$f$的转移方程,可以矩阵加速.</p>
<h4 id="将整数转化为分数求解"><a href="#将整数转化为分数求解" class="headerlink" title="将整数转化为分数求解"></a>将整数转化为分数求解</h4><h5 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h5><p>即恒等式$(34)$.</p>
<h4 id="利用高阶差分求解"><a href="#利用高阶差分求解" class="headerlink" title="利用高阶差分求解"></a>利用高阶差分求解</h4><h5 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h5><p>即恒等式$(35)$.</p>
<h4 id="利用二项式反演求解"><a href="#利用二项式反演求解" class="headerlink" title="利用二项式反演求解"></a>利用二项式反演求解</h4><p>见”反演.md”.</p>
<h4 id="利用生成函数求解"><a href="#利用生成函数求解" class="headerlink" title="利用生成函数求解"></a>利用生成函数求解</h4><h5 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h5><p>即恒等式$(36)$.</p>
<h4 id="利用超几何级数求解"><a href="#利用超几何级数求解" class="headerlink" title="利用超几何级数求解"></a>利用超几何级数求解</h4><p>见”生成函数.md”.</p>
<h4 id="利用微积分求解"><a href="#利用微积分求解" class="headerlink" title="利用微积分求解"></a>利用微积分求解</h4><h5 id="Example-3"><a href="#Example-3" class="headerlink" title="Example"></a>Example</h5><p>求$\sum_{k=1}^nk^2C_n^k$.</p>
<script type="math/tex; mode=display">
((1+x)^n)=(\sum_{k=0}^nC_n^kx^{k})\\
((1+x)^n)'=(\sum_{k=0}^nC_n^kx^{k})'\\
n(1+x)^{n-1}=\sum_{k=0}^nkC_n^kx^{k-1}\\
nx(1+x)^{n-1}=\sum_{k=0}^nkC_n^kx^{k}\\
(nx(1+x)^{n-1})'=(\sum_{k=0}^nkC_n^kx^{k})'\\
n((1+x)^{n-1}+(n-1)x(1+x)^{n-2})=\sum_{k=0}^nk^2C_n^kx^{k-1}\\</script><p>取$x=1$,则原式$=n(n+1)2^{n-2}$.</p>
<h3 id="Lucas定理"><a href="#Lucas定理" class="headerlink" title="Lucas定理"></a>Lucas定理</h3><p>若$p$是质数,则$C_n^m\mod p=C_{n\mod p}^{m\mod p}\times C_{\lfloor\frac n p\rfloor}^{\lfloor\frac m p\rfloor}\mod p\\$.</p>
<p>或者说,将$n$和$m$在$p$进制下分解,再逐位求组合数并相乘.</p>
<p>证明:</p>
<p>首先,若$i\ne 0$且$i\ne p$,$C_{p}^i\equiv\frac p iC_{p-1}^{i-1}\equiv 0(\mod p)\\$.</p>
<p>而根据二项式定理,$(1+x)^p\equiv \sum_{i=0}^pC_{p}^ix^i=1+x^p(\mod p)\\$.</p>
<p>令$n=k_1p+b_1$,$m=k_2p+b_2$,则$(1+x)^n=(1+x)^{k_1p}(1+x)^{b_1}\\$.</p>
<p>而$(1+x)^{k_1p}\equiv (1+x^p)^{k_1}(\mod p)\\$,有$(1+x)^n\equiv (1+x^p)^{k_1}(1+x)^{b_1}\\$</p>
<p>根据二项式定理,$C_n^m\mod p$即$x^m$项的系数.</p>
<p>我们可以得出,$C_n^mx^m\equiv C_{k_1}^{k_2}x^{k_2p}C_{b1}^{b_2}x^{b_2}(\mod p)\\$,那么有$C_a^b\equiv C_{k_1}^{k_2}C_{b_1}^{b_2}(\mod p)\\$.</p>
<h3 id="扩展Lucas定理"><a href="#扩展Lucas定理" class="headerlink" title="扩展Lucas定理"></a>扩展Lucas定理</h3><p>令$p=\prod p_i^{e_i}$,那我们只要对于每个$i$求出$C_n^m\mod p_i^{e_i}$,然后使用中国剩余定理合并即可.</p>
<p>那现在问题转化为要求$C_n^m\mod p^k$,其中$p\in prime$.</p>
<p>原式$=\frac{n!}{m!(n-m)!}\mod p^k=\frac {\frac {n!}{p^x}}{\frac{m!}{p^y}\frac{(n-m)!}{p^z}}p^{x-y-z}\mod p^k\\$.</p>
<p>现在问题转化为求$\frac{n!}{p^x}\mod p^k以及p^x\\$.</p>
<p>注意到:</p>
<script type="math/tex; mode=display">
n!=\prod_{i=1}i\\=(\prod_{i=wp,w\in \mathbb{Z}}i)(\prod_{i\ne wp,w\in\mathbb{Z}}i)\\= p^{\lfloor n p\rfloor}(\lfloor n p\rfloor!)(\prod_{i\ne wp,w\in\mathbb{Z}}i)\\
\equiv p^{\lfloor n p\rfloor}(\lfloor n p\rfloor!)(\prod_{i=1,i\ne wp,w\in\mathbb{Z}}^{p^k}i)^{\lfloor \frac n {p^k}\rfloor}(\prod^n_{i=p^k\lfloor\frac n {p^k}\rfloor,i\ne wp,w\in\mathbb{Z}}i)(\mod p^k)</script><p>递归求解即可.</p>
<p>ps:</p>
<p>这样摆式子可能非常难以理解,我们考虑将$1-n$的所有数全部排成一个宽为$p^k$的矩阵.</p>
<p>那右边第一项就是把那些$p$的倍数的列拿出来,第二项是那些填满的行,第三项是最后没填满的一行.</p>
<h2 id="斯特林数"><a href="#斯特林数" class="headerlink" title="斯特林数"></a>斯特林数</h2><h3 id="第一类斯特林数"><a href="#第一类斯特林数" class="headerlink" title="第一类斯特林数"></a>第一类斯特林数</h3><p>$ n\brack k\\$:长度为$n$的排列划分成$k$个轮换的方案数.</p>
<p>考虑现在已经将$n-1$个数分成了若干轮换,现在新加入第$n$个数.这个数要么和其他的数一起组成轮换,要么自己形成自环.</p>
<p>而由于它可以插入前面轮换的任意位置,显然$\left[ \begin{array}{c}n\\k\end{array} \right]=(n-1)\left[ \begin{array}{c}n-1\\k\end{array} \right]+\left[ \begin{array}{c}n-1\\k-1\end{array} \right]\\$.</p>
<p>特别地,我们定义$\left[ \begin{array}{c}0\\k\end{array} \right]=[k=0]\\$.</p>
<p>由于所有的排列都至少存在一个轮换,因此我们有:$\sum_{k=0}^n\left[ \begin{array}{c}n\\k\end{array} \right]=n!$.</p>
<h3 id="第二类斯特林数"><a href="#第二类斯特林数" class="headerlink" title="第二类斯特林数"></a>第二类斯特林数</h3><p>$\left\{ \begin{array}{c}n\\k\end{array} \right\}$:将$n$个本质不同的物品划分成k个非空集合的方案数.</p>
<p>考虑现在已经放好$n-1$个物品,正要放入第$n$个物品.那么这个物品要么单独放在一起,要么和其他物品放在一起.显然$\left\{ \begin{array}{c}n\\k\end{array} \right\}=k\left\{ \begin{array}{c}n-1\\k\end{array} \right\}+\left\{ \begin{array}{c}n-1\\k-1\end{array} \right\}\\$.</p>
<p>特别地,我们定义$\left\{ \begin{array}{c}0\\k\end{array} \right\}=[k=0]\\$.</p>
<h3 id="斯特林数的扩展"><a href="#斯特林数的扩展" class="headerlink" title="斯特林数的扩展"></a>斯特林数的扩展</h3><p>如果我们让斯特林数的定义式扩展到整数域,我们可以发现一个性质:${n\brack m}={-m\brace -n}\\$.</p>
<h3 id="斯特林恒等式"><a href="#斯特林恒等式" class="headerlink" title="斯特林恒等式"></a>斯特林恒等式</h3><script type="math/tex; mode=display">
(1)\\
x^n=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}x^{\underline{k}}=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}(-1)^{n-k}x^{\overline{k}}\\
证明：\\先考虑前半段，不妨使用数学归纳\\
若x^{n-1}=\sum_{k=0}^{n-1}\left\{ \begin{array}{c}n-1\\k\end{array} \right\}x^{\underline{k}}\\
我们要证明x^{n}=\sum_{k=0}^{n}\left\{ \begin{array}{c}n\\k\end{array} \right\}x^{\underline{k}}
\\\\
也就是证明x\sum_{k=0}^{n-1}\left\{ \begin{array}{c}n-1\\k\end{array} \right\}x^{\underline{k}}=\sum_{k=0}^{n}\left\{ \begin{array}{c}n\\k\end{array} \right\}x^{\underline{k}}\\
考虑(x-k)x^{\underline{k}}=x^{\underline{k+1}}，所以x\cdot x^{\underline{k}}=x^{\underline{k+1}}+kx^{\underline{k}}\\
那么左边=\sum_{k=0}^{n-1}\left\{ \begin{array}{c}n-1\\k\end{array} \right\}x^{\underline{k+1}}+\sum_{k=0}^{n-1}\left\{ \begin{array}{c}n-1\\k\end{array} \right\}kx^{\underline{k}}\\
由于n\ne1\\
原式=\sum_{k=1}^{n}\left\{ \begin{array}{c}n-1\\k-1\end{array} \right\}x^{\underline{k}}+\sum_{k=1}^{n}\left\{ \begin{array}{c}n-1\\k\end{array} \right\}kx^{\underline{k}}\\
=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}x^{\underline{k}}\\
\\
至于后半段，由于x^{\underline{n}}=(-1)^n(-x)^{\overline{n}}\\
所以x^n=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}(-1)^k(-x)^{\overline{k}}\\
不妨用x来代替-x，我们有(-x)^n=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}(-1)^k(x)^{\overline{k}}=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}(-1)^{n-k}x^{\overline{k}}</script><script type="math/tex; mode=display">
(2)\\
x^{\overline{n}}=\sum_{k=0}^n\left[ \begin{array}{c}n\\k\end{array} \right]x^k\\
x^{\underline{n}}=\sum_{k=0}^n\left[ \begin{array}{c}n\\k\end{array} \right](-1)^{n-k}x^k\\
证明：\\
先考虑前者，由于(x+n-1)x^k=x^{k+1}+(n-1)x^k\\
所以类似于(1)前半段的推导即可得到\\
后者同样可以使用下降幂和上升幂的转化来得到\\</script><script type="math/tex; mode=display">
(3)\\
\sum_{k=0}^n\left[ \begin{array}{c}n\\k\end{array} \right]\left\{ \begin{array}{c}k\\m\end{array} \right\}(-1)^{n-k}=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}\left[ \begin{array}{c}k\\m\end{array} \right](-1)^{n-k}=[m=n]\\
（反转公式）\\

证明：\\
考虑先证明后半部分，将(2)带入(1)，得到x^n=\sum_{k=0}^n\left\{ \begin{array}{c}n\\k\end{array} \right\}x^{\underline{k}}=\sum_{k=0}^n\sum_{m=0}^k\left\{ \begin{array}{c}n\\k\end{array} \right\}
\left[ \begin{array}{c}k\\m\end{array} \right](-1)^{n-k}x^m\\
由于这对任意x都成立，因此右边除了x^n以外的项系数均为0，而x^n的系数为1\\
前半部分是同理的\\</script><script type="math/tex; mode=display">
(4)\\
\left\{ \begin{array}{c}n+1\\m+1\end{array} \right\}=\sum_{k=m}^n\left( \begin{array}{c}n\\k\end{array} \right)\left\{ \begin{array}{c}k\\m\end{array} \right\}\\
\left[ \begin{array}{c}n+1\\m+1\end{array} \right]=\sum_{k=m}^n\left( \begin{array}{c}n\\k\end{array} \right)\left[ \begin{array}{c}k\\m\end{array} \right]\\
证明：\\
对于前者，考虑组合意义，将n+1个分为m+1组，也就是先找一部分分成m组，再把剩下的分到一组\\
对于后者，也可以同样考虑组合意义</script><script type="math/tex; mode=display">
(5)\\
\left\{ \begin{array}{c}n\\m\end{array} \right\}=\sum_{k=m}^n\left( \begin{array}{c}n\\k\end{array} \right)\left\{ \begin{array}{c}k+1\\m+1\end{array} \right\}(-1)^{n-k}\\
\left[ \begin{array}{c}n\\m\end{array} \right]=\sum_{k=m}^n\left( \begin{array}{c}n\\k\end{array} \right)\left[ \begin{array}{c}k+1\\m+1\end{array} \right](-1)^{n-k}\\
证明：\\
由(4)，根据二项式反演可知</script><script type="math/tex; mode=display">
(6)\\
m!\left\{ \begin{array}{c}n\\m\end{array} \right\}=\sum_{k=0}^mC_m^kk^n(-1)^{m-k}\\
证明：\\
首先有m^n=\sum_{k=0}^mm^{\underline{k}}\left\{ \begin{array}{c}m\\k\end{array} \right\}=\sum_{k=0}^mk!C_m^k\left\{ \begin{array}{c}m\\k\end{array} \right\}\\
对这个式子进行二项式反演即可</script><script type="math/tex; mode=display">
(7)\\
\left\{ \begin{array}{c}n+1\\m+1\end{array} \right\}=\sum_{k=0}^n\left\{ \begin{array}{c}k\\m\end{array} \right\}(m+1)^{n-k}\\
证明：\\
考虑组合意义，相当于先把前k个分为m组，把第k+1个数放到第m+1组\\
然后剩下(n+1)-(k+1)=n-k个随便放\\
相当于我们按照每组所放的数的最小值区分每组\\
由于这么做，第m+1组（最小值最大的那组）在k不同的时候最小值是不同的，因此一定不重不漏</script><script type="math/tex; mode=display">
(8)\\
\left[\begin{array}{c}n+1\\m+1\end{array} \right]=\sum_{k=0}^n\left[ \begin{array}{c}k\\m\end{array} \right]C_{n}^k(n-k)!=n!\sum_{k=0}^n\frac{\left[ \begin{array}{c}k\\m\end{array} \right]}{k!}\\
证明：\\
先考虑前半部分，首先如果n>0，我们有\left[ \begin{array}{c}n\\1\end{array} \right]=(n-1)!\\
这个式子很显然，我们现在有一个长度为n-1的环，想要往里插入第n个数有n-1种选择，所以我们有\\
\left[ \begin{array}{c}n\\1\end{array} \right]=\left[ \begin{array}{c}n-1\\1\end{array} \right](n-1)\\
数学归纳一下即可\\
那么前半部分的组合意义就是：考虑将n+1个数划分成m+1个环\\
我们先将其中k个数划分成m个环，剩下n+1-k个数划分成另一个环\\
但是这样算显然会算重，所以我们只需要勒令第n+1个数在最后一个环里即可\\
该证明就显然了\\
而由于C_n^k(n-k)!=C_n^{n-k}(n-k)!=n^{\underline{n-k}}=\frac{n!}{k!}\\
因此后半部分也得证\\</script><script type="math/tex; mode=display">
(9)\\
\left\{ \begin{array}{c}n+m+1\\m\end{array} \right\}=\sum_{k=0}^mk\left\{ \begin{array}{c}n+k\\k\end{array} \right\}\\
\left[ \begin{array}{c}n+m+1\\m\end{array} \right]\sum_{k=0}^m(n+k)\left[ \begin{array}{c}n+k\\k\end{array} \right]\\
证明：\\
先考虑前者，我们将n+k个位置分到k个集合之后\\
还剩下(n+m+1)-(n+k)=(m-k+1)个数，剩下(m-k)个集合\\
拿出来(n+k+1)这个数，剩下的数刚好够每个集合放一个\\
最后枚举一下把(n+k+1)放在哪里即可\\
由于每个划分一定存在一段（可能是0）单独自己集合的后缀\\
所以这个递推成立\\
后者也可以同样证明</script><script type="math/tex; mode=display">
(10)\\
C_n^m(n-1)^{\underline{n-m}}=\sum_{k=m}^n\left[ \begin{array}{c}n\\k\end{array} \right]\left\{ \begin{array}{c}k\\m\end{array} \right\}\\
证明：\\
考虑(n-1)^{\underline{n-m}}=\frac{(n-1)!}{(m-1)!}\\
不妨设f(n,m)=\sum_{k=m}^n\left[ \begin{array}{c}n\\k\end{array} \right]\left\{ \begin{array}{c}k\\m\end{array} \right\}\\
相当于将n个数分成非空m组，然后组内的数要形成若干轮换的方案数\\
那么知道f(n,m)=f(n-1,m-1)+(n-1+m)f(n-1,m)\\
设g(n,m)=C_n^m\frac{(n-1)!}{(m-1)!}=\frac{n!(n-1)!}{m!(n-m)!(m-1)!}\\
那么知道\\
g(n-1,m-1)=\frac{(n-1)!(n-2)!}{(m-1)!(n-m)!(m-2)!}\\
g(n-1,m)=\frac{(n-1)!(n-2)!}{m!(n-1-m)!(m-2)!}\\
显然g(n,m)=g(n-1,m-1)+(n-1+m)g(n-1,m)\\
数学归纳即可</script><script type="math/tex; mode=display">
(11)\\
C_n^m=\frac{n!}{m!(n-m)!}=\sum_{k=m}^n\left\{ \begin{array}{c}n+1\\k+1\end{array} \right\}\left[ \begin{array}{c}k\\m\end{array} \right](-1)^{m-k}\\
n^{\underline{n-m}}=\frac{n!}{m!}=\sum_{k=m}^n\left[ \begin{array}{c}n+1\\k+1\end{array} \right]\left\{ \begin{array}{c}k\\m\end{array} \right\}(-1)^{m-k}，其中m\leq n\\
证明：\\
考虑(4)，对其做一遍斯特林反演即可</script><script type="math/tex; mode=display">
(12)\\
\left\{ \begin{array}{c}n\\l+m\end{array} \right\}C_{l+m}^l=\sum_{k=l}^n\left\{ \begin{array}{c}k\\l\end{array} \right\}\left\{ \begin{array}{c}n-k\\m\end{array} \right\}C_n^k\\
\left[ \begin{array}{c}n\\l+m\end{array} \right]C_{l+m}^l=\sum_{k=l}^n\left[ \begin{array}{c}k\\l\end{array} \right]\left[ \begin{array}{c}n-k\\m\end{array} \right]C_n^k\\
证明：\\
先考虑前者，左边即先将n个数分为l+m个集合，然后再挑出l个集合\\
那不妨枚举这l个集合中是哪些数，然后再进行分配\\
后者同理</script><h2 id="欧拉数"><a href="#欧拉数" class="headerlink" title="欧拉数"></a>欧拉数</h2><p>记$\left\langle\begin{array}\\n\\k\end{array}\right\rangle$表示$\{1,2,…,n\}$的排列$a$中满足这条性质的排列个数:存在且只存在$k$个升高,换句话说,存在且只存在$k$个$i$,满足$1\leq i&lt;n$,$a_i&lt;a_{i+1}$.不难发现$\left\langle\begin{array}\\n\\k\end{array}\right\rangle=\left\langle\begin{array}\\n\\n-k-1\end{array}\right\rangle$</p>
<p>考虑在一个$\{1,2,…,n-1\}$的排列中插入$n$,设插入的位置是原本$a_i$的后面,那么要么原本$a_i&lt;a_{i+1}$,要么反之.前者不会改变排列的升高的数量,后者则会增加$1$.另外还有一种情况是插入到了序列最前面.于是我们自然得到:$\left\langle\begin{array}\\n\\k\end{array}\right\rangle=(k+1)\left\langle\begin{array}\\n-1\\k\end{array}\right\rangle+(n-k)\left\langle\begin{array}\\n-1\\k-1\end{array}\right\rangle$.</p>
<p>特别地,我们令$\left\langle\begin{array}\\0\\k\end{array}\right\rangle=[k=0]$,若$k&lt;0$,则$\left\langle\begin{array}\\n\\k\end{array}\right\rangle=0$.</p>
<h3 id="欧拉数与二项式系数"><a href="#欧拉数与二项式系数" class="headerlink" title="欧拉数与二项式系数"></a>欧拉数与二项式系数</h3><p>我们有Worpitzky恒等式:</p>
<script type="math/tex; mode=display">
x^n=\sum_{k\geq 0}\binom{x+k}{n}\left\langle\begin{array}\\n\\k\end{array}\right\rangle,n\in\mathbb{N}</script><p>还有另一个恒等式:</p>
<script type="math/tex; mode=display">
\left\langle\begin{array}\\n\\m\end{array}\right\rangle=\sum_{k=0}^m\binom{n+1}{k}(m+1-k)^n(-1)^k</script><p>剩下的不会了.</p>
<h2 id="调和数"><a href="#调和数" class="headerlink" title="调和数"></a>调和数</h2><p>略过.</p>
<h2 id="伯努利数"><a href="#伯努利数" class="headerlink" title="伯努利数"></a>伯努利数</h2><p>定义$B_j$为第$j$个伯努利数,且满足$\sum_{j=0}^m\binom{m+1}{j}B_j=[m=0],m\geq 0\\$.</p>
<p>定义$S_m(n)=\sum_{i=0}^{n-1}i^m$.</p>
<p>伯努利数满足公式:$S_m(n)=\cfrac{1}{m+1}\sum_{k=0}^m\binom{m+1}{k}B_kn^{m+1-k}\\$.</p>
<p>证明如下:</p>
<p>对$S_{m+1}(n)$使用扰动法,我们有:</p>
<script type="math/tex; mode=display">
S_{m+1}(n)+n^{m+1}=\sum_{k=0}^{n-1}(k+1)^{m+1}\\
=\sum_{k=0}^{n-1}\sum_{j=0}^{m+1}\binom{m+1}{j}k^j\\
=\sum_{j=0}^{m+1}\binom{m+1}{j}S_j(n)\\
=\sum_{j=0}^{m}\binom{m+1}{j}S_j(n)+S_{m+1}(n)\\
n^{m+1}=\sum_{j=0}^m\binom{m+1}{j}S_j(n)\\</script><p>接下来使用数学归纳,假设$0\leq j&lt;m$时该公式成立,并假设有$S_m(n)=\cfrac{1}{m+1}\sum_{k=0}^m\binom{m+1}{k}B_kn^{m+1-k}+\Delta\\$,我们只需要证明$\Delta=0$.</p>
<script type="math/tex; mode=display">
n^{m+1}=\sum_{j=0}^m\binom{m+1}{j}\cfrac{1}{j+1}\sum_{k=0}^j\binom{j+1}{k}B_kn^{j+1-k}+(m+1)\Delta\\
=\sum_{0\leq k\leq j\leq m}\binom{j+1}{k}\binom{m+1}{j}\cfrac{1}{j+1}B_kn^{j+1-k}+(m+1)\Delta\\
=\sum_{0\leq k\leq j\leq m}\binom{j+1}{j-k}\binom{m+1}{j}\cfrac{1}{j+1}B_{j-k}n^{k+1}+(m+1)\Delta\\
=\sum_{0\leq k\leq j\leq m}\binom{j+1}{k+1}\binom{m+1}{j}\cfrac{1}{j+1}B_{j-k}n^{k+1}+(m+1)\Delta\\
=\sum_{0\leq k\leq m}\cfrac{n^{k+1}}{k+1}\sum_{j=k}^mB_{j-k}\binom{m+1}{j}\binom{j}{k}+(m+1)\Delta\\
=\sum_{0\leq k\leq m}\cfrac{n^{k+1}}{k+1}\binom{m+1}{k}\sum_{j=k}^mB_{j-k}\binom{m+1-k}{j-k}+(m+1)\Delta\\
=\sum_{k=0}^m\cfrac{n^{k+1}}{k+1}\binom{m+1}{k}\sum_{j=0}^{m-k}B_{j}\binom{m+1-k}{j}+(m+1)\Delta\\
=\sum_{k=0}^m\cfrac{n^{k+1}}{k+1}\binom{m+1}{k}[m-k=0]+(m+1)\Delta\\
=n^{m+1}+(m+1)\Delta</script><p>显然$\Delta=0$,上式成立.</p>
<h2 id="斐波那契数"><a href="#斐波那契数" class="headerlink" title="斐波那契数"></a>斐波那契数</h2><p>定义斐波那契数$F_n=\begin{cases}0&amp;n=0\\1&amp;n=1\\F_{n-1}+F_{n-2}&amp;n&gt;1\end{cases}$.</p>
<h3 id="斐波那契数的扩展定义"><a href="#斐波那契数的扩展定义" class="headerlink" title="斐波那契数的扩展定义"></a>斐波那契数的扩展定义</h3><p>首先根据数学归纳,不难证明卡西尼恒等式:</p>
<script type="math/tex; mode=display">
F_{n+1}F_{n-1}-F_n^2=(-1)^n,n>0</script><p>事实上,如果我们将斐波那契数的递推式改写作:$F_n=F_{n+2}-F_{n+1}$,我们可以在$n\in\mathbb{Z}$的时候定义斐波那契数,同样也是满足上面的恒等式的,而且我们可以发现:</p>
<script type="math/tex; mode=display">
F_{-n}=(-1)^{n-1}F_n,n\in\mathbb{Z}</script><h3 id="斐波那契数与数论"><a href="#斐波那契数与数论" class="headerlink" title="斐波那契数与数论"></a>斐波那契数与数论</h3><p>如果我们考虑不断使用斐波那契递推式展开,不难发现:</p>
<script type="math/tex; mode=display">
F_{n+k}=F_kF_{n+1}+F_{k-1}F_n\\
F_{n+m+1}=F_{n+1}F_{m+1}+F_nF_m</script><p>另外,如果我们在上面这个式子中取$k=wn,w\in\mathbb{N}$并使用归纳法,我们又可以得到一个性质:$F_{kn}$是$F_n$的倍数,$k\in\mathbb{Z}$.</p>
<p>再观察这个式子,使用归纳法可以证明$\gcd(F_{n},F_{n-1})=1$,进一步有:$\gcd(F_{n+m},F_m)=\gcd(F_n,F_m)$.</p>
<p>如果我们推广这个结论,就可以得到一个重要的性质:</p>
<script type="math/tex; mode=display">
\gcd(F_m,F_n)=F_{\gcd(n,m)}</script><p>如果我们再一次推广这个结论,可以得到马蒂亚舍维奇引理:</p>
<script type="math/tex; mode=display">
F_n^2|F_m\Leftrightarrow nF_n|m,n>2</script><p>这个引理的证明如下:</p>
<p>由于$F_{n+1}\equiv F_{n-1}\pmod {F_n}$.于是我们有:$F_{2n}=F_nF_{n+1}+F_{n-1}F_n$,也就是$F_{2n}\equiv 2F_nF_{n+1}\pmod {F_n^2}$.</p>
<p>另外我们有:$F_{2n+1}\equiv F_{n+1}^2\pmod{F_n^2}$.</p>
<p>同理,使用归纳法可以证明:$F_{kn}\equiv kF_nF_{n+1}^{k-1}\pmod{F_n^2},F_{kn+1}\equiv F_{n+1}^k\pmod{F_n^2}$.</p>
<p>而$F_{n+1}\bot F_n$,于是$F_{kn}\equiv 0\pmod {F_n^2}\Leftrightarrow k\equiv 0\pmod {F_n},n&gt;2$.</p>
<h3 id="斐波那契数系"><a href="#斐波那契数系" class="headerlink" title="斐波那契数系"></a>斐波那契数系</h3><p>我们如果定义$j\gg k\Leftrightarrow j\geq k+2$,那么有齐肯多夫定理:</p>
<p>每个正整数都有唯一的表示方式满足:$n=\sum_{i=1}^rF_{k_i},\forall 1\leq i&lt; r,k_i\gg k_{i+1}\gg 0$.</p>
<p>首先证明存在性:我们考虑数学归纳,对于一个数n,如果$\exist k$满足$F_k=n$,则显然成立,不然,应$\exist k$满足$F_k&lt;n&lt;F_{k+1}$,而$n-F_k$的表示已经存在了.另外,由于$n-F_k&lt;F_{k+1}-F_k=F_{k-1}$,因此必定不可能出现选了$F_k$又选了$F_{k-1}$的情况,存在性得证.</p>
<p>至于唯一性,如果我们不选择$F_k$而是选择$F_{k-1}$,那么显然接下来无论怎么选,它们的加和都不可能大于等于$F_k$,因此一定是唯一的.</p>
<p>这样的话,我们可以将一个自然数$n$以斐波那契数的形式表示出来.</p>
<h3 id="斐波那契数的封闭形式"><a href="#斐波那契数的封闭形式" class="headerlink" title="斐波那契数的封闭形式"></a>斐波那契数的封闭形式</h3><p>使用生成函数,令$F(z)=\sum_{k\geq 0}F_kz^k$.那么不难发现$F(z)-zF(z)-z^2F(z)=z$,也就是$F(z)=\cfrac{z}{1-z-z^2}$.</p>
<p>考虑这个形式一定可以分解为$F(z)=\cfrac{a}{1-\alpha z}+\cfrac{b}{1-\beta z}$的形式,而这两种形式对应的生成函数都很显然.</p>
<p>进行因式分解,如果令$\phi=\cfrac{1+\sqrt 5}{2},\hat\phi=\cfrac{1-\sqrt 5}{2}$,那么可以得到$F_n=\cfrac{1}{\sqrt 5}(\phi^n-\hat\phi^n)$.</p>
<p>另外,由于$\hat\phi^n$的影响很小,于是又有$F_n=\lfloor\cfrac{\phi^n}{\sqrt 5}+0.5\rfloor$.</p>
<h3 id="连项式"><a href="#连项式" class="headerlink" title="连项式"></a>连项式</h3><p>连项式多项式$K_n(x_1,x_2,…,x_n)$定义为:$K_n(x_1,x_2,…,x_n)=\begin{cases}1&amp;n=0\\x_1&amp;n=1\\x_nK_{n-1}(x_1,x_2,…x_{n-1})+K_{n-2}(x_1,x_2,…,x_{n-2})&amp;n\geq 2\end{cases}$.</p>
<p>通过定义不难发现:$K_n(1,1,…,1)=F_{n+1}$.</p>
<p>继续观察式子,会发现它递归的过程相当于枚举是否消掉相邻的一对数$(x_{n-1},x_n)$.我们考虑用这样一种形式的字符串来表示最后某一项的情况:’.’为还没有消除掉的项,长度为$1$;’-‘为已经消除了的两项,长度为$2$.那么$K_n(x_1,x_2,…,x_n)$就可以表示为一个长度为$n$的字符串,其中若有$k$个’-‘,有$n-2k$个’.’,则有$\binom{n-k}{k}$种不同的排列方式.</p>
<p>于是我们有:</p>
<script type="math/tex; mode=display">
K_n(z,z,...,z)=\sum_{k=0}^n\binom{n-k}{k}z^{n-2k}\\</script><p>另外,这也导出:$F_{n+1}=\sum_{k=0}^n\binom{n-k}{k}\\$.</p>
<p>考虑上面的构造过程,不难发现$K_n(x_1,x_2,…,x_n)=K_n(x_n,x_{n-1},…,x_1)$.</p>
<p>于是递归式可以写成:$K_n(x_1,x_2,…,x_n)=x_1K_{n-1}(x_2,x_3,…x_{n})+K_{n-2}(x_3,x_4,…,x_{n})$.</p>
<p>进一步地,不断展开后得到:</p>
<script type="math/tex; mode=display">
K_{m+n}(x_1,...,x_m,x_{m+1},...,x_{n+m})=\\K_m(x_1,...,x_m)K_n(x_{m+1},...,x_{n+m})+K_{m-1}(x_1,...,x_{m-1})K_{n-1}(x_{m+2},...,x_{n+m})</script><p>另外,根据连项式的定义,不难导出$K_n(x_1,…,x_n+y)=K_n(x_1,…,x_n)+K_{n-1}(x_1,…,x_{n-1})y$.</p>
<p>由这个公式可以推出:$\cfrac{K_{n+1}(a_0,…,a_n)}{K_n(a_1,…,a_n)}=\cfrac{K_n(a_0,…,a_{n-1}+\cfrac{1}{a_n})}{K_{n-1}(a_1,…,a_{n-1}+\cfrac{1}{a_n})}$.</p>
<p>不断做这个迭代,于是我们可以得到连项式与连分数之间的关系:</p>
<script type="math/tex; mode=display">
\cfrac{K_{n+1}(a_0,...,a_n)}{K_n(a_1,...,a_n)}=a_0+\cfrac{1}{a_1+\cfrac{1}{a_2+\cfrac{1}{a_3+...}}}</script><p>另外,这个与数论中的Stern-Brocot树有很大关系,暂略.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://lwlaymh.github.io/2022/08/14/%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0/" data-id="cl7lnwvj7000b8wvt8ix67mth" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/08/14/%E5%8D%9A%E5%BC%88%E8%AE%BA/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2022/08/14/%E5%8F%8D%E6%BC%94/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/09/03/%E9%80%92%E5%BD%92%E5%BC%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/09/03/%E6%95%B4%E5%80%BC%E5%87%BD%E6%95%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/09/03/%E5%A4%9A%E9%A1%B9%E5%BC%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/09/03/%E6%95%B0%E8%AE%BA/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/29/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 LWLAymh<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>